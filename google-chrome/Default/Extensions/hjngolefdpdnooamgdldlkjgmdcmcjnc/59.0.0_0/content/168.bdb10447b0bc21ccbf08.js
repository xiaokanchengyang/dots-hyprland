(self.equatioChromeJsonp=self.equatioChromeJsonp||[]).push([[168,231],{37922:(e,t,r)=>{"use strict";r.d(t,{Ml:()=>n,cT:()=>a});r(61790);var n=e=>new Promise(((t,r)=>{chrome.storage.sync.get(e,(({[e]:n})=>chrome.runtime.lastError?r(chrome.runtime.lastError):t(n)))})),a=e=>new Promise(((t,r)=>{chrome.storage.sync.set(e,(()=>chrome.runtime.lastError?r(chrome.runtime.lastError):t()))}))},13467:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(85279);const a=e=>[n.WU.GoogleDocs,n.WU.GoogleSlides,n.WU.GoogleSheets].includes(e)},5246:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>n.Ay,TX:()=>n.TX});r(61790);var n=r(97219)},97099:(e,t,r)=>{"use strict";r.d(t,{A:()=>p});var n=r(45841),a=r(61790),o=r.n(a),c=r(77617),s=r(88820),i=r(97219),u=r(11441),d=r(70906),l=r(85279);const p=function(){var e=(0,n.A)(o().mark((function e(t){var r,n,a,p,f,h,m,v,b,x,y,w,g,A,k,E,S,C,T,M,O,I,_,R,L,D,P,q,F,U,N,G,W,j,B,H,$,K,Q,J,V,X,z,Y,Z,ee,te,re,ne,ae,oe,ce;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.default.getState(),n=r.mathquill,a=r.mathOptions,p=r.drawer,f=n.latex,h=a.locale,m=a.speechEngine,v=p.mode,b="",e.next=7,(0,i.Ys)(!0);case 7:x=e.sent,e.t0=t,e.next=e.t0===c.CopyMode.Html?11:e.t0===c.CopyMode.MathML?46:e.t0===c.CopyMode.Speech?50:e.t0===c.CopyMode.SVG?54:e.t0===c.CopyMode.PNG?60:e.t0===c.CopyMode.Download?96:e.t0===c.CopyMode.URL?122:157;break;case 11:if(v!==c.ToolModes.GraphEditor){e.next=25;break}return y=(0,c.getGraphRendering)(),w=y.getScreenshot,g=y.getState,e.next=15,w();case 15:return A=e.sent,e.next=18,g();case 18:return k=e.sent,e.next=21,(0,d.A)(A,k);case 21:E=e.sent,b=`<img src="${E}" alt="Equatio Graph" />`,e.next=45;break;case 25:if(v!==c.ToolModes.Whiteboard){e.next=37;break}return S=(0,c.getWhiteboardRendering)(),C=S.getScreenshot,T=S.appState,e.next=29,C();case 29:return M=e.sent,O=T,e.next=33,(0,d.A)(M,O);case 33:I=e.sent,b=`<img src="${I}" alt="Equatio Whiteboard" />`,e.next=45;break;case 37:return e.next=39,c.MathRendering.getSpokenText(f,h,m);case 39:_=e.sent,(R=document.createElement("img")).src=`https://equatio-api.texthelp.com/svg/${encodeURIComponent(f)}`,R.alt=_,L=R.outerHTML,b=L;case 45:return e.abrupt("break",159);case 46:return e.next=48,c.MathRendering.getMathML(f);case 48:return b=e.sent,e.abrupt("break",159);case 50:return e.next=52,c.MathRendering.getSpokenText(f,h,m);case 52:return b=e.sent,e.abrupt("break",159);case 54:return e.next=56,c.MathRendering.getSvg(f);case 56:return D=e.sent,P=D.html,b=P,e.abrupt("break",159);case 60:if(v!==c.ToolModes.GraphEditor){e.next=66;break}return e.next=63,(0,c.getGraphRendering)().getScreenshot();case 63:q=e.sent,e.next=79;break;case 66:if(v!==c.ToolModes.Whiteboard){e.next=72;break}return e.next=69,(0,c.getWhiteboardRendering)().getScreenshot();case 69:q=e.sent,e.next=79;break;case 72:return e.next=74,c.MathRendering.getSvg(f);case 74:return F=e.sent,U=F.html,e.next=78,c.MathRendering.getPng(U);case 78:q=e.sent;case 79:if(!(0,u.QW)(window.location.hostname)){e.next=84;break}return e.next=82,(0,i.Fe)(q);case 82:e.next=92;break;case 84:return e.next=86,fetch(q);case 86:return N=e.sent,e.next=89,N.blob();case 89:return G=e.sent,e.next=92,navigator.clipboard.write([new ClipboardItem({[G.type]:G})]);case 92:if(!x){e.next=95;break}return e.next=95,(0,i.aj)("clipboard",{copyBtn:!0,url:q});case 95:return e.abrupt("return");case 96:if(v!==c.ToolModes.GraphEditor){e.next=102;break}return e.next=99,(0,c.getGraphRendering)().getScreenshot();case 99:W=e.sent,e.next=115;break;case 102:if(v!==c.ToolModes.Whiteboard){e.next=108;break}return e.next=105,(0,c.getWhiteboardRendering)().getScreenshot();case 105:W=e.sent,e.next=115;break;case 108:return e.next=110,c.MathRendering.getSvg(f);case 110:return j=e.sent,B=j.html,e.next=114,c.MathRendering.getPng(B);case 114:W=e.sent;case 115:return H=document.createElement("a"),Object.assign(H,{download:"equatio.png",href:W}),document.body.appendChild(H),H.addEventListener("click",(e=>e.stopPropagation()),!1),H.click(),document.body.removeChild(H),e.abrupt("break",159);case 122:if(v!==c.ToolModes.GraphEditor){e.next=136;break}return $=(0,c.getGraphRendering)(),K=$.getScreenshot,Q=$.getState,e.next=126,K();case 126:return J=e.sent,e.next=129,Q();case 129:return V=e.sent,e.next=132,(0,d.A)(J,V);case 132:X=e.sent,b=X,e.next=156;break;case 136:if(v!==c.ToolModes.Whiteboard){e.next=148;break}return z=(0,c.getWhiteboardRendering)(),Y=z.getScreenshot,Z=z.appState,e.next=140,Y();case 140:return ee=e.sent,te=Z,e.next=144,(0,d.A)(ee,te);case 144:re=e.sent,b=re,e.next=156;break;case 148:return e.next=150,c.MathRendering.getSvg(f);case 150:ne=e.sent,ae=ne.width,oe=ne.height,ce=`height=${Math.floor(oe)}`,ae<20?ce="width=20":oe<20&&(ce="height=20"),b=(0,l.UF)()===l.WU.GoogleForms?`https://equatio-api.texthelp.com/png/${encodeURIComponent(f)}`:`https://equatio-api.texthelp.com/png/${encodeURIComponent(f)}?${ce}`;case 156:return e.abrupt("break",159);case 157:return b=f,e.abrupt("break",159);case 159:if(b){e.next=161;break}return e.abrupt("return");case 161:if(!(0,u.QW)(window.location.hostname)){e.next=166;break}return e.next=164,(0,i.Fe)(b,!0);case 164:e.next=168;break;case 166:return e.next=168,navigator.clipboard.writeText(b);case 168:if(!x){e.next=171;break}return e.next=171,(0,i.aj)("clipboard",{copyBtn:!0});case 171:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},58840:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});const n=Object.freeze({ShowAltTextDialog:0,SelectLeft:1,ArrowRight:2,SelectDocsEquationMac:3,SelectDocsEquationWin:4,InsertPlaceholderCharacter:5,Delete:6,SelectRight:7})},91018:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});const n={3:{code:"Cancel"},6:{code:"Help"},8:{code:"Backspace"},9:{code:"Tab"},12:{code:"Clear"},13:{code:"Enter"},16:{code:"Shift"},17:{code:"Control"},18:{code:"Alt"},19:{code:"Pause"},20:{code:"CapsLock"},21:{code:"KanaMode"},22:{code:"Lang1"},25:{code:"Lang2"},27:{code:"Escape"},28:{code:"Convert"},29:{code:"NonConvert"},30:{code:"Accept"},31:{code:"ModeChange"},32:{code:"Space"},33:{code:"PageUp"},34:{code:"PageDown"},35:{code:"End"},36:{code:"Home"},37:{code:"ArrowLeft"},38:{code:"ArrowUp"},39:{code:"ArrowRight"},40:{code:"ArrowDown"},41:{code:"Select"},42:{code:"Print"},43:{code:"Execute"},44:{code:"PrintScreen"},45:{code:"Insert"},46:{code:"Delete"},47:{code:"Help"},48:{code:"Digit0",keyCap:"0"},49:{code:"Digit1",keyCap:"1"},50:{code:"Digit2",keyCap:"2"},51:{code:"Digit3",keyCap:"3"},52:{code:"Digit4",keyCap:"4"},53:{code:"Digit5",keyCap:"5"},54:{code:"Digit6",keyCap:"6"},55:{code:"Digit7",keyCap:"7"},56:{code:"Digit8",keyCap:"8"},57:{code:"Digit9",keyCap:"9"},65:{code:"KeyA",keyCap:"a"},66:{code:"KeyB",keyCap:"b"},67:{code:"KeyC",keyCap:"c"},68:{code:"KeyD",keyCap:"d"},69:{code:"KeyE",keyCap:"e"},70:{code:"KeyF",keyCap:"f"},71:{code:"KeyG",keyCap:"g"},72:{code:"KeyH",keyCap:"h"},73:{code:"KeyI",keyCap:"i"},74:{code:"KeyJ",keyCap:"j"},75:{code:"KeyK",keyCap:"k"},76:{code:"KeyL",keyCap:"l"},77:{code:"KeyM",keyCap:"m"},78:{code:"KeyN",keyCap:"n"},79:{code:"KeyO",keyCap:"o"},80:{code:"KeyP",keyCap:"p"},81:{code:"KeyQ",keyCap:"q"},82:{code:"KeyR",keyCap:"r"},83:{code:"KeyS",keyCap:"s"},84:{code:"KeyT",keyCap:"t"},85:{code:"KeyU",keyCap:"u"},86:{code:"KeyV",keyCap:"v"},87:{code:"KeyW",keyCap:"w"},88:{code:"KeyX",keyCap:"x"},89:{code:"KeyY",keyCap:"y"},90:{code:"KeyZ",keyCap:"z"},91:{code:"MetaLeft"},92:{code:"MetaRight"},93:{code:"ContextMenu"},95:{code:"Standby"},96:{code:"Numpad0",keyCap:"0"},97:{code:"Numpad1",keyCap:"1"},98:{code:"Numpad2",keyCap:"2"},99:{code:"Numpad3",keyCap:"3"},100:{code:"Numpad4",keyCap:"4"},101:{code:"Numpad5",keyCap:"5"},102:{code:"Numpad6",keyCap:"6"},103:{code:"Numpad7",keyCap:"7"},104:{code:"Numpad8",keyCap:"8"},105:{code:"Numpad9",keyCap:"9"},106:{code:"NumpadMultiply",keyCap:"*"},107:{code:"NumpadAdd",keyCap:"+"},108:{code:"NumpadComma",keyCap:","},109:{code:"NumpadSubtract",keyCap:"-"},110:{code:"NumpadDecimal",keyCap:"."},111:{code:"NumpadDivide",keyCap:"/"},112:{code:"F1"},113:{code:"F2"},114:{code:"F3"},115:{code:"F4"},116:{code:"F5"},117:{code:"F6"},118:{code:"F7"},119:{code:"F8"},120:{code:"F9"},121:{code:"F10"},122:{code:"F11"},123:{code:"F12"},124:{code:"F13"},125:{code:"F14"},126:{code:"F15"},127:{code:"F16"},128:{code:"F17"},129:{code:"F18"},130:{code:"F19"},131:{code:"F20"},132:{code:"F21"},133:{code:"F22"},134:{code:"F23"},135:{code:"F24"},144:{code:"NumLock"},145:{code:"ScrollLock"},160:{code:"ShiftLeft"},161:{code:"ShiftRight"},162:{code:"ControlLeft"},163:{code:"ControlRight"},164:{code:"AltLeft"},165:{code:"AltRight"},166:{code:"BrowserBack"},167:{code:"BrowserForward"},168:{code:"BrowserRefresh"},169:{code:"BrowserStop"},170:{code:"BrowserSearch"},171:{code:"BrowserFavorites"},172:{code:"BrowserHome"},173:{code:"AudioVolumeMute"},174:{code:"AudioVolumeDown"},175:{code:"AudioVolumeUp"},176:{code:"MediaTrackNext"},177:{code:"MediaTrackPrevious"},178:{code:"MediaStop"},179:{code:"MediaPlayPause"},180:{code:"LaunchMail"},181:{code:"MediaSelect"},182:{code:"LaunchApp1"},183:{code:"LaunchApp2"},186:{code:"Semicolon",keyCap:";"},187:{code:"Equal",keyCap:"="},188:{code:"Comma",keyCap:","},189:{code:"Minus",keyCap:"-"},190:{code:"Period",keyCap:"."},191:{code:"Slash",keyCap:"/"},192:{code:"Backquote",keyCap:"`"},219:{code:"BracketLeft",keyCap:"["},220:{code:"Backslash",keyCap:"\\"},221:{code:"BracketRight",keyCap:"]"},222:{code:"Quote",keyCap:"'"},226:{code:"IntlBackslash",keyCap:"\\"},229:{code:"Process"},246:{code:"Attn"},247:{code:"CrSel"},248:{code:"ExSel"},249:{code:"EraseEof"},250:{code:"Play"},251:{code:"ZoomToggle"},254:{code:"Clear"}}},82627:(e,t,r)=>{"use strict";r.d(t,{A:()=>l,D:()=>p});var n=r(77617),a=r(88820),o=r(97219),c=r(16203),s=e=>{e&&(n.Actions.Toolbar.setExtractedGraph(e),a.default.getState().drawer.mode!==n.ToolModes.GraphEditor&&n.Actions.Toolbar.setMode(n.ToolModes.GraphEditor))},i=e=>{"string"==typeof e&&n.Actions.Toolbar.setExtractedMath(e,!0)},u=e=>{e&&(0,c.D)(e)},d=e=>{if(e.source===window&&e.origin===window.location.origin&&e.data&&e.data.action){if("EQUATIO_CHROME_EXTRACT_MATH"===e.data.action){var t=e.data.latex;i(t)}if("EQUATIO_CHROME_EXTRACT_MATHSPACE"===e.data.action){var r=e.data.platformIntegrationId;u(r)}if("EQUATIO_PARTNER_EXTRACT_URL"===e.data.action){var n=e.data.url;n&&(0,o.ns)(n).then((e=>{e&&("string"==typeof e&&i(e),"desmos"===e.type&&s(e.state),"mathspace"===e.type&&u(e.platformIntegrationId))}))}}};const l=()=>(window.postMessage({action:"EQUATIO_CHROME_REQUEST_EXTRACTED_MATH"},window.location.origin),Promise.resolve());var p=()=>{window.removeEventListener("message",d),window.addEventListener("message",d)}},13161:(e,t,r)=>{"use strict";r.d(t,{Dy:()=>u,IC:()=>p,JB:()=>l,Sl:()=>d});var n=r(45841),a=r(61790),o=r.n(a),c=r(18412),s=r(70906),i=r(20773),u=function(){var e=(0,n.A)(o().mark((function e(t,r,n,a){var s,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:s=(0,c.A)(r,n),i=e=>`https://equatio-api.texthelp.com/${e}/${encodeURIComponent(t)}?${s}`,window.postMessage({action:"EQUATIO_CHROME_INSERT_MATH",png:i("png"),svg:i("svg"),altText:a,width:r,height:n,latex:t},window.location.origin);case 5:case"end":return e.stop()}}),e)})));return function(t,r,n,a){return e.apply(this,arguments)}}(),d=function(){var e=(0,n.A)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.postMessage({action:"EQUATIO_CHROME_INSERT_IMAGE",png:t},window.location.origin);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l=function(){var e=(0,n.A)(o().mark((function e(t,r){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,s.A)(t,r);case 4:n=e.sent,window.postMessage({action:"EQUATIO_CHROME_INSERT_GRAPH",url:n},window.location.origin);case 6:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),p=function(){var e=(0,n.A)(o().mark((function e(t,r){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,i.A)(t,r);case 4:n=e.sent,window.postMessage({action:"EQUATIO_CHROME_INSERT_WHITEBOARD",url:n},window.location.origin);case 6:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},96685:(e,t,r)=>{"use strict";r.d(t,{A:()=>f,X:()=>p});var n=r(45841),a=r(61790),o=r.n(a),c=r(77617),s=r(97219),i=r(16203),u=r(35116),d=["mathspace","screenshot_reader","companion"],l=function(){var e=(0,n.A)(o().mark((function e(t){var r,n,a,l,p,f;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.origin!==window.location.origin||!t.data||!t.data.action){e.next=18;break}if("EQUATIO_CHROME_SET_MODE"!==t.data.action){e.next=17;break}if(r=t.data,n=r.mode,a=r.keepDrawerOpen,"string"==typeof n||void 0===n){e.next=5;break}return e.abrupt("return");case 5:if(!d.includes(n)){e.next=11;break}return e.next=8,(0,s.Ay)();case 8:if((l=e.sent)&&!(l.daysleft<1)){e.next=11;break}return e.abrupt("return");case 11:if("mathspace"!==n){e.next=14;break}return(0,i.D)(),e.abrupt("return");case 14:c.Actions.Toolbar.setMode(n,a),e.next=18;break;case 17:"EQUATIO_CHROME_API_SHOW_ACTION_BUTTONS"===t.data.action?c.Actions.Toolbar.hideActionButtons(!t.data.show):"EQUATIO_CHROME_API_DISABLE_EXTRACT_BUTTON"===t.data.action?c.Actions.Toolbar.setExtractedMathDisabled(!!t.data.disable):"EQUATIO_CHROME_API_SET_TOOLBAR_OFFSET"===t.data.action?(p=t.data.offset,f="number"==typeof p&&p>0?p:0,c.Actions.Toolbar.setToolbarBottomOffset(f)):"EQUATIO_CHROME_API_HIDE_EXTRACT_BUTTON"===t.data.action?c.Actions.Toolbar.hideExtractButton(t.data.hide):"EQUATIO_CHROME_API_SET_DISABLED_FEATURES"===t.data.action&&(0,u.A)(t.data.features,"equatioApi");case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=e=>{window.postMessage({action:"EQUATIO_CHROME_API_LATEX_CHANGE",latex:e},window.location.origin)};const f=()=>{window.addEventListener("message",l)}},56903:(e,t,r)=>{"use strict";r.d(t,{n:()=>a});var n=["coursera.org","dev-coursera.org",...[]],a=(e=window.location.hostname)=>n.some((t=>t===e||e.endsWith(`.${t}`)))},74744:(e,t,r)=>{"use strict";r.d(t,{Dy:()=>i,IC:()=>l,JB:()=>d,Sl:()=>u});var n=r(45841),a=r(61790),o=r.n(a),c=r(70906),s=r(20773),i=function(){var e=(0,n.A)(o().mark((function e(t,r,n,a){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:window.postMessage({action:"EQUATIO_INSERT_MATH_FORMS",latex:t,width:r,height:n,altText:a},window.location.origin);case 3:case"end":return e.stop()}}),e)})));return function(t,r,n,a){return e.apply(this,arguments)}}(),u=function(){var e=(0,n.A)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.postMessage({action:"EQUATIO_INSERT_IMAGE_FORMS",url:t},window.location.origin);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=(0,n.A)(o().mark((function e(t,r){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,c.A)(t,r);case 4:n=e.sent,window.postMessage({action:"EQUATIO_INSERT_GRAPH_FORMS",url:n},window.location.origin);case 6:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),l=function(){var e=(0,n.A)(o().mark((function e(t,r){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,s.A)(t,r);case 4:n=e.sent,window.postMessage({action:"EQUATIO_INSERT_WHITEBOARD_FORMS",url:n},window.location.origin);case 6:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},18412:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});const n=(e,t)=>e||t?[{name:"width",value:e},{name:"height",value:t}].map((e=>`${e.name}=${Math.ceil(e.value)}`)).join("&"):""},85208:(e,t,r)=>{"use strict";r.d(t,{D:()=>d,R:()=>l});var n=r(45841),a=r(61790),o=r.n(a),c=r(85279),s=r(74426),i=r(18141),u=r(157),d=()=>{var e=document.querySelector("path[stroke='#5da2ff'], path[stroke='#8ab4f8']");if(e){if((0,c.UF)()===c.WU.GoogleSlides)return e.closest("g[id^='editor-']").querySelector("image");var t=e.getAttribute("d"),r=document.querySelector(`clipPath path[d='${t}']`);if(r&&r.parentNode&&r.parentNode.nextSibling&&r.parentNode.nextSibling.children&&r.parentNode.nextSibling.children.length>0&&"image"===r.parentNode.nextSibling.children[0].tagName.toLowerCase())return r.parentNode.nextSibling.children[0]}},l=(e,t)=>{var r,a=function(){var r=(0,n.A)(o().mark((function r(n){return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n&&(0,u.A)(n),r.next=3,(0,i.Ay)();case 3:return r.next=5,(0,s.A)(e,t);case 5:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),d=new MutationObserver((e=>{var t;if((0,c.UF)()===c.WU.GoogleSlides)for(var n=0;n<e.length-1;n+=1){var o=e[n].target;if(o&&o.id.includes("SLIDES_API")&&e[n].addedNodes.length>0){t=o;break}}a(t).catch((e=>{console.error(`Setting alt text for google app failed. ${e}`)})),d.disconnect(),clearTimeout(r)}));d.observe(document.querySelector("#pages"),{childList:!0,subtree:!0}),r=setTimeout((()=>d&&d.disconnect()),2e4)}},74879:(e,t,r)=>{"use strict";r.d(t,{FW:()=>h,RC:()=>m,s$:()=>f});var n=r(45841),a=r(10911),o=r(61790),c=r.n(o),s=r(38469),i=r(74426),u=r(18141);function d(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=l(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return c=e.done,e},e:function(e){s=!0,o=e},f:function(){try{c||null==r.return||r.return()}finally{if(s)throw o}}}}function l(e,t){if(e){if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(e,t):void 0}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var f=()=>{var e=document.querySelector(".kix-cursor-caret"),t=e?e.parentElement:null;return t&&t.style.opacity>0?e:null},h=()=>new Promise((e=>{var t=e=>{var t=/transform:.*?;/,r=e.oldValue||"",n=e.target.getAttribute("style")||"";if(!r&&!n)return!1;var o=r.match(t),c=(0,a.A)(o,1)[0],s=n.match(t);return c!==(0,a.A)(s,1)[0]},r=(r,n)=>{var a,o=d(r);try{for(o.s();!(a=o.n()).done;){var c=a.value,s=c.target;"attributes"===c.type&&"style"===c.attributeName&&(s.className&&s.className.includes("kix-cursor")&&t(c)&&setTimeout((()=>{e(),n.disconnect()}),1e3),s.className&&s.className.includes("docs-texteventtarget-iframe")&&t(c)&&setTimeout((()=>{e(),n.disconnect()}),1e3)),"docs-aria-speakable"===c.target.id&&c.addedNodes.length&&setTimeout((()=>{e(),n.disconnect()}),500)}}catch(e){o.e(e)}finally{o.f()}},n=new MutationObserver(r);n.observe(document.body,{childList:!0,attributes:!0,subtree:!0,attributeOldValue:!0}),setTimeout((()=>{n.disconnect(),e()}),2e4)})),m=function(){var e=(0,n.A)(c().mark((function e(t,r,n){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=3;break}return e.next=3,h();case 3:return e.next=5,(0,s.IP)();case 5:return e.next=7,(0,u.Ay)();case 7:return e.next=9,(0,i.A)(t,r);case 9:setTimeout((()=>{(0,s.Uz)().catch((e=>{}))}),300);case 10:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()},31688:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(14971);const a=e=>{var t=(new DOMParser).parseFromString(e,"application/xml");if("math"!==t.documentElement.tagName.toLowerCase())throw Error("Invalid MathML document");t.documentElement.innerHTML=".",t.documentElement.removeAttribute("display");var r=(new XMLSerializer).serializeToString(t.documentElement);return n.pd.xmlmin(r,!1).trim()}},32859:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(45841),a=r(61790),o=r.n(a),c=r(18141);const s=(0,n.A)(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,c.Ay)();case 2:return e.next=4,(0,c.H2)();case 4:return t=e.sent,e.prev=5,e.next=8,(0,c.vv)();case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(5),console.error("Failed to close alt text dialog",e.t0);case 13:return e.abrupt("return",t.value);case 14:case"end":return e.stop()}}),e,null,[[5,10]])})))},54690:(e,t,r)=>{"use strict";var n;r.d(t,{A:()=>a});const a=()=>{if(n)return n;var e=Array.from(document.querySelectorAll(".goog-menuitem-label")).filter((e=>{var t=e.getAttribute("aria-label");return!!t&&((t.endsWith("..., x;")||t.endsWith("... x"))&&e.nextElementSibling&&e.nextElementSibling.textContent.endsWith("+Y"))}));return e.length||(e=Array.from(document.querySelectorAll(".goog-menuitem-accel")).filter((e=>{if(!e.textContent.startsWith("\u2318+")||!e.textContent.endsWith("+Y"))return!1;var t=e.previousElementSibling;if(!t)return!1;if(!t.matches(".goog-menuitem-label"))return!1;var r=e.previousElementSibling.getAttribute("aria-label");return r&&(r.endsWith(" x")||r.endsWith(" x;"))}))),n=e&&e.length&&e[0].closest(".goog-menuitem")}},3201:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(14971);const a=(e,t,r)=>{var a=(new DOMParser).parseFromString('<math xmlns="http://www.w3.org/1998/Math/MathML">\n    <mglyph src="" alt="Image"></mglyph>\n</math>',"application/xml");a.documentElement.setAttribute("data-is-equatio","1"),a.documentElement.setAttribute("data-equatio-url",e),a.documentElement.setAttribute("data-equatio-type",t);var o=a.querySelector("mglyph");o.setAttribute("src",e),o.setAttribute("alt",r);var c=(new XMLSerializer).serializeToString(a.documentElement);return n.pd.xmlmin(c,!1).trim()}},94772:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(14971);const a=(e,t)=>{var r=(new DOMParser).parseFromString(t,"application/xml");if("math"!==r.documentElement.tagName.toLowerCase())throw Error("Invalid MathML document");r.documentElement.setAttribute("data-is-equatio","1"),r.documentElement.setAttribute("data-latex",e);var a=(new XMLSerializer).serializeToString(r.documentElement);return n.pd.xmlmin(a,!1).trim()}},74426:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});var n=r(45841),a=r(61790),o=r.n(a),c=r(18141),s=r(49305),i=r(31688),u=(e,t)=>{var r=new InputEvent("input",{bubbles:!0,cancelBubble:!1,cancelable:!1,composed:!0,currentTarget:e,data:t,dataTransfer:null,defaultPrevented:!1,detail:0,eventPhase:3,inputType:"insertText",isComposing:!1,isTrusted:!0});e.dispatchEvent(r)};const d=function(){var e=(0,n.A)(o().mark((function e(t,r){var n,a,d,l,p;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,c.H2)();case 2:return n=e.sent,a=n.maxLength||5e3,e.next=6,(0,s.v)(50);case 6:return d="",t.length+r.length+2>=a?(l=(0,i.A)(r),p=t.slice(0,a-l.length+2),d=`${p}\n\n${l}`):d=`${t}\n\n${r}`,n.value=d,u(n,d),e.next=13,(0,s.v)(50);case 13:return e.next=15,(0,c.vv)();case 15:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},57096:(e,t,r)=>{"use strict";r.d(t,{R:()=>m,a:()=>h});var n=r(45841),a=r(61790),o=r.n(a),c=r(157),s=r(74426),i=r(78054),u=r(70552),d=r(49305);function l(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=p(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return c=e.done,e},e:function(e){s=!0,o=e},f:function(){try{c||null==r.return||r.return()}finally{if(s)throw o}}}}function p(e,t){if(e){if("string"==typeof e)return f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var h=function(){var e=(0,n.A)(o().mark((function e(){var t,r,n,a,s,i,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Array.from(document.querySelectorAll(".waffle-borderless-embedded-object-overlay-focused .waffle-overflow-menu-material")).find((e=>e.offsetParent))){e.next=3;break}return e.abrupt("return");case 3:return(0,c.A)(t),e.next=6,(0,d.v)(50);case 6:if(!(r=Array.from(document.querySelectorAll(".goog-menu.goog-menu-vertical")).find((e=>e.offsetParent)))||!r.children){e.next=20;break}a=r.children,s=0;case 10:if(!(s<a.length)){e.next=19;break}if(i=a[s],!(l=i.textContent?i.textContent.toLowerCase():null)||!l.includes("alt text")){e.next=16;break}return n=i,e.abrupt("break",19);case 16:s++,e.next=10;break;case 19:n||(n=a[4]);case 20:if(!n){e.next=24;break}(0,c.A)(n),e.next=30;break;case 24:return e.next=26,(0,u.Ay)("Up",document.activeElement);case 26:return e.next=28,(0,u.Ay)("Up",document.activeElement);case 28:return e.next=30,(0,u.Ay)("Enter",document.activeElement);case 30:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),m=function(){var e=(0,n.A)(o().mark((function e(t,r){var a,u,d;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u=function(){var e=(0,n.A)(o().mark((function e(n){var a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,i.A)((()=>Array.from(document.querySelectorAll(`img[src='${n.src}']`)).find((e=>e.offsetParent))),50);case 2:return a=e.sent,(0,c.A)(a),e.next=6,h();case 6:return e.next=8,(0,s.A)(t,r);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(d=new MutationObserver((e=>{var t,r,n=l(e);try{for(n.s();!(r=n.n()).done;){var o=r.value;if(t=Array.from(o.addedNodes).find((e=>"IMG"===e.nodeName)))break}}catch(e){n.e(e)}finally{n.f()}t&&(u(t).catch((e=>{console.error(`Setting alt text failed ${e}`)})),d.disconnect(),clearTimeout(a))}))).observe(document.querySelector("#waffle-grid-container"),{childList:!0,subtree:!0}),a=setTimeout((()=>d.disconnect()),15e3);case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},18141:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>f,H2:()=>h,vv:()=>m});var n=r(45841),a=r(61790),o=r.n(a),c=r(85279),s=r(38469),i=r(54690),u=r(157),d=r(57096),l=r(78054),p=r(49305);const f=(0,n.A)(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,c.UF)()!==c.WU.GoogleDocs){e.next=4;break}return e.next=3,(0,s.mk)();case 3:return e.abrupt("return");case 4:if((0,c.UF)()!==c.WU.GoogleSheets){e.next=8;break}return e.next=7,(0,d.a)();case 7:return e.abrupt("return");case 8:(t=(0,i.A)())?(0,u.A)(t):(0,s.mk)();case 10:case"end":return e.stop()}}),e)})));var h=function(){var e=(0,n.A)(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.A)((()=>document.querySelector("#docs-alt-text-tile-description")),20);case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),m=function(){var e=(0,n.A)(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=document.querySelector(".docs-sidebar-gm-titlebar-icon-button.docs-material.docs-sidebar-gm-close-button.docs-tiled-sidebar-close, .docs-tiled-sidebar-close"))){e.next=6;break}return e.next=4,(0,p.v)(50);case 4:return t.click(),e.abrupt("return");case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},35539:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});const n=(e,t,r)=>{for(var n,a,o,c=[];(n=document.elementFromPoint(e,t))&&!c.includes(n)&&n!==o;){if(n.matches(`${r}`)){a=n;break}c.push({element:n,value:n.style.getPropertyValue("pointer-events"),priority:n.style.getPropertyPriority("pointer-events")}),n.style.setProperty("pointer-events","none","important"),o=n}return c.forEach((e=>{e.element.style.setProperty("pointer-events",e.value||"",e.priority)})),a}},14598:(e,t,r)=>{"use strict";r.d(t,{A:()=>h});var n,a,o=r(45841),c=r(61790),s=r.n(c),i=r(97219),u=r(157),d=r(45439),l=r(85279),p=r(59186),f=(e,t)=>{n=t};const h=function(){var e=(0,o.A)(s().mark((function e(t){var r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,l.UF)()!==l.WU.GoogleSheets){e.next=4;break}(0,p.A)(),e.next=8;break;case 4:return e.next=6,(0,d.A)();case 6:r=e.sent,(0,u.A)(r);case 8:f(window.location.href,(()=>{(0,i.hT)(t,a)}));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();chrome.runtime.onMessage.addListener((e=>{"image_dialog_loaded"===e.action&&(a=e.pickerWindow,"function"==typeof n&&(n.call(void 0),n=null))}))},51127:(e,t,r)=>{"use strict";r.d(t,{A:()=>h});var n=r(45841),a=r(61790),o=r.n(a),c=r(70060),s=r(157),i=r(45439),u=r(78054),d=function(){var e=(0,n.A)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,u.A)((()=>document.querySelector(".picker-urlview-inner-input")),200);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),new Error("Couldn't find image dialog");case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}(),l=e=>{var t=(e,t)=>{var r=new MouseEvent(t,{bubbles:!0,cancelable:!0});e.dispatchEvent(r)};t(e,"mouseover"),t(e,"mouseenter")},p=function(){var e=(0,n.A)(o().mark((function e(){var t,r,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=()=>{var e=Array.from(document.querySelectorAll(".goog-menuitem.apps-menuitem:not([aria-disabled]) .goog-menuitem-label")).filter((e=>c.DF.some((t=>e.textContent&&e.textContent.includes(t)))));return e.length<1?null:e[0]&&e[0].closest(".goog-menuitem")},e.prev=1,(0,s.A)(document.getElementById("docs-insert-menu")),e.next=5,(0,i.A)();case 5:return r=e.sent,l(r),e.next=9,(0,u.A)(t,30);case 9:n=e.sent,(0,s.A)(n),e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(1),new Error(`Insert Image by URL Failed: ${e.t0}`);case 16:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(){return e.apply(this,arguments)}}(),f=function(){var e=(0,n.A)(o().mark((function e(t){var r,n,a,c,i,d;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=document.querySelector(".picker-urlview-inner-input"),n=document.querySelector(".picker-urlview-insertbutton"),a=document.querySelector(".picker-urlview-cancelbutton"),c=document.querySelector(".picker-urlview-error-container"),r.value=t,i=new Event("paste",{bubbles:!0,cancelable:!1,shiftKey:!1}),d=()=>{c&&"none"!==c.style.display&&c.textContent&&(c.textContent="")},e.prev=7,d(),document.querySelector(".picker-urlview-inner-input").dispatchEvent(i),e.next=12,(0,u.A)((()=>{if(c&&"none"!==c.style.display&&c.textContent)throw new Error(`Invalid URL ${t}. ${c.textContent}`);return!n.disabled}),300);case 12:(0,s.A)(n),e.next=19;break;case 15:throw e.prev=15,e.t0=e.catch(7),a&&a.click(),new Error(`Insert button never enabled. ${e.t0}`);case 19:case"end":return e.stop()}}),e,null,[[7,15]])})));return function(t){return e.apply(this,arguments)}}();const h=function(){var e=(0,n.A)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(document.querySelector(".picker-urlview-inner-input")){e.next=3;break}return e.next=3,p();case 3:return e.next=5,d();case 5:return e.next=7,f(t);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},45439:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var n,a=r(45841),o=r(61790),c=r.n(o),s=r(70060),i=r(85279),u=r(157),d=()=>{var e=Array.from(document.querySelectorAll(".goog-menuitem-label")).filter((e=>!!e.getAttribute("aria-label"))),t=e.find((e=>"Image i"===e.getAttribute("aria-label")));return t?[t]:e.filter((e=>{var t=e.getAttribute("aria-label");return(t.endsWith("... i")||t.endsWith("\u2026 i")||t.endsWith(" i"))&&e.closest(".goog-menuitem-content")&&e.closest(".goog-menuitem-content").querySelector(".docs-icon-img")}))};const l=()=>n||(n=new Promise(((e,t)=>{var r=0,n=function(){var o=(0,a.A)(c().mark((function a(){var o,l,p,f,h;return c().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if((o=d())&&o.length||((0,u.A)(document.getElementById("docs-insert-menu")),o=d(),(0,u.A)(document.getElementById("docs-insert-menu"))),l=Array.from(document.querySelectorAll(".goog-menuitem-mnemonic-hint")).filter((e=>e.closest(".goog-menuitem-label"))).filter((e=>s.Ph.some((t=>e.closest(".goog-menuitem-label").textContent.startsWith(t))))),(p="Google Sheets"===(0,i.UF)()?l&&l.length&&l[0].closest(".apps-menuitem"):o&&o.length&&o[0].closest(".apps-menuitem"))||(f=Array.from(document.querySelectorAll(".goog-menu-vertical[class='goog-menu goog-menu-vertical docs-material']"))).length>=4&&(p=f[3].querySelector(".goog-menuitem")),h=p||document.querySelector("#imageButton")){a.next=11;break}if(!((r+=1)>20)){a.next=10;break}return a.abrupt("return",t(Error("timed_out")));case 10:return a.abrupt("return",setTimeout(n,500));case 11:return a.abrupt("return",e(h));case 12:case"end":return a.stop()}}),a)})));return function(){return o.apply(this,arguments)}}();n()})))},74961:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});var n=r(45841),a=r(61790),o=r.n(a),c=r(38469),s=r(97219),i=r(85279),u=()=>new Promise((e=>{var t,r=document.getElementById("docs-save-indicator-badge"),n=new MutationObserver((()=>{r&&"string"==typeof r.textContent&&!r.textContent.includes("...")&&(n.disconnect(),e(),clearTimeout(t))}));r&&n.observe(r,{attributes:!0,childList:!0}),t=setTimeout((()=>{e(),n.disconnect()}),2e4)}));const d=function(){var e=(0,n.A)(o().mark((function e(t,{width:r,height:n}={},a,d){var l,p,f;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=t,n&&l.includes("/png/")&&(p="height="+5*Math.ceil(n),l=`${t.split("?")[0]}?${p}`),(0,i.UF)()!==i.WU.GoogleDocs){e.next=8;break}return e.next=5,(0,c.dV)();case 5:return e.next=7,u();case 7:f=d();case 8:return e.next=10,(0,s.Y2)(l,r,n,a);case 10:if(e.sent){e.next=12;break}return e.abrupt("return",!1);case 12:if(!f){e.next=15;break}return e.next=15,f;case 15:return e.abrupt("return",!0);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},43728:(e,t,r)=>{"use strict";r.d(t,{A:()=>h});var n=r(45841),a=r(61790),o=r.n(a),c=r(51127),s=r(85279),i=r(74961),u=r(13467),d=r(74879),l=r(38469),p=r(23e3),f=function(){var e=(0,n.A)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,i.A)(...t);case 2:if(e.sent){e.next=5;break}throw new Error("no_result");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();const h=(0,n.A)(o().mark((function e(...t){var r,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(0,s.UF)(),n=(0,p.iI)(),r!==s.WU.GoogleDocs||(0,d.s$)()){e.next=5;break}return e.next=5,(0,l.l0)();case 5:if((0,u.A)(r)){e.next=9;break}return e.next=8,(0,c.A)(...t);case 8:case 13:case 33:return e.abrupt("return","automation");case 9:if(n!==p.Tc.Automatic&&n!==p.Tc.Speed){e.next=22;break}return e.prev=10,e.next=13,(0,c.A)(...t);case 16:return e.prev=16,e.t0=e.catch(10),console.error("Speed insert failed",e.t0),e.next=21,f(t);case 21:case 25:return e.abrupt("return","api");case 22:return e.prev=22,e.next=25,f(t);case 28:return e.prev=28,e.t1=e.catch(22),console.error("Quality insert failed",e.t1),e.next=33,(0,c.A)(...t);case 34:case"end":return e.stop()}}),e,null,[[10,16],[22,28]])})))},59186:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(45841),a=r(61790),o=r.n(a),c=r(70552);const s=(0,n.A)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,c.Ay)("Ctrl+Alt+I","#docs-chrome");case 2:return e.next=4,(0,c.Ay)("Alt+I","#docs-chrome");case 4:return e.next=6,(0,c.Ay)("g","#docs-menubar");case 6:return e.next=8,(0,c.Ay)("a","#docs-menubar");case 8:case"end":return e.stop()}}),e)})))},38469:(e,t,r)=>{"use strict";r.d(t,{IP:()=>u,Uz:()=>d,dV:()=>l,l0:()=>p,mk:()=>i});var n=r(45841),a=r(61790),o=r.n(a),c=r(58840),s=e=>new Promise(((t,r)=>{var n=r=>{r.source===window&&r.data&&r.data.action===e&&"EQUATIO_DOCS_MESSAGING_API_RESPONSE"===r.data.type&&(window.removeEventListener("message",n),t())};setTimeout((()=>{window.removeEventListener("message",n),r(new Error("Keyboard shortcuts handler timed out"))}),5e3),window.addEventListener("message",n),window.postMessage({type:"EQUATIO_DOCS_MESSAGING_API",action:e},"https://docs.google.com")})),i=()=>s(c.A.ShowAltTextDialog),u=()=>s(c.A.SelectLeft),d=()=>s(c.A.ArrowRight),l=()=>s(c.A.InsertPlaceholderCharacter),p=function(){var e=(0,n.A)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s(c.A.Delete);case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}()},78054:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});const n=(e,t,r=!0)=>new Promise(((n,a)=>{var o=0,c=()=>{o+=1;try{var s=e();if(s)return void n(s);if(o>=t)return r?void a(new Error("element_wait_timeout")):void n(null)}catch(e){a(e)}setTimeout(c,50)};c()}))},36216:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var n=r(85279),a=r(10663),o=r(11460);const c=()=>(0,n.Ay)()?(0,a.A)():(0,o.A)()},10663:(e,t,r)=>{"use strict";r.d(t,{A:()=>h});var n=r(45841),a=r(61790),o=r.n(a),c=r(85208),s=r(25292),i=r(31596),u=r(85279),d=r(32859),l=r(72876),p=r(157),f=r(59227);const h=(0,n.A)(o().mark((function e(){var t,r,n,a,h,m,v,b,x;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(0,s.M$)(),!(r=t?(0,s.BW)():(0,c.D)())){e.next=38;break}return(0,p.A)(r),e.prev=4,e.next=7,(0,d.A)();case 7:return n=e.sent,e.next=10,(0,l.V)(n);case 10:if(!(a=e.sent)){e.next=13;break}return e.abrupt("return",a);case 13:e.next=17;break;case 15:e.prev=15,e.t0=e.catch(4);case 17:if(!(h=r.getAttribute("href"))||!h.includes("googleusercontent.com")&&!h.includes("filesystem:")){e.next=38;break}return e.prev=19,e.next=22,(0,f.T)(h);case 22:m=e.sent,e.next=27;break;case 25:e.prev=25,e.t1=e.catch(19);case 27:if(!m){e.next=29;break}return e.abrupt("return",m);case 29:if(![u.WU.GoogleSlides,u.WU.GoogleDrawings].includes((0,u.UF)())){e.next=38;break}return e.next=32,(0,i.d)();case 32:if(v=e.sent,!(b=r.closest("g[id^='editor-']"))){e.next=38;break}if(x=b.getAttribute("id").replace(/^editor-/,""),!v[x]){e.next=38;break}return e.abrupt("return",(0,f.T)(v[x]));case 38:return e.abrupt("return",Promise.reject(Error("no_text_found")));case 39:case"end":return e.stop()}}),e,null,[[4,15],[19,25]])})))},11460:(e,t,r)=>{"use strict";r.d(t,{A:()=>b});var n=r(45841),a=r(61790),o=r.n(a),c=r(4683),s=r(32859),i=r(72876),u=r(59227),d=function(){var e=(0,n.A)(o().mark((function e(t){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,u.T)(t);case 3:if(e.t0=e.sent,e.t0){e.next=8;break}return e.next=7,(0,c.A)(t);case 7:e.t0=e.sent;case 8:if(!(r=e.t0)){e.next=11;break}return e.abrupt("return",r);case 11:e.next=15;break;case 13:e.prev=13,e.t1=e.catch(0);case 15:return e.abrupt("return",null);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}(),l=function(){var e=(0,n.A)(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,s.A)();case 3:return t=e.sent,e.abrupt("return",t);case 7:e.prev=7,e.t0=e.catch(0);case 9:return e.abrupt("return",null);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),p=(e,t,r)=>{if(!r)return null;for(var n=0;n<r.length;n++){var a=r[n],o=a.getBoundingClientRect(),c=o.x,s=o.y,i=o.width,u=o.height;if(e>c&&e<c+i&&t>s&&t<s+u)return a}return null},f=()=>{var e=document.querySelector(".docs-squarehandleselectionbox-border");if(!e||!e.getBoundingClientRect)return null;var t=e.getBoundingClientRect(),r=t.width,n=t.height;return r<=0||n<=0?null:e},h=function(){var e=(0,n.A)(o().mark((function e(){var t,r,n,a,c,s,i,u,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=f(),r=t.getBoundingClientRect(),n=r.x,a=r.y,c=r.width,s=r.height,!((i=document.querySelectorAll("svg > g > image")).length<1)){e.next=5;break}return e.abrupt("return",null);case 5:if(!(u=p(n+c/2,a+s/2,i))){e.next=11;break}return e.next=9,d(u.href.baseVal);case 9:return l=e.sent,e.abrupt("return",l||null);case 11:return e.abrupt("return",null);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),m=function(){var e=(0,n.A)(o().mark((function e(){var t,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f()){e.next=2;break}return e.abrupt("return",null);case 2:if(!(t=document.querySelector(".kix-embeddedobject-image > image"))){e.next=8;break}return e.next=6,d(t.href.baseVal);case 6:return r=e.sent,e.abrupt("return",r||null);case 8:return e.abrupt("return",null);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=function(){var e=(0,n.A)(o().mark((function e(){var t,r,n,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l();case 3:return t=e.sent,e.next=6,(0,i.V)(t);case 6:if(!(r=e.sent)){e.next=9;break}return e.abrupt("return",r);case 9:return e.next=11,m();case 11:if(!(n=e.sent)){e.next=14;break}return e.abrupt("return",n);case 14:return e.next=16,h();case 16:if(!(a=e.sent)){e.next=19;break}return e.abrupt("return",a);case 19:e.next=23;break;case 21:e.prev=21,e.t0=e.catch(0);case 23:return e.abrupt("return",Promise.reject(Error("no_math_found")));case 24:case"end":return e.stop()}}),e,null,[[0,21]])})));return function(){return e.apply(this,arguments)}}();const b=()=>v()},4683:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var n=r(45841),a=r(61790),o=r.n(a),c=r(62399),s=r(48428),i=r.n(s),u=r(97219),d=(e,t)=>{if(t.startsWith("filesystem:")){var r=t.split("filesystem:")[1],n=i()(r);return"docs.google.com"!==n.hostname?null:e.getImages().find((e=>e.id===n.pathname.split("/").pop()))}return e.getImages().find((e=>e.proxySrc.toLowerCase()===t.toLowerCase()))};const l=function(){var e=(0,n.A)(o().mark((function e(t){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=d((0,c.c)(document.body.outerHTML),t)){e.next=8;break}return e.t0=d,e.next=5,(0,c.u)(window.location.href);case 5:e.t1=e.sent,e.t2=t,r=(0,e.t0)(e.t1,e.t2);case 8:if(r){e.next=10;break}return e.abrupt("return",null);case 10:return e.abrupt("return",(0,u.ns)(r.originalSrc));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},72876:(e,t,r)=>{"use strict";r.d(t,{V:()=>p});var n=r(10911),a=r(45841),o=r(61790),c=r.n(o),s=r(97219),i=r(94494),u=e=>"<math"===`${e}`.slice(0,5).toLowerCase(),d=e=>u(e)&&(e.includes("data-is-equatio")||e.includes("data-latex")),l=function(){var e=(0,a.A)(c().mark((function e(t){var r,n,a,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=new DOMParser,"math"===(n=r.parseFromString(t,"application/xml")).documentElement.tagName.toLowerCase()){e.next=4;break}throw Error("Invalid MathML document");case 4:if("string"!=typeof(a=n.documentElement.getAttribute("data-latex"))){e.next=7;break}return e.abrupt("return",a);case 7:if("string"==typeof(o=n.documentElement.getAttribute("data-equatio-url"))){e.next=10;break}return e.abrupt("return",null);case 10:return e.abrupt("return",(0,s.ns)(o));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=(0,a.A)(c().mark((function e(t){var r,a,o,s,p;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:if(r=t.match(/<\s*math[\s\S]*<\/\s*math>/gi)||[],a=(0,n.A)(r,1),o=a[0]){e.next=5;break}return e.abrupt("return",null);case 5:if(!d(o)){e.next=17;break}return e.prev=6,e.next=9,l(o);case 9:return s=e.sent,e.abrupt("return",s);case 13:e.prev=13,e.t0=e.catch(6);case 15:e.next=27;break;case 17:if(!u(o)){e.next=27;break}return e.prev=18,e.next=21,(0,i.A)(o);case 21:return p=e.sent,e.abrupt("return",p);case 25:e.prev=25,e.t1=e.catch(18);case 27:return e.abrupt("return",null);case 28:case"end":return e.stop()}}),e,null,[[6,13],[18,25]])})));return function(t){return e.apply(this,arguments)}}()},94494:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});var n,a=r(77617),o=r(15174),c=document.createElement("iframe");c.style.display="none",c.id="my-frame",document.body.appendChild(c);var s=!1,i=[[/\\uppi\b/g,"\\pi"],[/\\Updelta\b/g,"\\delta"],[/\\nequiv\b/g,"\\cancel{\\equiv}"],[/\\napprox\b/g,"\\cancel{\\approx}"]],u=e=>i.reduce(((e,[t,r])=>e.replace(t,r)),e);const d=e=>new Promise(((t,r)=>{s||(s=!0,(0,o.BZ)((({type:e})=>{e===a.Events.Toolbar.ExtractMathCancelled&&(c.src="about:blank",window.removeEventListener("message",n),n=null)}))),a.Actions.Toolbar.setCanCancel(!0),n&&window.removeEventListener("message",n),n=e=>{if("null"===e.origin&&e.data&&"EQUATIO_MATHML_RESULT"===e.data.type){a.Actions.Toolbar.setCanCancel(!1);var n=e.data,o=n.latex,c=n.error;c?r(c):t(u(o))}},c.src=`chrome-extension://hjngolefdpdnooamgdldlkjgmdcmcjnc/mmlWorker/index.html?mathml=${encodeURIComponent(e)}`,window.addEventListener("message",n)}))},70906:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var n=r(45841),a=r(61790),o=r.n(a),c=r(38891),s=r(97219),i=function(){var e=(0,n.A)(o().mark((function e(t,r){var n,a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.hp.from(t.substr(22),"base64"),a=c.hp.from(`desmos::${JSON.stringify(r)}::desmos`,"utf8"),s=c.hp.concat([n,a]),e.abrupt("return",URL.createObjectURL(new Blob([s]),{oneTimeOnly:!0}));case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}();const u=function(){var e=(0,n.A)(o().mark((function e(t,r){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i(t,r);case 2:return n=e.sent,e.abrupt("return",(0,s.WS)(n,null));case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},39956:(e,t,r)=>{"use strict";r.d(t,{Dy:()=>A,IC:()=>g,JB:()=>w,Sl:()=>y});var n=r(45841),a=r(61790),o=r.n(a),c=r(85279),s=r(74879),i=r(85208),u=r(70906),d=r(20773),l=r(18412),p=r(94772),f=r(3201),h=r(13467),m=r(43728),v=function(){var e=(0,n.A)(o().mark((function e(t,r,n,a){var u,d;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=(0,c.Ay)())try{(0,i.R)(t,r)}catch(e){console.error("Error setting alt text",e)}return e.next=4,(0,m.A)(n,a,{},s.FW);case 4:if(d=e.sent,u){e.next=14;break}return e.prev=6,e.next=9,(0,s.RC)(t,r,"api"===d);case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(6),console.error("Error setting alt text - docs");case 14:case"end":return e.stop()}}),e,null,[[6,11]])})));return function(t,r,n,a){return e.apply(this,arguments)}}(),b=(e,t,r,n)=>r||n?r&&n?{width:r,height:n}:r?{width:r,height:t*(r/e)}:{width:e*(n/t),height:n}:{width:e,height:t},x=e=>"desmos"===e?"Equatio Desmos Graph":"whiteboard"===e?"Equatio Whiteboard":"Equatio Image",y=function(){var e=(0,n.A)(o().mark((function e(t,r="image"){var n,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=x(r),a=(0,f.A)(t,r,n),e.next=4,v(n,a,t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=(0,n.A)(o().mark((function e(t,r){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,u.A)(t,r);case 4:return n=e.sent,e.next=7,y(n,"desmos");case 7:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),g=function(){var e=(0,n.A)(o().mark((function e(t,r){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,d.A)(t,r);case 4:return n=e.sent,e.next=7,y(n,"whiteboard");case 7:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),A=function(){var e=(0,n.A)(o().mark((function e(t,r,n,a,s){var i,u,d,f,m;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return u={width:r,height:n},(0,h.A)((0,c.UF)())?(d=n,r<20?(u=b(r,n,20),d=Math.ceil(u.height)):n<20&&(u=b(r,n,void 0,20),d=Math.ceil(u.height)),i=`height=${d}`):i=(0,l.A)(r,n),f=`https://equatio-api.texthelp.com/png/${encodeURIComponent(t)}?${i}`,m=(0,p.A)(t,s),e.next=8,v(a,m,f,u);case 8:case"end":return e.stop()}}),e)})));return function(t,r,n,a,o){return e.apply(this,arguments)}}()},20773:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var n=r(45841),a=r(61790),o=r.n(a),c=r(38891),s=r(97219),i=function(){var e=(0,n.A)(o().mark((function e(t,r){var n,a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.hp.from(t.substr(22),"base64"),a=c.hp.from(`whiteboard::${JSON.stringify(r)}::whiteboard`,"utf8"),s=c.hp.concat([n,a]),e.abrupt("return",URL.createObjectURL(new Blob([s]),{oneTimeOnly:!0}));case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}();const u=function(){var e=(0,n.A)(o().mark((function e(t,r){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i(t,r);case 2:return n=e.sent,e.abrupt("return",(0,s.WS)(n,null));case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},92668:(e,t,r)=>{"use strict";r.d(t,{A:()=>f});var n=r(45841),a=r(61790),o=r.n(a),c=r(35539),s=r(32859),i=r(72876),u=r(59227),d=()=>{var e=null,t="cell",r=Array.from(document.querySelectorAll(".waffle-obj-menu-control-material")).filter((e=>e.offsetParent));if(r.length){var n=r[0].getBoundingClientRect(),a=n.x,o=n.y,s=n.width,i=n.height,u=document.querySelector("div.focused-overlay-container").getBoundingClientRect(),d=o+i<u.top?o-u.top:0,l=a+s>u.width?a-u.width:0;e=(0,c.A)(a-l,o-d,".waffle-borderless-embedded-object-container img"),t="image"}else e=document.querySelector("#formula-bar .cell-input");return{element:e,type:t}},l=()=>{var e=document.querySelector("#formula-bar .cell-input");if(!e)return"";var t=/equatio-api(?:.dev)?\.texthelp\.com\/(?:png|svg)\/(.*?)["?]/.exec(e.textContent);return t&&t.length>1?decodeURIComponent(t[1]):""},p=e=>e&&e&&(e.includes("googleusercontent.com")||e.includes("filesystem:"))?(0,u.T)(e):null;const f=(0,n.A)(o().mark((function e(){var t,r,n,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=d())){e.next=28;break}if("cell"!==t.type){e.next=4;break}return e.abrupt("return",l());case 4:if(!t.element){e.next=28;break}return e.prev=5,e.next=8,p(t.element.src);case 8:if(!(r=e.sent)){e.next=11;break}return e.abrupt("return",r);case 11:e.next=15;break;case 13:e.prev=13,e.t0=e.catch(5);case 15:return e.prev=15,e.next=18,(0,s.A)();case 18:return n=e.sent,e.next=21,(0,i.V)(n);case 21:if(!(a=e.sent)){e.next=24;break}return e.abrupt("return",a);case 24:e.next=28;break;case 26:e.prev=26,e.t1=e.catch(15);case 28:return e.abrupt("return",null);case 29:case"end":return e.stop()}}),e,null,[[5,13],[15,26]])})))},33984:(e,t,r)=>{"use strict";r.d(t,{Dy:()=>k,IC:()=>b,JB:()=>v,Sl:()=>m});var n=r(45841),a=r(61790),o=r.n(a),c=r(70906),s=r(20773),i=r(3201),u=r(57096),d=r(70552),l=r(74961),p=r(78054),f=r(23e3),h=r(14598),m=function(){var e=(0,n.A)(o().mark((function e(t,r="image"){var n,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=r,e.next="desmos"===e.t0?3:"whiteboard"===e.t0?5:7;break;case 3:return n="Equatio Desmos Graph",e.abrupt("break",9);case 5:return n="Equatio Whiteboard",e.abrupt("break",9);case 7:return n="Equatio Image",e.abrupt("break",9);case 9:return a=(0,i.A)(t,r,n),(0,u.R)(n,a),e.next=13,(0,h.A)(t);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=(0,n.A)(o().mark((function e(t,r){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,c.A)(t,r);case 4:return n=e.sent,e.next=7,m(n,"desmos");case 7:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),b=function(){var e=(0,n.A)(o().mark((function e(t,r){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,s.A)(t,r);case 4:return n=e.sent,e.next=7,m(n,"whiteboard");case 7:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),x=()=>{var e=document.querySelector("#docs-screenreader-menu");if(!e)throw Error("accessibility_menu_missing");return e.offsetHeight>0},y=()=>{var e=document.querySelector("#docs-aria-speakable");if(!e)throw Error("aria_speakable_missing");var t=e.textContent.match(/[A-Z]+[0-9]+/);if(!t||!t[0])throw Error("failed_to_find_range");return t[0]},w=function(){var e=(0,n.A)(o().mark((function e(t){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=document.querySelector("#formula-bar .cell-input")).focus(),e.next=4,new Promise((e=>{setTimeout((0,n.A)(o().mark((function n(){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,r.innerHTML=`=IMAGE("${t}")`,n.next=4,(0,d.Ay)("Enter","#formula-bar .cell-input");case 4:e(),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),e();case 10:case"end":return n.stop()}}),n,null,[[0,7]])}))))}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=(0,n.A)(o().mark((function e(t=!0){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==x()){e.next=2;break}return e.abrupt("return");case 2:return r="body",(0,d.Ps)(r,"keydown"),(0,d.Hl)("Ctrl+Alt+Z",r,"keydown"),(0,d.Hl)("Ctrl+Alt+Z",r,"keyup"),(0,d.Ps)(r,"keyup"),e.next=9,(0,p.A)((()=>t?x():!x()),20);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),A=function(){var e=(0,n.A)(o().mark((function e(t,r,n){var a,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g(!0);case 2:return e.prev=2,e.next=5,(0,d.Ay)("Right",".cell-input");case 5:return e.next=7,(0,d.Ay)("Left",".cell-input");case 7:return a=y(),(c=document.querySelector(".docs-sheet-active-tab .docs-sheet-tab-name"))&&(a=`${c.textContent}!${a}`),e.next=12,(0,l.A)(t,{width:r,height:n},{range:a});case 12:e.next=19;break;case 14:return e.prev=14,e.t0=e.catch(2),e.next=18,g(!1).catch((()=>{}));case 18:throw e.t0;case 19:return e.next=21,g(!1).catch((()=>{}));case 21:case"end":return e.stop()}}),e,null,[[2,14]])})));return function(t,r,n){return e.apply(this,arguments)}}(),k=function(){var e=(0,n.A)(o().mark((function e(t,r,n){var a,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if(a=`https://equatio-api.texthelp.com/svg/${encodeURIComponent(t)}`,(c=(0,f.iI)())!==f.Tc.Automatic&&c!==f.Tc.Speed){e.next=16;break}return e.prev=5,e.next=8,w(a);case 8:e.next=15;break;case 10:return e.prev=10,e.t0=e.catch(5),console.error("Sheets speed insert failed",e.t0),e.next=15,A(a,r,n);case 15:return e.abrupt("return");case 16:return e.prev=16,e.next=19,A(a,r,n);case 19:e.next=26;break;case 21:return e.prev=21,e.t1=e.catch(16),console.error("Sheets quality insert failed",e.t1),e.next=26,w(a);case 26:case"end":return e.stop()}}),e,null,[[5,10],[16,21]])})));return function(t,r,n){return e.apply(this,arguments)}}()},70552:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>u,Hl:()=>i,Ps:()=>s});var n=r(70613),a=r.n(n),o=r(81515),c=r(91018),s=(e,t)=>{var r=new KeyboardEvent(t,{bubbles:!0,cancelable:!0,keyCode:18,ctrlKey:!0,altKey:!0,shiftKey:!1,composed:!0,returnValue:!1,view:window,which:18,key:"Alt",code:"AltLeft",target:document.querySelector(e),currentTarget:document,location:1});document.querySelector(e).dispatchEvent(r)},i=(e,t,r)=>{var n="string"==typeof t?document.querySelector(t):t,s=a()(e),i=s.altKey,u=s.shiftKey,d=s.ctrlKey,l=s.keyCode,p=Array.isArray(l)?l[0]:l,f=(0,o.getKey)(p),h=(c.A[p]||{code:String.fromCharCode(p)}).code,m=new KeyboardEvent(r,{bubbles:!0,cancelable:!0,charCode:String.fromCharCode(p),keyCode:p,ctrlKey:d,altKey:i,shiftKey:u,composed:!0,returnValue:!1,view:window,which:p,key:f,code:h,target:n,currentTarget:document,location:0});n.dispatchEvent(m)};const u=(e,t)=>new Promise((r=>{i(e,t,"keydown"),i(e,t,"keypress"),i(e,t,"keyup"),setTimeout(r,100)}))},53264:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});const n=(e=window.location.href)=>e.includes("pdf.dev.texthelp.com")||e.includes("orbit.texthelp.com")||e.includes("orbitnote-us.staging.texthelp.com")||e.includes("orbitnote.staging.texthelp.com")},25039:(e,t,r)=>{"use strict";r.d(t,{Dy:()=>u,IC:()=>p,JB:()=>l,Sl:()=>d});var n=r(45841),a=r(61790),o=r.n(a),c=r(77617),s=r(97219),i=function(){var e=(0,n.A)(o().mark((function e(t){var r,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t);case 3:return r=e.sent,e.next=6,r.blob();case 6:return n=e.sent,e.next=9,navigator.clipboard.write([new ClipboardItem({[n.type]:n})]);case 9:return e.next=11,(0,s.Ys)(!1);case 11:if(!e.sent){e.next=14;break}return e.next=14,(0,s.aj)("clipboard",{url:t});case 14:c.Actions.Toolbar.setCopyMathStatus(c.CopyMathStatus.Success),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(0),console.error("Failed to copy to clipboard",e.t0),c.Actions.Toolbar.setCopyMathStatus(c.CopyMathStatus.Failure);case 21:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(t){return e.apply(this,arguments)}}(),u=function(){var e=(0,n.A)(o().mark((function e(t){var r,n,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,c.MathRendering.getSvg(t);case 4:return r=e.sent,n=r.html,e.next=8,c.MathRendering.getPng(n);case 8:return a=e.sent,e.next=11,i(a);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=(0,n.A)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l=function(){var e=(0,n.A)(o().mark((function e(t,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case 1:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),p=function(){var e=(0,n.A)(o().mark((function e(t,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case 1:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},65617:(e,t,r)=>{"use strict";r.d(t,{FC:()=>c,a0:()=>s,tN:()=>u});var n=r(41705);function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){(0,n.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var c={GraphLoad:"CORE_DESMOS_LOAD",GraphSetExpression:"CORE_DESMOS_SET_EXPRESSION",GraphDestroy:"CORE_DESMOS_DESTROY_CALCULATOR",GraphInitialise:"CORE_DESMOS_INITIALISE_CALCULATOR",GraphSetLocale:"CORE_DESMOS_SET_LOCALE",GraphSetLatex:"CORE_DESMOS_SET_CALCULATOR_LATEX",GraphSetState:"CORE_DESMOS_SET_CALCULATOR_STATE",GraphSetCalculator:"CORE_DESMOS_SET_CALCULATOR",GraphClear:"CORE_DESMOS_CLEAR_GRAPH",GraphGetScreenshot:"CORE_DESMOS_GET_CALCULATOR_SCREENSHOT",GraphGetState:"CORE_DESMOS_GET_CALCULATOR_STATE",GraphFocus:"CORE_DESMOS_FOCUS",GraphDispatchLatex:"CORE_DESMOS_DISPATCH_LATEX",GraphUpdateSettings:"CORE_DESMOS_LOAD_SETTINGS",GraphDisablePrediction:"CORE_DESMOS_DISABLE_PREDICTION",GraphGetPrediction:"CORE_DESMOS_GET_PREDICTION",GraphSetPrediction:"CORE_DESMOS_SET_PREDICTION",CalcLoad:"CORE_DESMOS_SCIENTIFIC_LOAD",CalcSetLocale:"CORE_DESMOS_SCIENTIFIC_UPDATE_LOCALE",CalcInitialise:"CORE_DESMOS_SCIENTIFIC_INITIALIZE",CalcDestroy:"CORE_DESMOS_SCIENTIFIC_DESTROY",GraphPredictionAnalytics:"CORE_DESMOS_PREDICTION_ANALYTICS"},s={Graph:"EquatioGraphContainer",Calc:"EquatioCalculatorContainer"},i=e=>{var t=document.querySelector(`#${e}`);return t?t.contentWindow:null},u=(e,t,r={})=>{var n=i(e);n&&n.postMessage(o({action:t},r),"*")}},67024:(e,t,r)=>{"use strict";r.d(t,{oE:()=>n});var n={Insert:"INSERT_HTML_EDITOR",Extract:"EXTRACT_SELECTION_HTML_EDITOR",SetEditor:"SET_HTML_EDITOR"}},67690:(e,t,r)=>{"use strict";r.d(t,{A:()=>p});var n,a=r(45841),o=r(61790),c=r.n(o),s=r(97219),i=r(71001),u=r(67024),d=r(17156),l=()=>new Promise(((e,t)=>{var r=({action:n,command:a,value:o,fromEditor:c})=>{n===i.A.HtmlEditorApiAction&&c&&a===u.oE.Extract&&(chrome.runtime.onMessage.removeListener(r),o?e(o):t(new Error("HTML_EDITOR_API_RESPONSE_FAILED")))};setTimeout((()=>{chrome.runtime.onMessage.removeListener(r),t(new Error("HTML_EDITOR_API_NO_RESPONSE"))}),5e3),chrome.runtime.onMessage.addListener(r);var n=(0,d.d)();(0,s.pM)(u.oE.Extract,null,!1,n)}));const p=(0,a.A)(c().mark((function e(){var t,r,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l();case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return",null);case 5:if(n||(n=new DOMParser),r=n.parseFromString(t,"text/html"),!(a=r.querySelector("img"))||!a.src){e.next=10;break}return e.abrupt("return",(0,s.ns)(a.src));case 10:return e.abrupt("return",null);case 11:case"end":return e.stop()}}),e)})))},62974:(e,t,r)=>{"use strict";r.d(t,{Dy:()=>f,IC:()=>v,JB:()=>m,Sl:()=>h});var n=r(45841),a=r(61790),o=r.n(a),c=r(70906),s=r(20773),i=r(67024),u=r(71001),d=r(97219),l=r(17156),p=e=>new Promise(((t,r)=>{var n=({action:e,command:a,value:o,fromEditor:c})=>{e===u.A.HtmlEditorApiAction&&c&&a===i.oE.Insert&&(chrome.runtime.onMessage.removeListener(n),o?t():r(new Error("HTML_EDITOR_API_RESPONSE_FAILED")))};setTimeout((()=>{chrome.runtime.onMessage.removeListener(n),r(new Error("HTML_EDITOR_API_NO_RESPONSE"))}),5e3),chrome.runtime.onMessage.addListener(n);var a=(0,l.d)();(0,d.pM)(i.oE.Insert,e,!1,a)})),f=function(){var e=(0,n.A)(o().mark((function e(t,r,n,a){var c,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return(c=document.createElement("img")).src=`https://equatio-api.texthelp.com/svg/${encodeURIComponent(t)}`,c.style.height=`${Math.round(n)}px`,c.alt=a,s=c.outerHTML,e.next=9,p(s);case 9:case"end":return e.stop()}}),e)})));return function(t,r,n,a){return e.apply(this,arguments)}}(),h=function(){var e=(0,n.A)(o().mark((function e(t,r="image"){var n,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=r,e.next="desmos"===e.t0?3:"whiteboard"===e.t0?5:7;break;case 3:return n="Equatio Desmos Graph",e.abrupt("break",9);case 5:return n="Equatio Whiteboard",e.abrupt("break",9);case 7:return n="Equatio Image",e.abrupt("break",9);case 9:return a=`<img src="${t}" alt="${n}" />`,e.next=12,p(a);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=(0,n.A)(o().mark((function e(t,r){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,c.A)(t,r);case 4:return n=e.sent,e.next=7,h(n,"desmos");case 7:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),v=function(){var e=(0,n.A)(o().mark((function e(t,r){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,s.A)(t,r);case 4:return n=e.sent,e.next=7,h(n,"whiteboard");case 7:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},25292:(e,t,r)=>{"use strict";r.d(t,{BW:()=>i,Kj:()=>u,M$:()=>s});var n=r(35539),a=()=>{var e=document.querySelector("#equatio-gsuite-discover-shadow-host");return e&&e.shadowRoot?e.shadowRoot:document},o=()=>a().querySelector(".equatio-gsuite-discover-overlay-center"),c=()=>a().querySelector(".equatio-gsuite-discover-overlay"),s=()=>{var e=c();return null!==e&&"none"!==e.style.display},i=()=>{var e=o();if(e){var t=e.getBoundingClientRect(),r=t.x,a=t.y,c=t.width,s=t.height;return(0,n.A)(r+c/2,a+s/2,"div.kix-embeddedobject-view, g>image")}},u=()=>{var e=c();e&&(e.style.display="none")}},31596:(e,t,r)=>{"use strict";r.d(t,{d:()=>d});var n=r(45841),a=r(61790),o=r.n(a),c=e=>["https://equatio-api.texthelp.com/","https://equatio-api.dev.texthelp.com/"].some((t=>e.includes&&e.includes(t))),s=e=>[].concat(...e.map((e=>Array.isArray(e)?s(e):e))),i=(e,t)=>e.filter(t).pop(),u=function(){var e=(0,n.A)(o().mark((function e(t){var r,n,a,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(window.location.href.toString(),{method:"GET",credentials:"same-origin"});case 2:return r=e.sent,e.next=5,r.text();case 5:n=e.sent,(a=document.createElement("div")).id="th-page-reloaded",a.style.display="none",a.innerHTML=n,c=Array.prototype.slice.call(a.querySelectorAll("script")),c.filter((e=>"DOCS_modelChunk = ["===e.innerHTML.substr(0,19))).forEach((e=>{var r=e.innerHTML.replace("DOCS_modelChunk = ",""),n=r.lastIndexOf("]; ");r=r.substr(0,n+1);var a=JSON.parse(r);t(a)}));case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=(0,n.A)(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={},e.next=3,u((e=>{var r=s(e),n=r.reduce(((e,t,r)=>"string"==typeof t&&c(t)?[...e,r]:e),[]);if(0===n.length)return null;n.reverse().forEach((e=>{var n=r.slice(0,e),a=i(n,(e=>"string"==typeof e&&e.length>0));t[a]=r[e]}))}));case 3:return e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},16203:(e,t,r)=>{"use strict";r.d(t,{D:()=>i,W:()=>s});var n=r(73729),a=r(17156),o=r(11441),c=r(97219),s=()=>{var e=window.location.hostname;if((0,n.X)()&&null===(0,a.d)())return!1;if((0,o.Ay)(e)){var t=(0,o.QW)(e);return!!(0,o.ao)(t)}return!0},i=e=>{e||(0,c.nt)("InsertMathspaceSelected","Feature","Mathspace"),(0,c.$u)(e)}},83993:(e,t,r)=>{"use strict";r.d(t,{_:()=>E,w:()=>k});var n=r(45841),a=r(41705),o=r(61790),c=r.n(o),s=r(78054),i=r(49305),u=r(53760);function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){(0,a.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var p=e=>{var t={bubbles:!0,currentTarget:document,defaultPrevented:!1,srcElement:e,target:e,timeStamp:Date.now(),view:window,charCode:0,keyCode:27,key:"Escape",code:"Escape",which:27};e.dispatchEvent(new KeyboardEvent("keydown",l(l({},t),{},{type:"keydown"}))),e.dispatchEvent(new KeyboardEvent("keyup",l(l({},t),{},{type:"keyup"})))},f=(e,t=!1)=>{var r={bubbles:!0,currentTarget:document,defaultPrevented:!1,srcElement:e,target:e,timeStamp:Date.now(),view:window,charCode:0,keyCode:t?37:39,key:t?"ArrowLeft":"ArrowRight",code:t?37:39,which:t?37:39,shiftKey:t};e.dispatchEvent(new KeyboardEvent("keydown",l(l({},r),{},{type:"keydown"}))),e.dispatchEvent(new KeyboardEvent("keyup",l(l({},r),{},{type:"keyup"})))},h=e=>{var t=e.getBoundingClientRect(),r=t.x,n=t.y,a={altKey:!1,bubbles:!0,button:0,buttons:0,cancelBubble:!1,cancelable:!0,clientX:r+t.width/2,clientY:n+t.height/2,composed:!0,ctrlKey:!1,defaultPrevented:!1,detail:1,eventPhase:3,fromElement:null,isTrusted:!0,metaKey:!1,relatedTarget:null,returnValue:!0,shiftKey:!1,timeStamp:Date.now(),type:"click",view:window,which:1};e.dispatchEvent(new MouseEvent("mousedown",l(l({},a),{},{type:"mousedown"}))),e.dispatchEvent(new MouseEvent("mouseup",l(l({},a),{},{type:"mouseup"}))),e.dispatchEvent(new MouseEvent("click",a))},m=(e,t)=>{var r=new InputEvent("input",{bubbles:!0,cancelBubble:!1,cancelable:!1,composed:!0,currentTarget:e,data:t,dataTransfer:null,defaultPrevented:!1,detail:0,eventPhase:3,inputType:"insertText",isComposing:!1,isTrusted:!0});e.dispatchEvent(r)},v=()=>{var e=document.querySelector("button[data-unique-id='SingleLineRibbon-HideRibbon']");return!!e&&"true"===e.getAttribute("aria-checked")},b=e=>{try{var t=document.querySelector("#RibbonModeToggle");t&&t.click(),(e?document.querySelector("button[data-unique-id='SingleLineRibbon-AlwaysShowRibbon']"):document.querySelector("button[data-unique-id='SingleLineRibbon-HideRibbon']")).click()}catch(e){}},x=function(){var e=(0,n.A)(c().mark((function e(t,r,n){var a,o,u,d,l,x,y;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h(n),a=!!document.querySelector("#Title"),o=!1,a){e.next=23;break}return e.next=6,(0,s.A)((()=>document.querySelector("#Picture")),50);case 6:return e.sent.click(),e.next=10,(0,s.A)((()=>document.querySelector("#EditPictureAltText")),10,!1);case 10:if(u=e.sent){e.next=21;break}return(o=v())&&b(!0),e.next=16,(0,s.A)((()=>document.querySelector("#RibbonOverflowMenu-overflow")),10,!1);case 16:return(d=e.sent)&&d.click(),e.next=20,(0,s.A)((()=>{var e=document.querySelector("#EditPictureAltText");return e||document.querySelector("button[data-unique-id=Overflow-EditPictureAltText]")}),100);case 20:u=e.sent;case 21:o&&setTimeout((()=>b(!1)),200),u.click();case 23:return e.next=25,(0,s.A)((()=>document.querySelector("#Description")),100);case 25:if(l=e.sent,a){e.next=29;break}return e.next=29,(0,i.v)(200);case 29:x=`${t}\n\n${r}`,l.value=x,m(l,x),a||((y=document.querySelector("#TaskPaneCloseBtnFormatPictureTaskPane"))?y.click():p(l||document.body)),f(n);case 34:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),y=function(){var e=(0,n.A)(c().mark((function e(){var t,r,n,a,o,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,s.A)((()=>document.querySelector("#Home")),10,!1);case 2:return(t=e.sent)&&t.click(),e.next=6,(0,s.A)((()=>document.querySelector("#PasteStandalone, #PasteSplitButton > button, button[data-unique-id='Ribbon-PasteSplitButton']")),10,!1);case 6:if(!(r=e.sent)){e.next=10;break}return r.click(),e.abrupt("return");case 10:return e.next=12,(0,s.A)((()=>document.querySelector("#Clipboard")),10,!1);case 12:return(n=e.sent)&&n.click(),e.next=16,(0,s.A)((()=>document.querySelector("button[data-unique-id=Ribbon-Paste]")),10,!1);case 16:if(!(a=e.sent)){e.next=21;break}a.click(),e.next=27;break;case 21:if(!(o=document.querySelector("button[name=Paste]"))){e.next=25;break}return o.click(),e.abrupt("return");case 25:(i=document.querySelectorAll("#Ribbon-ClipboardDropdown li > button"))[i.length-1].click();case 27:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),w=()=>{var e=document.querySelector("#DialogActionButton"),t=document.activeElement;if(e&&t===e)return!0;if(e&&t&&t.contains(e))return!0;var r=document.querySelector("#dialogHost");return!(!r||!r.contains(t))},g=({tts:e,mathML:t})=>new Promise(((r,n)=>{var a=document.querySelector("#PageContentContainer");if(a){var o=new MutationObserver((a=>{for(var c=0;c<a.length;c+=1){var s=a[c].addedNodes[0];if(s&&s.parentElement&&s.classList&&s.classList.contains("WACImage")){var i=a[c].addedNodes[0].parentElement;o.disconnect(),x(e,t,i).then((()=>r())).catch((e=>{console.error("EquatIO Setting Alt Text Failed",e),n(e)}));break}}}));o.observe(a,{childList:!0,subtree:!0}),y().then((()=>{setTimeout((()=>{w()&&(o.disconnect(),r())}),1e3),setTimeout((()=>{o.disconnect(),n(new Error("Observer timed out"))}),3e4)})).catch((e=>{o.disconnect(),console.error("Error pasting into word!",e),n(e)}))}else n(new Error("PageContentContainer not found"))})),A=()=>{var e=document.querySelector(".OnlyImageSelected > img");return e&&e.alt?e.alt:null},k=e=>g(e),E=()=>(0,u.A)(A())},53760:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(45841),a=r(61790),o=r.n(a),c=r(72876);const s=function(){var e=(0,n.A)(o().mark((function e(t){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error("no_math_found");case 2:return e.next=4,(0,c.V)(t);case 4:if(!(r=e.sent)){e.next=7;break}return e.abrupt("return",r);case 7:throw new Error("no_math_found");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},88828:(e,t,r)=>{"use strict";r.d(t,{Dy:()=>y,IC:()=>x,JB:()=>b,Sl:()=>v});var n=r(45841),a=r(61790),o=r.n(a),c=r(77617),s=r(94772),i=r(3201),u=r(97219),d=r(70906),l=r(20773),p=r(83993),f=r(11441),h=()=>(0,f.ao)((0,f.QW)(window.location.hostname)),m=function(){var e=(0,n.A)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,u.Fe)(t);case 3:return e.next=5,(0,u.Ys)(!1);case 5:if(!e.sent){e.next=8;break}return e.next=8,(0,u.aj)("clipboard",{url:t});case 8:c.Actions.Toolbar.setCopyMathStatus(c.CopyMathStatus.Success),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.error("Failed to copy to clipboard",e.t0),c.Actions.Toolbar.setCopyMathStatus(c.CopyMathStatus.Failure);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=(0,n.A)(o().mark((function e(t,r="image"){var n,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h()){e.next=3;break}return m(t),e.abrupt("return");case 3:e.t0=r,e.next="desmos"===e.t0?6:"whiteboard"===e.t0?8:10;break;case 6:return n="Equatio Desmos Graph",e.abrupt("break",12);case 8:return n="Equatio Whiteboard",e.abrupt("break",12);case 10:return n="Equatio Image",e.abrupt("break",12);case 12:return a=(0,i.A)(t,r,n),e.next=15,(0,u.Fe)(t);case 15:return e.next=17,(0,p.w)({tts:n,mathML:a});case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=(0,n.A)(o().mark((function e(t,r){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,d.A)(t,r);case 4:return n=e.sent,e.next=7,v(n,"desmos");case 7:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),x=function(){var e=(0,n.A)(o().mark((function e(t,r){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,l.A)(t,r);case 4:return n=e.sent,e.next=7,v(n,"whiteboard");case 7:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),y=function(){var e=(0,n.A)(o().mark((function e(t,r,n,a,i){var d,l,f,v;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,c.MathRendering.getSvg(t);case 4:return d=e.sent,l=d.html,e.next=8,c.MathRendering.getPng(l);case 8:if(f=e.sent,h()){e.next=13;break}return e.next=12,m(f);case 12:return e.abrupt("return");case 13:return e.next=15,(0,u.Fe)(f);case 15:return v=(0,s.A)(t,i),e.next=18,(0,p.w)({tts:a,mathML:v});case 18:case"end":return e.stop()}}),e)})));return function(t,r,n,a,o){return e.apply(this,arguments)}}()},11441:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>s,QW:()=>i,ao:()=>c});var n=["onedrive.live.com",".sharepoint.com",".officeapps.live.com"],a={Word:"Word",PowerPoint:"PowerPoint",Excel:"Excel",Onenote:"Onenote"},o=[a.Word],c=e=>o.includes(e);const s=(e,t=!0)=>{if(!e)return!1;var r=e;if(!t)try{r=new URL(e).hostname}catch(e){return!1}for(var a=0;a<n.length;a+=1)if(r.endsWith(n[a]))return!0;return!1};var i=e=>e.endsWith("word-edit.officeapps.live.com")?a.Word:e.endsWith("powerpoint.officeapps.live.com")?a.PowerPoint:e.endsWith("excel.officeapps.live.com")?a.Excel:e.endsWith("onenote.officeapps.live.com")?a.Onenote:null},70140:(e,t,r)=>{"use strict";r.d(t,{s:()=>n});var n=(e,t=0)=>{var r;return function(...n){clearTimeout(r),r=window.setTimeout((()=>e.apply(this,n)),t)}}},83566:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(53264),a=r(85279),o=r(11441),c=r(56903);const s=e=>{var t;if(e)try{t=new URL(e)}catch(e){}if(!t&&window&&window.location&&(t=window.location),!t)return"Unknown";var r=t,s=r.hostname,i=r.href,u=(0,a.UF)(t);if(u)return`${u}${(0,a.eU)(t)?" - Response":""}`;if((0,n.A)(i))return"OrbitNote";if((0,o.Ay)(s,!0)){var d=(0,o.QW)(s);return d?`Microsoft ${d}`:"Microsoft Office"}return(0,c.n)(s)?`Partner - ${s}`:"Third Party Website"}},59227:(e,t,r)=>{"use strict";r.d(t,{T:()=>i});var n=r(45841),a=r(61790),o=r.n(a),c=r(60093),s=r(97219),i=function(){var e=(0,n.A)(o().mark((function e(t){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:if(!t.includes("filesystem:")){e.next=7;break}return e.next=5,(0,c.dw)(t);case 5:return r=e.sent,e.abrupt("return",r);case 7:return e.abrupt("return",(0,s.ns)(t));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},49305:(e,t,r)=>{"use strict";r.d(t,{v:()=>n});var n=e=>new Promise((t=>{setTimeout((()=>t()),e)}))},80086:(e,t,r)=>{"use strict";r.d(t,{e:()=>i});var n=r(45841),a=r(61790),o=r.n(a),c=r(77617),s=r(97219),i=function(){var e=(0,n.A)(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,s.Si)();case 2:if(t=e.sent){e.next=6;break}return c.Actions.Favourites.setFavourites([]),e.abrupt("return");case 6:c.Actions.Favourites.setFavourites(t);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},88820:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});var n=r(77617),a=r(15174),o=r(89621),c=r(32396);const s=(0,n.createReduxStore)([a.Ay,o.A,c.A],"Equatio Chrome")},879:(e,t,r)=>{"use strict";r.d(t,{A:()=>m});var n=r(45841),a=r(61790),o=r.n(a),c=r(77617),s=r(97219),i=r(88820),u=r(20044),d=r(16203),l=r(83566),p={InsertImage:"EQUATIO_COMPANION_INSERT_IMAGE",InsertMath:"EQUATIO_COMPANION_INSERT_MATH",InsertMathspace:"EQUATIO_MATHSPACE_INSERT_IMAGE"},f=e=>{var t=(0,u.Sn)().math;(0,n.A)(o().mark((function r(){var n,a,s,u,d,l,p,f;return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=i.default.getState().mathOptions,a=n.locale,s=n.speechEngine,r.next=3,c.MathRendering.getSvg(e);case 3:return u=r.sent,d=u.width,l=u.height,r.next=8,c.MathRendering.getSpokenText(e,a,s);case 8:return p=r.sent,r.next=11,c.MathRendering.getMathML(e);case 11:f=r.sent,t(e,d,l,p,f);case 13:case"end":return r.stop()}}),r)})))()},h=function(){var e=(0,n.A)(o().mark((function e(t){var r,n,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(0,u.Sn)(),n=r.image,!t.startsWith("http")){e.next=5;break}return e.next=4,n(t);case 4:return e.abrupt("return");case 5:if(!(0,d.W)()){e.next=13;break}return e.next=8,(0,s.WS)(null,t);case 8:return a=e.sent,e.next=11,n(a);case 11:e.next=15;break;case 13:return e.next=15,n(t);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();const m=()=>{var e=e=>{if(e&&e.action){var t=(0,l.A)();switch(e.action){case p.InsertMath:f(e.latex);break;case p.InsertImage:h(e.image);break;case p.InsertMathspace:(0,s.nt)("MathspaceInserted","Feature","Mathspace",{location:t}),h(e.image)}}};chrome.runtime.onMessage.addListener(e)}},17156:(e,t,r)=>{"use strict";r.d(t,{d:()=>a});r(61790),r(77617),r(67024),r(71001),r(97219),r(20044);var n=null,a=()=>n},20044:(e,t,r)=>{"use strict";r.d(t,{Sn:()=>C,i4:()=>S});var n,a,o,c=r(879),s=r(85279),i=r(82627),u=r(96685),d=r(13161),l=r(92668),p=r(33984),f=r(74744),h=r(36216),m=r(39956),v=r(88828),b=r(25039),x=r(62974),y=r(11441),w=r(83993),g=r(53264),A=r(67690),k=r(56903),E=()=>{var e=window.location,t=e.host,r=e.hostname;if("docs.google.com"===t)switch((0,s.UF)()){case"Google Forms":n=null,(0,i.D)(),a={graph:f.JB,math:f.Dy,image:f.Sl,whiteboard:f.IC};break;case"Google Sheets":n=l.A,a={graph:p.JB,math:p.Dy,image:p.Sl,whiteboard:p.IC};break;default:n=h.A,a={graph:m.JB,math:m.Dy,image:m.Sl,whiteboard:m.IC}}else(0,y.Ay)(r)?(n=w._,a={graph:v.JB,math:v.Dy,image:v.Sl,whiteboard:v.IC}):(0,g.A)()||(0,k.n)()?(n=i.A,a={graph:d.JB,math:d.Dy,image:d.Sl,whiteboard:d.IC},(0,i.D)(),(0,u.A)()):o?(n=A.A,a={graph:x.JB,math:x.Dy,image:x.Sl,whiteboard:x.IC,isEditorApi:!0}):(n=null,a={graph:b.JB,math:b.Dy,image:b.Sl,whiteboard:b.IC})};E(),(0,c.A)();var S=()=>n,C=()=>a},23e3:(e,t,r)=>{"use strict";r.d(t,{CI:()=>c,M0:()=>s,Tc:()=>n,iI:()=>o});var n=Object.freeze({Automatic:"automatic",Speed:"speed",Quality:"quality"}),a=n.Automatic,o=()=>a,c=e=>a=e,s=()=>({chromeOptions:{insertType:a}})},89621:(e,t,r)=>{"use strict";r.d(t,{A:()=>b});var n=r(41705),a=r(45841),o=r(61790),c=r.n(o),s=r(77617),i=r(97219),u=r(5246),d=r(32396),l=r(43320),p=r(23e3),f=r(65617),h=r(35116);function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){(0,n.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const b=()=>e=>t=>{switch(t.type){case s.Events.Options.SaveSettings:var r=t.profile,n=t.options,o=t.disabledFeatures;(0,a.A)(c().mark((function e(){var t,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,i.mJ)(v(v({},n),{},{disabledFeatures:o}),r,(0,p.M0)());case 2:t=(0,h.O)(),a=o.prediction||t.includes("prediction"),(0,f.tN)(f.a0.Graph,f.FC.GraphUpdateSettings,{options:v(v({},n),{},{disabled:a})});case 5:case"end":return e.stop()}}),e)})))(),(0,l.c)(n.locale);break;case s.Events.Options.CheckLicense:var m=t.code;(0,a.A)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,u.TX)(m);case 3:t=e.sent,s.Actions.Options.setUserLicense(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),s.Actions.Options.setUserLicenseError();case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))();break;case s.Events.Options.Closed:if(t.saved)break;(0,d.M)()}return e(t)}},32396:(e,t,r)=>{"use strict";r.d(t,{A:()=>h,M:()=>f});var n=r(10911),a=r(45841),o=r(61790),c=r.n(o),s=r(77617),i=r(97219),u=r(5246),d=r(23e3),l=r(80086),p=(e="enUS")=>{switch(e){case"en-GB":return"enGB";case"en-US":return"enUS";default:return e}},f=function(){var e=(0,a.A)(c().mark((function e(){var t,r,a,o,f,h,m,v,b,x,y,w,g,A,k,E,S,C,T,M,O,I,_,R,L,D,P,q,F,U,N,G,W,j,B,H,$;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([(0,i.h_)(),(0,u.Ay)(),(0,i.PD)()]);case 2:t=e.sent,r=(0,n.A)(t,3),a=r[0],o=r[1],f=r[2],h=a.options||{},m=h.fontSize,v=void 0===m?"regular":m,b=h.locale,x=void 0===b?"enUS":b,y=h.showTips,w=void 0===y||y,g=h.speechEngine,A=void 0===g?"auto":g,k=h.speechSpeed,E=void 0===k?50:k,S=h.autoplaySR,C=void 0===S||S,T=h.voice,M=void 0===T?null:T,O=h.math,I=void 0===O||O,_=h.chemistry,R=void 0===_||_,L=h.formulas,D=void 0===L||L,P=h.disabledFeatures,q=void 0===P?{}:P,F=h.mathSolver,U=void 0===F?null:F,N=a.profile_info,G=N.type,W=void 0===G?"student":G,j=N.provider,B=void 0===j?"google":j,s.Actions.Options.loadSettings({fontSize:v,showTips:w,math:I,chemistry:R,formulas:D,speechEngine:A,locale:p(x),speechSpeed:E,autoplaySR:C,voice:M,disabledFeatures:Object.keys(q).filter((e=>!0===q[e])),mathSolver:U},{type:W,license:o,displayName:f,provider:B}),(0,l.e)(),H=a.chromeOptions||{},$=H.insertType,(0,d.CI)($);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();const h=e=>t=>r=>{var n=e.getState();switch(r.type){case s.Events.PopupMenu.Shown:var o=n.drawer.mode;o&&s.Actions.Toolbar.setMode(o);break;case s.Events.PopupMenu.ShowOptionsDialog:s.Actions.Academy.setHidden(),s.Actions.PopupMenu.show(!1),(0,a.A)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f();case 2:case"end":return e.stop()}}),e)})))()}return t(r)}},35116:(e,t,r)=>{"use strict";r.d(t,{A:()=>u,O:()=>i});var n=r(77617),a=r(88820),o=r(65617),c={},s=[],i=()=>s;const u=(e,t)=>{if(e&&Array.isArray(e)){c[t]=e,s=[],Object.values(c).forEach((e=>{s=s.concat(e)}));var r=a.default.getState(),i=r.drawer,u=r.academyFloatingWindow,d=r.interactiveWindow;s.includes(i.mode)&&n.Actions.Toolbar.setMode(void 0),u.shown&&s.includes("equatio-academy")&&n.Actions.Academy.setHidden(),s.includes("stem-tools")&&d.activeWindows.length&&n.Actions.InteractiveWindow.closeWindows(),n.Actions.Toolbar.setDisabledFeatures(s);var l=s.includes("prediction");(0,o.tN)(o.a0.Graph,o.FC.GraphDisablePrediction,{disabled:l})}}},15174:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>C,BZ:()=>g});var n,a,o=r(45841),c=r(61790),s=r.n(c),i=r(77617),u=r(5246),d=r(97219),l=r(20044),p=r(83566),f=r(25292),h=r(97099),m=r(70140),v=r(16203),b=r(96685),x=r(56903),y=r(37922),w=[],g=e=>{w.push(e)},A=e=>{w.forEach((t=>{"function"==typeof t&&t(e)}))},k={},E={},S=(0,m.s)(function(){var e=(0,o.A)(s().mark((function e(t,r){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,d.C4)(Object.values(t));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error("THROTTLE_FAVOURITES_ADD",e.t0);case 8:return e.prev=8,e.next=11,(0,d.J2)(Object.values(r));case 11:e.next=16;break;case 13:e.prev=13,e.t1=e.catch(8),console.error("THROTTLE_FAVOURITES_REMOVE",e.t1);case 16:k={},E={};case 18:case"end":return e.stop()}}),e,null,[[0,5],[8,13]])})));return function(t,r){return e.apply(this,arguments)}}(),1e3);const C=e=>t=>r=>{switch(r.type){case i.Events.Toolbar.OpenMathspace:(0,d.aj)(null),(0,v.D)();break;case i.Events.General.RequestLicense:(0,o.A)(s().mark((function e(){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,u.Ay)();case 2:t=e.sent,i.Actions.General.setLicense(t);case 4:case"end":return e.stop()}}),e)})))();break;case i.Events.Toolbar.SetInsertsLeft:var c=r.value;(0,d.bb)(c);break;case i.Events.Toolbar.RequestExtractedMath:var m=(0,l.i4)();(0,o.A)(s().mark((function t(){var r,n,a,o,c,u,l;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m();case 2:if(r=t.sent){t.next=5;break}return t.abrupt("return");case 5:if(n=e.getState(),a=(0,p.A)(),"mathspace"!==r.type){t.next=15;break}if((0,i.canUseFeature)(n,i.Features.Mathspace)){t.next=10;break}return t.abrupt("return");case 10:(0,d.nt)("EditMathSelected","Feature","Math",{type:"Mathspace",location:a}),(0,v.D)(r.platformIntegrationId),(0,f.Kj)(),t.next=37;break;case 15:if("desmos"!==r.type){t.next=23;break}if((0,i.canUseFeature)(n,i.Features.GraphEditor)){t.next=18;break}return t.abrupt("return");case 18:(0,d.nt)("EditMathSelected","Feature","Math",{type:"Graph",location:a}),i.Actions.Toolbar.setExtractedGraph(r.state),i.Actions.Toolbar.setMode(i.ToolModes.GraphEditor,!0),t.next=37;break;case 23:if("whiteboard"!==r.type){t.next=33;break}if((0,i.canUseFeature)(n,i.Features.Whiteboard)){t.next=26;break}return t.abrupt("return");case 26:(0,d.nt)("EditMathSelected","Feature","Math",{type:"Whiteboard",location:a}),o=JSON.parse(r.state),c=o.elements,u=o.appState,l=o.files,i.Actions.Toolbar.setWhiteboardData({elements:c,appState:u,files:l}),i.Actions.Toolbar.setMode(i.ToolModes.Whiteboard,!0),t.next=37;break;case 33:if((0,i.canUseFeature)(n,i.Features.EquationEditor)){t.next=35;break}return t.abrupt("return");case 35:(0,d.nt)("EditMathSelected","Feature","Math",{type:"Math",location:a}),i.Actions.Toolbar.setExtractedMath(r,!0);case 37:case"end":return t.stop()}}),t)})))();break;case i.Events.Toolbar.InsertMath:(0,d.aj)(null),i.Actions.Toolbar.setInsertMathLoading(!0);var w=e.getState().drawer.mode,g=r.width,C=r.height,T=r.latex,M=r.spokenText,O=r.mathML,I=(0,l.Sn)().math,_=(0,p.A)();(0,d.nt)("MathInserted","Feature","Math",{type:w||"undefined",location:_}),(0,o.A)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I(T,g,C,M,O);case 3:e.next=10;break;case 5:e.prev=5,e.t0=e.catch(0),i.Actions.Toolbar.setInsertMathLoading(!1),console.error("Math insert failed",e.t0),(0,d.aj)("insert_fail");case 10:i.Actions.Toolbar.setInsertMathLoading(!1),w===i.ToolModes.HandwritingRecognition&&(0,d.Ae)();case 12:case"end":return e.stop()}}),e,null,[[0,5]])})))();break;case i.Events.Toolbar.InsertGraph:(0,d.aj)(null);var R=r.imageData,L=r.calculatorState;if(R&&L){var D=(0,p.A)();(0,d.nt)("GraphInserted","Feature","Graph",{location:D}),(0,o.A)(s().mark((function e(){var t,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i.Actions.Toolbar.setInsertMathLoading(!0),e.prev=1,t=(0,l.Sn)(),r=t.graph,e.next=5,r(R,L);case 5:e.next=12;break;case 7:e.prev=7,e.t0=e.catch(1),console.error("Insert Graph Failed",e.t0),i.Actions.Toolbar.setInsertMathLoading(!1),(0,d.aj)("insert_fail");case 12:i.Actions.Toolbar.setInsertMathLoading(!1),(0,d.Ae)();case 14:case"end":return e.stop()}}),e,null,[[1,7]])})))()}break;case i.Events.Toolbar.InsertWhiteboard:(0,d.aj)(null);var P=r.imageData,q=r.whiteboardState;if(P&&q){var F=(0,p.A)();(0,d.nt)("WhiteboardInserted","Feature","Whiteboard",{location:F}),(0,o.A)(s().mark((function e(){var t,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i.Actions.Toolbar.setInsertMathLoading(!0),e.prev=1,t=(0,l.Sn)(),r=t.whiteboard,e.next=5,r(P,q);case 5:e.next=12;break;case 7:e.prev=7,e.t0=e.catch(1),console.error("Insert Whiteboard Failed",e.t0),i.Actions.Toolbar.setInsertMathLoading(!1),(0,d.aj)("insert_whiteboard_fail");case 12:i.Actions.Toolbar.setInsertMathLoading(!1),(0,d.Ae)();case 14:case"end":return e.stop()}}),e,null,[[1,7]])})))()}else(0,d.aj)("insert_whiteboard_fail");break;case i.Events.Toolbar.SetMode:var U=r.mode;if("screenshot_reader"===U){var N=e.getState().licensing.profile,G=N.daysleft,W=N.features;if(G<0&&!W["Screenshot Reader"])return t({type:"noop"})}U===i.ToolModes.HandwritingRecognition?(0,d.AJ)():U===i.ToolModes.EquationEditor&&(0,d.HW)(),(0,o.A)(s().mark((function t(){var n,a,o;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.getState().drawer.mode,r.mode!==i.ToolModes.Whiteboard||n&&n===i.ToolModes.Whiteboard){t.next=11;break}return t.next=4,(0,y.Ml)("Whiteboard");case 4:if(a=t.sent,!!a&&a.splashDisplayed){t.next=11;break}return i.Actions.Toolbar.setWhiteboardSplashDisplay(!0),o={splashDisplayed:!0},t.next=11,(0,y.cT)({Whiteboard:o});case 11:case"end":return t.stop()}}),t)})))(),(0,f.Kj)();break;case i.Events.Favourites.Added:var j=r.item,B=`${j.name}${j.latex}${j.command}`;k[B]=j,delete E[B],S(k,E);break;case i.Events.Favourites.Removed:var H=r.item,$=`${H.name}${H.latex}${H.command}`;E[$]=H,delete k[$],S(k,E);break;case i.Events.Favourites.Reformat:var K=r.addItems,Q=r.removeItems;clearTimeout(a),a=setTimeout((()=>(0,d.DK)(K,Q)),1e3);break;case i.Events.Toolbar.MathCopied:(0,d.aj)(null),(0,d.nt)("CopyMathSelected","Feature","Math",{format:r.mode}),(0,o.A)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,h.A)(r.mode);case 3:if(r.mode!==i.CopyMode.Download){e.next=5;break}return e.abrupt("return");case 5:i.Actions.Toolbar.setCopyMathStatus(i.CopyMathStatus.Success),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),i.Actions.Toolbar.setCopyMathStatus(i.CopyMathStatus.Failure);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))();break;case i.Events.Toolbar.LatexChanged:void 0===n&&(n=(0,x.n)()),n&&(0,b.X)(r.latex)}var J=t(r);return A(r),J}},73729:(e,t,r)=>{"use strict";r.d(t,{X:()=>s});var n=r(53264),a=r(85279),o=r(11441),c=r(56903),s=(e=window.location)=>{var t=e.hostname,r=e.href;return!(0,a.UF)(e)&&(!(0,n.A)(r)&&(!(0,c.n)(t)&&!(0,o.Ay)(t)))}},43320:(e,t,r)=>{"use strict";r.d(t,{c:()=>o});r(61790),r(97219);var n,a=(e="enUS")=>{switch(e){case"en-GB":return"enGB";case"en-US":return"enUS";default:return e}},o=e=>{n&&(n.locale=a(e))}},69103:()=>{},69324:()=>{},80541:()=>{},43039:()=>{},59274:()=>{},9537:()=>{}}]);