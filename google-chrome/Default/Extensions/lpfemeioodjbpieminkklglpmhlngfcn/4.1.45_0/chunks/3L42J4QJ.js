import{c as Xs}from"./TASNGCXZ.js";import{a as le}from"./WZHIWEFG.js";import{A as re,B as vt,C as ys,E as Pn,F as Ce,G as pe,H as $e,J as Je,K as Yt,V as vs,a as V,b as Ut,c as Ss,d as Ke,e as Ds,f as bs,g as se,h as Ps,i as R,j as Ve,k as Ms,l as Ft,m as j,n as x,o as xt,p as Bs,q as ks,r as Hs,s as je,t as Us,u as qe,v as Fs,w as yt,x as wt,y as ze,z as xs}from"./GTVKCQRS.js";import{a as Ze}from"./IBXKRLTS.js";import{a as Hn}from"./MBSRGUFQ.js";import{a as qs}from"./OHEA6U3N.js";import{a as Ks,b as Vs}from"./FK4HKR72.js";import{a as tt}from"./65MXYLMS.js";import{a as js}from"./YJUUDRKB.js";import{ba as kn,f as Gs}from"./7E6GGIST.js";import{L as et,o as Ys,p as Mn,r as Qs,s as Ws,t as Bn,w as Ee}from"./EUSDRET5.js";import{a as ws}from"./E5ZZU67S.js";import{a as bn}from"./BXPPDSGN.js";import{a as Ls}from"./IWA7K7OR.js";import{a as gs,d as Os}from"./KHXRDVYA.js";import{c as Xe,d as X,f as ce,i as Ht}from"./3PS7M655.js";var zs=Xe(st=>{"use strict";var Un=et();Object.defineProperty(st,"__esModule",{value:!0});st.default=void 0;var Fn=Un(tt()),xn=Ee(),yn=(0,Fn.default)((0,xn.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close");st.default=yn});var zn=Xe(nt=>{"use strict";var Kn=et();Object.defineProperty(nt,"__esModule",{value:!0});nt.default=void 0;var Vn=Kn(tt()),jn=Ee(),qn=(0,Vn.default)((0,jn.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"}),"CloseOutlined");nt.default=qn});var ta=Xe(at=>{"use strict";var $n=et();Object.defineProperty(at,"__esModule",{value:!0});at.default=void 0;var Jn=$n(tt()),Zn=Ee(),ea=(0,Jn.default)((0,Zn.jsx)("path",{d:"M16 8v8H8V8h8m2-2H6v12h12V6z"}),"StopOutlined");at.default=ea});var Jc=Xe(Bt=>{"use strict";var jc=et();Object.defineProperty(Bt,"__esModule",{value:!0});Bt.default=void 0;var qc=jc(tt()),zc=Ee(),$c=(0,qc.default)((0,zc.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),"SearchOutlined");Bt.default=$c});Mn();Bn();var $s=ce(bn()),Js=ce(Hn()),Zs=ce(zs());var W=ce(Ee()),er="webchatgpt-snackbar",tr="webchatgpt-snackbar-container",K,wn=()=>(K=Vs(),null),TE=()=>K,uE=()=>{K&&K.closeSnackbar&&K.closeSnackbar()},dE=()=>{var e,t;return(t=(e=document.getElementById(er))==null?void 0:e.shadowRoot)==null?void 0:t.getElementById(tr)},vn=()=>{let{customTheme:e}=qs({colorSchema:"dark"});return(0,W.jsx)(Ws,{theme:e,children:(0,W.jsx)(Ks,{maxSnack:3,preventDuplicate:!0,hideIconVariant:!0,autoHideDuration:3e3,anchorOrigin:{vertical:"bottom",horizontal:"right"},action:t=>(0,W.jsx)(Gs,{onClick:()=>{K&&K.closeSnackbar&&K.closeSnackbar(t)},children:(0,W.jsx)(Zs.default,{fontSize:"inherit",sx:{color:"white"}})}),children:(0,W.jsx)(wn,{})})})},fE=()=>{let{container:e,shadowRoot:t,emotionRoot:s}=Xs({containerId:tr,shadowRootId:er,presetContainerElement(a){a.style.color="#fff"}});e.style.zIndex=`${gs.TOAST}`,document.body.appendChild(t);let n=Ys({key:"webchatgpt-snackbar-emotion-cache",prepend:!0,container:s});(0,Js.createRoot)(e).render((0,W.jsx)($s.default.StrictMode,{children:(0,W.jsx)(js,{children:(0,W.jsx)(Qs,{value:n,children:(0,W.jsx)(vn,{})})})}))},rt=(e,t={})=>{K.enqueueSnackbar(e,t)},Yn=(e,t={})=>{rt(e,{...t,variant:"success"})},Qn=(e,t={})=>{rt(e,{...t,variant:"warning"})},Wn=(e,t={})=>{rt(e,{...t,variant:"info"})},Gn=(e,t={})=>{rt(e,{...t,variant:"error"})},Xn={success:Yn,warning:Qn,info:Wn,error:Gn},mE=Xn;var ne=new ws("ArkoseIframeGenerator"),ot=class{constructor(){Ht(this,"iframeInstance",null)}async injectIframe(t){if(await this.ping(t))return!0;for(let n=0;n<1;n++){if(await Ze(this.injectIframeOnce(),1e4,!1))return ne.info("inject iframe success"),!0;ne.info("inject iframe fail","retry times",n+1),this.removeIframe()}return ne.info("inject iframe fail"),!1}async generateToken(t,s){if(Os||!await this.injectIframe(t))return"";let n=await Ze(this.postMessageGenerateToken(t,s),10*1e3,"");return n||this.removeIframe(),ne.info(`generateToken ${n?"success":"fail"}`,n),n}getRootContainer(){return document.body}async ping(t){return ne.info("ping"),this.iframeInstance?await Ze(new Promise(n=>{var c,l;let a=T=>{if(T.data&&T.data.id===le){let{data:u,type:A}=T.data;A==="pong"&&(ne.info("ping result",(u==null?void 0:u.success)===!0),n((u==null?void 0:u.success)===!0),window.removeEventListener("message",a))}};window.addEventListener("message",a),(l=(c=this.iframeInstance)==null?void 0:c.contentWindow)==null||l.postMessage({id:le,type:"ping",data:{model:t}},"*")}),2e3,!1)?!0:(this.removeIframe(),!1):(ne.info("ping result",!1),!1)}injectIframeOnce(){return new Promise(t=>{var a;let s=c=>{if(c.data&&c.data.id===le){let{data:l,type:T}=c.data;T==="inject_iframe_response"&&(t((l==null?void 0:l.success)===!0),window.removeEventListener("message",s))}};window.addEventListener("message",s);let n=document.createElement("iframe");n.id=ot.iframeId,n.src="https://chatgpt.com/favicon.ico",n.style.cssText=`
      position: absolute !important;
      opacity: 0 !important;
      width: 1px !important;
      height: 1px !important;
      top: 0 !important;
      left: 0 !important;
      border: none !important;
      display: block !important;
      z-index: -1 !important;
      pointer-events: none;`,this.iframeInstance=n,(a=this.getRootContainer())==null||a.append(n)})}removeIframe(){var s;let t=(s=this.getRootContainer())==null?void 0:s.querySelector(`#${ot.iframeId}`);t&&(this.iframeInstance=null,t.remove())}async postMessageGenerateToken(t,s){return new Promise(n=>{var c,l;let a=T=>{if(T.data&&T.data.id===le){let{data:u,type:A}=T.data;A==="get_token_response"&&(n((u==null?void 0:u.token)||""),window.removeEventListener("message",a))}};window.addEventListener("message",a),(l=(c=this.iframeInstance)==null?void 0:c.contentWindow)==null||l.postMessage({id:le,type:"get_token",data:{model:t,dx:s}},"*")})}},it=ot;Ht(it,"iframeId","webchatgpt-arkose-token-generate-iframe");var SE=new it;var BE=e=>e!=null&&e.includes?e&&e.includes("524")?"Network error: 524":e&&e.includes("502")?"Network error: 502":e:e,sr=e=>{try{let s=new URL(e).pathname.split(".").pop()||"";return!!["doc","xls","ppt","pdf","zip","rar","apk"].includes(s)}catch(t){return!1}},kE=async(e,t,s)=>{var n,a,c,l;try{let u=await new Ls().postMessage({event:"Client_proxyFetchAPI",data:{url:e,options:t,abortTaskId:s}});return(t==null?void 0:t.parse)==="blob"&&((a=(n=u==null?void 0:u.data)==null?void 0:n.data)!=null&&a.base64)&&(u.data.data=vs(u.data.data.base64,(t==null?void 0:t.blobContentType)||u.data.data.contentType)),{success:u.success,data:(c=u==null?void 0:u.data)==null?void 0:c.data,responseRaw:(l=u==null?void 0:u.data)==null?void 0:l.response,message:u.message,error:""}}catch(T){return{success:!1,data:null,error:(T==null?void 0:T.message)||T,responseRaw:null,message:""}}};var sa={xml:!1,decodeEntities:!0},Ie=sa,rr={_useHtmlParser2:!0,xmlMode:!0};function Ne(e){return e!=null&&e.xml?typeof e.xml=="boolean"?rr:{...rr,...e.xml}:e!=null?e:void 0}var z={};X(z,{contains:()=>Qt,html:()=>ir,merge:()=>ia,parseHTML:()=>na,root:()=>aa,text:()=>q,xml:()=>or});function ar(e,t,s){return e?e(t!=null?t:e._root.children,null,void 0,s).toString():""}function ra(e,t){return!t&&typeof e=="object"&&e!=null&&!("length"in e)&&!("type"in e)}function ir(e,t){let s=ra(e)?(t=e,void 0):e,n={...Ie,...this===null||this===void 0?void 0:this._options,...Ne(t!=null?t:{})};return ar(this,s,n)}function or(e){let t={...this._options,xmlMode:!0};return ar(this,e,t)}function q(e){let t=e||(this?this.root():[]),s="";for(let n=0;n<t.length;n++)s+=je(t[n]);return s}function na(e,t,s=typeof t=="boolean"?t:!1){if(!e||typeof e!="string")return null;typeof t=="boolean"&&(s=t);let n=this.load(e,Ie,!1);return s||n("script").remove(),n.root()[0].children.slice()}function aa(){return this(this._root)}function Qt(e,t){if(t===e)return!1;let s=t;for(;s&&s!==s.parent;)if(s=s.parent,s===e)return!0;return!1}function ia(e,t){if(!nr(e)||!nr(t))return;let s=e.length,n=+t.length;for(let a=0;a<n;a++)e[s++]=t[a];return e.length=s,e}function nr(e){if(Array.isArray(e))return!0;if(typeof e!="object"||!Object.prototype.hasOwnProperty.call(e,"length")||typeof e.length!="number"||e.length<0)return!1;for(let t=0;t<e.length;t++)if(!(t in e))return!1;return!0}var Kt={};X(Kt,{addClass:()=>fr,attr:()=>ca,data:()=>la,hasClass:()=>ua,prop:()=>Ea,removeAttr:()=>Ta,removeClass:()=>mr,toggleClass:()=>_r,val:()=>ha});function U(e){return e.cheerio!=null}function cr(e){return e.replace(/[_.-](\w|$)/g,(t,s)=>s.toUpperCase())}function Er(e){return e.replace(/[A-Z]/g,"-$&").toLowerCase()}function L(e,t){let s=e.length;for(let n=0;n<s;n++)t(e[n],n);return e}function ct(e){let t="length"in e?Array.prototype.map.call(e,n=>xt(n,!0)):[xt(e,!0)],s=new se(t);return t.forEach(n=>{n.parent=s}),t}var ae;(function(e){e[e.LowerA=97]="LowerA",e[e.LowerZ=122]="LowerZ",e[e.UpperA=65]="UpperA",e[e.UpperZ=90]="UpperZ",e[e.Exclamation=33]="Exclamation"})(ae||(ae={}));function Re(e){let t=e.indexOf("<");if(t<0||t>e.length-3)return!1;let s=e.charCodeAt(t+1);return(s>=ae.LowerA&&s<=ae.LowerZ||s>=ae.UpperA&&s<=ae.UpperZ||s===ae.Exclamation)&&e.includes(">",t+2)}var he=Object.prototype.hasOwnProperty,ge=/\s+/,Wt="data-",lr={null:null,true:!0,false:!1},Xt=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,oa=/^{[^]*}$|^\[[^]*]$/;function Et(e,t,s){var n;if(!(!e||!R(e))){if((n=e.attribs)!==null&&n!==void 0||(e.attribs={}),!t)return e.attribs;if(he.call(e.attribs,t))return!s&&Xt.test(t)?t:e.attribs[t];if(e.name==="option"&&t==="value")return q(e.children);if(e.name==="input"&&(e.attribs.type==="radio"||e.attribs.type==="checkbox")&&t==="value")return"on"}}function Te(e,t,s){s===null?dr(e,t):e.attribs[t]=`${s}`}function ca(e,t){if(typeof e=="object"||t!==void 0){if(typeof t=="function"){if(typeof e!="string")throw new Error("Bad combination of arguments.");return L(this,(s,n)=>{R(s)&&Te(s,e,t.call(s,n,s.attribs[e]))})}return L(this,s=>{R(s)&&(typeof e=="object"?Object.keys(e).forEach(n=>{let a=e[n];Te(s,n,a)}):Te(s,e,t))})}return arguments.length>1?this:Et(this[0],e,this.options.xmlMode)}function hr(e,t,s){return t in e?e[t]:!s&&Xt.test(t)?Et(e,t,!1)!==void 0:Et(e,t,s)}function Gt(e,t,s,n){t in e?e[t]=s:Te(e,t,!n&&Xt.test(t)?s?"":null:`${s}`)}function Ea(e,t){var s;if(typeof e=="string"&&t===void 0){let n=this[0];if(!n||!R(n))return;switch(e){case"style":{let a=this.css(),c=Object.keys(a);return c.forEach((l,T)=>{a[T]=l}),a.length=c.length,a}case"tagName":case"nodeName":return n.name.toUpperCase();case"href":case"src":{let a=(s=n.attribs)===null||s===void 0?void 0:s[e];return typeof URL!="undefined"&&(e==="href"&&(n.tagName==="a"||n.name==="link")||e==="src"&&(n.tagName==="img"||n.tagName==="iframe"||n.tagName==="audio"||n.tagName==="video"||n.tagName==="source"))&&a!==void 0&&this.options.baseURI?new URL(a,this.options.baseURI).href:a}case"innerText":return Us(n);case"textContent":return je(n);case"outerHTML":return this.clone().wrap("<container />").parent().html();case"innerHTML":return this.html();default:return hr(n,e,this.options.xmlMode)}}if(typeof e=="object"||t!==void 0){if(typeof t=="function"){if(typeof e=="object")throw new Error("Bad combination of arguments.");return L(this,(n,a)=>{R(n)&&Gt(n,e,t.call(n,a,hr(n,e,this.options.xmlMode)),this.options.xmlMode)})}return L(this,n=>{R(n)&&(typeof e=="object"?Object.keys(e).forEach(a=>{let c=e[a];Gt(n,a,c,this.options.xmlMode)}):Gt(n,e,t,this.options.xmlMode))})}}function Tr(e,t,s){var n;let a=e;(n=a.data)!==null&&n!==void 0||(a.data={}),typeof t=="object"?Object.assign(a.data,t):typeof t=="string"&&s!==void 0&&(a.data[t]=s)}function ur(e,t){let s,n,a;t==null?(s=Object.keys(e.attribs).filter(c=>c.startsWith(Wt)),n=s.map(c=>cr(c.slice(Wt.length)))):(s=[Wt+Er(t)],n=[t]);for(let c=0;c<s.length;++c){let l=s[c],T=n[c];if(he.call(e.attribs,l)&&!he.call(e.data,T)){if(a=e.attribs[l],he.call(lr,a))a=lr[a];else if(a===String(Number(a)))a=Number(a);else if(oa.test(a))try{a=JSON.parse(a)}catch(u){}e.data[T]=a}}return t==null?e.data:a}function la(e,t){var s;let n=this[0];if(!n||!R(n))return;let a=n;return(s=a.data)!==null&&s!==void 0||(a.data={}),e?typeof e=="object"||t!==void 0?(L(this,c=>{R(c)&&(typeof e=="object"?Tr(c,e):Tr(c,e,t))}),this):he.call(a.data,e)?a.data[e]:ur(a,e):ur(a)}function ha(e){let t=arguments.length===0,s=this[0];if(!s||!R(s))return t?void 0:this;switch(s.name){case"textarea":return this.text(e);case"select":{let n=this.find("option:selected");if(!t){if(this.attr("multiple")==null&&typeof e=="object")return this;this.find("option").removeAttr("selected");let a=typeof e!="object"?[e]:e;for(let c=0;c<a.length;c++)this.find(`option[value="${a[c]}"]`).attr("selected","");return this}return this.attr("multiple")?n.toArray().map(a=>q(a.children)):n.attr("value")}case"input":case"option":return t?this.attr("value"):this.attr("value",e)}}function dr(e,t){!e.attribs||!he.call(e.attribs,t)||delete e.attribs[t]}function lt(e){return e?e.trim().split(ge):[]}function Ta(e){let t=lt(e);for(let s=0;s<t.length;s++)L(this,n=>{R(n)&&dr(n,t[s])});return this}function ua(e){return this.toArray().some(t=>{let s=R(t)&&t.attribs.class,n=-1;if(s&&e.length)for(;(n=s.indexOf(e,n+1))>-1;){let a=n+e.length;if((n===0||ge.test(s[n-1]))&&(a===s.length||ge.test(s[a])))return!0}return!1})}function fr(e){if(typeof e=="function")return L(this,(n,a)=>{if(R(n)){let c=n.attribs.class||"";fr.call([n],e.call(n,a,c))}});if(!e||typeof e!="string")return this;let t=e.split(ge),s=this.length;for(let n=0;n<s;n++){let a=this[n];if(!R(a))continue;let c=Et(a,"class",!1);if(!c)Te(a,"class",t.join(" ").trim());else{let l=` ${c} `;for(let T=0;T<t.length;T++){let u=`${t[T]} `;l.includes(` ${u}`)||(l+=u)}Te(a,"class",l.trim())}}return this}function mr(e){if(typeof e=="function")return L(this,(a,c)=>{R(a)&&mr.call([a],e.call(a,c,a.attribs.class||""))});let t=lt(e),s=t.length,n=arguments.length===0;return L(this,a=>{if(R(a))if(n)a.attribs.class="";else{let c=lt(a.attribs.class),l=!1;for(let T=0;T<s;T++){let u=c.indexOf(t[T]);u>=0&&(c.splice(u,1),l=!0,T--)}l&&(a.attribs.class=c.join(" "))}})}function _r(e,t){if(typeof e=="function")return L(this,(l,T)=>{R(l)&&_r.call([l],e.call(l,T,l.attribs.class||"",t),t)});if(!e||typeof e!="string")return this;let s=e.split(ge),n=s.length,a=typeof t=="boolean"?t?1:-1:0,c=this.length;for(let l=0;l<c;l++){let T=this[l];if(!R(T))continue;let u=lt(T.attribs.class);for(let A=0;A<n;A++){let _=u.indexOf(s[A]);a>=0&&_<0?u.push(s[A]):a<=0&&_>=0&&u.splice(_,1)}T.attribs.class=u.join(" ")}return this}var ss={};X(ss,{add:()=>ja,addBack:()=>qa,children:()=>Ba,closest:()=>ga,contents:()=>ka,each:()=>Ha,end:()=>Va,eq:()=>Qa,filter:()=>Fa,filterArray:()=>ts,find:()=>pa,first:()=>va,get:()=>Wa,has:()=>wa,index:()=>Xa,is:()=>xa,last:()=>Ya,map:()=>Ua,next:()=>Oa,nextAll:()=>La,nextUntil:()=>Sa,not:()=>ya,parent:()=>Ia,parents:()=>Na,parentsUntil:()=>Ra,prev:()=>Da,prevAll:()=>ba,prevUntil:()=>Pa,siblings:()=>Ma,slice:()=>Ka,toArray:()=>Ga});var Tt=ce(Pn(),1);var da=new Set(["first","last","eq","gt","nth","lt","even","odd"]);function ue(e){return e.type!=="pseudo"?!1:da.has(e.name)?!0:e.name==="not"&&Array.isArray(e.data)?e.data.some(t=>t.some(ue)):!1}function Ar(e,t,s){let n=t!=null?parseInt(t,10):NaN;switch(e){case"first":return 1;case"nth":case"eq":return isFinite(n)?n>=0?n+1:1/0:0;case"lt":return isFinite(n)?n>=0?Math.min(n,s):1/0:0;case"gt":return isFinite(n)?1/0:0;case"odd":return 2*s;case"even":return 2*s-1;case"last":case"not":return 1/0}}function Cr(e){for(;e.parent;)e=e.parent;return e}function ht(e){let t=[],s=[];for(let n of e)n.some(ue)?t.push(n):s.push(n);return[s,t]}var fa={type:Ce.Universal,namespace:null},ma={type:Ce.Pseudo,name:"scope",data:null};function qt(e,t,s={}){return zt([e],t,s)}function zt(e,t,s={}){if(typeof t=="function")return e.some(t);let[n,a]=ht($e(t));return n.length>0&&e.some(Je(n,s))||a.some(c=>Ir(c,e,s).length>0)}function _a(e,t,s,n){let a=typeof s=="string"?parseInt(s,10):NaN;switch(e){case"first":case"lt":return t;case"last":return t.length>0?[t[t.length-1]]:t;case"nth":case"eq":return isFinite(a)&&Math.abs(a)<t.length?[a<0?t[t.length+a]:t[a]]:[];case"gt":return isFinite(a)?t.slice(a+1):[];case"even":return t.filter((c,l)=>l%2===0);case"odd":return t.filter((c,l)=>l%2===1);case"not":{let c=new Set(pr(s,t,n));return t.filter(l=>!c.has(l))}}}function $t(e,t,s={}){return pr($e(e),t,s)}function pr(e,t,s){if(t.length===0)return[];let[n,a]=ht(e),c;if(n.length){let l=jt(t,n,s);if(a.length===0)return l;l.length&&(c=new Set(l))}for(let l=0;l<a.length&&(c==null?void 0:c.size)!==t.length;l++){let T=a[l];if((c?t.filter(_=>R(_)&&!c.has(_)):t).length===0)break;let A=Ir(T,t,s);if(A.length)if(c)A.forEach(_=>c.add(_));else{if(l===a.length-1)return A;c=new Set(A)}}return typeof c!="undefined"?c.size===t.length?t:t.filter(l=>c.has(l)):[]}function Ir(e,t,s){var n;if(e.some(pe)){let a=(n=s.root)!==null&&n!==void 0?n:Cr(t[0]),c={...s,context:t,relativeSelector:!1};return e.push(ma),ut(a,e,c,!0,t.length)}return ut(t,e,s,!1,t.length)}function Nr(e,t,s={},n=1/0){if(typeof e=="function")return Rr(t,e);let[a,c]=ht($e(e)),l=c.map(T=>ut(t,T,s,!0,n));return a.length&&l.push(Vt(t,a,s,n)),l.length===0?[]:l.length===1?l[0]:re(l.reduce((T,u)=>[...T,...u]))}function ut(e,t,s,n,a){let c=t.findIndex(ue),l=t.slice(0,c),T=t[c],u=t.length-1===c?a:1/0,A=Ar(T.name,T.data,u);if(A===0)return[];let C=(l.length===0&&!Array.isArray(e)?qe(e).filter(R):l.length===0?(Array.isArray(e)?e:[e]).filter(R):n||l.some(pe)?Vt(e,[l],s,A):jt(e,[l],s)).slice(0,A),p=_a(T.name,C,T.data,s);if(p.length===0||t.length===c+1)return p;let I=t.slice(c+1),N=I.some(pe);if(N){if(pe(I[0])){let{type:S}=I[0];(S===Ce.Sibling||S===Ce.Adjacent)&&(p=Yt(p,vt,!0)),I.unshift(fa)}s={...s,relativeSelector:!1,rootFunc:S=>p.includes(S)}}else s.rootFunc&&s.rootFunc!==Tt.trueFunc&&(s={...s,rootFunc:Tt.trueFunc});return I.some(ue)?ut(p,I,s,!1,a):N?Vt(p,[I],s,a):jt(p,[I],s)}function Vt(e,t,s,n){let a=Je(t,s,e);return Rr(e,a,n)}function Rr(e,t,s=1/0){let n=Yt(e,vt,t.shouldTestNextSiblings);return xs(a=>R(a)&&t(a),n,!0,s)}function jt(e,t,s){let n=(Array.isArray(e)?e:[e]).filter(R);if(n.length===0)return n;let a=Je(t,s);return a===Tt.trueFunc?n:n.filter(a)}var Ca=/^\s*[~+]/;function pa(e){var t;if(!e)return this._make([]);let s=this.toArray();if(typeof e!="string"){let c=U(e)?e.toArray():[e];return this._make(c.filter(l=>s.some(T=>Qt(T,l))))}let n=Ca.test(e)?s:this.children().toArray(),a={context:s,root:(t=this._root)===null||t===void 0?void 0:t[0],xmlMode:this.options.xmlMode,lowerCaseTags:this.options.lowerCaseTags,lowerCaseAttributeNames:this.options.lowerCaseAttributeNames,pseudos:this.options.pseudos,quirksMode:this.options.quirksMode};return this._make(Nr(e,n,a))}function Jt(e){return function(t,...s){return function(n){var a;let c=e(t,this);return n&&(c=ts(c,n,this.options.xmlMode,(a=this._root)===null||a===void 0?void 0:a[0])),this._make(this.length>1&&c.length>1?s.reduce((l,T)=>T(l),c):c)}}}var Oe=Jt((e,t)=>{let s=[];for(let n=0;n<t.length;n++){let a=e(t[n]);s.push(a)}return new Array().concat(...s)}),Zt=Jt((e,t)=>{let s=[];for(let n=0;n<t.length;n++){let a=e(t[n]);a!==null&&s.push(a)}return s});function es(e,...t){let s=null,n=Jt((a,c)=>{let l=[];return L(c,T=>{for(let u;(u=a(T))&&!(s!=null&&s(u,l.length));T=u)l.push(u)}),l})(e,...t);return function(a,c){s=typeof a=="string"?T=>qt(T,a,this.options):a?Le(a):null;let l=n.call(this,c);return s=null,l}}function de(e){return Array.from(new Set(e))}var Ia=Zt(({parent:e})=>e&&!j(e)?e:null,de),Na=Oe(e=>{let t=[];for(;e.parent&&!j(e.parent);)t.push(e.parent),e=e.parent;return t},re,e=>e.reverse()),Ra=es(({parent:e})=>e&&!j(e)?e:null,re,e=>e.reverse());function ga(e){var t;let s=[];if(!e)return this._make(s);let n={xmlMode:this.options.xmlMode,root:(t=this._root)===null||t===void 0?void 0:t[0]},a=typeof e=="string"?c=>qt(c,e,n):Le(e);return L(this,c=>{for(;c&&R(c);){if(a(c,0)){s.includes(c)||s.push(c);break}c=c.parent}}),this._make(s)}var Oa=Zt(e=>yt(e)),La=Oe(e=>{let t=[];for(;e.next;)e=e.next,R(e)&&t.push(e);return t},de),Sa=es(e=>yt(e),de),Da=Zt(e=>wt(e)),ba=Oe(e=>{let t=[];for(;e.prev;)e=e.prev,R(e)&&t.push(e);return t},de),Pa=es(e=>wt(e),de),Ma=Oe(e=>Fs(e).filter(t=>R(t)&&t!==e),re),Ba=Oe(e=>qe(e).filter(R),de);function ka(){let e=this.toArray().reduce((t,s)=>x(s)?t.concat(s.children):t,[]);return this._make(e)}function Ha(e){let t=0,s=this.length;for(;t<s&&e.call(this[t],t,this[t])!==!1;)++t;return this}function Ua(e){let t=[];for(let s=0;s<this.length;s++){let n=this[s],a=e.call(n,s,n);a!=null&&(t=t.concat(a))}return this._make(t)}function Le(e){return typeof e=="function"?(t,s)=>e.call(t,s,t):U(e)?t=>Array.prototype.includes.call(e,t):function(t){return e===t}}function Fa(e){var t;return this._make(ts(this.toArray(),e,this.options.xmlMode,(t=this._root)===null||t===void 0?void 0:t[0]))}function ts(e,t,s,n){return typeof t=="string"?$t(t,e,{xmlMode:s,root:n}):e.filter(Le(t))}function xa(e){let t=this.toArray();return typeof e=="string"?zt(t.filter(R),e,this.options):e?t.some(Le(e)):!1}function ya(e){let t=this.toArray();if(typeof e=="string"){let s=new Set($t(e,t,this.options));t=t.filter(n=>!s.has(n))}else{let s=Le(e);t=t.filter((n,a)=>!s(n,a))}return this._make(t)}function wa(e){return this.filter(typeof e=="string"?`:has(${e})`:(t,s)=>this._make(s).find(e).length>0)}function va(){return this.length>1?this._make(this[0]):this}function Ya(){return this.length>0?this._make(this[this.length-1]):this}function Qa(e){var t;return e=+e,e===0&&this.length<=1?this:(e<0&&(e=this.length+e),this._make((t=this[e])!==null&&t!==void 0?t:[]))}function Wa(e){return e==null?this.toArray():this[e<0?this.length+e:e]}function Ga(){return Array.prototype.slice.call(this)}function Xa(e){let t,s;return e==null?(t=this.parent().children(),s=this[0]):typeof e=="string"?(t=this._make(e),s=this[0]):(t=this,s=U(e)?e[0]:e),Array.prototype.indexOf.call(t,s)}function Ka(e,t){return this._make(Array.prototype.slice.call(this,e,t))}function Va(){var e;return(e=this.prevObject)!==null&&e!==void 0?e:this._make([])}function ja(e,t){let s=this._make(e,t),n=re([...this.get(),...s.get()]);return this._make(n)}function qa(e){return this.prevObject?this.add(e?this.prevObject.filter(e):this.prevObject):this}var rs={};X(rs,{_makeDomArray:()=>za,after:()=>ai,append:()=>Za,appendTo:()=>$a,before:()=>oi,clone:()=>fi,empty:()=>hi,html:()=>Ti,insertAfter:()=>ii,insertBefore:()=>ci,prepend:()=>ei,prependTo:()=>Ja,remove:()=>Ei,replaceWith:()=>li,text:()=>di,toString:()=>ui,unwrap:()=>ri,wrap:()=>ti,wrapAll:()=>ni,wrapInner:()=>si});function gr(e){return function(s,n,a,c){if(typeof Buffer!="undefined"&&Buffer.isBuffer(s)&&(s=s.toString()),typeof s=="string")return e(s,n,a,c);let l=s;if(!Array.isArray(l)&&j(l))return l;let T=new se([]);return $(l,T),T}}function $(e,t){let s=Array.isArray(e)?e:[e];t?t.children=s:t=null;for(let n=0;n<s.length;n++){let a=s[n];a.parent&&a.parent.children!==s&&ze(a),t?(a.prev=s[n-1]||null,a.next=s[n+1]||null):a.prev=a.next=null,a.parent=t}return t}function za(e,t){return e==null?[]:U(e)?t?ct(e.get()):e.get():Array.isArray(e)?e.reduce((s,n)=>s.concat(this._makeDomArray(n,t)),[]):typeof e=="string"?this._parse(e,this.options,!1,null).children:t?ct([e]):[e]}function Or(e){return function(...t){let s=this.length-1;return L(this,(n,a)=>{if(!x(n))return;let c=typeof t[0]=="function"?t[0].call(n,a,this._render(n.children)):t,l=this._makeDomArray(c,a<s);e(l,n.children,n)})}}function J(e,t,s,n,a){var c,l;let T=[t,s,...n],u=t===0?null:e[t-1],A=t+s>=e.length?null:e[t+s];for(let _=0;_<n.length;++_){let C=n[_],p=C.parent;if(p){let N=p.children.indexOf(C);N>-1&&(p.children.splice(N,1),a===p&&t>N&&T[0]--)}C.parent=a,C.prev&&(C.prev.next=(c=C.next)!==null&&c!==void 0?c:null),C.next&&(C.next.prev=(l=C.prev)!==null&&l!==void 0?l:null),C.prev=_===0?u:n[_-1],C.next=_===n.length-1?A:n[_+1]}return u&&(u.next=n[0]),A&&(A.prev=n[n.length-1]),e.splice(...T)}function $a(e){return(U(e)?e:this._make(e)).append(this),this}function Ja(e){return(U(e)?e:this._make(e)).prepend(this),this}var Za=Or((e,t,s)=>{J(t,t.length,0,e,s)}),ei=Or((e,t,s)=>{J(t,0,0,e,s)});function Lr(e){return function(t){let s=this.length-1,n=this.parents().last();for(let a=0;a<this.length;a++){let c=this[a],l=typeof t=="function"?t.call(c,a,c):typeof t=="string"&&!Re(t)?n.find(t).clone():t,[T]=this._makeDomArray(l,a<s);if(!T||!x(T))continue;let u=T,A=0;for(;A<u.children.length;){let _=u.children[A];R(_)?(u=_,A=0):A++}e(c,u,[T])}return this}}var ti=Lr((e,t,s)=>{let{parent:n}=e;if(!n)return;let a=n.children,c=a.indexOf(e);$([e],t),J(a,c,0,s,n)}),si=Lr((e,t,s)=>{x(e)&&($(e.children,t),$(s,e))});function ri(e){return this.parent(e).not("body").each((t,s)=>{this._make(s).replaceWith(s.children)}),this}function ni(e){let t=this[0];if(t){let s=this._make(typeof e=="function"?e.call(t,0,t):e).insertBefore(t),n;for(let c=0;c<s.length;c++)s[c].type==="tag"&&(n=s[c]);let a=0;for(;n&&a<n.children.length;){let c=n.children[a];c.type==="tag"?(n=c,a=0):a++}n&&this._make(n).append(this)}return this}function ai(...e){let t=this.length-1;return L(this,(s,n)=>{let{parent:a}=s;if(!x(s)||!a)return;let c=a.children,l=c.indexOf(s);if(l<0)return;let T=typeof e[0]=="function"?e[0].call(s,n,this._render(s.children)):e,u=this._makeDomArray(T,n<t);J(c,l+1,0,u,a)})}function ii(e){typeof e=="string"&&(e=this._make(e)),this.remove();let t=[];return this._makeDomArray(e).forEach(s=>{let n=this.clone().toArray(),{parent:a}=s;if(!a)return;let c=a.children,l=c.indexOf(s);l<0||(J(c,l+1,0,n,a),t.push(...n))}),this._make(t)}function oi(...e){let t=this.length-1;return L(this,(s,n)=>{let{parent:a}=s;if(!x(s)||!a)return;let c=a.children,l=c.indexOf(s);if(l<0)return;let T=typeof e[0]=="function"?e[0].call(s,n,this._render(s.children)):e,u=this._makeDomArray(T,n<t);J(c,l,0,u,a)})}function ci(e){let t=this._make(e);this.remove();let s=[];return L(t,n=>{let a=this.clone().toArray(),{parent:c}=n;if(!c)return;let l=c.children,T=l.indexOf(n);T<0||(J(l,T,0,a,c),s.push(...a))}),this._make(s)}function Ei(e){let t=e?this.filter(e):this;return L(t,s=>{ze(s),s.prev=s.next=s.parent=null}),this}function li(e){return L(this,(t,s)=>{let{parent:n}=t;if(!n)return;let a=n.children,c=typeof e=="function"?e.call(t,s,t):e,l=this._makeDomArray(c);$(l,null);let T=a.indexOf(t);J(a,T,1,l,n),l.includes(t)||(t.parent=t.prev=t.next=null)})}function hi(){return L(this,e=>{x(e)&&(e.children.forEach(t=>{t.next=t.prev=t.parent=null}),e.children.length=0)})}function Ti(e){if(e===void 0){let t=this[0];return!t||!x(t)?null:this._render(t.children)}return L(this,t=>{if(!x(t))return;t.children.forEach(n=>{n.next=n.prev=n.parent=null});let s=U(e)?e.toArray():this._parse(`${e}`,this.options,!1,t).children;$(s,t)})}function ui(){return this._render(this)}function di(e){return e===void 0?q(this):typeof e=="function"?L(this,(t,s)=>this._make(t).text(e.call(t,s,q([t])))):L(this,t=>{if(!x(t))return;t.children.forEach(n=>{n.next=n.prev=n.parent=null});let s=new Ke(`${e}`);$(s,t)})}function fi(){return this._make(ct(this.get()))}var ns={};X(ns,{css:()=>mi});function mi(e,t){if(e!=null&&t!=null||typeof e=="object"&&!Array.isArray(e))return L(this,(s,n)=>{R(s)&&Sr(s,e,t,n)});if(this.length!==0)return Dr(this[0],e)}function Sr(e,t,s,n){if(typeof t=="string"){let a=Dr(e),c=typeof s=="function"?s.call(e,n,a[t]):s;c===""?delete a[t]:c!=null&&(a[t]=c),e.attribs.style=_i(a)}else typeof t=="object"&&Object.keys(t).forEach((a,c)=>{Sr(e,a,t[a],c)})}function Dr(e,t){if(!e||!R(e))return;let s=Ai(e.attribs.style);if(typeof t=="string")return s[t];if(Array.isArray(t)){let n={};return t.forEach(a=>{s[a]!=null&&(n[a]=s[a])}),n}return s}function _i(e){return Object.keys(e).reduce((t,s)=>`${t}${t?" ":""}${s}: ${e[s]};`,"")}function Ai(e){if(e=(e||"").trim(),!e)return{};let t={},s;for(let n of e.split(";")){let a=n.indexOf(":");if(a<1||a===n.length-1){let c=n.trimEnd();c.length>0&&s!==void 0&&(t[s]+=`;${c}`)}else s=n.slice(0,a).trim(),t[s]=n.slice(a+1).trim()}return t}var as={};X(as,{serialize:()=>pi,serializeArray:()=>Ii});var br="input,select,textarea,keygen",Ci=/%20/g,Pr=/\r?\n/g;function pi(){return this.serializeArray().map(s=>`${encodeURIComponent(s.name)}=${encodeURIComponent(s.value)}`).join("&").replace(Ci,"+")}function Ii(){return this.map((e,t)=>{let s=this._make(t);return R(t)&&t.name==="form"?s.find(br).toArray():s.filter(br).toArray()}).filter('[name!=""]:enabled:not(:submit, :button, :image, :reset, :file):matches([checked], :not(:checkbox, :radio))').map((e,t)=>{var s;let n=this._make(t),a=n.attr("name"),c=(s=n.val())!==null&&s!==void 0?s:"";return Array.isArray(c)?c.map(l=>({name:a,value:l.replace(Pr,`\r
`)})):{name:a,value:c.replace(Pr,`\r
`)}}).toArray()}var Z=class{constructor(t,s,n){if(this.length=0,this.options=n,this._root=s,t){for(let a=0;a<t.length;a++)this[a]=t[a];this.length=t.length}}};Z.prototype.cheerio="[cheerio object]";Z.prototype.splice=Array.prototype.splice;Z.prototype[Symbol.iterator]=Array.prototype[Symbol.iterator];Object.assign(Z.prototype,Kt,ss,rs,ns,as);function Mr(e,t){return function s(n,a,c=!0){if(n==null)throw new Error("cheerio.load() expects a string");let l={...Ie,...Ne(a)},T=e(n,l,c,null);class u extends Z{_make(C,p){let I=A(C,p);return I.prevObject=this,I}_parse(C,p,I,N){return e(C,p,I,N)}_render(C){return t(C,this.options)}}function A(_,C,p=T,I){if(_&&U(_))return _;let N={...l,...Ne(I)},S=typeof p=="string"?[e(p,N,!1,null)]:"length"in p?p:[p],O=U(S)?S:new u(S,null,N);if(O._root=O,!_)return new u(void 0,O,N);let b=typeof _=="string"&&Re(_)?e(_,N,!1,null).children:Ni(_)?[_]:Array.isArray(_)?_:void 0,w=new u(b,O,N);if(b)return w;if(typeof _!="string")throw new Error("Unexpected type of selector");let F=_,Q=C?typeof C=="string"?Re(C)?new u([e(C,N,!1,null)],O,N):(F=`${C} ${F}`,O):U(C)?C:new u(Array.isArray(C)?C:[C],O,N):O;return Q?Q.find(F):w}return Object.assign(A,z,{load:s,_root:T,_options:l,fn:u.prototype,prototype:u.prototype}),A}}function Ni(e){return!!e.name||e.type==="root"||e.type==="text"||e.type==="comment"}var Ri=new Set([65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111]),D="\uFFFD",i;(function(e){e[e.EOF=-1]="EOF",e[e.NULL=0]="NULL",e[e.TABULATION=9]="TABULATION",e[e.CARRIAGE_RETURN=13]="CARRIAGE_RETURN",e[e.LINE_FEED=10]="LINE_FEED",e[e.FORM_FEED=12]="FORM_FEED",e[e.SPACE=32]="SPACE",e[e.EXCLAMATION_MARK=33]="EXCLAMATION_MARK",e[e.QUOTATION_MARK=34]="QUOTATION_MARK",e[e.NUMBER_SIGN=35]="NUMBER_SIGN",e[e.AMPERSAND=38]="AMPERSAND",e[e.APOSTROPHE=39]="APOSTROPHE",e[e.HYPHEN_MINUS=45]="HYPHEN_MINUS",e[e.SOLIDUS=47]="SOLIDUS",e[e.DIGIT_0=48]="DIGIT_0",e[e.DIGIT_9=57]="DIGIT_9",e[e.SEMICOLON=59]="SEMICOLON",e[e.LESS_THAN_SIGN=60]="LESS_THAN_SIGN",e[e.EQUALS_SIGN=61]="EQUALS_SIGN",e[e.GREATER_THAN_SIGN=62]="GREATER_THAN_SIGN",e[e.QUESTION_MARK=63]="QUESTION_MARK",e[e.LATIN_CAPITAL_A=65]="LATIN_CAPITAL_A",e[e.LATIN_CAPITAL_F=70]="LATIN_CAPITAL_F",e[e.LATIN_CAPITAL_X=88]="LATIN_CAPITAL_X",e[e.LATIN_CAPITAL_Z=90]="LATIN_CAPITAL_Z",e[e.RIGHT_SQUARE_BRACKET=93]="RIGHT_SQUARE_BRACKET",e[e.GRAVE_ACCENT=96]="GRAVE_ACCENT",e[e.LATIN_SMALL_A=97]="LATIN_SMALL_A",e[e.LATIN_SMALL_F=102]="LATIN_SMALL_F",e[e.LATIN_SMALL_X=120]="LATIN_SMALL_X",e[e.LATIN_SMALL_Z=122]="LATIN_SMALL_Z",e[e.REPLACEMENT_CHARACTER=65533]="REPLACEMENT_CHARACTER"})(i=i||(i={}));var k={DASH_DASH:"--",CDATA_START:"[CDATA[",DOCTYPE:"doctype",SCRIPT:"script",PUBLIC:"public",SYSTEM:"system"};function dt(e){return e>=55296&&e<=57343}function Br(e){return e>=56320&&e<=57343}function kr(e,t){return(e-55296)*1024+9216+t}function ft(e){return e!==32&&e!==10&&e!==13&&e!==9&&e!==12&&e>=1&&e<=31||e>=127&&e<=159}function mt(e){return e>=64976&&e<=65007||Ri.has(e)}var d;(function(e){e.controlCharacterInInputStream="control-character-in-input-stream",e.noncharacterInInputStream="noncharacter-in-input-stream",e.surrogateInInputStream="surrogate-in-input-stream",e.nonVoidHtmlElementStartTagWithTrailingSolidus="non-void-html-element-start-tag-with-trailing-solidus",e.endTagWithAttributes="end-tag-with-attributes",e.endTagWithTrailingSolidus="end-tag-with-trailing-solidus",e.unexpectedSolidusInTag="unexpected-solidus-in-tag",e.unexpectedNullCharacter="unexpected-null-character",e.unexpectedQuestionMarkInsteadOfTagName="unexpected-question-mark-instead-of-tag-name",e.invalidFirstCharacterOfTagName="invalid-first-character-of-tag-name",e.unexpectedEqualsSignBeforeAttributeName="unexpected-equals-sign-before-attribute-name",e.missingEndTagName="missing-end-tag-name",e.unexpectedCharacterInAttributeName="unexpected-character-in-attribute-name",e.unknownNamedCharacterReference="unknown-named-character-reference",e.missingSemicolonAfterCharacterReference="missing-semicolon-after-character-reference",e.unexpectedCharacterAfterDoctypeSystemIdentifier="unexpected-character-after-doctype-system-identifier",e.unexpectedCharacterInUnquotedAttributeValue="unexpected-character-in-unquoted-attribute-value",e.eofBeforeTagName="eof-before-tag-name",e.eofInTag="eof-in-tag",e.missingAttributeValue="missing-attribute-value",e.missingWhitespaceBetweenAttributes="missing-whitespace-between-attributes",e.missingWhitespaceAfterDoctypePublicKeyword="missing-whitespace-after-doctype-public-keyword",e.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers="missing-whitespace-between-doctype-public-and-system-identifiers",e.missingWhitespaceAfterDoctypeSystemKeyword="missing-whitespace-after-doctype-system-keyword",e.missingQuoteBeforeDoctypePublicIdentifier="missing-quote-before-doctype-public-identifier",e.missingQuoteBeforeDoctypeSystemIdentifier="missing-quote-before-doctype-system-identifier",e.missingDoctypePublicIdentifier="missing-doctype-public-identifier",e.missingDoctypeSystemIdentifier="missing-doctype-system-identifier",e.abruptDoctypePublicIdentifier="abrupt-doctype-public-identifier",e.abruptDoctypeSystemIdentifier="abrupt-doctype-system-identifier",e.cdataInHtmlContent="cdata-in-html-content",e.incorrectlyOpenedComment="incorrectly-opened-comment",e.eofInScriptHtmlCommentLikeText="eof-in-script-html-comment-like-text",e.eofInDoctype="eof-in-doctype",e.nestedComment="nested-comment",e.abruptClosingOfEmptyComment="abrupt-closing-of-empty-comment",e.eofInComment="eof-in-comment",e.incorrectlyClosedComment="incorrectly-closed-comment",e.eofInCdata="eof-in-cdata",e.absenceOfDigitsInNumericCharacterReference="absence-of-digits-in-numeric-character-reference",e.nullCharacterReference="null-character-reference",e.surrogateCharacterReference="surrogate-character-reference",e.characterReferenceOutsideUnicodeRange="character-reference-outside-unicode-range",e.controlCharacterReference="control-character-reference",e.noncharacterCharacterReference="noncharacter-character-reference",e.missingWhitespaceBeforeDoctypeName="missing-whitespace-before-doctype-name",e.missingDoctypeName="missing-doctype-name",e.invalidCharacterSequenceAfterDoctypeName="invalid-character-sequence-after-doctype-name",e.duplicateAttribute="duplicate-attribute",e.nonConformingDoctype="non-conforming-doctype",e.missingDoctype="missing-doctype",e.misplacedDoctype="misplaced-doctype",e.endTagWithoutMatchingOpenElement="end-tag-without-matching-open-element",e.closingOfElementWithOpenChildElements="closing-of-element-with-open-child-elements",e.disallowedContentInNoscriptInHead="disallowed-content-in-noscript-in-head",e.openElementsLeftAfterEof="open-elements-left-after-eof",e.abandonedHeadElementChild="abandoned-head-element-child",e.misplacedStartTagForHeadElement="misplaced-start-tag-for-head-element",e.nestedNoscriptInHead="nested-noscript-in-head",e.eofInElementThatCanContainOnlyText="eof-in-element-that-can-contain-only-text"})(d=d||(d={}));var Oi=1<<16,_t=class{constructor(t){this.handler=t,this.html="",this.pos=-1,this.lastGapPos=-2,this.gapStack=[],this.skipNextNewLine=!1,this.lastChunkWritten=!1,this.endOfChunkHit=!1,this.bufferWaterline=Oi,this.isEol=!1,this.lineStartPos=0,this.droppedBufferSize=0,this.line=1,this.lastErrOffset=-1}get col(){return this.pos-this.lineStartPos+Number(this.lastGapPos!==this.pos)}get offset(){return this.droppedBufferSize+this.pos}getError(t){let{line:s,col:n,offset:a}=this;return{code:t,startLine:s,endLine:s,startCol:n,endCol:n,startOffset:a,endOffset:a}}_err(t){this.handler.onParseError&&this.lastErrOffset!==this.offset&&(this.lastErrOffset=this.offset,this.handler.onParseError(this.getError(t)))}_addGap(){this.gapStack.push(this.lastGapPos),this.lastGapPos=this.pos}_processSurrogate(t){if(this.pos!==this.html.length-1){let s=this.html.charCodeAt(this.pos+1);if(Br(s))return this.pos++,this._addGap(),kr(t,s)}else if(!this.lastChunkWritten)return this.endOfChunkHit=!0,i.EOF;return this._err(d.surrogateInInputStream),t}willDropParsedChunk(){return this.pos>this.bufferWaterline}dropParsedChunk(){this.willDropParsedChunk()&&(this.html=this.html.substring(this.pos),this.lineStartPos-=this.pos,this.droppedBufferSize+=this.pos,this.pos=0,this.lastGapPos=-2,this.gapStack.length=0)}write(t,s){this.html.length>0?this.html+=t:this.html=t,this.endOfChunkHit=!1,this.lastChunkWritten=s}insertHtmlAtCurrentPos(t){this.html=this.html.substring(0,this.pos+1)+t+this.html.substring(this.pos+1),this.endOfChunkHit=!1}startsWith(t,s){if(this.pos+t.length>this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,!1;if(s)return this.html.startsWith(t,this.pos);for(let n=0;n<t.length;n++)if((this.html.charCodeAt(this.pos+n)|32)!==t.charCodeAt(n))return!1;return!0}peek(t){let s=this.pos+t;if(s>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,i.EOF;let n=this.html.charCodeAt(s);return n===i.CARRIAGE_RETURN?i.LINE_FEED:n}advance(){if(this.pos++,this.isEol&&(this.isEol=!1,this.line++,this.lineStartPos=this.pos),this.pos>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,i.EOF;let t=this.html.charCodeAt(this.pos);return t===i.CARRIAGE_RETURN?(this.isEol=!0,this.skipNextNewLine=!0,i.LINE_FEED):t===i.LINE_FEED&&(this.isEol=!0,this.skipNextNewLine)?(this.line--,this.skipNextNewLine=!1,this._addGap(),this.advance()):(this.skipNextNewLine=!1,dt(t)&&(t=this._processSurrogate(t)),this.handler.onParseError===null||t>31&&t<127||t===i.LINE_FEED||t===i.CARRIAGE_RETURN||t>159&&t<64976||this._checkForProblematicCharacters(t),t)}_checkForProblematicCharacters(t){ft(t)?this._err(d.controlCharacterInInputStream):mt(t)&&this._err(d.noncharacterInInputStream)}retreat(t){for(this.pos-=t;this.pos<this.lastGapPos;)this.lastGapPos=this.gapStack.pop(),this.pos--;this.isEol=!1}};var is={};X(is,{TokenType:()=>g,getTokenAttr:()=>Se});var g;(function(e){e[e.CHARACTER=0]="CHARACTER",e[e.NULL_CHARACTER=1]="NULL_CHARACTER",e[e.WHITESPACE_CHARACTER=2]="WHITESPACE_CHARACTER",e[e.START_TAG=3]="START_TAG",e[e.END_TAG=4]="END_TAG",e[e.COMMENT=5]="COMMENT",e[e.DOCTYPE=6]="DOCTYPE",e[e.EOF=7]="EOF",e[e.HIBERNATION=8]="HIBERNATION"})(g=g||(g={}));function Se(e,t){for(let s=e.attrs.length-1;s>=0;s--)if(e.attrs[s].name===t)return e.attrs[s].value;return null}var be={};X(be,{ATTRS:()=>v,DOCUMENT_MODE:()=>P,NS:()=>f,SPECIAL_ELEMENTS:()=>os,TAG_ID:()=>r,TAG_NAMES:()=>h,getTagID:()=>ee,hasUnescapedText:()=>cs,isNumberedHeader:()=>De});var f;(function(e){e.HTML="http://www.w3.org/1999/xhtml",e.MATHML="http://www.w3.org/1998/Math/MathML",e.SVG="http://www.w3.org/2000/svg",e.XLINK="http://www.w3.org/1999/xlink",e.XML="http://www.w3.org/XML/1998/namespace",e.XMLNS="http://www.w3.org/2000/xmlns/"})(f=f||(f={}));var v;(function(e){e.TYPE="type",e.ACTION="action",e.ENCODING="encoding",e.PROMPT="prompt",e.NAME="name",e.COLOR="color",e.FACE="face",e.SIZE="size"})(v=v||(v={}));var P;(function(e){e.NO_QUIRKS="no-quirks",e.QUIRKS="quirks",e.LIMITED_QUIRKS="limited-quirks"})(P=P||(P={}));var h;(function(e){e.A="a",e.ADDRESS="address",e.ANNOTATION_XML="annotation-xml",e.APPLET="applet",e.AREA="area",e.ARTICLE="article",e.ASIDE="aside",e.B="b",e.BASE="base",e.BASEFONT="basefont",e.BGSOUND="bgsound",e.BIG="big",e.BLOCKQUOTE="blockquote",e.BODY="body",e.BR="br",e.BUTTON="button",e.CAPTION="caption",e.CENTER="center",e.CODE="code",e.COL="col",e.COLGROUP="colgroup",e.DD="dd",e.DESC="desc",e.DETAILS="details",e.DIALOG="dialog",e.DIR="dir",e.DIV="div",e.DL="dl",e.DT="dt",e.EM="em",e.EMBED="embed",e.FIELDSET="fieldset",e.FIGCAPTION="figcaption",e.FIGURE="figure",e.FONT="font",e.FOOTER="footer",e.FOREIGN_OBJECT="foreignObject",e.FORM="form",e.FRAME="frame",e.FRAMESET="frameset",e.H1="h1",e.H2="h2",e.H3="h3",e.H4="h4",e.H5="h5",e.H6="h6",e.HEAD="head",e.HEADER="header",e.HGROUP="hgroup",e.HR="hr",e.HTML="html",e.I="i",e.IMG="img",e.IMAGE="image",e.INPUT="input",e.IFRAME="iframe",e.KEYGEN="keygen",e.LABEL="label",e.LI="li",e.LINK="link",e.LISTING="listing",e.MAIN="main",e.MALIGNMARK="malignmark",e.MARQUEE="marquee",e.MATH="math",e.MENU="menu",e.META="meta",e.MGLYPH="mglyph",e.MI="mi",e.MO="mo",e.MN="mn",e.MS="ms",e.MTEXT="mtext",e.NAV="nav",e.NOBR="nobr",e.NOFRAMES="noframes",e.NOEMBED="noembed",e.NOSCRIPT="noscript",e.OBJECT="object",e.OL="ol",e.OPTGROUP="optgroup",e.OPTION="option",e.P="p",e.PARAM="param",e.PLAINTEXT="plaintext",e.PRE="pre",e.RB="rb",e.RP="rp",e.RT="rt",e.RTC="rtc",e.RUBY="ruby",e.S="s",e.SCRIPT="script",e.SECTION="section",e.SELECT="select",e.SOURCE="source",e.SMALL="small",e.SPAN="span",e.STRIKE="strike",e.STRONG="strong",e.STYLE="style",e.SUB="sub",e.SUMMARY="summary",e.SUP="sup",e.TABLE="table",e.TBODY="tbody",e.TEMPLATE="template",e.TEXTAREA="textarea",e.TFOOT="tfoot",e.TD="td",e.TH="th",e.THEAD="thead",e.TITLE="title",e.TR="tr",e.TRACK="track",e.TT="tt",e.U="u",e.UL="ul",e.SVG="svg",e.VAR="var",e.WBR="wbr",e.XMP="xmp"})(h=h||(h={}));var r;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.A=1]="A",e[e.ADDRESS=2]="ADDRESS",e[e.ANNOTATION_XML=3]="ANNOTATION_XML",e[e.APPLET=4]="APPLET",e[e.AREA=5]="AREA",e[e.ARTICLE=6]="ARTICLE",e[e.ASIDE=7]="ASIDE",e[e.B=8]="B",e[e.BASE=9]="BASE",e[e.BASEFONT=10]="BASEFONT",e[e.BGSOUND=11]="BGSOUND",e[e.BIG=12]="BIG",e[e.BLOCKQUOTE=13]="BLOCKQUOTE",e[e.BODY=14]="BODY",e[e.BR=15]="BR",e[e.BUTTON=16]="BUTTON",e[e.CAPTION=17]="CAPTION",e[e.CENTER=18]="CENTER",e[e.CODE=19]="CODE",e[e.COL=20]="COL",e[e.COLGROUP=21]="COLGROUP",e[e.DD=22]="DD",e[e.DESC=23]="DESC",e[e.DETAILS=24]="DETAILS",e[e.DIALOG=25]="DIALOG",e[e.DIR=26]="DIR",e[e.DIV=27]="DIV",e[e.DL=28]="DL",e[e.DT=29]="DT",e[e.EM=30]="EM",e[e.EMBED=31]="EMBED",e[e.FIELDSET=32]="FIELDSET",e[e.FIGCAPTION=33]="FIGCAPTION",e[e.FIGURE=34]="FIGURE",e[e.FONT=35]="FONT",e[e.FOOTER=36]="FOOTER",e[e.FOREIGN_OBJECT=37]="FOREIGN_OBJECT",e[e.FORM=38]="FORM",e[e.FRAME=39]="FRAME",e[e.FRAMESET=40]="FRAMESET",e[e.H1=41]="H1",e[e.H2=42]="H2",e[e.H3=43]="H3",e[e.H4=44]="H4",e[e.H5=45]="H5",e[e.H6=46]="H6",e[e.HEAD=47]="HEAD",e[e.HEADER=48]="HEADER",e[e.HGROUP=49]="HGROUP",e[e.HR=50]="HR",e[e.HTML=51]="HTML",e[e.I=52]="I",e[e.IMG=53]="IMG",e[e.IMAGE=54]="IMAGE",e[e.INPUT=55]="INPUT",e[e.IFRAME=56]="IFRAME",e[e.KEYGEN=57]="KEYGEN",e[e.LABEL=58]="LABEL",e[e.LI=59]="LI",e[e.LINK=60]="LINK",e[e.LISTING=61]="LISTING",e[e.MAIN=62]="MAIN",e[e.MALIGNMARK=63]="MALIGNMARK",e[e.MARQUEE=64]="MARQUEE",e[e.MATH=65]="MATH",e[e.MENU=66]="MENU",e[e.META=67]="META",e[e.MGLYPH=68]="MGLYPH",e[e.MI=69]="MI",e[e.MO=70]="MO",e[e.MN=71]="MN",e[e.MS=72]="MS",e[e.MTEXT=73]="MTEXT",e[e.NAV=74]="NAV",e[e.NOBR=75]="NOBR",e[e.NOFRAMES=76]="NOFRAMES",e[e.NOEMBED=77]="NOEMBED",e[e.NOSCRIPT=78]="NOSCRIPT",e[e.OBJECT=79]="OBJECT",e[e.OL=80]="OL",e[e.OPTGROUP=81]="OPTGROUP",e[e.OPTION=82]="OPTION",e[e.P=83]="P",e[e.PARAM=84]="PARAM",e[e.PLAINTEXT=85]="PLAINTEXT",e[e.PRE=86]="PRE",e[e.RB=87]="RB",e[e.RP=88]="RP",e[e.RT=89]="RT",e[e.RTC=90]="RTC",e[e.RUBY=91]="RUBY",e[e.S=92]="S",e[e.SCRIPT=93]="SCRIPT",e[e.SECTION=94]="SECTION",e[e.SELECT=95]="SELECT",e[e.SOURCE=96]="SOURCE",e[e.SMALL=97]="SMALL",e[e.SPAN=98]="SPAN",e[e.STRIKE=99]="STRIKE",e[e.STRONG=100]="STRONG",e[e.STYLE=101]="STYLE",e[e.SUB=102]="SUB",e[e.SUMMARY=103]="SUMMARY",e[e.SUP=104]="SUP",e[e.TABLE=105]="TABLE",e[e.TBODY=106]="TBODY",e[e.TEMPLATE=107]="TEMPLATE",e[e.TEXTAREA=108]="TEXTAREA",e[e.TFOOT=109]="TFOOT",e[e.TD=110]="TD",e[e.TH=111]="TH",e[e.THEAD=112]="THEAD",e[e.TITLE=113]="TITLE",e[e.TR=114]="TR",e[e.TRACK=115]="TRACK",e[e.TT=116]="TT",e[e.U=117]="U",e[e.UL=118]="UL",e[e.SVG=119]="SVG",e[e.VAR=120]="VAR",e[e.WBR=121]="WBR",e[e.XMP=122]="XMP"})(r=r||(r={}));var Li=new Map([[h.A,r.A],[h.ADDRESS,r.ADDRESS],[h.ANNOTATION_XML,r.ANNOTATION_XML],[h.APPLET,r.APPLET],[h.AREA,r.AREA],[h.ARTICLE,r.ARTICLE],[h.ASIDE,r.ASIDE],[h.B,r.B],[h.BASE,r.BASE],[h.BASEFONT,r.BASEFONT],[h.BGSOUND,r.BGSOUND],[h.BIG,r.BIG],[h.BLOCKQUOTE,r.BLOCKQUOTE],[h.BODY,r.BODY],[h.BR,r.BR],[h.BUTTON,r.BUTTON],[h.CAPTION,r.CAPTION],[h.CENTER,r.CENTER],[h.CODE,r.CODE],[h.COL,r.COL],[h.COLGROUP,r.COLGROUP],[h.DD,r.DD],[h.DESC,r.DESC],[h.DETAILS,r.DETAILS],[h.DIALOG,r.DIALOG],[h.DIR,r.DIR],[h.DIV,r.DIV],[h.DL,r.DL],[h.DT,r.DT],[h.EM,r.EM],[h.EMBED,r.EMBED],[h.FIELDSET,r.FIELDSET],[h.FIGCAPTION,r.FIGCAPTION],[h.FIGURE,r.FIGURE],[h.FONT,r.FONT],[h.FOOTER,r.FOOTER],[h.FOREIGN_OBJECT,r.FOREIGN_OBJECT],[h.FORM,r.FORM],[h.FRAME,r.FRAME],[h.FRAMESET,r.FRAMESET],[h.H1,r.H1],[h.H2,r.H2],[h.H3,r.H3],[h.H4,r.H4],[h.H5,r.H5],[h.H6,r.H6],[h.HEAD,r.HEAD],[h.HEADER,r.HEADER],[h.HGROUP,r.HGROUP],[h.HR,r.HR],[h.HTML,r.HTML],[h.I,r.I],[h.IMG,r.IMG],[h.IMAGE,r.IMAGE],[h.INPUT,r.INPUT],[h.IFRAME,r.IFRAME],[h.KEYGEN,r.KEYGEN],[h.LABEL,r.LABEL],[h.LI,r.LI],[h.LINK,r.LINK],[h.LISTING,r.LISTING],[h.MAIN,r.MAIN],[h.MALIGNMARK,r.MALIGNMARK],[h.MARQUEE,r.MARQUEE],[h.MATH,r.MATH],[h.MENU,r.MENU],[h.META,r.META],[h.MGLYPH,r.MGLYPH],[h.MI,r.MI],[h.MO,r.MO],[h.MN,r.MN],[h.MS,r.MS],[h.MTEXT,r.MTEXT],[h.NAV,r.NAV],[h.NOBR,r.NOBR],[h.NOFRAMES,r.NOFRAMES],[h.NOEMBED,r.NOEMBED],[h.NOSCRIPT,r.NOSCRIPT],[h.OBJECT,r.OBJECT],[h.OL,r.OL],[h.OPTGROUP,r.OPTGROUP],[h.OPTION,r.OPTION],[h.P,r.P],[h.PARAM,r.PARAM],[h.PLAINTEXT,r.PLAINTEXT],[h.PRE,r.PRE],[h.RB,r.RB],[h.RP,r.RP],[h.RT,r.RT],[h.RTC,r.RTC],[h.RUBY,r.RUBY],[h.S,r.S],[h.SCRIPT,r.SCRIPT],[h.SECTION,r.SECTION],[h.SELECT,r.SELECT],[h.SOURCE,r.SOURCE],[h.SMALL,r.SMALL],[h.SPAN,r.SPAN],[h.STRIKE,r.STRIKE],[h.STRONG,r.STRONG],[h.STYLE,r.STYLE],[h.SUB,r.SUB],[h.SUMMARY,r.SUMMARY],[h.SUP,r.SUP],[h.TABLE,r.TABLE],[h.TBODY,r.TBODY],[h.TEMPLATE,r.TEMPLATE],[h.TEXTAREA,r.TEXTAREA],[h.TFOOT,r.TFOOT],[h.TD,r.TD],[h.TH,r.TH],[h.THEAD,r.THEAD],[h.TITLE,r.TITLE],[h.TR,r.TR],[h.TRACK,r.TRACK],[h.TT,r.TT],[h.U,r.U],[h.UL,r.UL],[h.SVG,r.SVG],[h.VAR,r.VAR],[h.WBR,r.WBR],[h.XMP,r.XMP]]);function ee(e){var t;return(t=Li.get(e))!==null&&t!==void 0?t:r.UNKNOWN}var m=r,os={[f.HTML]:new Set([m.ADDRESS,m.APPLET,m.AREA,m.ARTICLE,m.ASIDE,m.BASE,m.BASEFONT,m.BGSOUND,m.BLOCKQUOTE,m.BODY,m.BR,m.BUTTON,m.CAPTION,m.CENTER,m.COL,m.COLGROUP,m.DD,m.DETAILS,m.DIR,m.DIV,m.DL,m.DT,m.EMBED,m.FIELDSET,m.FIGCAPTION,m.FIGURE,m.FOOTER,m.FORM,m.FRAME,m.FRAMESET,m.H1,m.H2,m.H3,m.H4,m.H5,m.H6,m.HEAD,m.HEADER,m.HGROUP,m.HR,m.HTML,m.IFRAME,m.IMG,m.INPUT,m.LI,m.LINK,m.LISTING,m.MAIN,m.MARQUEE,m.MENU,m.META,m.NAV,m.NOEMBED,m.NOFRAMES,m.NOSCRIPT,m.OBJECT,m.OL,m.P,m.PARAM,m.PLAINTEXT,m.PRE,m.SCRIPT,m.SECTION,m.SELECT,m.SOURCE,m.STYLE,m.SUMMARY,m.TABLE,m.TBODY,m.TD,m.TEMPLATE,m.TEXTAREA,m.TFOOT,m.TH,m.THEAD,m.TITLE,m.TR,m.TRACK,m.UL,m.WBR,m.XMP]),[f.MATHML]:new Set([m.MI,m.MO,m.MN,m.MS,m.MTEXT,m.ANNOTATION_XML]),[f.SVG]:new Set([m.TITLE,m.FOREIGN_OBJECT,m.DESC]),[f.XLINK]:new Set,[f.XML]:new Set,[f.XMLNS]:new Set};function De(e){return e===m.H1||e===m.H2||e===m.H3||e===m.H4||e===m.H5||e===m.H6}var Si=new Set([h.STYLE,h.SCRIPT,h.XMP,h.IFRAME,h.NOEMBED,h.NOFRAMES,h.PLAINTEXT]);function cs(e,t){return Si.has(e)||t&&e===h.NOSCRIPT}var Di=new Map([[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),o;(function(e){e[e.DATA=0]="DATA",e[e.RCDATA=1]="RCDATA",e[e.RAWTEXT=2]="RAWTEXT",e[e.SCRIPT_DATA=3]="SCRIPT_DATA",e[e.PLAINTEXT=4]="PLAINTEXT",e[e.TAG_OPEN=5]="TAG_OPEN",e[e.END_TAG_OPEN=6]="END_TAG_OPEN",e[e.TAG_NAME=7]="TAG_NAME",e[e.RCDATA_LESS_THAN_SIGN=8]="RCDATA_LESS_THAN_SIGN",e[e.RCDATA_END_TAG_OPEN=9]="RCDATA_END_TAG_OPEN",e[e.RCDATA_END_TAG_NAME=10]="RCDATA_END_TAG_NAME",e[e.RAWTEXT_LESS_THAN_SIGN=11]="RAWTEXT_LESS_THAN_SIGN",e[e.RAWTEXT_END_TAG_OPEN=12]="RAWTEXT_END_TAG_OPEN",e[e.RAWTEXT_END_TAG_NAME=13]="RAWTEXT_END_TAG_NAME",e[e.SCRIPT_DATA_LESS_THAN_SIGN=14]="SCRIPT_DATA_LESS_THAN_SIGN",e[e.SCRIPT_DATA_END_TAG_OPEN=15]="SCRIPT_DATA_END_TAG_OPEN",e[e.SCRIPT_DATA_END_TAG_NAME=16]="SCRIPT_DATA_END_TAG_NAME",e[e.SCRIPT_DATA_ESCAPE_START=17]="SCRIPT_DATA_ESCAPE_START",e[e.SCRIPT_DATA_ESCAPE_START_DASH=18]="SCRIPT_DATA_ESCAPE_START_DASH",e[e.SCRIPT_DATA_ESCAPED=19]="SCRIPT_DATA_ESCAPED",e[e.SCRIPT_DATA_ESCAPED_DASH=20]="SCRIPT_DATA_ESCAPED_DASH",e[e.SCRIPT_DATA_ESCAPED_DASH_DASH=21]="SCRIPT_DATA_ESCAPED_DASH_DASH",e[e.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN=22]="SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN",e[e.SCRIPT_DATA_ESCAPED_END_TAG_OPEN=23]="SCRIPT_DATA_ESCAPED_END_TAG_OPEN",e[e.SCRIPT_DATA_ESCAPED_END_TAG_NAME=24]="SCRIPT_DATA_ESCAPED_END_TAG_NAME",e[e.SCRIPT_DATA_DOUBLE_ESCAPE_START=25]="SCRIPT_DATA_DOUBLE_ESCAPE_START",e[e.SCRIPT_DATA_DOUBLE_ESCAPED=26]="SCRIPT_DATA_DOUBLE_ESCAPED",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_DASH=27]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH=28]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN=29]="SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN",e[e.SCRIPT_DATA_DOUBLE_ESCAPE_END=30]="SCRIPT_DATA_DOUBLE_ESCAPE_END",e[e.BEFORE_ATTRIBUTE_NAME=31]="BEFORE_ATTRIBUTE_NAME",e[e.ATTRIBUTE_NAME=32]="ATTRIBUTE_NAME",e[e.AFTER_ATTRIBUTE_NAME=33]="AFTER_ATTRIBUTE_NAME",e[e.BEFORE_ATTRIBUTE_VALUE=34]="BEFORE_ATTRIBUTE_VALUE",e[e.ATTRIBUTE_VALUE_DOUBLE_QUOTED=35]="ATTRIBUTE_VALUE_DOUBLE_QUOTED",e[e.ATTRIBUTE_VALUE_SINGLE_QUOTED=36]="ATTRIBUTE_VALUE_SINGLE_QUOTED",e[e.ATTRIBUTE_VALUE_UNQUOTED=37]="ATTRIBUTE_VALUE_UNQUOTED",e[e.AFTER_ATTRIBUTE_VALUE_QUOTED=38]="AFTER_ATTRIBUTE_VALUE_QUOTED",e[e.SELF_CLOSING_START_TAG=39]="SELF_CLOSING_START_TAG",e[e.BOGUS_COMMENT=40]="BOGUS_COMMENT",e[e.MARKUP_DECLARATION_OPEN=41]="MARKUP_DECLARATION_OPEN",e[e.COMMENT_START=42]="COMMENT_START",e[e.COMMENT_START_DASH=43]="COMMENT_START_DASH",e[e.COMMENT=44]="COMMENT",e[e.COMMENT_LESS_THAN_SIGN=45]="COMMENT_LESS_THAN_SIGN",e[e.COMMENT_LESS_THAN_SIGN_BANG=46]="COMMENT_LESS_THAN_SIGN_BANG",e[e.COMMENT_LESS_THAN_SIGN_BANG_DASH=47]="COMMENT_LESS_THAN_SIGN_BANG_DASH",e[e.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH=48]="COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH",e[e.COMMENT_END_DASH=49]="COMMENT_END_DASH",e[e.COMMENT_END=50]="COMMENT_END",e[e.COMMENT_END_BANG=51]="COMMENT_END_BANG",e[e.DOCTYPE=52]="DOCTYPE",e[e.BEFORE_DOCTYPE_NAME=53]="BEFORE_DOCTYPE_NAME",e[e.DOCTYPE_NAME=54]="DOCTYPE_NAME",e[e.AFTER_DOCTYPE_NAME=55]="AFTER_DOCTYPE_NAME",e[e.AFTER_DOCTYPE_PUBLIC_KEYWORD=56]="AFTER_DOCTYPE_PUBLIC_KEYWORD",e[e.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER=57]="BEFORE_DOCTYPE_PUBLIC_IDENTIFIER",e[e.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED=58]="DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED",e[e.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED=59]="DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED",e[e.AFTER_DOCTYPE_PUBLIC_IDENTIFIER=60]="AFTER_DOCTYPE_PUBLIC_IDENTIFIER",e[e.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS=61]="BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS",e[e.AFTER_DOCTYPE_SYSTEM_KEYWORD=62]="AFTER_DOCTYPE_SYSTEM_KEYWORD",e[e.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER=63]="BEFORE_DOCTYPE_SYSTEM_IDENTIFIER",e[e.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED=64]="DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED",e[e.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED=65]="DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED",e[e.AFTER_DOCTYPE_SYSTEM_IDENTIFIER=66]="AFTER_DOCTYPE_SYSTEM_IDENTIFIER",e[e.BOGUS_DOCTYPE=67]="BOGUS_DOCTYPE",e[e.CDATA_SECTION=68]="CDATA_SECTION",e[e.CDATA_SECTION_BRACKET=69]="CDATA_SECTION_BRACKET",e[e.CDATA_SECTION_END=70]="CDATA_SECTION_END",e[e.CHARACTER_REFERENCE=71]="CHARACTER_REFERENCE",e[e.NAMED_CHARACTER_REFERENCE=72]="NAMED_CHARACTER_REFERENCE",e[e.AMBIGUOUS_AMPERSAND=73]="AMBIGUOUS_AMPERSAND",e[e.NUMERIC_CHARACTER_REFERENCE=74]="NUMERIC_CHARACTER_REFERENCE",e[e.HEXADEMICAL_CHARACTER_REFERENCE_START=75]="HEXADEMICAL_CHARACTER_REFERENCE_START",e[e.HEXADEMICAL_CHARACTER_REFERENCE=76]="HEXADEMICAL_CHARACTER_REFERENCE",e[e.DECIMAL_CHARACTER_REFERENCE=77]="DECIMAL_CHARACTER_REFERENCE",e[e.NUMERIC_CHARACTER_REFERENCE_END=78]="NUMERIC_CHARACTER_REFERENCE_END"})(o||(o={}));var M={DATA:o.DATA,RCDATA:o.RCDATA,RAWTEXT:o.RAWTEXT,SCRIPT_DATA:o.SCRIPT_DATA,PLAINTEXT:o.PLAINTEXT,CDATA_SECTION:o.CDATA_SECTION};function Me(e){return e>=i.DIGIT_0&&e<=i.DIGIT_9}function Pe(e){return e>=i.LATIN_CAPITAL_A&&e<=i.LATIN_CAPITAL_Z}function bi(e){return e>=i.LATIN_SMALL_A&&e<=i.LATIN_SMALL_Z}function te(e){return bi(e)||Pe(e)}function Es(e){return te(e)||Me(e)}function Ur(e){return e>=i.LATIN_CAPITAL_A&&e<=i.LATIN_CAPITAL_F}function Fr(e){return e>=i.LATIN_SMALL_A&&e<=i.LATIN_SMALL_F}function Pi(e){return Me(e)||Ur(e)||Fr(e)}function At(e){return e+32}function xr(e){return e===i.SPACE||e===i.LINE_FEED||e===i.TABULATION||e===i.FORM_FEED}function Mi(e){return e===i.EQUALS_SIGN||Es(e)}function Hr(e){return xr(e)||e===i.SOLIDUS||e===i.GREATER_THAN_SIGN}var Be=class{constructor(t,s){this.options=t,this.handler=s,this.paused=!1,this.inLoop=!1,this.inForeignNode=!1,this.lastStartTagName="",this.active=!1,this.state=o.DATA,this.returnState=o.DATA,this.charRefCode=-1,this.consumedAfterSnapshot=-1,this.currentCharacterToken=null,this.currentToken=null,this.currentAttr={name:"",value:""},this.preprocessor=new _t(s),this.currentLocation=this.getCurrentLocation(-1)}_err(t){var s,n;(n=(s=this.handler).onParseError)===null||n===void 0||n.call(s,this.preprocessor.getError(t))}getCurrentLocation(t){return this.options.sourceCodeLocationInfo?{startLine:this.preprocessor.line,startCol:this.preprocessor.col-t,startOffset:this.preprocessor.offset-t,endLine:-1,endCol:-1,endOffset:-1}:null}_runParsingLoop(){if(!this.inLoop){for(this.inLoop=!0;this.active&&!this.paused;){this.consumedAfterSnapshot=0;let t=this._consume();this._ensureHibernation()||this._callState(t)}this.inLoop=!1}}pause(){this.paused=!0}resume(t){if(!this.paused)throw new Error("Parser was already resumed");this.paused=!1,!this.inLoop&&(this._runParsingLoop(),this.paused||t==null||t())}write(t,s,n){this.active=!0,this.preprocessor.write(t,s),this._runParsingLoop(),this.paused||n==null||n()}insertHtmlAtCurrentPos(t){this.active=!0,this.preprocessor.insertHtmlAtCurrentPos(t),this._runParsingLoop()}_ensureHibernation(){return this.preprocessor.endOfChunkHit?(this._unconsume(this.consumedAfterSnapshot),this.active=!1,!0):!1}_consume(){return this.consumedAfterSnapshot++,this.preprocessor.advance()}_unconsume(t){this.consumedAfterSnapshot-=t,this.preprocessor.retreat(t)}_reconsumeInState(t,s){this.state=t,this._callState(s)}_advanceBy(t){this.consumedAfterSnapshot+=t;for(let s=0;s<t;s++)this.preprocessor.advance()}_consumeSequenceIfMatch(t,s){return this.preprocessor.startsWith(t,s)?(this._advanceBy(t.length-1),!0):!1}_createStartTagToken(){this.currentToken={type:g.START_TAG,tagName:"",tagID:r.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(1)}}_createEndTagToken(){this.currentToken={type:g.END_TAG,tagName:"",tagID:r.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(2)}}_createCommentToken(t){this.currentToken={type:g.COMMENT,data:"",location:this.getCurrentLocation(t)}}_createDoctypeToken(t){this.currentToken={type:g.DOCTYPE,name:t,forceQuirks:!1,publicId:null,systemId:null,location:this.currentLocation}}_createCharacterToken(t,s){this.currentCharacterToken={type:t,chars:s,location:this.currentLocation}}_createAttr(t){this.currentAttr={name:t,value:""},this.currentLocation=this.getCurrentLocation(0)}_leaveAttrName(){var t,s;let n=this.currentToken;if(Se(n,this.currentAttr.name)===null){if(n.attrs.push(this.currentAttr),n.location&&this.currentLocation){let a=(t=(s=n.location).attrs)!==null&&t!==void 0?t:s.attrs=Object.create(null);a[this.currentAttr.name]=this.currentLocation,this._leaveAttrValue()}}else this._err(d.duplicateAttribute)}_leaveAttrValue(){this.currentLocation&&(this.currentLocation.endLine=this.preprocessor.line,this.currentLocation.endCol=this.preprocessor.col,this.currentLocation.endOffset=this.preprocessor.offset)}prepareToken(t){this._emitCurrentCharacterToken(t.location),this.currentToken=null,t.location&&(t.location.endLine=this.preprocessor.line,t.location.endCol=this.preprocessor.col+1,t.location.endOffset=this.preprocessor.offset+1),this.currentLocation=this.getCurrentLocation(-1)}emitCurrentTagToken(){let t=this.currentToken;this.prepareToken(t),t.tagID=ee(t.tagName),t.type===g.START_TAG?(this.lastStartTagName=t.tagName,this.handler.onStartTag(t)):(t.attrs.length>0&&this._err(d.endTagWithAttributes),t.selfClosing&&this._err(d.endTagWithTrailingSolidus),this.handler.onEndTag(t)),this.preprocessor.dropParsedChunk()}emitCurrentComment(t){this.prepareToken(t),this.handler.onComment(t),this.preprocessor.dropParsedChunk()}emitCurrentDoctype(t){this.prepareToken(t),this.handler.onDoctype(t),this.preprocessor.dropParsedChunk()}_emitCurrentCharacterToken(t){if(this.currentCharacterToken){switch(t&&this.currentCharacterToken.location&&(this.currentCharacterToken.location.endLine=t.startLine,this.currentCharacterToken.location.endCol=t.startCol,this.currentCharacterToken.location.endOffset=t.startOffset),this.currentCharacterToken.type){case g.CHARACTER:{this.handler.onCharacter(this.currentCharacterToken);break}case g.NULL_CHARACTER:{this.handler.onNullCharacter(this.currentCharacterToken);break}case g.WHITESPACE_CHARACTER:{this.handler.onWhitespaceCharacter(this.currentCharacterToken);break}}this.currentCharacterToken=null}}_emitEOFToken(){let t=this.getCurrentLocation(0);t&&(t.endLine=t.startLine,t.endCol=t.startCol,t.endOffset=t.startOffset),this._emitCurrentCharacterToken(t),this.handler.onEof({type:g.EOF,location:t}),this.active=!1}_appendCharToCurrentCharacterToken(t,s){if(this.currentCharacterToken)if(this.currentCharacterToken.type!==t)this.currentLocation=this.getCurrentLocation(0),this._emitCurrentCharacterToken(this.currentLocation),this.preprocessor.dropParsedChunk();else{this.currentCharacterToken.chars+=s;return}this._createCharacterToken(t,s)}_emitCodePoint(t){let s=xr(t)?g.WHITESPACE_CHARACTER:t===i.NULL?g.NULL_CHARACTER:g.CHARACTER;this._appendCharToCurrentCharacterToken(s,String.fromCodePoint(t))}_emitChars(t){this._appendCharToCurrentCharacterToken(g.CHARACTER,t)}_matchNamedCharacterReference(t){let s=null,n=0,a=!1;for(let c=0,l=V[0];c>=0&&(c=Ss(V,l,c+1,t),!(c<0));t=this._consume()){n+=1,l=V[c];let T=l&Ut.VALUE_LENGTH;if(T){let u=(T>>14)-1;if(t!==i.SEMICOLON&&this._isCharacterReferenceInAttribute()&&Mi(this.preprocessor.peek(1))?(s=[i.AMPERSAND],c+=u):(s=u===0?[V[c]&~Ut.VALUE_LENGTH]:u===1?[V[++c]]:[V[++c],V[++c]],n=0,a=t!==i.SEMICOLON),u===0){this._consume();break}}}return this._unconsume(n),a&&!this.preprocessor.endOfChunkHit&&this._err(d.missingSemicolonAfterCharacterReference),this._unconsume(1),s}_isCharacterReferenceInAttribute(){return this.returnState===o.ATTRIBUTE_VALUE_DOUBLE_QUOTED||this.returnState===o.ATTRIBUTE_VALUE_SINGLE_QUOTED||this.returnState===o.ATTRIBUTE_VALUE_UNQUOTED}_flushCodePointConsumedAsCharacterReference(t){this._isCharacterReferenceInAttribute()?this.currentAttr.value+=String.fromCodePoint(t):this._emitCodePoint(t)}_callState(t){switch(this.state){case o.DATA:{this._stateData(t);break}case o.RCDATA:{this._stateRcdata(t);break}case o.RAWTEXT:{this._stateRawtext(t);break}case o.SCRIPT_DATA:{this._stateScriptData(t);break}case o.PLAINTEXT:{this._statePlaintext(t);break}case o.TAG_OPEN:{this._stateTagOpen(t);break}case o.END_TAG_OPEN:{this._stateEndTagOpen(t);break}case o.TAG_NAME:{this._stateTagName(t);break}case o.RCDATA_LESS_THAN_SIGN:{this._stateRcdataLessThanSign(t);break}case o.RCDATA_END_TAG_OPEN:{this._stateRcdataEndTagOpen(t);break}case o.RCDATA_END_TAG_NAME:{this._stateRcdataEndTagName(t);break}case o.RAWTEXT_LESS_THAN_SIGN:{this._stateRawtextLessThanSign(t);break}case o.RAWTEXT_END_TAG_OPEN:{this._stateRawtextEndTagOpen(t);break}case o.RAWTEXT_END_TAG_NAME:{this._stateRawtextEndTagName(t);break}case o.SCRIPT_DATA_LESS_THAN_SIGN:{this._stateScriptDataLessThanSign(t);break}case o.SCRIPT_DATA_END_TAG_OPEN:{this._stateScriptDataEndTagOpen(t);break}case o.SCRIPT_DATA_END_TAG_NAME:{this._stateScriptDataEndTagName(t);break}case o.SCRIPT_DATA_ESCAPE_START:{this._stateScriptDataEscapeStart(t);break}case o.SCRIPT_DATA_ESCAPE_START_DASH:{this._stateScriptDataEscapeStartDash(t);break}case o.SCRIPT_DATA_ESCAPED:{this._stateScriptDataEscaped(t);break}case o.SCRIPT_DATA_ESCAPED_DASH:{this._stateScriptDataEscapedDash(t);break}case o.SCRIPT_DATA_ESCAPED_DASH_DASH:{this._stateScriptDataEscapedDashDash(t);break}case o.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataEscapedLessThanSign(t);break}case o.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:{this._stateScriptDataEscapedEndTagOpen(t);break}case o.SCRIPT_DATA_ESCAPED_END_TAG_NAME:{this._stateScriptDataEscapedEndTagName(t);break}case o.SCRIPT_DATA_DOUBLE_ESCAPE_START:{this._stateScriptDataDoubleEscapeStart(t);break}case o.SCRIPT_DATA_DOUBLE_ESCAPED:{this._stateScriptDataDoubleEscaped(t);break}case o.SCRIPT_DATA_DOUBLE_ESCAPED_DASH:{this._stateScriptDataDoubleEscapedDash(t);break}case o.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH:{this._stateScriptDataDoubleEscapedDashDash(t);break}case o.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataDoubleEscapedLessThanSign(t);break}case o.SCRIPT_DATA_DOUBLE_ESCAPE_END:{this._stateScriptDataDoubleEscapeEnd(t);break}case o.BEFORE_ATTRIBUTE_NAME:{this._stateBeforeAttributeName(t);break}case o.ATTRIBUTE_NAME:{this._stateAttributeName(t);break}case o.AFTER_ATTRIBUTE_NAME:{this._stateAfterAttributeName(t);break}case o.BEFORE_ATTRIBUTE_VALUE:{this._stateBeforeAttributeValue(t);break}case o.ATTRIBUTE_VALUE_DOUBLE_QUOTED:{this._stateAttributeValueDoubleQuoted(t);break}case o.ATTRIBUTE_VALUE_SINGLE_QUOTED:{this._stateAttributeValueSingleQuoted(t);break}case o.ATTRIBUTE_VALUE_UNQUOTED:{this._stateAttributeValueUnquoted(t);break}case o.AFTER_ATTRIBUTE_VALUE_QUOTED:{this._stateAfterAttributeValueQuoted(t);break}case o.SELF_CLOSING_START_TAG:{this._stateSelfClosingStartTag(t);break}case o.BOGUS_COMMENT:{this._stateBogusComment(t);break}case o.MARKUP_DECLARATION_OPEN:{this._stateMarkupDeclarationOpen(t);break}case o.COMMENT_START:{this._stateCommentStart(t);break}case o.COMMENT_START_DASH:{this._stateCommentStartDash(t);break}case o.COMMENT:{this._stateComment(t);break}case o.COMMENT_LESS_THAN_SIGN:{this._stateCommentLessThanSign(t);break}case o.COMMENT_LESS_THAN_SIGN_BANG:{this._stateCommentLessThanSignBang(t);break}case o.COMMENT_LESS_THAN_SIGN_BANG_DASH:{this._stateCommentLessThanSignBangDash(t);break}case o.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:{this._stateCommentLessThanSignBangDashDash(t);break}case o.COMMENT_END_DASH:{this._stateCommentEndDash(t);break}case o.COMMENT_END:{this._stateCommentEnd(t);break}case o.COMMENT_END_BANG:{this._stateCommentEndBang(t);break}case o.DOCTYPE:{this._stateDoctype(t);break}case o.BEFORE_DOCTYPE_NAME:{this._stateBeforeDoctypeName(t);break}case o.DOCTYPE_NAME:{this._stateDoctypeName(t);break}case o.AFTER_DOCTYPE_NAME:{this._stateAfterDoctypeName(t);break}case o.AFTER_DOCTYPE_PUBLIC_KEYWORD:{this._stateAfterDoctypePublicKeyword(t);break}case o.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateBeforeDoctypePublicIdentifier(t);break}case o.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypePublicIdentifierDoubleQuoted(t);break}case o.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypePublicIdentifierSingleQuoted(t);break}case o.AFTER_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateAfterDoctypePublicIdentifier(t);break}case o.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS:{this._stateBetweenDoctypePublicAndSystemIdentifiers(t);break}case o.AFTER_DOCTYPE_SYSTEM_KEYWORD:{this._stateAfterDoctypeSystemKeyword(t);break}case o.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateBeforeDoctypeSystemIdentifier(t);break}case o.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypeSystemIdentifierDoubleQuoted(t);break}case o.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypeSystemIdentifierSingleQuoted(t);break}case o.AFTER_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateAfterDoctypeSystemIdentifier(t);break}case o.BOGUS_DOCTYPE:{this._stateBogusDoctype(t);break}case o.CDATA_SECTION:{this._stateCdataSection(t);break}case o.CDATA_SECTION_BRACKET:{this._stateCdataSectionBracket(t);break}case o.CDATA_SECTION_END:{this._stateCdataSectionEnd(t);break}case o.CHARACTER_REFERENCE:{this._stateCharacterReference(t);break}case o.NAMED_CHARACTER_REFERENCE:{this._stateNamedCharacterReference(t);break}case o.AMBIGUOUS_AMPERSAND:{this._stateAmbiguousAmpersand(t);break}case o.NUMERIC_CHARACTER_REFERENCE:{this._stateNumericCharacterReference(t);break}case o.HEXADEMICAL_CHARACTER_REFERENCE_START:{this._stateHexademicalCharacterReferenceStart(t);break}case o.HEXADEMICAL_CHARACTER_REFERENCE:{this._stateHexademicalCharacterReference(t);break}case o.DECIMAL_CHARACTER_REFERENCE:{this._stateDecimalCharacterReference(t);break}case o.NUMERIC_CHARACTER_REFERENCE_END:{this._stateNumericCharacterReferenceEnd(t);break}default:throw new Error("Unknown state")}}_stateData(t){switch(t){case i.LESS_THAN_SIGN:{this.state=o.TAG_OPEN;break}case i.AMPERSAND:{this.returnState=o.DATA,this.state=o.CHARACTER_REFERENCE;break}case i.NULL:{this._err(d.unexpectedNullCharacter),this._emitCodePoint(t);break}case i.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateRcdata(t){switch(t){case i.AMPERSAND:{this.returnState=o.RCDATA,this.state=o.CHARACTER_REFERENCE;break}case i.LESS_THAN_SIGN:{this.state=o.RCDATA_LESS_THAN_SIGN;break}case i.NULL:{this._err(d.unexpectedNullCharacter),this._emitChars(D);break}case i.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateRawtext(t){switch(t){case i.LESS_THAN_SIGN:{this.state=o.RAWTEXT_LESS_THAN_SIGN;break}case i.NULL:{this._err(d.unexpectedNullCharacter),this._emitChars(D);break}case i.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptData(t){switch(t){case i.LESS_THAN_SIGN:{this.state=o.SCRIPT_DATA_LESS_THAN_SIGN;break}case i.NULL:{this._err(d.unexpectedNullCharacter),this._emitChars(D);break}case i.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_statePlaintext(t){switch(t){case i.NULL:{this._err(d.unexpectedNullCharacter),this._emitChars(D);break}case i.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateTagOpen(t){if(te(t))this._createStartTagToken(),this.state=o.TAG_NAME,this._stateTagName(t);else switch(t){case i.EXCLAMATION_MARK:{this.state=o.MARKUP_DECLARATION_OPEN;break}case i.SOLIDUS:{this.state=o.END_TAG_OPEN;break}case i.QUESTION_MARK:{this._err(d.unexpectedQuestionMarkInsteadOfTagName),this._createCommentToken(1),this.state=o.BOGUS_COMMENT,this._stateBogusComment(t);break}case i.EOF:{this._err(d.eofBeforeTagName),this._emitChars("<"),this._emitEOFToken();break}default:this._err(d.invalidFirstCharacterOfTagName),this._emitChars("<"),this.state=o.DATA,this._stateData(t)}}_stateEndTagOpen(t){if(te(t))this._createEndTagToken(),this.state=o.TAG_NAME,this._stateTagName(t);else switch(t){case i.GREATER_THAN_SIGN:{this._err(d.missingEndTagName),this.state=o.DATA;break}case i.EOF:{this._err(d.eofBeforeTagName),this._emitChars("</"),this._emitEOFToken();break}default:this._err(d.invalidFirstCharacterOfTagName),this._createCommentToken(2),this.state=o.BOGUS_COMMENT,this._stateBogusComment(t)}}_stateTagName(t){let s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:{this.state=o.BEFORE_ATTRIBUTE_NAME;break}case i.SOLIDUS:{this.state=o.SELF_CLOSING_START_TAG;break}case i.GREATER_THAN_SIGN:{this.state=o.DATA,this.emitCurrentTagToken();break}case i.NULL:{this._err(d.unexpectedNullCharacter),s.tagName+=D;break}case i.EOF:{this._err(d.eofInTag),this._emitEOFToken();break}default:s.tagName+=String.fromCodePoint(Pe(t)?At(t):t)}}_stateRcdataLessThanSign(t){t===i.SOLIDUS?this.state=o.RCDATA_END_TAG_OPEN:(this._emitChars("<"),this.state=o.RCDATA,this._stateRcdata(t))}_stateRcdataEndTagOpen(t){te(t)?(this.state=o.RCDATA_END_TAG_NAME,this._stateRcdataEndTagName(t)):(this._emitChars("</"),this.state=o.RCDATA,this._stateRcdata(t))}handleSpecialEndTag(t){if(!this.preprocessor.startsWith(this.lastStartTagName,!1))return!this._ensureHibernation();this._createEndTagToken();let s=this.currentToken;switch(s.tagName=this.lastStartTagName,this.preprocessor.peek(this.lastStartTagName.length)){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:return this._advanceBy(this.lastStartTagName.length),this.state=o.BEFORE_ATTRIBUTE_NAME,!1;case i.SOLIDUS:return this._advanceBy(this.lastStartTagName.length),this.state=o.SELF_CLOSING_START_TAG,!1;case i.GREATER_THAN_SIGN:return this._advanceBy(this.lastStartTagName.length),this.emitCurrentTagToken(),this.state=o.DATA,!1;default:return!this._ensureHibernation()}}_stateRcdataEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=o.RCDATA,this._stateRcdata(t))}_stateRawtextLessThanSign(t){t===i.SOLIDUS?this.state=o.RAWTEXT_END_TAG_OPEN:(this._emitChars("<"),this.state=o.RAWTEXT,this._stateRawtext(t))}_stateRawtextEndTagOpen(t){te(t)?(this.state=o.RAWTEXT_END_TAG_NAME,this._stateRawtextEndTagName(t)):(this._emitChars("</"),this.state=o.RAWTEXT,this._stateRawtext(t))}_stateRawtextEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=o.RAWTEXT,this._stateRawtext(t))}_stateScriptDataLessThanSign(t){switch(t){case i.SOLIDUS:{this.state=o.SCRIPT_DATA_END_TAG_OPEN;break}case i.EXCLAMATION_MARK:{this.state=o.SCRIPT_DATA_ESCAPE_START,this._emitChars("<!");break}default:this._emitChars("<"),this.state=o.SCRIPT_DATA,this._stateScriptData(t)}}_stateScriptDataEndTagOpen(t){te(t)?(this.state=o.SCRIPT_DATA_END_TAG_NAME,this._stateScriptDataEndTagName(t)):(this._emitChars("</"),this.state=o.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=o.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscapeStart(t){t===i.HYPHEN_MINUS?(this.state=o.SCRIPT_DATA_ESCAPE_START_DASH,this._emitChars("-")):(this.state=o.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscapeStartDash(t){t===i.HYPHEN_MINUS?(this.state=o.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-")):(this.state=o.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscaped(t){switch(t){case i.HYPHEN_MINUS:{this.state=o.SCRIPT_DATA_ESCAPED_DASH,this._emitChars("-");break}case i.LESS_THAN_SIGN:{this.state=o.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case i.NULL:{this._err(d.unexpectedNullCharacter),this._emitChars(D);break}case i.EOF:{this._err(d.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptDataEscapedDash(t){switch(t){case i.HYPHEN_MINUS:{this.state=o.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-");break}case i.LESS_THAN_SIGN:{this.state=o.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case i.NULL:{this._err(d.unexpectedNullCharacter),this.state=o.SCRIPT_DATA_ESCAPED,this._emitChars(D);break}case i.EOF:{this._err(d.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=o.SCRIPT_DATA_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataEscapedDashDash(t){switch(t){case i.HYPHEN_MINUS:{this._emitChars("-");break}case i.LESS_THAN_SIGN:{this.state=o.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case i.GREATER_THAN_SIGN:{this.state=o.SCRIPT_DATA,this._emitChars(">");break}case i.NULL:{this._err(d.unexpectedNullCharacter),this.state=o.SCRIPT_DATA_ESCAPED,this._emitChars(D);break}case i.EOF:{this._err(d.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=o.SCRIPT_DATA_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataEscapedLessThanSign(t){t===i.SOLIDUS?this.state=o.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:te(t)?(this._emitChars("<"),this.state=o.SCRIPT_DATA_DOUBLE_ESCAPE_START,this._stateScriptDataDoubleEscapeStart(t)):(this._emitChars("<"),this.state=o.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataEscapedEndTagOpen(t){te(t)?(this.state=o.SCRIPT_DATA_ESCAPED_END_TAG_NAME,this._stateScriptDataEscapedEndTagName(t)):(this._emitChars("</"),this.state=o.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataEscapedEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=o.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataDoubleEscapeStart(t){if(this.preprocessor.startsWith(k.SCRIPT,!1)&&Hr(this.preprocessor.peek(k.SCRIPT.length))){this._emitCodePoint(t);for(let s=0;s<k.SCRIPT.length;s++)this._emitCodePoint(this._consume());this.state=o.SCRIPT_DATA_DOUBLE_ESCAPED}else this._ensureHibernation()||(this.state=o.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataDoubleEscaped(t){switch(t){case i.HYPHEN_MINUS:{this.state=o.SCRIPT_DATA_DOUBLE_ESCAPED_DASH,this._emitChars("-");break}case i.LESS_THAN_SIGN:{this.state=o.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case i.NULL:{this._err(d.unexpectedNullCharacter),this._emitChars(D);break}case i.EOF:{this._err(d.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedDash(t){switch(t){case i.HYPHEN_MINUS:{this.state=o.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH,this._emitChars("-");break}case i.LESS_THAN_SIGN:{this.state=o.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case i.NULL:{this._err(d.unexpectedNullCharacter),this.state=o.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(D);break}case i.EOF:{this._err(d.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=o.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedDashDash(t){switch(t){case i.HYPHEN_MINUS:{this._emitChars("-");break}case i.LESS_THAN_SIGN:{this.state=o.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case i.GREATER_THAN_SIGN:{this.state=o.SCRIPT_DATA,this._emitChars(">");break}case i.NULL:{this._err(d.unexpectedNullCharacter),this.state=o.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(D);break}case i.EOF:{this._err(d.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=o.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedLessThanSign(t){t===i.SOLIDUS?(this.state=o.SCRIPT_DATA_DOUBLE_ESCAPE_END,this._emitChars("/")):(this.state=o.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(t))}_stateScriptDataDoubleEscapeEnd(t){if(this.preprocessor.startsWith(k.SCRIPT,!1)&&Hr(this.preprocessor.peek(k.SCRIPT.length))){this._emitCodePoint(t);for(let s=0;s<k.SCRIPT.length;s++)this._emitCodePoint(this._consume());this.state=o.SCRIPT_DATA_ESCAPED}else this._ensureHibernation()||(this.state=o.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(t))}_stateBeforeAttributeName(t){switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:break;case i.SOLIDUS:case i.GREATER_THAN_SIGN:case i.EOF:{this.state=o.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(t);break}case i.EQUALS_SIGN:{this._err(d.unexpectedEqualsSignBeforeAttributeName),this._createAttr("="),this.state=o.ATTRIBUTE_NAME;break}default:this._createAttr(""),this.state=o.ATTRIBUTE_NAME,this._stateAttributeName(t)}}_stateAttributeName(t){switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:case i.SOLIDUS:case i.GREATER_THAN_SIGN:case i.EOF:{this._leaveAttrName(),this.state=o.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(t);break}case i.EQUALS_SIGN:{this._leaveAttrName(),this.state=o.BEFORE_ATTRIBUTE_VALUE;break}case i.QUOTATION_MARK:case i.APOSTROPHE:case i.LESS_THAN_SIGN:{this._err(d.unexpectedCharacterInAttributeName),this.currentAttr.name+=String.fromCodePoint(t);break}case i.NULL:{this._err(d.unexpectedNullCharacter),this.currentAttr.name+=D;break}default:this.currentAttr.name+=String.fromCodePoint(Pe(t)?At(t):t)}}_stateAfterAttributeName(t){switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:break;case i.SOLIDUS:{this.state=o.SELF_CLOSING_START_TAG;break}case i.EQUALS_SIGN:{this.state=o.BEFORE_ATTRIBUTE_VALUE;break}case i.GREATER_THAN_SIGN:{this.state=o.DATA,this.emitCurrentTagToken();break}case i.EOF:{this._err(d.eofInTag),this._emitEOFToken();break}default:this._createAttr(""),this.state=o.ATTRIBUTE_NAME,this._stateAttributeName(t)}}_stateBeforeAttributeValue(t){switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:break;case i.QUOTATION_MARK:{this.state=o.ATTRIBUTE_VALUE_DOUBLE_QUOTED;break}case i.APOSTROPHE:{this.state=o.ATTRIBUTE_VALUE_SINGLE_QUOTED;break}case i.GREATER_THAN_SIGN:{this._err(d.missingAttributeValue),this.state=o.DATA,this.emitCurrentTagToken();break}default:this.state=o.ATTRIBUTE_VALUE_UNQUOTED,this._stateAttributeValueUnquoted(t)}}_stateAttributeValueDoubleQuoted(t){switch(t){case i.QUOTATION_MARK:{this.state=o.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case i.AMPERSAND:{this.returnState=o.ATTRIBUTE_VALUE_DOUBLE_QUOTED,this.state=o.CHARACTER_REFERENCE;break}case i.NULL:{this._err(d.unexpectedNullCharacter),this.currentAttr.value+=D;break}case i.EOF:{this._err(d.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAttributeValueSingleQuoted(t){switch(t){case i.APOSTROPHE:{this.state=o.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case i.AMPERSAND:{this.returnState=o.ATTRIBUTE_VALUE_SINGLE_QUOTED,this.state=o.CHARACTER_REFERENCE;break}case i.NULL:{this._err(d.unexpectedNullCharacter),this.currentAttr.value+=D;break}case i.EOF:{this._err(d.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAttributeValueUnquoted(t){switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:{this._leaveAttrValue(),this.state=o.BEFORE_ATTRIBUTE_NAME;break}case i.AMPERSAND:{this.returnState=o.ATTRIBUTE_VALUE_UNQUOTED,this.state=o.CHARACTER_REFERENCE;break}case i.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=o.DATA,this.emitCurrentTagToken();break}case i.NULL:{this._err(d.unexpectedNullCharacter),this.currentAttr.value+=D;break}case i.QUOTATION_MARK:case i.APOSTROPHE:case i.LESS_THAN_SIGN:case i.EQUALS_SIGN:case i.GRAVE_ACCENT:{this._err(d.unexpectedCharacterInUnquotedAttributeValue),this.currentAttr.value+=String.fromCodePoint(t);break}case i.EOF:{this._err(d.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAfterAttributeValueQuoted(t){switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:{this._leaveAttrValue(),this.state=o.BEFORE_ATTRIBUTE_NAME;break}case i.SOLIDUS:{this._leaveAttrValue(),this.state=o.SELF_CLOSING_START_TAG;break}case i.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=o.DATA,this.emitCurrentTagToken();break}case i.EOF:{this._err(d.eofInTag),this._emitEOFToken();break}default:this._err(d.missingWhitespaceBetweenAttributes),this.state=o.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(t)}}_stateSelfClosingStartTag(t){switch(t){case i.GREATER_THAN_SIGN:{let s=this.currentToken;s.selfClosing=!0,this.state=o.DATA,this.emitCurrentTagToken();break}case i.EOF:{this._err(d.eofInTag),this._emitEOFToken();break}default:this._err(d.unexpectedSolidusInTag),this.state=o.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(t)}}_stateBogusComment(t){let s=this.currentToken;switch(t){case i.GREATER_THAN_SIGN:{this.state=o.DATA,this.emitCurrentComment(s);break}case i.EOF:{this.emitCurrentComment(s),this._emitEOFToken();break}case i.NULL:{this._err(d.unexpectedNullCharacter),s.data+=D;break}default:s.data+=String.fromCodePoint(t)}}_stateMarkupDeclarationOpen(t){this._consumeSequenceIfMatch(k.DASH_DASH,!0)?(this._createCommentToken(k.DASH_DASH.length+1),this.state=o.COMMENT_START):this._consumeSequenceIfMatch(k.DOCTYPE,!1)?(this.currentLocation=this.getCurrentLocation(k.DOCTYPE.length+1),this.state=o.DOCTYPE):this._consumeSequenceIfMatch(k.CDATA_START,!0)?this.inForeignNode?this.state=o.CDATA_SECTION:(this._err(d.cdataInHtmlContent),this._createCommentToken(k.CDATA_START.length+1),this.currentToken.data="[CDATA[",this.state=o.BOGUS_COMMENT):this._ensureHibernation()||(this._err(d.incorrectlyOpenedComment),this._createCommentToken(2),this.state=o.BOGUS_COMMENT,this._stateBogusComment(t))}_stateCommentStart(t){switch(t){case i.HYPHEN_MINUS:{this.state=o.COMMENT_START_DASH;break}case i.GREATER_THAN_SIGN:{this._err(d.abruptClosingOfEmptyComment),this.state=o.DATA;let s=this.currentToken;this.emitCurrentComment(s);break}default:this.state=o.COMMENT,this._stateComment(t)}}_stateCommentStartDash(t){let s=this.currentToken;switch(t){case i.HYPHEN_MINUS:{this.state=o.COMMENT_END;break}case i.GREATER_THAN_SIGN:{this._err(d.abruptClosingOfEmptyComment),this.state=o.DATA,this.emitCurrentComment(s);break}case i.EOF:{this._err(d.eofInComment),this.emitCurrentComment(s),this._emitEOFToken();break}default:s.data+="-",this.state=o.COMMENT,this._stateComment(t)}}_stateComment(t){let s=this.currentToken;switch(t){case i.HYPHEN_MINUS:{this.state=o.COMMENT_END_DASH;break}case i.LESS_THAN_SIGN:{s.data+="<",this.state=o.COMMENT_LESS_THAN_SIGN;break}case i.NULL:{this._err(d.unexpectedNullCharacter),s.data+=D;break}case i.EOF:{this._err(d.eofInComment),this.emitCurrentComment(s),this._emitEOFToken();break}default:s.data+=String.fromCodePoint(t)}}_stateCommentLessThanSign(t){let s=this.currentToken;switch(t){case i.EXCLAMATION_MARK:{s.data+="!",this.state=o.COMMENT_LESS_THAN_SIGN_BANG;break}case i.LESS_THAN_SIGN:{s.data+="<";break}default:this.state=o.COMMENT,this._stateComment(t)}}_stateCommentLessThanSignBang(t){t===i.HYPHEN_MINUS?this.state=o.COMMENT_LESS_THAN_SIGN_BANG_DASH:(this.state=o.COMMENT,this._stateComment(t))}_stateCommentLessThanSignBangDash(t){t===i.HYPHEN_MINUS?this.state=o.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:(this.state=o.COMMENT_END_DASH,this._stateCommentEndDash(t))}_stateCommentLessThanSignBangDashDash(t){t!==i.GREATER_THAN_SIGN&&t!==i.EOF&&this._err(d.nestedComment),this.state=o.COMMENT_END,this._stateCommentEnd(t)}_stateCommentEndDash(t){let s=this.currentToken;switch(t){case i.HYPHEN_MINUS:{this.state=o.COMMENT_END;break}case i.EOF:{this._err(d.eofInComment),this.emitCurrentComment(s),this._emitEOFToken();break}default:s.data+="-",this.state=o.COMMENT,this._stateComment(t)}}_stateCommentEnd(t){let s=this.currentToken;switch(t){case i.GREATER_THAN_SIGN:{this.state=o.DATA,this.emitCurrentComment(s);break}case i.EXCLAMATION_MARK:{this.state=o.COMMENT_END_BANG;break}case i.HYPHEN_MINUS:{s.data+="-";break}case i.EOF:{this._err(d.eofInComment),this.emitCurrentComment(s),this._emitEOFToken();break}default:s.data+="--",this.state=o.COMMENT,this._stateComment(t)}}_stateCommentEndBang(t){let s=this.currentToken;switch(t){case i.HYPHEN_MINUS:{s.data+="--!",this.state=o.COMMENT_END_DASH;break}case i.GREATER_THAN_SIGN:{this._err(d.incorrectlyClosedComment),this.state=o.DATA,this.emitCurrentComment(s);break}case i.EOF:{this._err(d.eofInComment),this.emitCurrentComment(s),this._emitEOFToken();break}default:s.data+="--!",this.state=o.COMMENT,this._stateComment(t)}}_stateDoctype(t){switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:{this.state=o.BEFORE_DOCTYPE_NAME;break}case i.GREATER_THAN_SIGN:{this.state=o.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(t);break}case i.EOF:{this._err(d.eofInDoctype),this._createDoctypeToken(null);let s=this.currentToken;s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(d.missingWhitespaceBeforeDoctypeName),this.state=o.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(t)}}_stateBeforeDoctypeName(t){if(Pe(t))this._createDoctypeToken(String.fromCharCode(At(t))),this.state=o.DOCTYPE_NAME;else switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:break;case i.NULL:{this._err(d.unexpectedNullCharacter),this._createDoctypeToken(D),this.state=o.DOCTYPE_NAME;break}case i.GREATER_THAN_SIGN:{this._err(d.missingDoctypeName),this._createDoctypeToken(null);let s=this.currentToken;s.forceQuirks=!0,this.emitCurrentDoctype(s),this.state=o.DATA;break}case i.EOF:{this._err(d.eofInDoctype),this._createDoctypeToken(null);let s=this.currentToken;s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._createDoctypeToken(String.fromCodePoint(t)),this.state=o.DOCTYPE_NAME}}_stateDoctypeName(t){let s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:{this.state=o.AFTER_DOCTYPE_NAME;break}case i.GREATER_THAN_SIGN:{this.state=o.DATA,this.emitCurrentDoctype(s);break}case i.NULL:{this._err(d.unexpectedNullCharacter),s.name+=D;break}case i.EOF:{this._err(d.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:s.name+=String.fromCodePoint(Pe(t)?At(t):t)}}_stateAfterDoctypeName(t){let s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:break;case i.GREATER_THAN_SIGN:{this.state=o.DATA,this.emitCurrentDoctype(s);break}case i.EOF:{this._err(d.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._consumeSequenceIfMatch(k.PUBLIC,!1)?this.state=o.AFTER_DOCTYPE_PUBLIC_KEYWORD:this._consumeSequenceIfMatch(k.SYSTEM,!1)?this.state=o.AFTER_DOCTYPE_SYSTEM_KEYWORD:this._ensureHibernation()||(this._err(d.invalidCharacterSequenceAfterDoctypeName),s.forceQuirks=!0,this.state=o.BOGUS_DOCTYPE,this._stateBogusDoctype(t))}}_stateAfterDoctypePublicKeyword(t){let s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:{this.state=o.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER;break}case i.QUOTATION_MARK:{this._err(d.missingWhitespaceAfterDoctypePublicKeyword),s.publicId="",this.state=o.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case i.APOSTROPHE:{this._err(d.missingWhitespaceAfterDoctypePublicKeyword),s.publicId="",this.state=o.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case i.GREATER_THAN_SIGN:{this._err(d.missingDoctypePublicIdentifier),s.forceQuirks=!0,this.state=o.DATA,this.emitCurrentDoctype(s);break}case i.EOF:{this._err(d.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(d.missingQuoteBeforeDoctypePublicIdentifier),s.forceQuirks=!0,this.state=o.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBeforeDoctypePublicIdentifier(t){let s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:break;case i.QUOTATION_MARK:{s.publicId="",this.state=o.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case i.APOSTROPHE:{s.publicId="",this.state=o.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case i.GREATER_THAN_SIGN:{this._err(d.missingDoctypePublicIdentifier),s.forceQuirks=!0,this.state=o.DATA,this.emitCurrentDoctype(s);break}case i.EOF:{this._err(d.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(d.missingQuoteBeforeDoctypePublicIdentifier),s.forceQuirks=!0,this.state=o.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateDoctypePublicIdentifierDoubleQuoted(t){let s=this.currentToken;switch(t){case i.QUOTATION_MARK:{this.state=o.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case i.NULL:{this._err(d.unexpectedNullCharacter),s.publicId+=D;break}case i.GREATER_THAN_SIGN:{this._err(d.abruptDoctypePublicIdentifier),s.forceQuirks=!0,this.emitCurrentDoctype(s),this.state=o.DATA;break}case i.EOF:{this._err(d.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:s.publicId+=String.fromCodePoint(t)}}_stateDoctypePublicIdentifierSingleQuoted(t){let s=this.currentToken;switch(t){case i.APOSTROPHE:{this.state=o.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case i.NULL:{this._err(d.unexpectedNullCharacter),s.publicId+=D;break}case i.GREATER_THAN_SIGN:{this._err(d.abruptDoctypePublicIdentifier),s.forceQuirks=!0,this.emitCurrentDoctype(s),this.state=o.DATA;break}case i.EOF:{this._err(d.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:s.publicId+=String.fromCodePoint(t)}}_stateAfterDoctypePublicIdentifier(t){let s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:{this.state=o.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS;break}case i.GREATER_THAN_SIGN:{this.state=o.DATA,this.emitCurrentDoctype(s);break}case i.QUOTATION_MARK:{this._err(d.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),s.systemId="",this.state=o.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case i.APOSTROPHE:{this._err(d.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),s.systemId="",this.state=o.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case i.EOF:{this._err(d.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(d.missingQuoteBeforeDoctypeSystemIdentifier),s.forceQuirks=!0,this.state=o.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBetweenDoctypePublicAndSystemIdentifiers(t){let s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:break;case i.GREATER_THAN_SIGN:{this.emitCurrentDoctype(s),this.state=o.DATA;break}case i.QUOTATION_MARK:{s.systemId="",this.state=o.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case i.APOSTROPHE:{s.systemId="",this.state=o.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case i.EOF:{this._err(d.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(d.missingQuoteBeforeDoctypeSystemIdentifier),s.forceQuirks=!0,this.state=o.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateAfterDoctypeSystemKeyword(t){let s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:{this.state=o.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER;break}case i.QUOTATION_MARK:{this._err(d.missingWhitespaceAfterDoctypeSystemKeyword),s.systemId="",this.state=o.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case i.APOSTROPHE:{this._err(d.missingWhitespaceAfterDoctypeSystemKeyword),s.systemId="",this.state=o.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case i.GREATER_THAN_SIGN:{this._err(d.missingDoctypeSystemIdentifier),s.forceQuirks=!0,this.state=o.DATA,this.emitCurrentDoctype(s);break}case i.EOF:{this._err(d.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(d.missingQuoteBeforeDoctypeSystemIdentifier),s.forceQuirks=!0,this.state=o.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBeforeDoctypeSystemIdentifier(t){let s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:break;case i.QUOTATION_MARK:{s.systemId="",this.state=o.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case i.APOSTROPHE:{s.systemId="",this.state=o.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case i.GREATER_THAN_SIGN:{this._err(d.missingDoctypeSystemIdentifier),s.forceQuirks=!0,this.state=o.DATA,this.emitCurrentDoctype(s);break}case i.EOF:{this._err(d.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(d.missingQuoteBeforeDoctypeSystemIdentifier),s.forceQuirks=!0,this.state=o.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateDoctypeSystemIdentifierDoubleQuoted(t){let s=this.currentToken;switch(t){case i.QUOTATION_MARK:{this.state=o.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case i.NULL:{this._err(d.unexpectedNullCharacter),s.systemId+=D;break}case i.GREATER_THAN_SIGN:{this._err(d.abruptDoctypeSystemIdentifier),s.forceQuirks=!0,this.emitCurrentDoctype(s),this.state=o.DATA;break}case i.EOF:{this._err(d.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:s.systemId+=String.fromCodePoint(t)}}_stateDoctypeSystemIdentifierSingleQuoted(t){let s=this.currentToken;switch(t){case i.APOSTROPHE:{this.state=o.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case i.NULL:{this._err(d.unexpectedNullCharacter),s.systemId+=D;break}case i.GREATER_THAN_SIGN:{this._err(d.abruptDoctypeSystemIdentifier),s.forceQuirks=!0,this.emitCurrentDoctype(s),this.state=o.DATA;break}case i.EOF:{this._err(d.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:s.systemId+=String.fromCodePoint(t)}}_stateAfterDoctypeSystemIdentifier(t){let s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:break;case i.GREATER_THAN_SIGN:{this.emitCurrentDoctype(s),this.state=o.DATA;break}case i.EOF:{this._err(d.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(d.unexpectedCharacterAfterDoctypeSystemIdentifier),this.state=o.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBogusDoctype(t){let s=this.currentToken;switch(t){case i.GREATER_THAN_SIGN:{this.emitCurrentDoctype(s),this.state=o.DATA;break}case i.NULL:{this._err(d.unexpectedNullCharacter);break}case i.EOF:{this.emitCurrentDoctype(s),this._emitEOFToken();break}default:}}_stateCdataSection(t){switch(t){case i.RIGHT_SQUARE_BRACKET:{this.state=o.CDATA_SECTION_BRACKET;break}case i.EOF:{this._err(d.eofInCdata),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateCdataSectionBracket(t){t===i.RIGHT_SQUARE_BRACKET?this.state=o.CDATA_SECTION_END:(this._emitChars("]"),this.state=o.CDATA_SECTION,this._stateCdataSection(t))}_stateCdataSectionEnd(t){switch(t){case i.GREATER_THAN_SIGN:{this.state=o.DATA;break}case i.RIGHT_SQUARE_BRACKET:{this._emitChars("]");break}default:this._emitChars("]]"),this.state=o.CDATA_SECTION,this._stateCdataSection(t)}}_stateCharacterReference(t){t===i.NUMBER_SIGN?this.state=o.NUMERIC_CHARACTER_REFERENCE:Es(t)?(this.state=o.NAMED_CHARACTER_REFERENCE,this._stateNamedCharacterReference(t)):(this._flushCodePointConsumedAsCharacterReference(i.AMPERSAND),this._reconsumeInState(this.returnState,t))}_stateNamedCharacterReference(t){let s=this._matchNamedCharacterReference(t);if(!this._ensureHibernation())if(s){for(let n=0;n<s.length;n++)this._flushCodePointConsumedAsCharacterReference(s[n]);this.state=this.returnState}else this._flushCodePointConsumedAsCharacterReference(i.AMPERSAND),this.state=o.AMBIGUOUS_AMPERSAND}_stateAmbiguousAmpersand(t){Es(t)?this._flushCodePointConsumedAsCharacterReference(t):(t===i.SEMICOLON&&this._err(d.unknownNamedCharacterReference),this._reconsumeInState(this.returnState,t))}_stateNumericCharacterReference(t){this.charRefCode=0,t===i.LATIN_SMALL_X||t===i.LATIN_CAPITAL_X?this.state=o.HEXADEMICAL_CHARACTER_REFERENCE_START:Me(t)?(this.state=o.DECIMAL_CHARACTER_REFERENCE,this._stateDecimalCharacterReference(t)):(this._err(d.absenceOfDigitsInNumericCharacterReference),this._flushCodePointConsumedAsCharacterReference(i.AMPERSAND),this._flushCodePointConsumedAsCharacterReference(i.NUMBER_SIGN),this._reconsumeInState(this.returnState,t))}_stateHexademicalCharacterReferenceStart(t){Pi(t)?(this.state=o.HEXADEMICAL_CHARACTER_REFERENCE,this._stateHexademicalCharacterReference(t)):(this._err(d.absenceOfDigitsInNumericCharacterReference),this._flushCodePointConsumedAsCharacterReference(i.AMPERSAND),this._flushCodePointConsumedAsCharacterReference(i.NUMBER_SIGN),this._unconsume(2),this.state=this.returnState)}_stateHexademicalCharacterReference(t){Ur(t)?this.charRefCode=this.charRefCode*16+t-55:Fr(t)?this.charRefCode=this.charRefCode*16+t-87:Me(t)?this.charRefCode=this.charRefCode*16+t-48:t===i.SEMICOLON?this.state=o.NUMERIC_CHARACTER_REFERENCE_END:(this._err(d.missingSemicolonAfterCharacterReference),this.state=o.NUMERIC_CHARACTER_REFERENCE_END,this._stateNumericCharacterReferenceEnd(t))}_stateDecimalCharacterReference(t){Me(t)?this.charRefCode=this.charRefCode*10+t-48:t===i.SEMICOLON?this.state=o.NUMERIC_CHARACTER_REFERENCE_END:(this._err(d.missingSemicolonAfterCharacterReference),this.state=o.NUMERIC_CHARACTER_REFERENCE_END,this._stateNumericCharacterReferenceEnd(t))}_stateNumericCharacterReferenceEnd(t){if(this.charRefCode===i.NULL)this._err(d.nullCharacterReference),this.charRefCode=i.REPLACEMENT_CHARACTER;else if(this.charRefCode>1114111)this._err(d.characterReferenceOutsideUnicodeRange),this.charRefCode=i.REPLACEMENT_CHARACTER;else if(dt(this.charRefCode))this._err(d.surrogateCharacterReference),this.charRefCode=i.REPLACEMENT_CHARACTER;else if(mt(this.charRefCode))this._err(d.noncharacterCharacterReference);else if(ft(this.charRefCode)||this.charRefCode===i.CARRIAGE_RETURN){this._err(d.controlCharacterReference);let s=Di.get(this.charRefCode);s!==void 0&&(this.charRefCode=s)}this._flushCodePointConsumedAsCharacterReference(this.charRefCode),this._reconsumeInState(this.returnState,t)}};var wr=new Set([r.DD,r.DT,r.LI,r.OPTGROUP,r.OPTION,r.P,r.RB,r.RP,r.RT,r.RTC]),yr=new Set([...wr,r.CAPTION,r.COLGROUP,r.TBODY,r.TD,r.TFOOT,r.TH,r.THEAD,r.TR]),Ct=new Map([[r.APPLET,f.HTML],[r.CAPTION,f.HTML],[r.HTML,f.HTML],[r.MARQUEE,f.HTML],[r.OBJECT,f.HTML],[r.TABLE,f.HTML],[r.TD,f.HTML],[r.TEMPLATE,f.HTML],[r.TH,f.HTML],[r.ANNOTATION_XML,f.MATHML],[r.MI,f.MATHML],[r.MN,f.MATHML],[r.MO,f.MATHML],[r.MS,f.MATHML],[r.MTEXT,f.MATHML],[r.DESC,f.SVG],[r.FOREIGN_OBJECT,f.SVG],[r.TITLE,f.SVG]]),Bi=[r.H1,r.H2,r.H3,r.H4,r.H5,r.H6],ki=[r.TR,r.TEMPLATE,r.HTML],Hi=[r.TBODY,r.TFOOT,r.THEAD,r.TEMPLATE,r.HTML],Ui=[r.TABLE,r.TEMPLATE,r.HTML],Fi=[r.TD,r.TH],pt=class{get currentTmplContentOrNode(){return this._isInTemplate()?this.treeAdapter.getTemplateContent(this.current):this.current}constructor(t,s,n){this.treeAdapter=s,this.handler=n,this.items=[],this.tagIDs=[],this.stackTop=-1,this.tmplCount=0,this.currentTagId=r.UNKNOWN,this.current=t}_indexOf(t){return this.items.lastIndexOf(t,this.stackTop)}_isInTemplate(){return this.currentTagId===r.TEMPLATE&&this.treeAdapter.getNamespaceURI(this.current)===f.HTML}_updateCurrentElement(){this.current=this.items[this.stackTop],this.currentTagId=this.tagIDs[this.stackTop]}push(t,s){this.stackTop++,this.items[this.stackTop]=t,this.current=t,this.tagIDs[this.stackTop]=s,this.currentTagId=s,this._isInTemplate()&&this.tmplCount++,this.handler.onItemPush(t,s,!0)}pop(){let t=this.current;this.tmplCount>0&&this._isInTemplate()&&this.tmplCount--,this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(t,!0)}replace(t,s){let n=this._indexOf(t);this.items[n]=s,n===this.stackTop&&(this.current=s)}insertAfter(t,s,n){let a=this._indexOf(t)+1;this.items.splice(a,0,s),this.tagIDs.splice(a,0,n),this.stackTop++,a===this.stackTop&&this._updateCurrentElement(),this.handler.onItemPush(this.current,this.currentTagId,a===this.stackTop)}popUntilTagNamePopped(t){let s=this.stackTop+1;do s=this.tagIDs.lastIndexOf(t,s-1);while(s>0&&this.treeAdapter.getNamespaceURI(this.items[s])!==f.HTML);this.shortenToLength(s<0?0:s)}shortenToLength(t){for(;this.stackTop>=t;){let s=this.current;this.tmplCount>0&&this._isInTemplate()&&(this.tmplCount-=1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(s,this.stackTop<t)}}popUntilElementPopped(t){let s=this._indexOf(t);this.shortenToLength(s<0?0:s)}popUntilPopped(t,s){let n=this._indexOfTagNames(t,s);this.shortenToLength(n<0?0:n)}popUntilNumberedHeaderPopped(){this.popUntilPopped(Bi,f.HTML)}popUntilTableCellPopped(){this.popUntilPopped(Fi,f.HTML)}popAllUpToHtmlElement(){this.tmplCount=0,this.shortenToLength(1)}_indexOfTagNames(t,s){for(let n=this.stackTop;n>=0;n--)if(t.includes(this.tagIDs[n])&&this.treeAdapter.getNamespaceURI(this.items[n])===s)return n;return-1}clearBackTo(t,s){let n=this._indexOfTagNames(t,s);this.shortenToLength(n+1)}clearBackToTableContext(){this.clearBackTo(Ui,f.HTML)}clearBackToTableBodyContext(){this.clearBackTo(Hi,f.HTML)}clearBackToTableRowContext(){this.clearBackTo(ki,f.HTML)}remove(t){let s=this._indexOf(t);s>=0&&(s===this.stackTop?this.pop():(this.items.splice(s,1),this.tagIDs.splice(s,1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(t,!1)))}tryPeekProperlyNestedBodyElement(){return this.stackTop>=1&&this.tagIDs[1]===r.BODY?this.items[1]:null}contains(t){return this._indexOf(t)>-1}getCommonAncestor(t){let s=this._indexOf(t)-1;return s>=0?this.items[s]:null}isRootHtmlElementCurrent(){return this.stackTop===0&&this.tagIDs[0]===r.HTML}hasInScope(t){for(let s=this.stackTop;s>=0;s--){let n=this.tagIDs[s],a=this.treeAdapter.getNamespaceURI(this.items[s]);if(n===t&&a===f.HTML)return!0;if(Ct.get(n)===a)return!1}return!0}hasNumberedHeaderInScope(){for(let t=this.stackTop;t>=0;t--){let s=this.tagIDs[t],n=this.treeAdapter.getNamespaceURI(this.items[t]);if(De(s)&&n===f.HTML)return!0;if(Ct.get(s)===n)return!1}return!0}hasInListItemScope(t){for(let s=this.stackTop;s>=0;s--){let n=this.tagIDs[s],a=this.treeAdapter.getNamespaceURI(this.items[s]);if(n===t&&a===f.HTML)return!0;if((n===r.UL||n===r.OL)&&a===f.HTML||Ct.get(n)===a)return!1}return!0}hasInButtonScope(t){for(let s=this.stackTop;s>=0;s--){let n=this.tagIDs[s],a=this.treeAdapter.getNamespaceURI(this.items[s]);if(n===t&&a===f.HTML)return!0;if(n===r.BUTTON&&a===f.HTML||Ct.get(n)===a)return!1}return!0}hasInTableScope(t){for(let s=this.stackTop;s>=0;s--){let n=this.tagIDs[s];if(this.treeAdapter.getNamespaceURI(this.items[s])===f.HTML){if(n===t)return!0;if(n===r.TABLE||n===r.TEMPLATE||n===r.HTML)return!1}}return!0}hasTableBodyContextInTableScope(){for(let t=this.stackTop;t>=0;t--){let s=this.tagIDs[t];if(this.treeAdapter.getNamespaceURI(this.items[t])===f.HTML){if(s===r.TBODY||s===r.THEAD||s===r.TFOOT)return!0;if(s===r.TABLE||s===r.HTML)return!1}}return!0}hasInSelectScope(t){for(let s=this.stackTop;s>=0;s--){let n=this.tagIDs[s];if(this.treeAdapter.getNamespaceURI(this.items[s])===f.HTML){if(n===t)return!0;if(n!==r.OPTION&&n!==r.OPTGROUP)return!1}}return!0}generateImpliedEndTags(){for(;wr.has(this.currentTagId);)this.pop()}generateImpliedEndTagsThoroughly(){for(;yr.has(this.currentTagId);)this.pop()}generateImpliedEndTagsWithExclusion(t){for(;this.currentTagId!==t&&yr.has(this.currentTagId);)this.pop()}};var y;(function(e){e[e.Marker=0]="Marker",e[e.Element=1]="Element"})(y=y||(y={}));var vr={type:y.Marker},It=class{constructor(t){this.treeAdapter=t,this.entries=[],this.bookmark=null}_getNoahArkConditionCandidates(t,s){let n=[],a=s.length,c=this.treeAdapter.getTagName(t),l=this.treeAdapter.getNamespaceURI(t);for(let T=0;T<this.entries.length;T++){let u=this.entries[T];if(u.type===y.Marker)break;let{element:A}=u;if(this.treeAdapter.getTagName(A)===c&&this.treeAdapter.getNamespaceURI(A)===l){let _=this.treeAdapter.getAttrList(A);_.length===a&&n.push({idx:T,attrs:_})}}return n}_ensureNoahArkCondition(t){if(this.entries.length<3)return;let s=this.treeAdapter.getAttrList(t),n=this._getNoahArkConditionCandidates(t,s);if(n.length<3)return;let a=new Map(s.map(l=>[l.name,l.value])),c=0;for(let l=0;l<n.length;l++){let T=n[l];T.attrs.every(u=>a.get(u.name)===u.value)&&(c+=1,c>=3&&this.entries.splice(T.idx,1))}}insertMarker(){this.entries.unshift(vr)}pushElement(t,s){this._ensureNoahArkCondition(t),this.entries.unshift({type:y.Element,element:t,token:s})}insertElementAfterBookmark(t,s){let n=this.entries.indexOf(this.bookmark);this.entries.splice(n,0,{type:y.Element,element:t,token:s})}removeEntry(t){let s=this.entries.indexOf(t);s>=0&&this.entries.splice(s,1)}clearToLastMarker(){let t=this.entries.indexOf(vr);t>=0?this.entries.splice(0,t+1):this.entries.length=0}getElementEntryInScopeWithTagName(t){let s=this.entries.find(n=>n.type===y.Marker||this.treeAdapter.getTagName(n.element)===t);return s&&s.type===y.Element?s:null}getElementEntry(t){return this.entries.find(s=>s.type===y.Element&&s.element===t)}};function Yr(e){return{nodeName:"#text",value:e,parentNode:null}}var G={createDocument(){return{nodeName:"#document",mode:P.NO_QUIRKS,childNodes:[]}},createDocumentFragment(){return{nodeName:"#document-fragment",childNodes:[]}},createElement(e,t,s){return{nodeName:e,tagName:e,attrs:s,namespaceURI:t,childNodes:[],parentNode:null}},createCommentNode(e){return{nodeName:"#comment",data:e,parentNode:null}},appendChild(e,t){e.childNodes.push(t),t.parentNode=e},insertBefore(e,t,s){let n=e.childNodes.indexOf(s);e.childNodes.splice(n,0,t),t.parentNode=e},setTemplateContent(e,t){e.content=t},getTemplateContent(e){return e.content},setDocumentType(e,t,s,n){let a=e.childNodes.find(c=>c.nodeName==="#documentType");if(a)a.name=t,a.publicId=s,a.systemId=n;else{let c={nodeName:"#documentType",name:t,publicId:s,systemId:n,parentNode:null};G.appendChild(e,c)}},setDocumentMode(e,t){e.mode=t},getDocumentMode(e){return e.mode},detachNode(e){if(e.parentNode){let t=e.parentNode.childNodes.indexOf(e);e.parentNode.childNodes.splice(t,1),e.parentNode=null}},insertText(e,t){if(e.childNodes.length>0){let s=e.childNodes[e.childNodes.length-1];if(G.isTextNode(s)){s.value+=t;return}}G.appendChild(e,Yr(t))},insertTextBefore(e,t,s){let n=e.childNodes[e.childNodes.indexOf(s)-1];n&&G.isTextNode(n)?n.value+=t:G.insertBefore(e,Yr(t),s)},adoptAttributes(e,t){let s=new Set(e.attrs.map(n=>n.name));for(let n=0;n<t.length;n++)s.has(t[n].name)||e.attrs.push(t[n])},getFirstChild(e){return e.childNodes[0]},getChildNodes(e){return e.childNodes},getParentNode(e){return e.parentNode},getAttrList(e){return e.attrs},getTagName(e){return e.tagName},getNamespaceURI(e){return e.namespaceURI},getTextNodeContent(e){return e.value},getCommentNodeContent(e){return e.data},getDocumentTypeNodeName(e){return e.name},getDocumentTypeNodePublicId(e){return e.publicId},getDocumentTypeNodeSystemId(e){return e.systemId},isTextNode(e){return e.nodeName==="#text"},isCommentNode(e){return e.nodeName==="#comment"},isDocumentTypeNode(e){return e.nodeName==="#documentType"},isElementNode(e){return Object.prototype.hasOwnProperty.call(e,"tagName")},setNodeSourceCodeLocation(e,t){e.sourceCodeLocation=t},getNodeSourceCodeLocation(e){return e.sourceCodeLocation},updateNodeSourceCodeLocation(e,t){e.sourceCodeLocation={...e.sourceCodeLocation,...t}}};var Wr="html",xi="about:legacy-compat",yi="http://www.ibm.com/data/dtd/v11/ibmxhtml1-transitional.dtd",Gr=["+//silmaril//dtd html pro v0r11 19970101//","-//as//dtd html 3.0 aswedit + extensions//","-//advasoft ltd//dtd html 3.0 aswedit + extensions//","-//ietf//dtd html 2.0 level 1//","-//ietf//dtd html 2.0 level 2//","-//ietf//dtd html 2.0 strict level 1//","-//ietf//dtd html 2.0 strict level 2//","-//ietf//dtd html 2.0 strict//","-//ietf//dtd html 2.0//","-//ietf//dtd html 2.1e//","-//ietf//dtd html 3.0//","-//ietf//dtd html 3.2 final//","-//ietf//dtd html 3.2//","-//ietf//dtd html 3//","-//ietf//dtd html level 0//","-//ietf//dtd html level 1//","-//ietf//dtd html level 2//","-//ietf//dtd html level 3//","-//ietf//dtd html strict level 0//","-//ietf//dtd html strict level 1//","-//ietf//dtd html strict level 2//","-//ietf//dtd html strict level 3//","-//ietf//dtd html strict//","-//ietf//dtd html//","-//metrius//dtd metrius presentational//","-//microsoft//dtd internet explorer 2.0 html strict//","-//microsoft//dtd internet explorer 2.0 html//","-//microsoft//dtd internet explorer 2.0 tables//","-//microsoft//dtd internet explorer 3.0 html strict//","-//microsoft//dtd internet explorer 3.0 html//","-//microsoft//dtd internet explorer 3.0 tables//","-//netscape comm. corp.//dtd html//","-//netscape comm. corp.//dtd strict html//","-//o'reilly and associates//dtd html 2.0//","-//o'reilly and associates//dtd html extended 1.0//","-//o'reilly and associates//dtd html extended relaxed 1.0//","-//sq//dtd html 2.0 hotmetal + extensions//","-//softquad software//dtd hotmetal pro 6.0::19990601::extensions to html 4.0//","-//softquad//dtd hotmetal pro 4.0::19971010::extensions to html 4.0//","-//spyglass//dtd html 2.0 extended//","-//sun microsystems corp.//dtd hotjava html//","-//sun microsystems corp.//dtd hotjava strict html//","-//w3c//dtd html 3 1995-03-24//","-//w3c//dtd html 3.2 draft//","-//w3c//dtd html 3.2 final//","-//w3c//dtd html 3.2//","-//w3c//dtd html 3.2s draft//","-//w3c//dtd html 4.0 frameset//","-//w3c//dtd html 4.0 transitional//","-//w3c//dtd html experimental 19960712//","-//w3c//dtd html experimental 970421//","-//w3c//dtd w3 html//","-//w3o//dtd w3 html 3.0//","-//webtechs//dtd mozilla html 2.0//","-//webtechs//dtd mozilla html//"],wi=[...Gr,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"],vi=new Set(["-//w3o//dtd w3 html strict 3.0//en//","-/w3c/dtd html 4.0 transitional/en","html"]),Xr=["-//w3c//dtd xhtml 1.0 frameset//","-//w3c//dtd xhtml 1.0 transitional//"],Yi=[...Xr,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"];function Qr(e,t){return t.some(s=>e.startsWith(s))}function Kr(e){return e.name===Wr&&e.publicId===null&&(e.systemId===null||e.systemId===xi)}function Vr(e){if(e.name!==Wr)return P.QUIRKS;let{systemId:t}=e;if(t&&t.toLowerCase()===yi)return P.QUIRKS;let{publicId:s}=e;if(s!==null){if(s=s.toLowerCase(),vi.has(s))return P.QUIRKS;let n=t===null?wi:Gr;if(Qr(s,n))return P.QUIRKS;if(n=t===null?Xr:Yi,Qr(s,n))return P.LIMITED_QUIRKS}return P.NO_QUIRKS}var gt={};X(gt,{SVG_TAG_NAMES_ADJUSTMENT_MAP:()=>qr,adjustTokenMathMLAttrs:()=>Nt,adjustTokenSVGAttrs:()=>Rt,adjustTokenSVGTagName:()=>hs,adjustTokenXMLAttrs:()=>ke,causesExit:()=>ls,isIntegrationPoint:()=>Ts});var jr={TEXT_HTML:"text/html",APPLICATION_XML:"application/xhtml+xml"},Wi="definitionurl",Gi="definitionURL",Xi=new Map(["attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(e=>[e.toLowerCase(),e])),Ki=new Map([["xlink:actuate",{prefix:"xlink",name:"actuate",namespace:f.XLINK}],["xlink:arcrole",{prefix:"xlink",name:"arcrole",namespace:f.XLINK}],["xlink:href",{prefix:"xlink",name:"href",namespace:f.XLINK}],["xlink:role",{prefix:"xlink",name:"role",namespace:f.XLINK}],["xlink:show",{prefix:"xlink",name:"show",namespace:f.XLINK}],["xlink:title",{prefix:"xlink",name:"title",namespace:f.XLINK}],["xlink:type",{prefix:"xlink",name:"type",namespace:f.XLINK}],["xml:base",{prefix:"xml",name:"base",namespace:f.XML}],["xml:lang",{prefix:"xml",name:"lang",namespace:f.XML}],["xml:space",{prefix:"xml",name:"space",namespace:f.XML}],["xmlns",{prefix:"",name:"xmlns",namespace:f.XMLNS}],["xmlns:xlink",{prefix:"xmlns",name:"xlink",namespace:f.XMLNS}]]),qr=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(e=>[e.toLowerCase(),e])),Vi=new Set([r.B,r.BIG,r.BLOCKQUOTE,r.BODY,r.BR,r.CENTER,r.CODE,r.DD,r.DIV,r.DL,r.DT,r.EM,r.EMBED,r.H1,r.H2,r.H3,r.H4,r.H5,r.H6,r.HEAD,r.HR,r.I,r.IMG,r.LI,r.LISTING,r.MENU,r.META,r.NOBR,r.OL,r.P,r.PRE,r.RUBY,r.S,r.SMALL,r.SPAN,r.STRONG,r.STRIKE,r.SUB,r.SUP,r.TABLE,r.TT,r.U,r.UL,r.VAR]);function ls(e){let t=e.tagID;return t===r.FONT&&e.attrs.some(({name:n})=>n===v.COLOR||n===v.SIZE||n===v.FACE)||Vi.has(t)}function Nt(e){for(let t=0;t<e.attrs.length;t++)if(e.attrs[t].name===Wi){e.attrs[t].name=Gi;break}}function Rt(e){for(let t=0;t<e.attrs.length;t++){let s=Xi.get(e.attrs[t].name);s!=null&&(e.attrs[t].name=s)}}function ke(e){for(let t=0;t<e.attrs.length;t++){let s=Ki.get(e.attrs[t].name);s&&(e.attrs[t].prefix=s.prefix,e.attrs[t].name=s.name,e.attrs[t].namespace=s.namespace)}}function hs(e){let t=qr.get(e.tagName);t!=null&&(e.tagName=t,e.tagID=ee(e.tagName))}function ji(e,t){return t===f.MATHML&&(e===r.MI||e===r.MO||e===r.MN||e===r.MS||e===r.MTEXT)}function qi(e,t,s){if(t===f.MATHML&&e===r.ANNOTATION_XML){for(let n=0;n<s.length;n++)if(s[n].name===v.ENCODING){let a=s[n].value.toLowerCase();return a===jr.TEXT_HTML||a===jr.APPLICATION_XML}}return t===f.SVG&&(e===r.FOREIGN_OBJECT||e===r.DESC||e===r.TITLE)}function Ts(e,t,s,n){return(!n||n===f.HTML)&&qi(e,t,s)||(!n||n===f.MATHML)&&ji(e,t)}var zi="hidden",$i=8,Ji=3,E;(function(e){e[e.INITIAL=0]="INITIAL",e[e.BEFORE_HTML=1]="BEFORE_HTML",e[e.BEFORE_HEAD=2]="BEFORE_HEAD",e[e.IN_HEAD=3]="IN_HEAD",e[e.IN_HEAD_NO_SCRIPT=4]="IN_HEAD_NO_SCRIPT",e[e.AFTER_HEAD=5]="AFTER_HEAD",e[e.IN_BODY=6]="IN_BODY",e[e.TEXT=7]="TEXT",e[e.IN_TABLE=8]="IN_TABLE",e[e.IN_TABLE_TEXT=9]="IN_TABLE_TEXT",e[e.IN_CAPTION=10]="IN_CAPTION",e[e.IN_COLUMN_GROUP=11]="IN_COLUMN_GROUP",e[e.IN_TABLE_BODY=12]="IN_TABLE_BODY",e[e.IN_ROW=13]="IN_ROW",e[e.IN_CELL=14]="IN_CELL",e[e.IN_SELECT=15]="IN_SELECT",e[e.IN_SELECT_IN_TABLE=16]="IN_SELECT_IN_TABLE",e[e.IN_TEMPLATE=17]="IN_TEMPLATE",e[e.AFTER_BODY=18]="AFTER_BODY",e[e.IN_FRAMESET=19]="IN_FRAMESET",e[e.AFTER_FRAMESET=20]="AFTER_FRAMESET",e[e.AFTER_AFTER_BODY=21]="AFTER_AFTER_BODY",e[e.AFTER_AFTER_FRAMESET=22]="AFTER_AFTER_FRAMESET"})(E||(E={}));var Zi={startLine:-1,startCol:-1,startOffset:-1,endLine:-1,endCol:-1,endOffset:-1},Zr=new Set([r.TABLE,r.TBODY,r.TFOOT,r.THEAD,r.TR]),zr={scriptingEnabled:!0,sourceCodeLocationInfo:!1,treeAdapter:G,onParseError:null},fe=class{constructor(t,s,n=null,a=null){this.fragmentContext=n,this.scriptHandler=a,this.currentToken=null,this.stopped=!1,this.insertionMode=E.INITIAL,this.originalInsertionMode=E.INITIAL,this.headElement=null,this.formElement=null,this.currentNotInHTML=!1,this.tmplInsertionModeStack=[],this.pendingCharacterTokens=[],this.hasNonWhitespacePendingCharacterToken=!1,this.framesetOk=!0,this.skipNextNewLine=!1,this.fosterParentingEnabled=!1,this.options={...zr,...t},this.treeAdapter=this.options.treeAdapter,this.onParseError=this.options.onParseError,this.onParseError&&(this.options.sourceCodeLocationInfo=!0),this.document=s!=null?s:this.treeAdapter.createDocument(),this.tokenizer=new Be(this.options,this),this.activeFormattingElements=new It(this.treeAdapter),this.fragmentContextID=n?ee(this.treeAdapter.getTagName(n)):r.UNKNOWN,this._setContextModes(n!=null?n:this.document,this.fragmentContextID),this.openElements=new pt(this.document,this.treeAdapter,this)}static parse(t,s){let n=new this(s);return n.tokenizer.write(t,!0),n.document}static getFragmentParser(t,s){let n={...zr,...s};t!=null||(t=n.treeAdapter.createElement(h.TEMPLATE,f.HTML,[]));let a=n.treeAdapter.createElement("documentmock",f.HTML,[]),c=new this(n,a,t);return c.fragmentContextID===r.TEMPLATE&&c.tmplInsertionModeStack.unshift(E.IN_TEMPLATE),c._initTokenizerForFragmentParsing(),c._insertFakeRootElement(),c._resetInsertionMode(),c._findFormInFragmentContext(),c}getFragment(){let t=this.treeAdapter.getFirstChild(this.document),s=this.treeAdapter.createDocumentFragment();return this._adoptNodes(t,s),s}_err(t,s,n){var a;if(!this.onParseError)return;let c=(a=t.location)!==null&&a!==void 0?a:Zi,l={code:s,startLine:c.startLine,startCol:c.startCol,startOffset:c.startOffset,endLine:n?c.startLine:c.endLine,endCol:n?c.startCol:c.endCol,endOffset:n?c.startOffset:c.endOffset};this.onParseError(l)}onItemPush(t,s,n){var a,c;(c=(a=this.treeAdapter).onItemPush)===null||c===void 0||c.call(a,t),n&&this.openElements.stackTop>0&&this._setContextModes(t,s)}onItemPop(t,s){var n,a;if(this.options.sourceCodeLocationInfo&&this._setEndLocation(t,this.currentToken),(a=(n=this.treeAdapter).onItemPop)===null||a===void 0||a.call(n,t,this.openElements.current),s){let c,l;this.openElements.stackTop===0&&this.fragmentContext?(c=this.fragmentContext,l=this.fragmentContextID):{current:c,currentTagId:l}=this.openElements,this._setContextModes(c,l)}}_setContextModes(t,s){let n=t===this.document||this.treeAdapter.getNamespaceURI(t)===f.HTML;this.currentNotInHTML=!n,this.tokenizer.inForeignNode=!n&&!this._isIntegrationPoint(s,t)}_switchToTextParsing(t,s){this._insertElement(t,f.HTML),this.tokenizer.state=s,this.originalInsertionMode=this.insertionMode,this.insertionMode=E.TEXT}switchToPlaintextParsing(){this.insertionMode=E.TEXT,this.originalInsertionMode=E.IN_BODY,this.tokenizer.state=M.PLAINTEXT}_getAdjustedCurrentElement(){return this.openElements.stackTop===0&&this.fragmentContext?this.fragmentContext:this.openElements.current}_findFormInFragmentContext(){let t=this.fragmentContext;for(;t;){if(this.treeAdapter.getTagName(t)===h.FORM){this.formElement=t;break}t=this.treeAdapter.getParentNode(t)}}_initTokenizerForFragmentParsing(){if(!(!this.fragmentContext||this.treeAdapter.getNamespaceURI(this.fragmentContext)!==f.HTML))switch(this.fragmentContextID){case r.TITLE:case r.TEXTAREA:{this.tokenizer.state=M.RCDATA;break}case r.STYLE:case r.XMP:case r.IFRAME:case r.NOEMBED:case r.NOFRAMES:case r.NOSCRIPT:{this.tokenizer.state=M.RAWTEXT;break}case r.SCRIPT:{this.tokenizer.state=M.SCRIPT_DATA;break}case r.PLAINTEXT:{this.tokenizer.state=M.PLAINTEXT;break}default:}}_setDocumentType(t){let s=t.name||"",n=t.publicId||"",a=t.systemId||"";if(this.treeAdapter.setDocumentType(this.document,s,n,a),t.location){let l=this.treeAdapter.getChildNodes(this.document).find(T=>this.treeAdapter.isDocumentTypeNode(T));l&&this.treeAdapter.setNodeSourceCodeLocation(l,t.location)}}_attachElementToTree(t,s){if(this.options.sourceCodeLocationInfo){let n=s&&{...s,startTag:s};this.treeAdapter.setNodeSourceCodeLocation(t,n)}if(this._shouldFosterParentOnInsertion())this._fosterParentElement(t);else{let n=this.openElements.currentTmplContentOrNode;this.treeAdapter.appendChild(n,t)}}_appendElement(t,s){let n=this.treeAdapter.createElement(t.tagName,s,t.attrs);this._attachElementToTree(n,t.location)}_insertElement(t,s){let n=this.treeAdapter.createElement(t.tagName,s,t.attrs);this._attachElementToTree(n,t.location),this.openElements.push(n,t.tagID)}_insertFakeElement(t,s){let n=this.treeAdapter.createElement(t,f.HTML,[]);this._attachElementToTree(n,null),this.openElements.push(n,s)}_insertTemplate(t){let s=this.treeAdapter.createElement(t.tagName,f.HTML,t.attrs),n=this.treeAdapter.createDocumentFragment();this.treeAdapter.setTemplateContent(s,n),this._attachElementToTree(s,t.location),this.openElements.push(s,t.tagID),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(n,null)}_insertFakeRootElement(){let t=this.treeAdapter.createElement(h.HTML,f.HTML,[]);this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(t,null),this.treeAdapter.appendChild(this.openElements.current,t),this.openElements.push(t,r.HTML)}_appendCommentNode(t,s){let n=this.treeAdapter.createCommentNode(t.data);this.treeAdapter.appendChild(s,n),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(n,t.location)}_insertCharacters(t){let s,n;if(this._shouldFosterParentOnInsertion()?({parent:s,beforeElement:n}=this._findFosterParentingLocation(),n?this.treeAdapter.insertTextBefore(s,t.chars,n):this.treeAdapter.insertText(s,t.chars)):(s=this.openElements.currentTmplContentOrNode,this.treeAdapter.insertText(s,t.chars)),!t.location)return;let a=this.treeAdapter.getChildNodes(s),c=n?a.lastIndexOf(n):a.length,l=a[c-1];if(this.treeAdapter.getNodeSourceCodeLocation(l)){let{endLine:u,endCol:A,endOffset:_}=t.location;this.treeAdapter.updateNodeSourceCodeLocation(l,{endLine:u,endCol:A,endOffset:_})}else this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(l,t.location)}_adoptNodes(t,s){for(let n=this.treeAdapter.getFirstChild(t);n;n=this.treeAdapter.getFirstChild(t))this.treeAdapter.detachNode(n),this.treeAdapter.appendChild(s,n)}_setEndLocation(t,s){if(this.treeAdapter.getNodeSourceCodeLocation(t)&&s.location){let n=s.location,a=this.treeAdapter.getTagName(t),c=s.type===g.END_TAG&&a===s.tagName?{endTag:{...n},endLine:n.endLine,endCol:n.endCol,endOffset:n.endOffset}:{endLine:n.startLine,endCol:n.startCol,endOffset:n.startOffset};this.treeAdapter.updateNodeSourceCodeLocation(t,c)}}shouldProcessStartTagTokenInForeignContent(t){if(!this.currentNotInHTML)return!1;let s,n;return this.openElements.stackTop===0&&this.fragmentContext?(s=this.fragmentContext,n=this.fragmentContextID):{current:s,currentTagId:n}=this.openElements,t.tagID===r.SVG&&this.treeAdapter.getTagName(s)===h.ANNOTATION_XML&&this.treeAdapter.getNamespaceURI(s)===f.MATHML?!1:this.tokenizer.inForeignNode||(t.tagID===r.MGLYPH||t.tagID===r.MALIGNMARK)&&!this._isIntegrationPoint(n,s,f.HTML)}_processToken(t){switch(t.type){case g.CHARACTER:{this.onCharacter(t);break}case g.NULL_CHARACTER:{this.onNullCharacter(t);break}case g.COMMENT:{this.onComment(t);break}case g.DOCTYPE:{this.onDoctype(t);break}case g.START_TAG:{this._processStartTag(t);break}case g.END_TAG:{this.onEndTag(t);break}case g.EOF:{this.onEof(t);break}case g.WHITESPACE_CHARACTER:{this.onWhitespaceCharacter(t);break}}}_isIntegrationPoint(t,s,n){let a=this.treeAdapter.getNamespaceURI(s),c=this.treeAdapter.getAttrList(s);return Ts(t,a,c,n)}_reconstructActiveFormattingElements(){let t=this.activeFormattingElements.entries.length;if(t){let s=this.activeFormattingElements.entries.findIndex(a=>a.type===y.Marker||this.openElements.contains(a.element)),n=s<0?t-1:s-1;for(let a=n;a>=0;a--){let c=this.activeFormattingElements.entries[a];this._insertElement(c.token,this.treeAdapter.getNamespaceURI(c.element)),c.element=this.openElements.current}}}_closeTableCell(){this.openElements.generateImpliedEndTags(),this.openElements.popUntilTableCellPopped(),this.activeFormattingElements.clearToLastMarker(),this.insertionMode=E.IN_ROW}_closePElement(){this.openElements.generateImpliedEndTagsWithExclusion(r.P),this.openElements.popUntilTagNamePopped(r.P)}_resetInsertionMode(){for(let t=this.openElements.stackTop;t>=0;t--)switch(t===0&&this.fragmentContext?this.fragmentContextID:this.openElements.tagIDs[t]){case r.TR:{this.insertionMode=E.IN_ROW;return}case r.TBODY:case r.THEAD:case r.TFOOT:{this.insertionMode=E.IN_TABLE_BODY;return}case r.CAPTION:{this.insertionMode=E.IN_CAPTION;return}case r.COLGROUP:{this.insertionMode=E.IN_COLUMN_GROUP;return}case r.TABLE:{this.insertionMode=E.IN_TABLE;return}case r.BODY:{this.insertionMode=E.IN_BODY;return}case r.FRAMESET:{this.insertionMode=E.IN_FRAMESET;return}case r.SELECT:{this._resetInsertionModeForSelect(t);return}case r.TEMPLATE:{this.insertionMode=this.tmplInsertionModeStack[0];return}case r.HTML:{this.insertionMode=this.headElement?E.AFTER_HEAD:E.BEFORE_HEAD;return}case r.TD:case r.TH:{if(t>0){this.insertionMode=E.IN_CELL;return}break}case r.HEAD:{if(t>0){this.insertionMode=E.IN_HEAD;return}break}}this.insertionMode=E.IN_BODY}_resetInsertionModeForSelect(t){if(t>0)for(let s=t-1;s>0;s--){let n=this.openElements.tagIDs[s];if(n===r.TEMPLATE)break;if(n===r.TABLE){this.insertionMode=E.IN_SELECT_IN_TABLE;return}}this.insertionMode=E.IN_SELECT}_isElementCausesFosterParenting(t){return Zr.has(t)}_shouldFosterParentOnInsertion(){return this.fosterParentingEnabled&&this._isElementCausesFosterParenting(this.openElements.currentTagId)}_findFosterParentingLocation(){for(let t=this.openElements.stackTop;t>=0;t--){let s=this.openElements.items[t];switch(this.openElements.tagIDs[t]){case r.TEMPLATE:{if(this.treeAdapter.getNamespaceURI(s)===f.HTML)return{parent:this.treeAdapter.getTemplateContent(s),beforeElement:null};break}case r.TABLE:{let n=this.treeAdapter.getParentNode(s);return n?{parent:n,beforeElement:s}:{parent:this.openElements.items[t-1],beforeElement:null}}default:}}return{parent:this.openElements.items[0],beforeElement:null}}_fosterParentElement(t){let s=this._findFosterParentingLocation();s.beforeElement?this.treeAdapter.insertBefore(s.parent,t,s.beforeElement):this.treeAdapter.appendChild(s.parent,t)}_isSpecialElement(t,s){let n=this.treeAdapter.getNamespaceURI(t);return os[n].has(s)}onCharacter(t){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){Pc(this,t);return}switch(this.insertionMode){case E.INITIAL:{He(this,t);break}case E.BEFORE_HTML:{Fe(this,t);break}case E.BEFORE_HEAD:{xe(this,t);break}case E.IN_HEAD:{ye(this,t);break}case E.IN_HEAD_NO_SCRIPT:{we(this,t);break}case E.AFTER_HEAD:{ve(this,t);break}case E.IN_BODY:case E.IN_CAPTION:case E.IN_CELL:case E.IN_TEMPLATE:{tn(this,t);break}case E.TEXT:case E.IN_SELECT:case E.IN_SELECT_IN_TABLE:{this._insertCharacters(t);break}case E.IN_TABLE:case E.IN_TABLE_BODY:case E.IN_ROW:{us(this,t);break}case E.IN_TABLE_TEXT:{cn(this,t);break}case E.IN_COLUMN_GROUP:{Lt(this,t);break}case E.AFTER_BODY:{St(this,t);break}case E.AFTER_AFTER_BODY:{Ot(this,t);break}default:}}onNullCharacter(t){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){bc(this,t);return}switch(this.insertionMode){case E.INITIAL:{He(this,t);break}case E.BEFORE_HTML:{Fe(this,t);break}case E.BEFORE_HEAD:{xe(this,t);break}case E.IN_HEAD:{ye(this,t);break}case E.IN_HEAD_NO_SCRIPT:{we(this,t);break}case E.AFTER_HEAD:{ve(this,t);break}case E.TEXT:{this._insertCharacters(t);break}case E.IN_TABLE:case E.IN_TABLE_BODY:case E.IN_ROW:{us(this,t);break}case E.IN_COLUMN_GROUP:{Lt(this,t);break}case E.AFTER_BODY:{St(this,t);break}case E.AFTER_AFTER_BODY:{Ot(this,t);break}default:}}onComment(t){if(this.skipNextNewLine=!1,this.currentNotInHTML){ds(this,t);return}switch(this.insertionMode){case E.INITIAL:case E.BEFORE_HTML:case E.BEFORE_HEAD:case E.IN_HEAD:case E.IN_HEAD_NO_SCRIPT:case E.AFTER_HEAD:case E.IN_BODY:case E.IN_TABLE:case E.IN_CAPTION:case E.IN_COLUMN_GROUP:case E.IN_TABLE_BODY:case E.IN_ROW:case E.IN_CELL:case E.IN_SELECT:case E.IN_SELECT_IN_TABLE:case E.IN_TEMPLATE:case E.IN_FRAMESET:case E.AFTER_FRAMESET:{ds(this,t);break}case E.IN_TABLE_TEXT:{Ue(this,t);break}case E.AFTER_BODY:{io(this,t);break}case E.AFTER_AFTER_BODY:case E.AFTER_AFTER_FRAMESET:{oo(this,t);break}default:}}onDoctype(t){switch(this.skipNextNewLine=!1,this.insertionMode){case E.INITIAL:{co(this,t);break}case E.BEFORE_HEAD:case E.IN_HEAD:case E.IN_HEAD_NO_SCRIPT:case E.AFTER_HEAD:{this._err(t,d.misplacedDoctype);break}case E.IN_TABLE_TEXT:{Ue(this,t);break}default:}}onStartTag(t){this.skipNextNewLine=!1,this.currentToken=t,this._processStartTag(t),t.selfClosing&&!t.ackSelfClosing&&this._err(t,d.nonVoidHtmlElementStartTagWithTrailingSolidus)}_processStartTag(t){this.shouldProcessStartTagTokenInForeignContent(t)?Mc(this,t):this._startTagOutsideForeignContent(t)}_startTagOutsideForeignContent(t){switch(this.insertionMode){case E.INITIAL:{He(this,t);break}case E.BEFORE_HTML:{Eo(this,t);break}case E.BEFORE_HEAD:{ho(this,t);break}case E.IN_HEAD:{Y(this,t);break}case E.IN_HEAD_NO_SCRIPT:{fo(this,t);break}case E.AFTER_HEAD:{_o(this,t);break}case E.IN_BODY:{B(this,t);break}case E.IN_TABLE:{me(this,t);break}case E.IN_TABLE_TEXT:{Ue(this,t);break}case E.IN_CAPTION:{uc(this,t);break}case E.IN_COLUMN_GROUP:{As(this,t);break}case E.IN_TABLE_BODY:{Pt(this,t);break}case E.IN_ROW:{Mt(this,t);break}case E.IN_CELL:{mc(this,t);break}case E.IN_SELECT:{hn(this,t);break}case E.IN_SELECT_IN_TABLE:{Ac(this,t);break}case E.IN_TEMPLATE:{pc(this,t);break}case E.AFTER_BODY:{Nc(this,t);break}case E.IN_FRAMESET:{Rc(this,t);break}case E.AFTER_FRAMESET:{Oc(this,t);break}case E.AFTER_AFTER_BODY:{Sc(this,t);break}case E.AFTER_AFTER_FRAMESET:{Dc(this,t);break}default:}}onEndTag(t){this.skipNextNewLine=!1,this.currentToken=t,this.currentNotInHTML?Bc(this,t):this._endTagOutsideForeignContent(t)}_endTagOutsideForeignContent(t){switch(this.insertionMode){case E.INITIAL:{He(this,t);break}case E.BEFORE_HTML:{lo(this,t);break}case E.BEFORE_HEAD:{To(this,t);break}case E.IN_HEAD:{uo(this,t);break}case E.IN_HEAD_NO_SCRIPT:{mo(this,t);break}case E.AFTER_HEAD:{Ao(this,t);break}case E.IN_BODY:{bt(this,t);break}case E.TEXT:{rc(this,t);break}case E.IN_TABLE:{Ye(this,t);break}case E.IN_TABLE_TEXT:{Ue(this,t);break}case E.IN_CAPTION:{dc(this,t);break}case E.IN_COLUMN_GROUP:{fc(this,t);break}case E.IN_TABLE_BODY:{fs(this,t);break}case E.IN_ROW:{ln(this,t);break}case E.IN_CELL:{_c(this,t);break}case E.IN_SELECT:{Tn(this,t);break}case E.IN_SELECT_IN_TABLE:{Cc(this,t);break}case E.IN_TEMPLATE:{Ic(this,t);break}case E.AFTER_BODY:{dn(this,t);break}case E.IN_FRAMESET:{gc(this,t);break}case E.AFTER_FRAMESET:{Lc(this,t);break}case E.AFTER_AFTER_BODY:{Ot(this,t);break}default:}}onEof(t){switch(this.insertionMode){case E.INITIAL:{He(this,t);break}case E.BEFORE_HTML:{Fe(this,t);break}case E.BEFORE_HEAD:{xe(this,t);break}case E.IN_HEAD:{ye(this,t);break}case E.IN_HEAD_NO_SCRIPT:{we(this,t);break}case E.AFTER_HEAD:{ve(this,t);break}case E.IN_BODY:case E.IN_TABLE:case E.IN_CAPTION:case E.IN_COLUMN_GROUP:case E.IN_TABLE_BODY:case E.IN_ROW:case E.IN_CELL:case E.IN_SELECT:case E.IN_SELECT_IN_TABLE:{an(this,t);break}case E.TEXT:{nc(this,t);break}case E.IN_TABLE_TEXT:{Ue(this,t);break}case E.IN_TEMPLATE:{un(this,t);break}case E.AFTER_BODY:case E.IN_FRAMESET:case E.AFTER_FRAMESET:case E.AFTER_AFTER_BODY:case E.AFTER_AFTER_FRAMESET:{_s(this,t);break}default:}}onWhitespaceCharacter(t){if(this.skipNextNewLine&&(this.skipNextNewLine=!1,t.chars.charCodeAt(0)===i.LINE_FEED)){if(t.chars.length===1)return;t.chars=t.chars.substr(1)}if(this.tokenizer.inForeignNode){this._insertCharacters(t);return}switch(this.insertionMode){case E.IN_HEAD:case E.IN_HEAD_NO_SCRIPT:case E.AFTER_HEAD:case E.TEXT:case E.IN_COLUMN_GROUP:case E.IN_SELECT:case E.IN_SELECT_IN_TABLE:case E.IN_FRAMESET:case E.AFTER_FRAMESET:{this._insertCharacters(t);break}case E.IN_BODY:case E.IN_CAPTION:case E.IN_CELL:case E.IN_TEMPLATE:case E.AFTER_BODY:case E.AFTER_AFTER_BODY:case E.AFTER_AFTER_FRAMESET:{en(this,t);break}case E.IN_TABLE:case E.IN_TABLE_BODY:case E.IN_ROW:{us(this,t);break}case E.IN_TABLE_TEXT:{on(this,t);break}default:}}};function eo(e,t){let s=e.activeFormattingElements.getElementEntryInScopeWithTagName(t.tagName);return s?e.openElements.contains(s.element)?e.openElements.hasInScope(t.tagID)||(s=null):(e.activeFormattingElements.removeEntry(s),s=null):nn(e,t),s}function to(e,t){let s=null,n=e.openElements.stackTop;for(;n>=0;n--){let a=e.openElements.items[n];if(a===t.element)break;e._isSpecialElement(a,e.openElements.tagIDs[n])&&(s=a)}return s||(e.openElements.shortenToLength(n<0?0:n),e.activeFormattingElements.removeEntry(t)),s}function so(e,t,s){let n=t,a=e.openElements.getCommonAncestor(t);for(let c=0,l=a;l!==s;c++,l=a){a=e.openElements.getCommonAncestor(l);let T=e.activeFormattingElements.getElementEntry(l),u=T&&c>=Ji;!T||u?(u&&e.activeFormattingElements.removeEntry(T),e.openElements.remove(l)):(l=ro(e,T),n===t&&(e.activeFormattingElements.bookmark=T),e.treeAdapter.detachNode(n),e.treeAdapter.appendChild(l,n),n=l)}return n}function ro(e,t){let s=e.treeAdapter.getNamespaceURI(t.element),n=e.treeAdapter.createElement(t.token.tagName,s,t.token.attrs);return e.openElements.replace(t.element,n),t.element=n,n}function no(e,t,s){let n=e.treeAdapter.getTagName(t),a=ee(n);if(e._isElementCausesFosterParenting(a))e._fosterParentElement(s);else{let c=e.treeAdapter.getNamespaceURI(t);a===r.TEMPLATE&&c===f.HTML&&(t=e.treeAdapter.getTemplateContent(t)),e.treeAdapter.appendChild(t,s)}}function ao(e,t,s){let n=e.treeAdapter.getNamespaceURI(s.element),{token:a}=s,c=e.treeAdapter.createElement(a.tagName,n,a.attrs);e._adoptNodes(t,c),e.treeAdapter.appendChild(t,c),e.activeFormattingElements.insertElementAfterBookmark(c,a),e.activeFormattingElements.removeEntry(s),e.openElements.remove(s.element),e.openElements.insertAfter(t,c,a.tagID)}function ms(e,t){for(let s=0;s<$i;s++){let n=eo(e,t);if(!n)break;let a=to(e,n);if(!a)break;e.activeFormattingElements.bookmark=n;let c=so(e,a,n.element),l=e.openElements.getCommonAncestor(n.element);e.treeAdapter.detachNode(c),l&&no(e,l,c),ao(e,a,n)}}function ds(e,t){e._appendCommentNode(t,e.openElements.currentTmplContentOrNode)}function io(e,t){e._appendCommentNode(t,e.openElements.items[0])}function oo(e,t){e._appendCommentNode(t,e.document)}function _s(e,t){if(e.stopped=!0,t.location){let s=e.fragmentContext?0:2;for(let n=e.openElements.stackTop;n>=s;n--)e._setEndLocation(e.openElements.items[n],t);if(!e.fragmentContext&&e.openElements.stackTop>=0){let n=e.openElements.items[0],a=e.treeAdapter.getNodeSourceCodeLocation(n);if(a&&!a.endTag&&(e._setEndLocation(n,t),e.openElements.stackTop>=1)){let c=e.openElements.items[1],l=e.treeAdapter.getNodeSourceCodeLocation(c);l&&!l.endTag&&e._setEndLocation(c,t)}}}}function co(e,t){e._setDocumentType(t);let s=t.forceQuirks?P.QUIRKS:Vr(t);Kr(t)||e._err(t,d.nonConformingDoctype),e.treeAdapter.setDocumentMode(e.document,s),e.insertionMode=E.BEFORE_HTML}function He(e,t){e._err(t,d.missingDoctype,!0),e.treeAdapter.setDocumentMode(e.document,P.QUIRKS),e.insertionMode=E.BEFORE_HTML,e._processToken(t)}function Eo(e,t){t.tagID===r.HTML?(e._insertElement(t,f.HTML),e.insertionMode=E.BEFORE_HEAD):Fe(e,t)}function lo(e,t){let s=t.tagID;(s===r.HTML||s===r.HEAD||s===r.BODY||s===r.BR)&&Fe(e,t)}function Fe(e,t){e._insertFakeRootElement(),e.insertionMode=E.BEFORE_HEAD,e._processToken(t)}function ho(e,t){switch(t.tagID){case r.HTML:{B(e,t);break}case r.HEAD:{e._insertElement(t,f.HTML),e.headElement=e.openElements.current,e.insertionMode=E.IN_HEAD;break}default:xe(e,t)}}function To(e,t){let s=t.tagID;s===r.HEAD||s===r.BODY||s===r.HTML||s===r.BR?xe(e,t):e._err(t,d.endTagWithoutMatchingOpenElement)}function xe(e,t){e._insertFakeElement(h.HEAD,r.HEAD),e.headElement=e.openElements.current,e.insertionMode=E.IN_HEAD,e._processToken(t)}function Y(e,t){switch(t.tagID){case r.HTML:{B(e,t);break}case r.BASE:case r.BASEFONT:case r.BGSOUND:case r.LINK:case r.META:{e._appendElement(t,f.HTML),t.ackSelfClosing=!0;break}case r.TITLE:{e._switchToTextParsing(t,M.RCDATA);break}case r.NOSCRIPT:{e.options.scriptingEnabled?e._switchToTextParsing(t,M.RAWTEXT):(e._insertElement(t,f.HTML),e.insertionMode=E.IN_HEAD_NO_SCRIPT);break}case r.NOFRAMES:case r.STYLE:{e._switchToTextParsing(t,M.RAWTEXT);break}case r.SCRIPT:{e._switchToTextParsing(t,M.SCRIPT_DATA);break}case r.TEMPLATE:{e._insertTemplate(t),e.activeFormattingElements.insertMarker(),e.framesetOk=!1,e.insertionMode=E.IN_TEMPLATE,e.tmplInsertionModeStack.unshift(E.IN_TEMPLATE);break}case r.HEAD:{e._err(t,d.misplacedStartTagForHeadElement);break}default:ye(e,t)}}function uo(e,t){switch(t.tagID){case r.HEAD:{e.openElements.pop(),e.insertionMode=E.AFTER_HEAD;break}case r.BODY:case r.BR:case r.HTML:{ye(e,t);break}case r.TEMPLATE:{ie(e,t);break}default:e._err(t,d.endTagWithoutMatchingOpenElement)}}function ie(e,t){e.openElements.tmplCount>0?(e.openElements.generateImpliedEndTagsThoroughly(),e.openElements.currentTagId!==r.TEMPLATE&&e._err(t,d.closingOfElementWithOpenChildElements),e.openElements.popUntilTagNamePopped(r.TEMPLATE),e.activeFormattingElements.clearToLastMarker(),e.tmplInsertionModeStack.shift(),e._resetInsertionMode()):e._err(t,d.endTagWithoutMatchingOpenElement)}function ye(e,t){e.openElements.pop(),e.insertionMode=E.AFTER_HEAD,e._processToken(t)}function fo(e,t){switch(t.tagID){case r.HTML:{B(e,t);break}case r.BASEFONT:case r.BGSOUND:case r.HEAD:case r.LINK:case r.META:case r.NOFRAMES:case r.STYLE:{Y(e,t);break}case r.NOSCRIPT:{e._err(t,d.nestedNoscriptInHead);break}default:we(e,t)}}function mo(e,t){switch(t.tagID){case r.NOSCRIPT:{e.openElements.pop(),e.insertionMode=E.IN_HEAD;break}case r.BR:{we(e,t);break}default:e._err(t,d.endTagWithoutMatchingOpenElement)}}function we(e,t){let s=t.type===g.EOF?d.openElementsLeftAfterEof:d.disallowedContentInNoscriptInHead;e._err(t,s),e.openElements.pop(),e.insertionMode=E.IN_HEAD,e._processToken(t)}function _o(e,t){switch(t.tagID){case r.HTML:{B(e,t);break}case r.BODY:{e._insertElement(t,f.HTML),e.framesetOk=!1,e.insertionMode=E.IN_BODY;break}case r.FRAMESET:{e._insertElement(t,f.HTML),e.insertionMode=E.IN_FRAMESET;break}case r.BASE:case r.BASEFONT:case r.BGSOUND:case r.LINK:case r.META:case r.NOFRAMES:case r.SCRIPT:case r.STYLE:case r.TEMPLATE:case r.TITLE:{e._err(t,d.abandonedHeadElementChild),e.openElements.push(e.headElement,r.HEAD),Y(e,t),e.openElements.remove(e.headElement);break}case r.HEAD:{e._err(t,d.misplacedStartTagForHeadElement);break}default:ve(e,t)}}function Ao(e,t){switch(t.tagID){case r.BODY:case r.HTML:case r.BR:{ve(e,t);break}case r.TEMPLATE:{ie(e,t);break}default:e._err(t,d.endTagWithoutMatchingOpenElement)}}function ve(e,t){e._insertFakeElement(h.BODY,r.BODY),e.insertionMode=E.IN_BODY,Dt(e,t)}function Dt(e,t){switch(t.type){case g.CHARACTER:{tn(e,t);break}case g.WHITESPACE_CHARACTER:{en(e,t);break}case g.COMMENT:{ds(e,t);break}case g.START_TAG:{B(e,t);break}case g.END_TAG:{bt(e,t);break}case g.EOF:{an(e,t);break}default:}}function en(e,t){e._reconstructActiveFormattingElements(),e._insertCharacters(t)}function tn(e,t){e._reconstructActiveFormattingElements(),e._insertCharacters(t),e.framesetOk=!1}function Co(e,t){e.openElements.tmplCount===0&&e.treeAdapter.adoptAttributes(e.openElements.items[0],t.attrs)}function po(e,t){let s=e.openElements.tryPeekProperlyNestedBodyElement();s&&e.openElements.tmplCount===0&&(e.framesetOk=!1,e.treeAdapter.adoptAttributes(s,t.attrs))}function Io(e,t){let s=e.openElements.tryPeekProperlyNestedBodyElement();e.framesetOk&&s&&(e.treeAdapter.detachNode(s),e.openElements.popAllUpToHtmlElement(),e._insertElement(t,f.HTML),e.insertionMode=E.IN_FRAMESET)}function No(e,t){e.openElements.hasInButtonScope(r.P)&&e._closePElement(),e._insertElement(t,f.HTML)}function Ro(e,t){e.openElements.hasInButtonScope(r.P)&&e._closePElement(),De(e.openElements.currentTagId)&&e.openElements.pop(),e._insertElement(t,f.HTML)}function go(e,t){e.openElements.hasInButtonScope(r.P)&&e._closePElement(),e._insertElement(t,f.HTML),e.skipNextNewLine=!0,e.framesetOk=!1}function Oo(e,t){let s=e.openElements.tmplCount>0;(!e.formElement||s)&&(e.openElements.hasInButtonScope(r.P)&&e._closePElement(),e._insertElement(t,f.HTML),s||(e.formElement=e.openElements.current))}function Lo(e,t){e.framesetOk=!1;let s=t.tagID;for(let n=e.openElements.stackTop;n>=0;n--){let a=e.openElements.tagIDs[n];if(s===r.LI&&a===r.LI||(s===r.DD||s===r.DT)&&(a===r.DD||a===r.DT)){e.openElements.generateImpliedEndTagsWithExclusion(a),e.openElements.popUntilTagNamePopped(a);break}if(a!==r.ADDRESS&&a!==r.DIV&&a!==r.P&&e._isSpecialElement(e.openElements.items[n],a))break}e.openElements.hasInButtonScope(r.P)&&e._closePElement(),e._insertElement(t,f.HTML)}function So(e,t){e.openElements.hasInButtonScope(r.P)&&e._closePElement(),e._insertElement(t,f.HTML),e.tokenizer.state=M.PLAINTEXT}function Do(e,t){e.openElements.hasInScope(r.BUTTON)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(r.BUTTON)),e._reconstructActiveFormattingElements(),e._insertElement(t,f.HTML),e.framesetOk=!1}function bo(e,t){let s=e.activeFormattingElements.getElementEntryInScopeWithTagName(h.A);s&&(ms(e,t),e.openElements.remove(s.element),e.activeFormattingElements.removeEntry(s)),e._reconstructActiveFormattingElements(),e._insertElement(t,f.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function Po(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,f.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function Mo(e,t){e._reconstructActiveFormattingElements(),e.openElements.hasInScope(r.NOBR)&&(ms(e,t),e._reconstructActiveFormattingElements()),e._insertElement(t,f.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function Bo(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,f.HTML),e.activeFormattingElements.insertMarker(),e.framesetOk=!1}function ko(e,t){e.treeAdapter.getDocumentMode(e.document)!==P.QUIRKS&&e.openElements.hasInButtonScope(r.P)&&e._closePElement(),e._insertElement(t,f.HTML),e.framesetOk=!1,e.insertionMode=E.IN_TABLE}function sn(e,t){e._reconstructActiveFormattingElements(),e._appendElement(t,f.HTML),e.framesetOk=!1,t.ackSelfClosing=!0}function rn(e){let t=Se(e,v.TYPE);return t!=null&&t.toLowerCase()===zi}function Ho(e,t){e._reconstructActiveFormattingElements(),e._appendElement(t,f.HTML),rn(t)||(e.framesetOk=!1),t.ackSelfClosing=!0}function Uo(e,t){e._appendElement(t,f.HTML),t.ackSelfClosing=!0}function Fo(e,t){e.openElements.hasInButtonScope(r.P)&&e._closePElement(),e._appendElement(t,f.HTML),e.framesetOk=!1,t.ackSelfClosing=!0}function xo(e,t){t.tagName=h.IMG,t.tagID=r.IMG,sn(e,t)}function yo(e,t){e._insertElement(t,f.HTML),e.skipNextNewLine=!0,e.tokenizer.state=M.RCDATA,e.originalInsertionMode=e.insertionMode,e.framesetOk=!1,e.insertionMode=E.TEXT}function wo(e,t){e.openElements.hasInButtonScope(r.P)&&e._closePElement(),e._reconstructActiveFormattingElements(),e.framesetOk=!1,e._switchToTextParsing(t,M.RAWTEXT)}function vo(e,t){e.framesetOk=!1,e._switchToTextParsing(t,M.RAWTEXT)}function $r(e,t){e._switchToTextParsing(t,M.RAWTEXT)}function Yo(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,f.HTML),e.framesetOk=!1,e.insertionMode=e.insertionMode===E.IN_TABLE||e.insertionMode===E.IN_CAPTION||e.insertionMode===E.IN_TABLE_BODY||e.insertionMode===E.IN_ROW||e.insertionMode===E.IN_CELL?E.IN_SELECT_IN_TABLE:E.IN_SELECT}function Qo(e,t){e.openElements.currentTagId===r.OPTION&&e.openElements.pop(),e._reconstructActiveFormattingElements(),e._insertElement(t,f.HTML)}function Wo(e,t){e.openElements.hasInScope(r.RUBY)&&e.openElements.generateImpliedEndTags(),e._insertElement(t,f.HTML)}function Go(e,t){e.openElements.hasInScope(r.RUBY)&&e.openElements.generateImpliedEndTagsWithExclusion(r.RTC),e._insertElement(t,f.HTML)}function Xo(e,t){e._reconstructActiveFormattingElements(),Nt(t),ke(t),t.selfClosing?e._appendElement(t,f.MATHML):e._insertElement(t,f.MATHML),t.ackSelfClosing=!0}function Ko(e,t){e._reconstructActiveFormattingElements(),Rt(t),ke(t),t.selfClosing?e._appendElement(t,f.SVG):e._insertElement(t,f.SVG),t.ackSelfClosing=!0}function Jr(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,f.HTML)}function B(e,t){switch(t.tagID){case r.I:case r.S:case r.B:case r.U:case r.EM:case r.TT:case r.BIG:case r.CODE:case r.FONT:case r.SMALL:case r.STRIKE:case r.STRONG:{Po(e,t);break}case r.A:{bo(e,t);break}case r.H1:case r.H2:case r.H3:case r.H4:case r.H5:case r.H6:{Ro(e,t);break}case r.P:case r.DL:case r.OL:case r.UL:case r.DIV:case r.DIR:case r.NAV:case r.MAIN:case r.MENU:case r.ASIDE:case r.CENTER:case r.FIGURE:case r.FOOTER:case r.HEADER:case r.HGROUP:case r.DIALOG:case r.DETAILS:case r.ADDRESS:case r.ARTICLE:case r.SECTION:case r.SUMMARY:case r.FIELDSET:case r.BLOCKQUOTE:case r.FIGCAPTION:{No(e,t);break}case r.LI:case r.DD:case r.DT:{Lo(e,t);break}case r.BR:case r.IMG:case r.WBR:case r.AREA:case r.EMBED:case r.KEYGEN:{sn(e,t);break}case r.HR:{Fo(e,t);break}case r.RB:case r.RTC:{Wo(e,t);break}case r.RT:case r.RP:{Go(e,t);break}case r.PRE:case r.LISTING:{go(e,t);break}case r.XMP:{wo(e,t);break}case r.SVG:{Ko(e,t);break}case r.HTML:{Co(e,t);break}case r.BASE:case r.LINK:case r.META:case r.STYLE:case r.TITLE:case r.SCRIPT:case r.BGSOUND:case r.BASEFONT:case r.TEMPLATE:{Y(e,t);break}case r.BODY:{po(e,t);break}case r.FORM:{Oo(e,t);break}case r.NOBR:{Mo(e,t);break}case r.MATH:{Xo(e,t);break}case r.TABLE:{ko(e,t);break}case r.INPUT:{Ho(e,t);break}case r.PARAM:case r.TRACK:case r.SOURCE:{Uo(e,t);break}case r.IMAGE:{xo(e,t);break}case r.BUTTON:{Do(e,t);break}case r.APPLET:case r.OBJECT:case r.MARQUEE:{Bo(e,t);break}case r.IFRAME:{vo(e,t);break}case r.SELECT:{Yo(e,t);break}case r.OPTION:case r.OPTGROUP:{Qo(e,t);break}case r.NOEMBED:{$r(e,t);break}case r.FRAMESET:{Io(e,t);break}case r.TEXTAREA:{yo(e,t);break}case r.NOSCRIPT:{e.options.scriptingEnabled?$r(e,t):Jr(e,t);break}case r.PLAINTEXT:{So(e,t);break}case r.COL:case r.TH:case r.TD:case r.TR:case r.HEAD:case r.FRAME:case r.TBODY:case r.TFOOT:case r.THEAD:case r.CAPTION:case r.COLGROUP:break;default:Jr(e,t)}}function Vo(e,t){if(e.openElements.hasInScope(r.BODY)&&(e.insertionMode=E.AFTER_BODY,e.options.sourceCodeLocationInfo)){let s=e.openElements.tryPeekProperlyNestedBodyElement();s&&e._setEndLocation(s,t)}}function jo(e,t){e.openElements.hasInScope(r.BODY)&&(e.insertionMode=E.AFTER_BODY,dn(e,t))}function qo(e,t){let s=t.tagID;e.openElements.hasInScope(s)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(s))}function zo(e){let t=e.openElements.tmplCount>0,{formElement:s}=e;t||(e.formElement=null),(s||t)&&e.openElements.hasInScope(r.FORM)&&(e.openElements.generateImpliedEndTags(),t?e.openElements.popUntilTagNamePopped(r.FORM):s&&e.openElements.remove(s))}function $o(e){e.openElements.hasInButtonScope(r.P)||e._insertFakeElement(h.P,r.P),e._closePElement()}function Jo(e){e.openElements.hasInListItemScope(r.LI)&&(e.openElements.generateImpliedEndTagsWithExclusion(r.LI),e.openElements.popUntilTagNamePopped(r.LI))}function Zo(e,t){let s=t.tagID;e.openElements.hasInScope(s)&&(e.openElements.generateImpliedEndTagsWithExclusion(s),e.openElements.popUntilTagNamePopped(s))}function ec(e){e.openElements.hasNumberedHeaderInScope()&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilNumberedHeaderPopped())}function tc(e,t){let s=t.tagID;e.openElements.hasInScope(s)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(s),e.activeFormattingElements.clearToLastMarker())}function sc(e){e._reconstructActiveFormattingElements(),e._insertFakeElement(h.BR,r.BR),e.openElements.pop(),e.framesetOk=!1}function nn(e,t){let s=t.tagName,n=t.tagID;for(let a=e.openElements.stackTop;a>0;a--){let c=e.openElements.items[a],l=e.openElements.tagIDs[a];if(n===l&&(n!==r.UNKNOWN||e.treeAdapter.getTagName(c)===s)){e.openElements.generateImpliedEndTagsWithExclusion(n),e.openElements.stackTop>=a&&e.openElements.shortenToLength(a);break}if(e._isSpecialElement(c,l))break}}function bt(e,t){switch(t.tagID){case r.A:case r.B:case r.I:case r.S:case r.U:case r.EM:case r.TT:case r.BIG:case r.CODE:case r.FONT:case r.NOBR:case r.SMALL:case r.STRIKE:case r.STRONG:{ms(e,t);break}case r.P:{$o(e);break}case r.DL:case r.UL:case r.OL:case r.DIR:case r.DIV:case r.NAV:case r.PRE:case r.MAIN:case r.MENU:case r.ASIDE:case r.BUTTON:case r.CENTER:case r.FIGURE:case r.FOOTER:case r.HEADER:case r.HGROUP:case r.DIALOG:case r.ADDRESS:case r.ARTICLE:case r.DETAILS:case r.SECTION:case r.SUMMARY:case r.LISTING:case r.FIELDSET:case r.BLOCKQUOTE:case r.FIGCAPTION:{qo(e,t);break}case r.LI:{Jo(e);break}case r.DD:case r.DT:{Zo(e,t);break}case r.H1:case r.H2:case r.H3:case r.H4:case r.H5:case r.H6:{ec(e);break}case r.BR:{sc(e);break}case r.BODY:{Vo(e,t);break}case r.HTML:{jo(e,t);break}case r.FORM:{zo(e);break}case r.APPLET:case r.OBJECT:case r.MARQUEE:{tc(e,t);break}case r.TEMPLATE:{ie(e,t);break}default:nn(e,t)}}function an(e,t){e.tmplInsertionModeStack.length>0?un(e,t):_s(e,t)}function rc(e,t){var s;t.tagID===r.SCRIPT&&((s=e.scriptHandler)===null||s===void 0||s.call(e,e.openElements.current)),e.openElements.pop(),e.insertionMode=e.originalInsertionMode}function nc(e,t){e._err(t,d.eofInElementThatCanContainOnlyText),e.openElements.pop(),e.insertionMode=e.originalInsertionMode,e.onEof(t)}function us(e,t){if(Zr.has(e.openElements.currentTagId))switch(e.pendingCharacterTokens.length=0,e.hasNonWhitespacePendingCharacterToken=!1,e.originalInsertionMode=e.insertionMode,e.insertionMode=E.IN_TABLE_TEXT,t.type){case g.CHARACTER:{cn(e,t);break}case g.WHITESPACE_CHARACTER:{on(e,t);break}}else Qe(e,t)}function ac(e,t){e.openElements.clearBackToTableContext(),e.activeFormattingElements.insertMarker(),e._insertElement(t,f.HTML),e.insertionMode=E.IN_CAPTION}function ic(e,t){e.openElements.clearBackToTableContext(),e._insertElement(t,f.HTML),e.insertionMode=E.IN_COLUMN_GROUP}function oc(e,t){e.openElements.clearBackToTableContext(),e._insertFakeElement(h.COLGROUP,r.COLGROUP),e.insertionMode=E.IN_COLUMN_GROUP,As(e,t)}function cc(e,t){e.openElements.clearBackToTableContext(),e._insertElement(t,f.HTML),e.insertionMode=E.IN_TABLE_BODY}function Ec(e,t){e.openElements.clearBackToTableContext(),e._insertFakeElement(h.TBODY,r.TBODY),e.insertionMode=E.IN_TABLE_BODY,Pt(e,t)}function lc(e,t){e.openElements.hasInTableScope(r.TABLE)&&(e.openElements.popUntilTagNamePopped(r.TABLE),e._resetInsertionMode(),e._processStartTag(t))}function hc(e,t){rn(t)?e._appendElement(t,f.HTML):Qe(e,t),t.ackSelfClosing=!0}function Tc(e,t){!e.formElement&&e.openElements.tmplCount===0&&(e._insertElement(t,f.HTML),e.formElement=e.openElements.current,e.openElements.pop())}function me(e,t){switch(t.tagID){case r.TD:case r.TH:case r.TR:{Ec(e,t);break}case r.STYLE:case r.SCRIPT:case r.TEMPLATE:{Y(e,t);break}case r.COL:{oc(e,t);break}case r.FORM:{Tc(e,t);break}case r.TABLE:{lc(e,t);break}case r.TBODY:case r.TFOOT:case r.THEAD:{cc(e,t);break}case r.INPUT:{hc(e,t);break}case r.CAPTION:{ac(e,t);break}case r.COLGROUP:{ic(e,t);break}default:Qe(e,t)}}function Ye(e,t){switch(t.tagID){case r.TABLE:{e.openElements.hasInTableScope(r.TABLE)&&(e.openElements.popUntilTagNamePopped(r.TABLE),e._resetInsertionMode());break}case r.TEMPLATE:{ie(e,t);break}case r.BODY:case r.CAPTION:case r.COL:case r.COLGROUP:case r.HTML:case r.TBODY:case r.TD:case r.TFOOT:case r.TH:case r.THEAD:case r.TR:break;default:Qe(e,t)}}function Qe(e,t){let s=e.fosterParentingEnabled;e.fosterParentingEnabled=!0,Dt(e,t),e.fosterParentingEnabled=s}function on(e,t){e.pendingCharacterTokens.push(t)}function cn(e,t){e.pendingCharacterTokens.push(t),e.hasNonWhitespacePendingCharacterToken=!0}function Ue(e,t){let s=0;if(e.hasNonWhitespacePendingCharacterToken)for(;s<e.pendingCharacterTokens.length;s++)Qe(e,e.pendingCharacterTokens[s]);else for(;s<e.pendingCharacterTokens.length;s++)e._insertCharacters(e.pendingCharacterTokens[s]);e.insertionMode=e.originalInsertionMode,e._processToken(t)}var En=new Set([r.CAPTION,r.COL,r.COLGROUP,r.TBODY,r.TD,r.TFOOT,r.TH,r.THEAD,r.TR]);function uc(e,t){let s=t.tagID;En.has(s)?e.openElements.hasInTableScope(r.CAPTION)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(r.CAPTION),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=E.IN_TABLE,me(e,t)):B(e,t)}function dc(e,t){let s=t.tagID;switch(s){case r.CAPTION:case r.TABLE:{e.openElements.hasInTableScope(r.CAPTION)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(r.CAPTION),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=E.IN_TABLE,s===r.TABLE&&Ye(e,t));break}case r.BODY:case r.COL:case r.COLGROUP:case r.HTML:case r.TBODY:case r.TD:case r.TFOOT:case r.TH:case r.THEAD:case r.TR:break;default:bt(e,t)}}function As(e,t){switch(t.tagID){case r.HTML:{B(e,t);break}case r.COL:{e._appendElement(t,f.HTML),t.ackSelfClosing=!0;break}case r.TEMPLATE:{Y(e,t);break}default:Lt(e,t)}}function fc(e,t){switch(t.tagID){case r.COLGROUP:{e.openElements.currentTagId===r.COLGROUP&&(e.openElements.pop(),e.insertionMode=E.IN_TABLE);break}case r.TEMPLATE:{ie(e,t);break}case r.COL:break;default:Lt(e,t)}}function Lt(e,t){e.openElements.currentTagId===r.COLGROUP&&(e.openElements.pop(),e.insertionMode=E.IN_TABLE,e._processToken(t))}function Pt(e,t){switch(t.tagID){case r.TR:{e.openElements.clearBackToTableBodyContext(),e._insertElement(t,f.HTML),e.insertionMode=E.IN_ROW;break}case r.TH:case r.TD:{e.openElements.clearBackToTableBodyContext(),e._insertFakeElement(h.TR,r.TR),e.insertionMode=E.IN_ROW,Mt(e,t);break}case r.CAPTION:case r.COL:case r.COLGROUP:case r.TBODY:case r.TFOOT:case r.THEAD:{e.openElements.hasTableBodyContextInTableScope()&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=E.IN_TABLE,me(e,t));break}default:me(e,t)}}function fs(e,t){let s=t.tagID;switch(t.tagID){case r.TBODY:case r.TFOOT:case r.THEAD:{e.openElements.hasInTableScope(s)&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=E.IN_TABLE);break}case r.TABLE:{e.openElements.hasTableBodyContextInTableScope()&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=E.IN_TABLE,Ye(e,t));break}case r.BODY:case r.CAPTION:case r.COL:case r.COLGROUP:case r.HTML:case r.TD:case r.TH:case r.TR:break;default:Ye(e,t)}}function Mt(e,t){switch(t.tagID){case r.TH:case r.TD:{e.openElements.clearBackToTableRowContext(),e._insertElement(t,f.HTML),e.insertionMode=E.IN_CELL,e.activeFormattingElements.insertMarker();break}case r.CAPTION:case r.COL:case r.COLGROUP:case r.TBODY:case r.TFOOT:case r.THEAD:case r.TR:{e.openElements.hasInTableScope(r.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=E.IN_TABLE_BODY,Pt(e,t));break}default:me(e,t)}}function ln(e,t){switch(t.tagID){case r.TR:{e.openElements.hasInTableScope(r.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=E.IN_TABLE_BODY);break}case r.TABLE:{e.openElements.hasInTableScope(r.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=E.IN_TABLE_BODY,fs(e,t));break}case r.TBODY:case r.TFOOT:case r.THEAD:{(e.openElements.hasInTableScope(t.tagID)||e.openElements.hasInTableScope(r.TR))&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=E.IN_TABLE_BODY,fs(e,t));break}case r.BODY:case r.CAPTION:case r.COL:case r.COLGROUP:case r.HTML:case r.TD:case r.TH:break;default:Ye(e,t)}}function mc(e,t){let s=t.tagID;En.has(s)?(e.openElements.hasInTableScope(r.TD)||e.openElements.hasInTableScope(r.TH))&&(e._closeTableCell(),Mt(e,t)):B(e,t)}function _c(e,t){let s=t.tagID;switch(s){case r.TD:case r.TH:{e.openElements.hasInTableScope(s)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(s),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=E.IN_ROW);break}case r.TABLE:case r.TBODY:case r.TFOOT:case r.THEAD:case r.TR:{e.openElements.hasInTableScope(s)&&(e._closeTableCell(),ln(e,t));break}case r.BODY:case r.CAPTION:case r.COL:case r.COLGROUP:case r.HTML:break;default:bt(e,t)}}function hn(e,t){switch(t.tagID){case r.HTML:{B(e,t);break}case r.OPTION:{e.openElements.currentTagId===r.OPTION&&e.openElements.pop(),e._insertElement(t,f.HTML);break}case r.OPTGROUP:{e.openElements.currentTagId===r.OPTION&&e.openElements.pop(),e.openElements.currentTagId===r.OPTGROUP&&e.openElements.pop(),e._insertElement(t,f.HTML);break}case r.INPUT:case r.KEYGEN:case r.TEXTAREA:case r.SELECT:{e.openElements.hasInSelectScope(r.SELECT)&&(e.openElements.popUntilTagNamePopped(r.SELECT),e._resetInsertionMode(),t.tagID!==r.SELECT&&e._processStartTag(t));break}case r.SCRIPT:case r.TEMPLATE:{Y(e,t);break}default:}}function Tn(e,t){switch(t.tagID){case r.OPTGROUP:{e.openElements.stackTop>0&&e.openElements.currentTagId===r.OPTION&&e.openElements.tagIDs[e.openElements.stackTop-1]===r.OPTGROUP&&e.openElements.pop(),e.openElements.currentTagId===r.OPTGROUP&&e.openElements.pop();break}case r.OPTION:{e.openElements.currentTagId===r.OPTION&&e.openElements.pop();break}case r.SELECT:{e.openElements.hasInSelectScope(r.SELECT)&&(e.openElements.popUntilTagNamePopped(r.SELECT),e._resetInsertionMode());break}case r.TEMPLATE:{ie(e,t);break}default:}}function Ac(e,t){let s=t.tagID;s===r.CAPTION||s===r.TABLE||s===r.TBODY||s===r.TFOOT||s===r.THEAD||s===r.TR||s===r.TD||s===r.TH?(e.openElements.popUntilTagNamePopped(r.SELECT),e._resetInsertionMode(),e._processStartTag(t)):hn(e,t)}function Cc(e,t){let s=t.tagID;s===r.CAPTION||s===r.TABLE||s===r.TBODY||s===r.TFOOT||s===r.THEAD||s===r.TR||s===r.TD||s===r.TH?e.openElements.hasInTableScope(s)&&(e.openElements.popUntilTagNamePopped(r.SELECT),e._resetInsertionMode(),e.onEndTag(t)):Tn(e,t)}function pc(e,t){switch(t.tagID){case r.BASE:case r.BASEFONT:case r.BGSOUND:case r.LINK:case r.META:case r.NOFRAMES:case r.SCRIPT:case r.STYLE:case r.TEMPLATE:case r.TITLE:{Y(e,t);break}case r.CAPTION:case r.COLGROUP:case r.TBODY:case r.TFOOT:case r.THEAD:{e.tmplInsertionModeStack[0]=E.IN_TABLE,e.insertionMode=E.IN_TABLE,me(e,t);break}case r.COL:{e.tmplInsertionModeStack[0]=E.IN_COLUMN_GROUP,e.insertionMode=E.IN_COLUMN_GROUP,As(e,t);break}case r.TR:{e.tmplInsertionModeStack[0]=E.IN_TABLE_BODY,e.insertionMode=E.IN_TABLE_BODY,Pt(e,t);break}case r.TD:case r.TH:{e.tmplInsertionModeStack[0]=E.IN_ROW,e.insertionMode=E.IN_ROW,Mt(e,t);break}default:e.tmplInsertionModeStack[0]=E.IN_BODY,e.insertionMode=E.IN_BODY,B(e,t)}}function Ic(e,t){t.tagID===r.TEMPLATE&&ie(e,t)}function un(e,t){e.openElements.tmplCount>0?(e.openElements.popUntilTagNamePopped(r.TEMPLATE),e.activeFormattingElements.clearToLastMarker(),e.tmplInsertionModeStack.shift(),e._resetInsertionMode(),e.onEof(t)):_s(e,t)}function Nc(e,t){t.tagID===r.HTML?B(e,t):St(e,t)}function dn(e,t){var s;if(t.tagID===r.HTML){if(e.fragmentContext||(e.insertionMode=E.AFTER_AFTER_BODY),e.options.sourceCodeLocationInfo&&e.openElements.tagIDs[0]===r.HTML){e._setEndLocation(e.openElements.items[0],t);let n=e.openElements.items[1];n&&!(!((s=e.treeAdapter.getNodeSourceCodeLocation(n))===null||s===void 0)&&s.endTag)&&e._setEndLocation(n,t)}}else St(e,t)}function St(e,t){e.insertionMode=E.IN_BODY,Dt(e,t)}function Rc(e,t){switch(t.tagID){case r.HTML:{B(e,t);break}case r.FRAMESET:{e._insertElement(t,f.HTML);break}case r.FRAME:{e._appendElement(t,f.HTML),t.ackSelfClosing=!0;break}case r.NOFRAMES:{Y(e,t);break}default:}}function gc(e,t){t.tagID===r.FRAMESET&&!e.openElements.isRootHtmlElementCurrent()&&(e.openElements.pop(),!e.fragmentContext&&e.openElements.currentTagId!==r.FRAMESET&&(e.insertionMode=E.AFTER_FRAMESET))}function Oc(e,t){switch(t.tagID){case r.HTML:{B(e,t);break}case r.NOFRAMES:{Y(e,t);break}default:}}function Lc(e,t){t.tagID===r.HTML&&(e.insertionMode=E.AFTER_AFTER_FRAMESET)}function Sc(e,t){t.tagID===r.HTML?B(e,t):Ot(e,t)}function Ot(e,t){e.insertionMode=E.IN_BODY,Dt(e,t)}function Dc(e,t){switch(t.tagID){case r.HTML:{B(e,t);break}case r.NOFRAMES:{Y(e,t);break}default:}}function bc(e,t){t.chars=D,e._insertCharacters(t)}function Pc(e,t){e._insertCharacters(t),e.framesetOk=!1}function fn(e){for(;e.treeAdapter.getNamespaceURI(e.openElements.current)!==f.HTML&&!e._isIntegrationPoint(e.openElements.currentTagId,e.openElements.current);)e.openElements.pop()}function Mc(e,t){if(ls(t))fn(e),e._startTagOutsideForeignContent(t);else{let s=e._getAdjustedCurrentElement(),n=e.treeAdapter.getNamespaceURI(s);n===f.MATHML?Nt(t):n===f.SVG&&(hs(t),Rt(t)),ke(t),t.selfClosing?e._appendElement(t,n):e._insertElement(t,n),t.ackSelfClosing=!0}}function Bc(e,t){if(t.tagID===r.P||t.tagID===r.BR){fn(e),e._endTagOutsideForeignContent(t);return}for(let s=e.openElements.stackTop;s>0;s--){let n=e.openElements.items[s];if(e.treeAdapter.getNamespaceURI(n)===f.HTML){e._endTagOutsideForeignContent(t);break}let a=e.treeAdapter.getTagName(n);if(a.toLowerCase()===t.tagName){t.tagName=a,e.openElements.shortenToLength(s);break}}}var kc=new Set([h.AREA,h.BASE,h.BASEFONT,h.BGSOUND,h.BR,h.COL,h.EMBED,h.FRAME,h.HR,h.IMG,h.INPUT,h.KEYGEN,h.LINK,h.META,h.PARAM,h.SOURCE,h.TRACK,h.WBR]);function Hc(e,t){return t.treeAdapter.isElementNode(e)&&t.treeAdapter.getNamespaceURI(e)===f.HTML&&kc.has(t.treeAdapter.getTagName(e))}var Uc={treeAdapter:G,scriptingEnabled:!0};function Cs(e,t){let s={...Uc,...t};return mn(e,s)}function Fc(e,t){let s="",n=t.treeAdapter.isElementNode(e)&&t.treeAdapter.getTagName(e)===h.TEMPLATE&&t.treeAdapter.getNamespaceURI(e)===f.HTML?t.treeAdapter.getTemplateContent(e):e,a=t.treeAdapter.getChildNodes(n);if(a)for(let c of a)s+=mn(c,t);return s}function mn(e,t){return t.treeAdapter.isElementNode(e)?xc(e,t):t.treeAdapter.isTextNode(e)?wc(e,t):t.treeAdapter.isCommentNode(e)?vc(e,t):t.treeAdapter.isDocumentTypeNode(e)?Yc(e,t):""}function xc(e,t){let s=t.treeAdapter.getTagName(e);return`<${s}${yc(e,t)}>${Hc(e,t)?"":`${Fc(e,t)}</${s}>`}`}function yc(e,{treeAdapter:t}){let s="";for(let n of t.getAttrList(e)){if(s+=" ",!n.namespace)s+=n.name;else switch(n.namespace){case f.XML:{s+=`xml:${n.name}`;break}case f.XMLNS:{n.name!=="xmlns"&&(s+="xmlns:"),s+=n.name;break}case f.XLINK:{s+=`xlink:${n.name}`;break}default:s+=`${n.prefix}:${n.name}`}s+=`="${Bs(n.value)}"`}return s}function wc(e,t){let{treeAdapter:s}=t,n=s.getTextNodeContent(e),a=s.getParentNode(e),c=a&&s.isElementNode(a)&&s.getTagName(a);return c&&s.getNamespaceURI(a)===f.HTML&&cs(c,t.scriptingEnabled)?n:ks(n)}function vc(e,{treeAdapter:t}){return`<!--${t.getCommentNodeContent(e)}-->`}function Yc(e,{treeAdapter:t}){return`<!DOCTYPE ${t.getDocumentTypeNodeName(e)}>`}function _n(e,t){return fe.parse(e,t)}function An(e,t,s){typeof e=="string"&&(s=t,t=e,e=null);let n=fe.getFragmentParser(e,s);return n.tokenizer.write(t,!0),n.getFragment()}function Cn(e){return new Ke(e)}function pn(e){let t=e.includes('"')?"'":'"';return t+e+t}function Qc(e,t,s){let n="!DOCTYPE ";return e&&(n+=e),t?n+=` PUBLIC ${pn(t)}`:s&&(n+=" SYSTEM"),s&&(n+=` ${pn(s)}`),n}var oe={isCommentNode:Ms,isElementNode:R,isTextNode:Ve,createDocument(){let e=new se([]);return e["x-mode"]=be.DOCUMENT_MODE.NO_QUIRKS,e},createDocumentFragment(){return new se([])},createElement(e,t,s){let n=Object.create(null),a=Object.create(null),c=Object.create(null);for(let T=0;T<s.length;T++){let u=s[T].name;n[u]=s[T].value,a[u]=s[T].namespace,c[u]=s[T].prefix}let l=new Ps(e,n,[]);return l.namespace=t,l["x-attribsNamespace"]=a,l["x-attribsPrefix"]=c,l},createCommentNode(e){return new Ds(e)},appendChild(e,t){let s=e.children[e.children.length-1];s&&(s.next=t,t.prev=s),e.children.push(t),t.parent=e},insertBefore(e,t,s){let n=e.children.indexOf(s),{prev:a}=s;a&&(a.next=t,t.prev=a),s.prev=t,t.next=s,e.children.splice(n,0,t),t.parent=e},setTemplateContent(e,t){oe.appendChild(e,t)},getTemplateContent(e){return e.children[0]},setDocumentType(e,t,s,n){let a=Qc(t,s,n),c=e.children.find(l=>Ft(l)&&l.name==="!doctype");c?c.data=a!=null?a:null:(c=new bs("!doctype",a),oe.appendChild(e,c)),c["x-name"]=t!=null?t:void 0,c["x-publicId"]=s!=null?s:void 0,c["x-systemId"]=n!=null?n:void 0},setDocumentMode(e,t){e["x-mode"]=t},getDocumentMode(e){return e["x-mode"]},detachNode(e){if(e.parent){let t=e.parent.children.indexOf(e),{prev:s,next:n}=e;e.prev=null,e.next=null,s&&(s.next=n),n&&(n.prev=s),e.parent.children.splice(t,1),e.parent=null}},insertText(e,t){let s=e.children[e.children.length-1];s&&Ve(s)?s.data+=t:oe.appendChild(e,Cn(t))},insertTextBefore(e,t,s){let n=e.children[e.children.indexOf(s)-1];n&&Ve(n)?n.data+=t:oe.insertBefore(e,Cn(t),s)},adoptAttributes(e,t){for(let s=0;s<t.length;s++){let n=t[s].name;typeof e.attribs[n]=="undefined"&&(e.attribs[n]=t[s].value,e["x-attribsNamespace"][n]=t[s].namespace,e["x-attribsPrefix"][n]=t[s].prefix)}},getFirstChild(e){return e.children[0]},getChildNodes(e){return e.children},getParentNode(e){return e.parent},getAttrList(e){return e.attributes},getTagName(e){return e.name},getNamespaceURI(e){return e.namespace},getTextNodeContent(e){return e.data},getCommentNodeContent(e){return e.data},getDocumentTypeNodeName(e){var t;return(t=e["x-name"])!==null&&t!==void 0?t:""},getDocumentTypeNodePublicId(e){var t;return(t=e["x-publicId"])!==null&&t!==void 0?t:""},getDocumentTypeNodeSystemId(e){var t;return(t=e["x-systemId"])!==null&&t!==void 0?t:""},isDocumentTypeNode(e){return Ft(e)&&e.name==="!doctype"},setNodeSourceCodeLocation(e,t){t&&(e.startIndex=t.startOffset,e.endIndex=t.endOffset),e.sourceCodeLocation=t},getNodeSourceCodeLocation(e){return e.sourceCodeLocation},updateNodeSourceCodeLocation(e,t){t.endOffset!=null&&(e.endIndex=t.endOffset),e.sourceCodeLocation={...e.sourceCodeLocation,...t}}};function In(e,t,s,n){let a={scriptingEnabled:typeof t.scriptingEnabled=="boolean"?t.scriptingEnabled:!0,treeAdapter:oe,sourceCodeLocationInfo:t.sourceCodeLocationInfo};return s?_n(e,a):An(n,e,a)}var Wc={treeAdapter:oe};function Nn(e){let t="length"in e?e:[e];for(let n=0;n<t.length;n+=1){let a=t[n];j(a)&&Array.prototype.splice.call(t,n,1,...a.children)}let s="";for(let n=0;n<t.length;n+=1){let a=t[n];s+=Cs(a,Wc)}return s}var Gc=gr((e,t,s,n)=>t.xmlMode||t._useHtmlParser2?ys(e,t):In(e,t,s,n)),Xc=Mr(Gc,(e,t)=>t.xmlMode||t._useHtmlParser2?Hs(e,t):Nn(e)),Rn=Xc([]),{contains:mh}=z,{merge:_h}=z,{parseHTML:Ah}=z,{root:Ch}=z;var gn=e=>new RegExp(/^(((ht|f)tps?):\/\/)?([^!@#$%^&*?.\s-]([^!@#$%^&*?.\s]{0,63}[^!@#$%^&*?.\s])?\.)+[a-z]{2,6}\/?/).test(e),Kc=e=>{if(!e)return"";try{let t=/^(?:https?:\/\/)?(?:www\.)?((?:(?!www\.|\.).)+\.[-a-zA-Z0-9.]+)/gm,s=e.match(t);return(s?s[0]:"").toLowerCase()}catch(t){return e}},ps=(e,t=16)=>{let s=Kc(e)||`${e==null?void 0:e.toLowerCase()}.com`;return`https://www.google.com/s2/favicons?sz=${t}&domain_url=${s}`},On=e=>e?(e.search(/^http[s]?:\/\//)==-1&&(e="https://"+e),e):"";var Ln=e=>{let t=[];return e("#search #rso > div").filter((a,c)=>!!e(c).find("a > h3").text()).each((a,c)=>{var N,S,O,b,w,F,Q,kt,We,Ae;let l=e(c),T=l.find("a > h3"),u=T.closest("a"),A=l.find("div.MUxGbd").text();if(A||(A=(S=(N=u==null?void 0:u.parent())==null?void 0:N.parent())==null?void 0:S.parent().next().text().trim()),A||(A=(b=(O=u==null?void 0:u.parent())==null?void 0:O.parent())==null?void 0:b.parent().next().next().text().trim()),!A){let Ge=l.find("div[style]").filter((Zc,Dn)=>{var Ns,Rs;return!!((Rs=(Ns=e(Dn))==null?void 0:Ns.attr("style"))!=null&&Rs.includes("-webkit-line-clamp"))});A=e(Ge[0]).text().trim()}let _=T.text(),C=T.next(),p=H((w=u.attr("href"))!=null?w:""),I=(We=(kt=(Q=(F=C==null?void 0:C.children())==null?void 0:F.last())==null?void 0:Q.children())==null?void 0:kt.first())==null?void 0:We.text();t.push({title:_,body:A||_,url:p,from:I,imgLink:(Ae=C==null?void 0:C.find("img"))==null?void 0:Ae.attr("src")})}),e("#rso #kp-wp-tab-overview:not([style])").length>0&&e('#rso #kp-wp-tab-overview:not([style]) div[class*="K7khPe"]').each((a,c)=>{var N,S,O,b,w,F;let l=e(c),T=l.find("a > h3"),u=T.closest("a"),A=l.find("div.MUxGbd").text();if(!A){let Q=l.find("div[style]").filter((kt,We)=>{var Ae,Ge;return!!((Ge=(Ae=e(We))==null?void 0:Ae.attr("style"))!=null&&Ge.includes("-webkit-line-clamp"))});A=e(Q[0]).text().trim()}let _=T.next(),C=H((N=u.attr("href"))!=null?N:""),p=(w=(b=(O=(S=_==null?void 0:_.children())==null?void 0:S.last())==null?void 0:O.children())==null?void 0:b.first())==null?void 0:w.text(),I=T.text();I&&t.push({title:I,body:A||I,url:C,from:p,imgLink:(F=_==null?void 0:_.find("img"))==null?void 0:F.attr("src")})}),e("#search #rso > div a[data-ved]").filter((a,c)=>!!e(c).find("div[role=heading]").text()).each((a,c)=>{var p,I;let l=e(c),T=l.find("div[role=heading]"),u=T.text(),A=T.next().text(),_=T.prev(),C=H((p=l.attr("href"))!=null?p:"");t.push({title:u,body:A||u,url:C,from:_.text(),imgLink:(I=_.find("img"))==null?void 0:I.attr("src")})}),e('#search #rso div[role="tabpanel"] div[jscontroller="SC7lYd"]').each((a,c)=>{var N,S;let l=e(c),T=l.find("a > h3"),u=T.text(),A=T.closest("a"),_=l.find('div[style="-webkit-line-clamp:2"]').text(),C=T.next(),p=H((N=A.attr("href"))!=null?N:""),I=C.find("span.VuuXrf").text();t.push({title:u,body:_||u,url:p,from:I,imgLink:(S=C.find("img"))==null?void 0:S.attr("src")})}),t};var Sn=e=>{let t=[];return e("ol#b_results li.b_algo").each((s,n)=>{var T,u;let a=e(n),c=a.find("h2 > a"),l=a.find(".b_algoSlug").text();l||(l=a.find(".b_wikiRichcard .tab-content").text().trim()),t.push({title:(T=c.text())!=null?T:"",body:l!=null?l:"",url:H((u=c.attr("href"))!=null?u:""),from:a.find("a .tptt").text(),imgLink:a.find("img.rms_img").attr("src")})}),t};function Uh({html:e,searchEngine:t}){try{return Vc(e,t).filter(a=>sr(a.url)?!1:a.url&&(a.body||a.title))}catch(s){return[]}}function H(e){let t=e.match(/RU=([^/]+)/);return t&&t[1]?decodeURIComponent(t[1]):e}var Vc=(e,t)=>{try{let s=Rn.load(e),n=[];switch(t){case"google":{n=Ln(s);break}case"baidu":{let l=[],T=[];s("div#content_left div[class^=result]").each((u,A)=>{var F,Q;let _=s(A),C=_.find("h3"),p=C.find("a"),I=_.attr("tpl"),N=_.attr("mu")||"",S=!1;N&&I==="se_com_default"?(N=H(N),S=!0):(N=H((F=p.attr("href"))!=null?F:""),N=N.replace("http://www.baidu","https://www.baidu"));let O=_.find("div[class*=description_]").text();if(O||(O=_.find(".op_dict_content").text()),O||(O=_.find("div[class*=basis-info_]").text()),O||(O=_.find(".c-color-text").text()),O||(O=C.next().next().text()),!O.trim()&&!N.trim())return;let b=_.find("a[class^=siteLink]"),w={title:C.text(),body:O!=null?O:"",url:N,from:b.text(),imgLink:(Q=b.find("img"))==null?void 0:Q.attr("src")};S?l.push(w):T.push(w)}),n=[...l,...T];break}case"duckduckgo":{s("ol.react-results--main li[data-layout=organic]").each((l,T)=>{var I,N;let u=s(T),A=u.find("h2 > a"),_=u.find("a[data-testid=result-extras-url-link]"),C=_.parent(),p=H((I=A.attr("href"))!=null?I:"");n.push({title:A.text(),body:u.find("div[data-result=snippet]").text(),url:p,from:_e(p)||_.children().first().text(),imgLink:(N=C.find("a > img"))==null?void 0:N.attr("src")})});break}case"yahoo":{s('.algo:not([class*="ad"])').each((l,T)=>{var p,I;let u=s(T),A=u.find("h3.title a"),_=H((p=A.attr("href"))!=null?p:""),C=A.find("span").text().split(" \u203A ");n.push({title:(I=A.attr("aria-label"))!=null?I:"",body:u.find(".compText").text(),url:_,from:_e(_)||C[0]})});break}case"naver":{s("ul.lst_total > li.bx").each((l,T)=>{var p;let u=s(T),A=u.find("a.link_tit");(!A||A.length<=0)&&(A=u.find("a.total_tit"));let _=H((p=A.attr("href"))!=null?p:""),C=u.find("a.thumb img").attr("src");n.push({title:A.text(),body:u.find(".dsc_txt").text(),url:_,from:_e(_),imgLink:C})});break}case"yandex":{s(".content__left ul.serp-list > li.serp-item").each((l,T)=>{var I;let u=s(T),A=u.find("a.organic__url"),_=H((I=A.attr("href"))!=null?I:""),C=u.find(".Favicon-Icon").css("background-image"),p=C==null?void 0:C.slice(5).slice(0,-2);n.push({title:A.text(),body:u.find(".organic__content-wrapper").text(),url:_,imgLink:p,from:_e(_)})});break}case"sogou":{s(".results div.vrwrap").each((l,T)=>{var S;let u=s(T),A=u.find("h3.vr-title a"),_=u.find(".text-layout").text();_||(_=u.find(".word-result").text()),_||(_=u.find(".space-txt").text());let C=H((S=A.attr("href"))!=null?S:"");C=C.startsWith("/")?location.origin+C:C;let I=u.find(".citeurl").text().replace(/\n\s*/g,"").split("-").find(O=>{try{let b=O.trim().replace("...","");return b.includes("/")&&(b=b.split("/")[0]),gn(b)}catch(b){return!1}}),N=_e(I||"");n.push({title:A.text(),body:_,url:C,from:N,imgLink:ps(N)})});break}case"brave":{s("#results > .snippet[data-type=web]").each((l,T)=>{var b;let u=s(T),A=u.find(".snippet-title"),_=A.text(),C=A.closest("a"),p=u.find("img.favicon").attr("src");_||(A=u.find("a > div.url"),_=A.text(),C=A.closest("a"));let I=u.find(".snippet-content").text();I||(I=u.find(".snippet-description").text());let S=u.find(".snippet-url").children().first().text();u.attr("id")==="discussions"&&(_=u.find(".question > p.title").text(),I=u.find(".faq-a").text(),C=u.find("a.source").first(),S=u.find("img.forum-name").text());let O=H((b=C.attr("href"))!=null?b:"");n.push({title:_,body:I,url:O,imgLink:p,from:S})});break}case"bing":{n=Sn(s);break}default:return[]}n=n.map(l=>{let T={...l};return T.from||(T.from=_e(T.url)),T.from&&(T.from=T.from.replace(/\.[^.]*$/,"")),!T.imgLink&&T.url&&(T.imgLink=ps(T.url)),T.from=Is(T.from),T.body=Is(T.body),T.title=Is(T.title),T});let a=new Map;return n.filter(l=>a.has(l.url)?!1:(a.set(l.url,!0),!0))}catch(s){return[]}};function Is(e){return e.trim().replaceAll(`
`,"")||""}function _e(e){try{let t=On(e.trim().replaceAll("...","")),n=new URL(t).host.split(".");return n.length>=3?n[1]:n[0]}catch(t){return e}}export{zs as a,TE as b,uE as c,dE as d,fE as e,mE as f,SE as g,BE as h,kE as i,gn as j,Uh as k,zn as l,ta as m,Jc as n};
