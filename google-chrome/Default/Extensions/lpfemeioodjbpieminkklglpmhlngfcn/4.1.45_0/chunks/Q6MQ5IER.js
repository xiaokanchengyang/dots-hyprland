import{a as we,c as G}from"./IPPTDVLS.js";import{a as oe,c as Ie,d as Ee,e as Oe,g as Pe}from"./EVSA3OY5.js";import{a as Ae,c as ve,g as _e}from"./C2E66DLF.js";import{a as te,c as Te,f as pe}from"./3PS7M655.js";var je=Te((xe,Ne)=>{(function(P){var n;typeof xe=="object"?Ne.exports=P():typeof define=="function"&&define.amd?define(P):(typeof window!="undefined"?n=window:typeof global!="undefined"?n=global:typeof self!="undefined"&&(n=self),n.objectHash=P())})(function(){return function P(n,f,m){function _(k,C){if(!f[k]){if(!n[k]){var Y=typeof te=="function"&&te;if(!C&&Y)return Y(k,!0);if(B)return B(k,!0);throw new Error("Cannot find module '"+k+"'")}C=f[k]={exports:{}},n[k][0].call(C.exports,function(K){var U=n[k][1][K];return _(U||K)},C,C.exports,P,n,f,m)}return f[k].exports}for(var B=typeof te=="function"&&te,L=0;L<m.length;L++)_(m[L]);return _}({1:[function(P,n,f){(function(m,_,B,L,k,C,Y,K,U){"use strict";var w=P("crypto");function E(u,l){l=g(u,l);var r;return(r=l.algorithm!=="passthrough"?w.createHash(l.algorithm):new x).write===void 0&&(r.write=r.update,r.end=r.update),y(l,r).dispatch(u),r.update||r.end(""),r.digest?r.digest(l.encoding==="buffer"?void 0:l.encoding):(u=r.read(),l.encoding!=="buffer"?u.toString(l.encoding):u)}(f=n.exports=E).sha1=function(u){return E(u)},f.keys=function(u){return E(u,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},f.MD5=function(u){return E(u,{algorithm:"md5",encoding:"hex"})},f.keysMD5=function(u){return E(u,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var p=w.getHashes?w.getHashes().slice():["sha1","md5"],h=(p.push("passthrough"),["buffer","hex","binary","base64"]);function g(u,l){var r={};if(r.algorithm=(l=l||{}).algorithm||"sha1",r.encoding=l.encoding||"hex",r.excludeValues=!!l.excludeValues,r.algorithm=r.algorithm.toLowerCase(),r.encoding=r.encoding.toLowerCase(),r.ignoreUnknown=l.ignoreUnknown===!0,r.respectType=l.respectType!==!1,r.respectFunctionNames=l.respectFunctionNames!==!1,r.respectFunctionProperties=l.respectFunctionProperties!==!1,r.unorderedArrays=l.unorderedArrays===!0,r.unorderedSets=l.unorderedSets!==!1,r.unorderedObjects=l.unorderedObjects!==!1,r.replacer=l.replacer||void 0,r.excludeKeys=l.excludeKeys||void 0,u===void 0)throw new Error("Object argument required.");for(var i=0;i<p.length;++i)p[i].toLowerCase()===r.algorithm.toLowerCase()&&(r.algorithm=p[i]);if(p.indexOf(r.algorithm)===-1)throw new Error('Algorithm "'+r.algorithm+'"  not supported. supported values: '+p.join(", "));if(h.indexOf(r.encoding)===-1&&r.algorithm!=="passthrough")throw new Error('Encoding "'+r.encoding+'"  not supported. supported values: '+h.join(", "));return r}function A(u){if(typeof u=="function")return/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(u))!=null}function y(u,l,r){r=r||[];function i(t){return l.update?l.update(t,"utf8"):l.write(t,"utf8")}return{dispatch:function(t){return this["_"+((t=u.replacer?u.replacer(t):t)===null?"null":typeof t)](t)},_object:function(t){var s,c=Object.prototype.toString.call(t),N=/\[object (.*)\]/i.exec(c);if(N=(N=N?N[1]:"unknown:["+c+"]").toLowerCase(),0<=(c=r.indexOf(t)))return this.dispatch("[CIRCULAR:"+c+"]");if(r.push(t),B!==void 0&&B.isBuffer&&B.isBuffer(t))return i("buffer:"),i(t);if(N==="object"||N==="function"||N==="asyncfunction")return c=Object.keys(t),u.unorderedObjects&&(c=c.sort()),u.respectType===!1||A(t)||c.splice(0,0,"prototype","__proto__","constructor"),u.excludeKeys&&(c=c.filter(function(j){return!u.excludeKeys(j)})),i("object:"+c.length+":"),s=this,c.forEach(function(j){s.dispatch(j),i(":"),u.excludeValues||s.dispatch(t[j]),i(",")});if(!this["_"+N]){if(u.ignoreUnknown)return i("["+N+"]");throw new Error('Unknown object type "'+N+'"')}this["_"+N](t)},_array:function(t,j){j=j!==void 0?j:u.unorderedArrays!==!1;var c=this;if(i("array:"+t.length+":"),!j||t.length<=1)return t.forEach(function(T){return c.dispatch(T)});var N=[],j=t.map(function(T){var O=new x,z=r.slice();return y(u,O,z).dispatch(T),N=N.concat(z.slice(r.length)),O.read().toString()});return r=r.concat(N),j.sort(),this._array(j,!1)},_date:function(t){return i("date:"+t.toJSON())},_symbol:function(t){return i("symbol:"+t.toString())},_error:function(t){return i("error:"+t.toString())},_boolean:function(t){return i("bool:"+t.toString())},_string:function(t){i("string:"+t.length+":"),i(t.toString())},_function:function(t){i("fn:"),A(t)?this.dispatch("[native]"):this.dispatch(t.toString()),u.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(t.name)),u.respectFunctionProperties&&this._object(t)},_number:function(t){return i("number:"+t.toString())},_xml:function(t){return i("xml:"+t.toString())},_null:function(){return i("Null")},_undefined:function(){return i("Undefined")},_regexp:function(t){return i("regex:"+t.toString())},_uint8array:function(t){return i("uint8array:"),this.dispatch(Array.prototype.slice.call(t))},_uint8clampedarray:function(t){return i("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(t))},_int8array:function(t){return i("int8array:"),this.dispatch(Array.prototype.slice.call(t))},_uint16array:function(t){return i("uint16array:"),this.dispatch(Array.prototype.slice.call(t))},_int16array:function(t){return i("int16array:"),this.dispatch(Array.prototype.slice.call(t))},_uint32array:function(t){return i("uint32array:"),this.dispatch(Array.prototype.slice.call(t))},_int32array:function(t){return i("int32array:"),this.dispatch(Array.prototype.slice.call(t))},_float32array:function(t){return i("float32array:"),this.dispatch(Array.prototype.slice.call(t))},_float64array:function(t){return i("float64array:"),this.dispatch(Array.prototype.slice.call(t))},_arraybuffer:function(t){return i("arraybuffer:"),this.dispatch(new Uint8Array(t))},_url:function(t){return i("url:"+t.toString())},_map:function(t){return i("map:"),t=Array.from(t),this._array(t,u.unorderedSets!==!1)},_set:function(t){return i("set:"),t=Array.from(t),this._array(t,u.unorderedSets!==!1)},_file:function(t){return i("file:"),this.dispatch([t.name,t.size,t.type,t.lastModfied])},_blob:function(){if(u.ignoreUnknown)return i("[blob]");throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){return i("domwindow")},_bigint:function(t){return i("bigint:"+t.toString())},_process:function(){return i("process")},_timer:function(){return i("timer")},_pipe:function(){return i("pipe")},_tcp:function(){return i("tcp")},_udp:function(){return i("udp")},_tty:function(){return i("tty")},_statwatcher:function(){return i("statwatcher")},_securecontext:function(){return i("securecontext")},_connection:function(){return i("connection")},_zlib:function(){return i("zlib")},_context:function(){return i("context")},_nodescript:function(){return i("nodescript")},_httpparser:function(){return i("httpparser")},_dataview:function(){return i("dataview")},_signal:function(){return i("signal")},_fsevent:function(){return i("fsevent")},_tlswrap:function(){return i("tlswrap")}}}function x(){return{buf:"",write:function(u){this.buf+=u},end:function(u){this.buf+=u},read:function(){return this.buf}}}f.writeToStream=function(u,l,r){return r===void 0&&(r=l,l={}),y(l=g(u,l),r).dispatch(u)}}).call(this,P("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},P("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_9a5aa49d.js","/")},{buffer:3,crypto:5,lYpoI2:11}],2:[function(P,n,f){(function(m,_,B,L,k,C,Y,K,U){(function(w){"use strict";var E=typeof Uint8Array!="undefined"?Uint8Array:Array,p="+".charCodeAt(0),h="/".charCodeAt(0),g="0".charCodeAt(0),A="a".charCodeAt(0),y="A".charCodeAt(0),x="-".charCodeAt(0),u="_".charCodeAt(0);function l(r){return r=r.charCodeAt(0),r===p||r===x?62:r===h||r===u?63:r<g?-1:r<g+10?r-g+26+26:r<y+26?r-y:r<A+26?r-A+26:void 0}w.toByteArray=function(r){var i,t;if(0<r.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var s=r.length,s=r.charAt(s-2)==="="?2:r.charAt(s-1)==="="?1:0,c=new E(3*r.length/4-s),N=0<s?r.length-4:r.length,j=0;function T(O){c[j++]=O}for(i=0;i<N;i+=4,0)T((16711680&(t=l(r.charAt(i))<<18|l(r.charAt(i+1))<<12|l(r.charAt(i+2))<<6|l(r.charAt(i+3))))>>16),T((65280&t)>>8),T(255&t);return s==2?T(255&(t=l(r.charAt(i))<<2|l(r.charAt(i+1))>>4)):s==1&&(T((t=l(r.charAt(i))<<10|l(r.charAt(i+1))<<4|l(r.charAt(i+2))>>2)>>8&255),T(255&t)),c},w.fromByteArray=function(r){var i,t,s,c,N=r.length%3,j="";function T(O){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(O)}for(i=0,s=r.length-N;i<s;i+=3)t=(r[i]<<16)+(r[i+1]<<8)+r[i+2],j+=T((c=t)>>18&63)+T(c>>12&63)+T(c>>6&63)+T(63&c);switch(N){case 1:j=(j+=T((t=r[r.length-1])>>2))+T(t<<4&63)+"==";break;case 2:j=(j=(j+=T((t=(r[r.length-2]<<8)+r[r.length-1])>>10))+T(t>>4&63))+T(t<<2&63)+"="}return j}})(f===void 0?this.base64js={}:f)}).call(this,P("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},P("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:11}],3:[function(P,n,f){(function(m,_,p,L,k,C,Y,K,U){var w=P("base64-js"),E=P("ieee754");function p(e,o,a){if(!(this instanceof p))return new p(e,o,a);var b,d,I,S,F=typeof e;if(o==="base64"&&F=="string")for(e=(S=e).trim?S.trim():S.replace(/^\s+|\s+$/g,"");e.length%4!=0;)e+="=";if(F=="number")b=M(e);else if(F=="string")b=p.byteLength(e,o);else{if(F!="object")throw new Error("First argument needs to be a number, array or string.");b=M(e.length)}if(p._useTypedArrays?d=p._augment(new Uint8Array(b)):((d=this).length=b,d._isBuffer=!0),p._useTypedArrays&&typeof e.byteLength=="number")d._set(e);else if(D(S=e)||p.isBuffer(S)||S&&typeof S=="object"&&typeof S.length=="number")for(I=0;I<b;I++)p.isBuffer(e)?d[I]=e.readUInt8(I):d[I]=e[I];else if(F=="string")d.write(e,0,o);else if(F=="number"&&!p._useTypedArrays&&!a)for(I=0;I<b;I++)d[I]=0;return d}function h(e,o,a,b){return p._charsWritten=ne(function(d){for(var I=[],S=0;S<d.length;S++)I.push(255&d.charCodeAt(S));return I}(o),e,a,b)}function g(e,o,a,b){return p._charsWritten=ne(function(d){for(var I,S,F=[],V=0;V<d.length;V++)S=d.charCodeAt(V),I=S>>8,S=S%256,F.push(S),F.push(I);return F}(o),e,a,b)}function A(e,o,a){var b="";a=Math.min(e.length,a);for(var d=o;d<a;d++)b+=String.fromCharCode(e[d]);return b}function y(e,o,a,I){I||(v(typeof a=="boolean","missing or invalid endian"),v(o!=null,"missing offset"),v(o+1<e.length,"Trying to read beyond buffer length"));var d,I=e.length;if(!(I<=o))return a?(d=e[o],o+1<I&&(d|=e[o+1]<<8)):(d=e[o]<<8,o+1<I&&(d|=e[o+1])),d}function x(e,o,a,I){I||(v(typeof a=="boolean","missing or invalid endian"),v(o!=null,"missing offset"),v(o+3<e.length,"Trying to read beyond buffer length"));var d,I=e.length;if(!(I<=o))return a?(o+2<I&&(d=e[o+2]<<16),o+1<I&&(d|=e[o+1]<<8),d|=e[o],o+3<I&&(d+=e[o+3]<<24>>>0)):(o+1<I&&(d=e[o+1]<<16),o+2<I&&(d|=e[o+2]<<8),o+3<I&&(d|=e[o+3]),d+=e[o]<<24>>>0),d}function u(e,o,a,b){if(b||(v(typeof a=="boolean","missing or invalid endian"),v(o!=null,"missing offset"),v(o+1<e.length,"Trying to read beyond buffer length")),!(e.length<=o))return b=y(e,o,a,!0),32768&b?-1*(65535-b+1):b}function l(e,o,a,b){if(b||(v(typeof a=="boolean","missing or invalid endian"),v(o!=null,"missing offset"),v(o+3<e.length,"Trying to read beyond buffer length")),!(e.length<=o))return b=x(e,o,a,!0),2147483648&b?-1*(4294967295-b+1):b}function r(e,o,a,b){return b||(v(typeof a=="boolean","missing or invalid endian"),v(o+3<e.length,"Trying to read beyond buffer length")),E.read(e,o,a,23,4)}function i(e,o,a,b){return b||(v(typeof a=="boolean","missing or invalid endian"),v(o+7<e.length,"Trying to read beyond buffer length")),E.read(e,o,a,52,8)}function t(e,o,a,b,d){if(d||(v(o!=null,"missing value"),v(typeof b=="boolean","missing or invalid endian"),v(a!=null,"missing offset"),v(a+1<e.length,"trying to write beyond buffer length"),ue(o,65535)),d=e.length,!(d<=a))for(var I=0,S=Math.min(d-a,2);I<S;I++)e[a+I]=(o&255<<8*(b?I:1-I))>>>8*(b?I:1-I)}function s(e,o,a,b,d){if(d||(v(o!=null,"missing value"),v(typeof b=="boolean","missing or invalid endian"),v(a!=null,"missing offset"),v(a+3<e.length,"trying to write beyond buffer length"),ue(o,4294967295)),d=e.length,!(d<=a))for(var I=0,S=Math.min(d-a,4);I<S;I++)e[a+I]=o>>>8*(b?I:3-I)&255}function c(e,o,a,b,d){d||(v(o!=null,"missing value"),v(typeof b=="boolean","missing or invalid endian"),v(a!=null,"missing offset"),v(a+1<e.length,"Trying to write beyond buffer length"),ce(o,32767,-32768)),e.length<=a||t(e,0<=o?o:65535+o+1,a,b,d)}function N(e,o,a,b,d){d||(v(o!=null,"missing value"),v(typeof b=="boolean","missing or invalid endian"),v(a!=null,"missing offset"),v(a+3<e.length,"Trying to write beyond buffer length"),ce(o,2147483647,-2147483648)),e.length<=a||s(e,0<=o?o:4294967295+o+1,a,b,d)}function j(e,o,a,b,d){d||(v(o!=null,"missing value"),v(typeof b=="boolean","missing or invalid endian"),v(a!=null,"missing offset"),v(a+3<e.length,"Trying to write beyond buffer length"),ye(o,34028234663852886e22,-34028234663852886e22)),e.length<=a||E.write(e,o,a,b,23,4)}function T(e,o,a,b,d){d||(v(o!=null,"missing value"),v(typeof b=="boolean","missing or invalid endian"),v(a!=null,"missing offset"),v(a+7<e.length,"Trying to write beyond buffer length"),ye(o,17976931348623157e292,-17976931348623157e292)),e.length<=a||E.write(e,o,a,b,52,8)}f.Buffer=p,f.SlowBuffer=p,f.INSPECT_MAX_BYTES=50,p.poolSize=8192,p._useTypedArrays=function(){try{var e=new ArrayBuffer(0),o=new Uint8Array(e);return o.foo=function(){return 42},o.foo()===42&&typeof o.subarray=="function"}catch(a){return!1}}(),p.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},p.isBuffer=function(e){return!(e==null||!e._isBuffer)},p.byteLength=function(e,o){var a;switch(e+="",o||"utf8"){case"hex":a=e.length/2;break;case"utf8":case"utf-8":a=H(e).length;break;case"ascii":case"binary":case"raw":a=e.length;break;case"base64":a=ge(e).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":a=2*e.length;break;default:throw new Error("Unknown encoding")}return a},p.concat=function(e,o){if(v(D(e),`Usage: Buffer.concat(list, [totalLength])
list should be an Array.`),e.length===0)return new p(0);if(e.length===1)return e[0];if(typeof o!="number")for(d=o=0;d<e.length;d++)o+=e[d].length;for(var a=new p(o),b=0,d=0;d<e.length;d++){var I=e[d];I.copy(a,b),b+=I.length}return a},p.prototype.write=function(e,o,a,b){isFinite(o)?isFinite(a)||(b=a,a=void 0):(V=b,b=o,o=a,a=V),o=Number(o)||0;var d,I,S,F,V=this.length-o;switch((!a||V<(a=Number(a)))&&(a=V),b=String(b||"utf8").toLowerCase()){case"hex":d=function($,Z,J,W){J=Number(J)||0;var q=$.length-J;(!W||q<(W=Number(W)))&&(W=q),v((q=Z.length)%2==0,"Invalid hex string"),q/2<W&&(W=q/2);for(var X=0;X<W;X++){var be=parseInt(Z.substr(2*X,2),16);v(!isNaN(be),"Invalid hex string"),$[J+X]=be}return p._charsWritten=2*X,X}(this,e,o,a);break;case"utf8":case"utf-8":I=this,S=o,F=a,d=p._charsWritten=ne(H(e),I,S,F);break;case"ascii":case"binary":d=h(this,e,o,a);break;case"base64":I=this,S=o,F=a,d=p._charsWritten=ne(ge(e),I,S,F);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":d=g(this,e,o,a);break;default:throw new Error("Unknown encoding")}return d},p.prototype.toString=function(e,o,a){var b,d,I,S,F=this;if(e=String(e||"utf8").toLowerCase(),o=Number(o)||0,(a=a!==void 0?Number(a):F.length)===o)return"";switch(e){case"hex":b=function(V,$,Z){var J=V.length;(!$||$<0)&&($=0),(!Z||Z<0||J<Z)&&(Z=J);for(var W="",q=$;q<Z;q++)W+=R(V[q]);return W}(F,o,a);break;case"utf8":case"utf-8":b=function(V,$,Z){var J="",W="";Z=Math.min(V.length,Z);for(var q=$;q<Z;q++)V[q]<=127?(J+=de(W)+String.fromCharCode(V[q]),W=""):W+="%"+V[q].toString(16);return J+de(W)}(F,o,a);break;case"ascii":case"binary":b=A(F,o,a);break;case"base64":d=F,S=a,b=(I=o)===0&&S===d.length?w.fromByteArray(d):w.fromByteArray(d.slice(I,S));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":b=function(V,$,Z){for(var J=V.slice($,Z),W="",q=0;q<J.length;q+=2)W+=String.fromCharCode(J[q]+256*J[q+1]);return W}(F,o,a);break;default:throw new Error("Unknown encoding")}return b},p.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},p.prototype.copy=function(e,o,a,b){if(o=o||0,(b=b||b===0?b:this.length)!==(a=a||0)&&e.length!==0&&this.length!==0){v(a<=b,"sourceEnd < sourceStart"),v(0<=o&&o<e.length,"targetStart out of bounds"),v(0<=a&&a<this.length,"sourceStart out of bounds"),v(0<=b&&b<=this.length,"sourceEnd out of bounds"),b>this.length&&(b=this.length);var d=(b=e.length-o<b-a?e.length-o+a:b)-a;if(d<100||!p._useTypedArrays)for(var I=0;I<d;I++)e[I+o]=this[I+a];else e._set(this.subarray(a,a+d),o)}},p.prototype.slice=function(e,o){var a=this.length;if(e=z(e,a,0),o=z(o,a,a),p._useTypedArrays)return p._augment(this.subarray(e,o));for(var b=o-e,d=new p(b,void 0,!0),I=0;I<b;I++)d[I]=this[I+e];return d},p.prototype.get=function(e){return this.readUInt8(e)},p.prototype.set=function(e,o){return this.writeUInt8(e,o)},p.prototype.readUInt8=function(e,o){if(o||(v(e!=null,"missing offset"),v(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return this[e]},p.prototype.readUInt16LE=function(e,o){return y(this,e,!0,o)},p.prototype.readUInt16BE=function(e,o){return y(this,e,!1,o)},p.prototype.readUInt32LE=function(e,o){return x(this,e,!0,o)},p.prototype.readUInt32BE=function(e,o){return x(this,e,!1,o)},p.prototype.readInt8=function(e,o){if(o||(v(e!=null,"missing offset"),v(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return 128&this[e]?-1*(255-this[e]+1):this[e]},p.prototype.readInt16LE=function(e,o){return u(this,e,!0,o)},p.prototype.readInt16BE=function(e,o){return u(this,e,!1,o)},p.prototype.readInt32LE=function(e,o){return l(this,e,!0,o)},p.prototype.readInt32BE=function(e,o){return l(this,e,!1,o)},p.prototype.readFloatLE=function(e,o){return r(this,e,!0,o)},p.prototype.readFloatBE=function(e,o){return r(this,e,!1,o)},p.prototype.readDoubleLE=function(e,o){return i(this,e,!0,o)},p.prototype.readDoubleBE=function(e,o){return i(this,e,!1,o)},p.prototype.writeUInt8=function(e,o,a){a||(v(e!=null,"missing value"),v(o!=null,"missing offset"),v(o<this.length,"trying to write beyond buffer length"),ue(e,255)),o>=this.length||(this[o]=e)},p.prototype.writeUInt16LE=function(e,o,a){t(this,e,o,!0,a)},p.prototype.writeUInt16BE=function(e,o,a){t(this,e,o,!1,a)},p.prototype.writeUInt32LE=function(e,o,a){s(this,e,o,!0,a)},p.prototype.writeUInt32BE=function(e,o,a){s(this,e,o,!1,a)},p.prototype.writeInt8=function(e,o,a){a||(v(e!=null,"missing value"),v(o!=null,"missing offset"),v(o<this.length,"Trying to write beyond buffer length"),ce(e,127,-128)),o>=this.length||(0<=e?this.writeUInt8(e,o,a):this.writeUInt8(255+e+1,o,a))},p.prototype.writeInt16LE=function(e,o,a){c(this,e,o,!0,a)},p.prototype.writeInt16BE=function(e,o,a){c(this,e,o,!1,a)},p.prototype.writeInt32LE=function(e,o,a){N(this,e,o,!0,a)},p.prototype.writeInt32BE=function(e,o,a){N(this,e,o,!1,a)},p.prototype.writeFloatLE=function(e,o,a){j(this,e,o,!0,a)},p.prototype.writeFloatBE=function(e,o,a){j(this,e,o,!1,a)},p.prototype.writeDoubleLE=function(e,o,a){T(this,e,o,!0,a)},p.prototype.writeDoubleBE=function(e,o,a){T(this,e,o,!1,a)},p.prototype.fill=function(e,o,a){if(o=o||0,a=a||this.length,v(typeof(e=typeof(e=e||0)=="string"?e.charCodeAt(0):e)=="number"&&!isNaN(e),"value is not a number"),v(o<=a,"end < start"),a!==o&&this.length!==0){v(0<=o&&o<this.length,"start out of bounds"),v(0<=a&&a<=this.length,"end out of bounds");for(var b=o;b<a;b++)this[b]=e}},p.prototype.inspect=function(){for(var e=[],o=this.length,a=0;a<o;a++)if(e[a]=R(this[a]),a===f.INSPECT_MAX_BYTES){e[a+1]="...";break}return"<Buffer "+e.join(" ")+">"},p.prototype.toArrayBuffer=function(){if(typeof Uint8Array=="undefined")throw new Error("Buffer.toArrayBuffer not supported in this browser");if(p._useTypedArrays)return new p(this).buffer;for(var e=new Uint8Array(this.length),o=0,a=e.length;o<a;o+=1)e[o]=this[o];return e.buffer};var O=p.prototype;function z(e,o,a){return typeof e!="number"?a:o<=(e=~~e)?o:0<=e||0<=(e+=o)?e:0}function M(e){return(e=~~Math.ceil(+e))<0?0:e}function D(e){return(Array.isArray||function(o){return Object.prototype.toString.call(o)==="[object Array]"})(e)}function R(e){return e<16?"0"+e.toString(16):e.toString(16)}function H(e){for(var o=[],a=0;a<e.length;a++){var b=e.charCodeAt(a);if(b<=127)o.push(e.charCodeAt(a));else for(var d=a,I=(55296<=b&&b<=57343&&a++,encodeURIComponent(e.slice(d,a+1)).substr(1).split("%")),S=0;S<I.length;S++)o.push(parseInt(I[S],16))}return o}function ge(e){return w.toByteArray(e)}function ne(e,o,a,b){for(var d=0;d<b&&!(d+a>=o.length||d>=e.length);d++)o[d+a]=e[d];return d}function de(e){try{return decodeURIComponent(e)}catch(o){return String.fromCharCode(65533)}}function ue(e,o){v(typeof e=="number","cannot write a non-number as a number"),v(0<=e,"specified a negative value for writing an unsigned value"),v(e<=o,"value is larger than maximum value for type"),v(Math.floor(e)===e,"value has a fractional component")}function ce(e,o,a){v(typeof e=="number","cannot write a non-number as a number"),v(e<=o,"value larger than maximum allowed value"),v(a<=e,"value smaller than minimum allowed value"),v(Math.floor(e)===e,"value has a fractional component")}function ye(e,o,a){v(typeof e=="number","cannot write a non-number as a number"),v(e<=o,"value larger than maximum allowed value"),v(a<=e,"value smaller than minimum allowed value")}function v(e,o){if(!e)throw new Error(o||"Failed assertion")}p._augment=function(e){return e._isBuffer=!0,e._get=e.get,e._set=e.set,e.get=O.get,e.set=O.set,e.write=O.write,e.toString=O.toString,e.toLocaleString=O.toString,e.toJSON=O.toJSON,e.copy=O.copy,e.slice=O.slice,e.readUInt8=O.readUInt8,e.readUInt16LE=O.readUInt16LE,e.readUInt16BE=O.readUInt16BE,e.readUInt32LE=O.readUInt32LE,e.readUInt32BE=O.readUInt32BE,e.readInt8=O.readInt8,e.readInt16LE=O.readInt16LE,e.readInt16BE=O.readInt16BE,e.readInt32LE=O.readInt32LE,e.readInt32BE=O.readInt32BE,e.readFloatLE=O.readFloatLE,e.readFloatBE=O.readFloatBE,e.readDoubleLE=O.readDoubleLE,e.readDoubleBE=O.readDoubleBE,e.writeUInt8=O.writeUInt8,e.writeUInt16LE=O.writeUInt16LE,e.writeUInt16BE=O.writeUInt16BE,e.writeUInt32LE=O.writeUInt32LE,e.writeUInt32BE=O.writeUInt32BE,e.writeInt8=O.writeInt8,e.writeInt16LE=O.writeInt16LE,e.writeInt16BE=O.writeInt16BE,e.writeInt32LE=O.writeInt32LE,e.writeInt32BE=O.writeInt32BE,e.writeFloatLE=O.writeFloatLE,e.writeFloatBE=O.writeFloatBE,e.writeDoubleLE=O.writeDoubleLE,e.writeDoubleBE=O.writeDoubleBE,e.fill=O.fill,e.inspect=O.inspect,e.toArrayBuffer=O.toArrayBuffer,e}}).call(this,P("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},P("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:10,lYpoI2:11}],4:[function(P,n,f){(function(m,_,w,L,k,C,Y,K,U){var w=P("buffer").Buffer,E=4,p=new w(E);p.fill(0),n.exports={hash:function(h,g,A,y){for(var x=g(function(t,s){t.length%E!=0&&(c=t.length+(E-t.length%E),t=w.concat([t,p],c));for(var c,N=[],j=s?t.readInt32BE:t.readInt32LE,T=0;T<t.length;T+=E)N.push(j.call(t,T));return N}(h=w.isBuffer(h)?h:new w(h),y),8*h.length),g=y,u=new w(A),l=g?u.writeInt32BE:u.writeInt32LE,r=0;r<x.length;r++)l.call(u,x[r],4*r,!0);return u}}}).call(this,P("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},P("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],5:[function(P,n,f){(function(m,_,w,L,k,C,Y,K,U){var w=P("buffer").Buffer,E=P("./sha"),p=P("./sha256"),h=P("./rng"),g={sha1:E,sha256:p,md5:P("./md5")},A=64,y=new w(A);function x(t,s){var c=g[t=t||"sha1"],N=[];return c||u("algorithm:",t,"is not yet supported"),{update:function(j){return w.isBuffer(j)||(j=new w(j)),N.push(j),j.length,this},digest:function(j){var T=w.concat(N),T=s?function(O,z,M){w.isBuffer(z)||(z=new w(z)),w.isBuffer(M)||(M=new w(M)),z.length>A?z=O(z):z.length<A&&(z=w.concat([z,y],A));for(var D=new w(A),R=new w(A),H=0;H<A;H++)D[H]=54^z[H],R[H]=92^z[H];return M=O(w.concat([D,M])),O(w.concat([R,M]))}(c,s,T):c(T);return N=null,j?T.toString(j):T}}}function u(){var t=[].slice.call(arguments).join(" ");throw new Error([t,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join(`
`))}y.fill(0),f.createHash=function(t){return x(t)},f.createHmac=x,f.randomBytes=function(t,s){if(!s||!s.call)return new w(h(t));try{s.call(this,void 0,new w(h(t)))}catch(c){s(c)}};var l,r=["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],i=function(t){f[t]=function(){u("sorry,",t,"is not implemented yet")}};for(l in r)i(r[l],l)}).call(this,P("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},P("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:11}],6:[function(P,n,f){(function(m,_,B,L,k,C,Y,K,U){var w=P("./helpers");function E(u,l){u[l>>5]|=128<<l%32,u[14+(l+64>>>9<<4)]=l;for(var r=1732584193,i=-271733879,t=-1732584194,s=271733878,c=0;c<u.length;c+=16){var N=r,j=i,T=t,O=s,r=h(r,i,t,s,u[c+0],7,-680876936),s=h(s,r,i,t,u[c+1],12,-389564586),t=h(t,s,r,i,u[c+2],17,606105819),i=h(i,t,s,r,u[c+3],22,-1044525330);r=h(r,i,t,s,u[c+4],7,-176418897),s=h(s,r,i,t,u[c+5],12,1200080426),t=h(t,s,r,i,u[c+6],17,-1473231341),i=h(i,t,s,r,u[c+7],22,-45705983),r=h(r,i,t,s,u[c+8],7,1770035416),s=h(s,r,i,t,u[c+9],12,-1958414417),t=h(t,s,r,i,u[c+10],17,-42063),i=h(i,t,s,r,u[c+11],22,-1990404162),r=h(r,i,t,s,u[c+12],7,1804603682),s=h(s,r,i,t,u[c+13],12,-40341101),t=h(t,s,r,i,u[c+14],17,-1502002290),r=g(r,i=h(i,t,s,r,u[c+15],22,1236535329),t,s,u[c+1],5,-165796510),s=g(s,r,i,t,u[c+6],9,-1069501632),t=g(t,s,r,i,u[c+11],14,643717713),i=g(i,t,s,r,u[c+0],20,-373897302),r=g(r,i,t,s,u[c+5],5,-701558691),s=g(s,r,i,t,u[c+10],9,38016083),t=g(t,s,r,i,u[c+15],14,-660478335),i=g(i,t,s,r,u[c+4],20,-405537848),r=g(r,i,t,s,u[c+9],5,568446438),s=g(s,r,i,t,u[c+14],9,-1019803690),t=g(t,s,r,i,u[c+3],14,-187363961),i=g(i,t,s,r,u[c+8],20,1163531501),r=g(r,i,t,s,u[c+13],5,-1444681467),s=g(s,r,i,t,u[c+2],9,-51403784),t=g(t,s,r,i,u[c+7],14,1735328473),r=A(r,i=g(i,t,s,r,u[c+12],20,-1926607734),t,s,u[c+5],4,-378558),s=A(s,r,i,t,u[c+8],11,-2022574463),t=A(t,s,r,i,u[c+11],16,1839030562),i=A(i,t,s,r,u[c+14],23,-35309556),r=A(r,i,t,s,u[c+1],4,-1530992060),s=A(s,r,i,t,u[c+4],11,1272893353),t=A(t,s,r,i,u[c+7],16,-155497632),i=A(i,t,s,r,u[c+10],23,-1094730640),r=A(r,i,t,s,u[c+13],4,681279174),s=A(s,r,i,t,u[c+0],11,-358537222),t=A(t,s,r,i,u[c+3],16,-722521979),i=A(i,t,s,r,u[c+6],23,76029189),r=A(r,i,t,s,u[c+9],4,-640364487),s=A(s,r,i,t,u[c+12],11,-421815835),t=A(t,s,r,i,u[c+15],16,530742520),r=y(r,i=A(i,t,s,r,u[c+2],23,-995338651),t,s,u[c+0],6,-198630844),s=y(s,r,i,t,u[c+7],10,1126891415),t=y(t,s,r,i,u[c+14],15,-1416354905),i=y(i,t,s,r,u[c+5],21,-57434055),r=y(r,i,t,s,u[c+12],6,1700485571),s=y(s,r,i,t,u[c+3],10,-1894986606),t=y(t,s,r,i,u[c+10],15,-1051523),i=y(i,t,s,r,u[c+1],21,-2054922799),r=y(r,i,t,s,u[c+8],6,1873313359),s=y(s,r,i,t,u[c+15],10,-30611744),t=y(t,s,r,i,u[c+6],15,-1560198380),i=y(i,t,s,r,u[c+13],21,1309151649),r=y(r,i,t,s,u[c+4],6,-145523070),s=y(s,r,i,t,u[c+11],10,-1120210379),t=y(t,s,r,i,u[c+2],15,718787259),i=y(i,t,s,r,u[c+9],21,-343485551),r=x(r,N),i=x(i,j),t=x(t,T),s=x(s,O)}return Array(r,i,t,s)}function p(u,l,r,i,t,s){return x((l=x(x(l,u),x(i,s)))<<t|l>>>32-t,r)}function h(u,l,r,i,t,s,c){return p(l&r|~l&i,u,l,t,s,c)}function g(u,l,r,i,t,s,c){return p(l&i|r&~i,u,l,t,s,c)}function A(u,l,r,i,t,s,c){return p(l^r^i,u,l,t,s,c)}function y(u,l,r,i,t,s,c){return p(r^(l|~i),u,l,t,s,c)}function x(u,l){var r=(65535&u)+(65535&l);return(u>>16)+(l>>16)+(r>>16)<<16|65535&r}n.exports=function(u){return w.hash(u,E,16)}}).call(this,P("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},P("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],7:[function(P,n,f){(function(m,_,B,L,k,C,Y,K,U){var w;n.exports=w||function(E){for(var p,h=new Array(E),g=0;g<E;g++)!(3&g)&&(p=4294967296*Math.random()),h[g]=p>>>((3&g)<<3)&255;return h}}).call(this,P("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},P("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],8:[function(P,n,f){(function(m,_,B,L,k,C,Y,K,U){var w=P("./helpers");function E(g,A){g[A>>5]|=128<<24-A%32,g[15+(A+64>>9<<4)]=A;for(var y,x,u,l=Array(80),r=1732584193,i=-271733879,t=-1732584194,s=271733878,c=-1009589776,N=0;N<g.length;N+=16){for(var j=r,T=i,O=t,z=s,M=c,D=0;D<80;D++){l[D]=D<16?g[N+D]:h(l[D-3]^l[D-8]^l[D-14]^l[D-16],1);var R=p(p(h(r,5),(R=i,x=t,u=s,(y=D)<20?R&x|~R&u:!(y<40)&&y<60?R&x|R&u|x&u:R^x^u)),p(p(c,l[D]),(y=D)<20?1518500249:y<40?1859775393:y<60?-1894007588:-899497514)),c=s,s=t,t=h(i,30),i=r,r=R}r=p(r,j),i=p(i,T),t=p(t,O),s=p(s,z),c=p(c,M)}return Array(r,i,t,s,c)}function p(g,A){var y=(65535&g)+(65535&A);return(g>>16)+(A>>16)+(y>>16)<<16|65535&y}function h(g,A){return g<<A|g>>>32-A}n.exports=function(g){return w.hash(g,E,20,!0)}}).call(this,P("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},P("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],9:[function(P,n,f){(function(m,_,B,L,k,C,Y,K,U){function w(A,y){var x=(65535&A)+(65535&y);return(A>>16)+(y>>16)+(x>>16)<<16|65535&x}function E(A,y){var x,u=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),l=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),r=new Array(64);A[y>>5]|=128<<24-y%32,A[15+(y+64>>9<<4)]=y;for(var i,t,s=0;s<A.length;s+=16){for(var c=l[0],N=l[1],j=l[2],T=l[3],O=l[4],z=l[5],M=l[6],D=l[7],R=0;R<64;R++)r[R]=R<16?A[R+s]:w(w(w((t=r[R-2],h(t,17)^h(t,19)^g(t,10)),r[R-7]),(t=r[R-15],h(t,7)^h(t,18)^g(t,3))),r[R-16]),x=w(w(w(w(D,h(t=O,6)^h(t,11)^h(t,25)),O&z^~O&M),u[R]),r[R]),i=w(h(i=c,2)^h(i,13)^h(i,22),c&N^c&j^N&j),D=M,M=z,z=O,O=w(T,x),T=j,j=N,N=c,c=w(x,i);l[0]=w(c,l[0]),l[1]=w(N,l[1]),l[2]=w(j,l[2]),l[3]=w(T,l[3]),l[4]=w(O,l[4]),l[5]=w(z,l[5]),l[6]=w(M,l[6]),l[7]=w(D,l[7])}return l}var p=P("./helpers"),h=function(A,y){return A>>>y|A<<32-y},g=function(A,y){return A>>>y};n.exports=function(A){return p.hash(A,E,32,!0)}}).call(this,P("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},P("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],10:[function(P,n,f){(function(m,_,B,L,k,C,Y,K,U){f.read=function(w,E,p,h,s){var A,y,x=8*s-h-1,u=(1<<x)-1,l=u>>1,r=-7,i=p?s-1:0,t=p?-1:1,s=w[E+i];for(i+=t,A=s&(1<<-r)-1,s>>=-r,r+=x;0<r;A=256*A+w[E+i],i+=t,r-=8);for(y=A&(1<<-r)-1,A>>=-r,r+=h;0<r;y=256*y+w[E+i],i+=t,r-=8);if(A===0)A=1-l;else{if(A===u)return y?NaN:1/0*(s?-1:1);y+=Math.pow(2,h),A-=l}return(s?-1:1)*y*Math.pow(2,A-h)},f.write=function(w,E,p,h,g,c){var y,x,u=8*c-g-1,l=(1<<u)-1,r=l>>1,i=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,t=h?0:c-1,s=h?1:-1,c=E<0||E===0&&1/E<0?1:0;for(E=Math.abs(E),isNaN(E)||E===1/0?(x=isNaN(E)?1:0,y=l):(y=Math.floor(Math.log(E)/Math.LN2),E*(h=Math.pow(2,-y))<1&&(y--,h*=2),2<=(E+=1<=y+r?i/h:i*Math.pow(2,1-r))*h&&(y++,h/=2),l<=y+r?(x=0,y=l):1<=y+r?(x=(E*h-1)*Math.pow(2,g),y+=r):(x=E*Math.pow(2,r-1)*Math.pow(2,g),y=0));8<=g;w[p+t]=255&x,t+=s,x/=256,g-=8);for(y=y<<g|x,u+=g;0<u;w[p+t]=255&y,t+=s,y/=256,u-=8);w[p+t-s]|=128*c}}).call(this,P("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},P("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/ieee754/index.js","/node_modules/gulp-browserify/node_modules/ieee754")},{buffer:3,lYpoI2:11}],11:[function(P,n,f){(function(m,_,B,L,k,C,Y,K,U){var w,E,p;function h(){}(m=n.exports={}).nextTick=(E=typeof window!="undefined"&&window.setImmediate,p=typeof window!="undefined"&&window.postMessage&&window.addEventListener,E?function(g){return window.setImmediate(g)}:p?(w=[],window.addEventListener("message",function(g){var A=g.source;A!==window&&A!==null||g.data!=="process-tick"||(g.stopPropagation(),0<w.length&&w.shift()())},!0),function(g){w.push(g),window.postMessage("process-tick","*")}):function(g){setTimeout(g,0)}),m.title="browser",m.browser=!0,m.env={},m.argv=[],m.on=h,m.addListener=h,m.once=h,m.off=h,m.removeListener=h,m.removeAllListeners=h,m.emit=h,m.binding=function(g){throw new Error("process.binding is not supported")},m.cwd=function(){return"/"},m.chdir=function(g){throw new Error("process.chdir is not supported")}}).call(this,P("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},P("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:11}]},{},[1])(1)})});var se=pe(we(),1);var le=(P,n)=>P.reduce((f,m,_)=>{let B=Math.floor(_/n),L=f[B]||[];return f[B]=L.concat([m]),f},[]);var Be=pe(je(),1),fe=(...P)=>(0,Be.default)(P.join("_"));var ke=new Map,Q=class extends _e{constructor(n){super(),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cache=n!=null?n:new Map}lookup(n,f){var m;return Promise.resolve((m=this.cache.get(fe(n,f)))!=null?m:null)}async update(n,f,m){this.cache.set(fe(n,f),m)}static global(){return new Q(ke)}};var re=class extends Pe{constructor({cache:n,concurrency:f,...m}){super(f?{maxConcurrency:f,...m}:m),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof n=="object"?this.cache=n:n?this.cache=Q.global():this.cache=void 0}async generatePrompt(n,f,m){let _=n.map(B=>B.toString());return this.generate(_,f,m)}invocationParams(){return{}}async _generateUncached(n,f,m){let _=await Oe.configure(m,this.callbacks,{verbose:this.verbose}),B={invocation_params:this==null?void 0:this.invocationParams()},L=await(_==null?void 0:_.handleLLMStart({name:this._llmType()},n,void 0,void 0,B)),k;try{k=await this._generate(n,f,L)}catch(C){throw await(L==null?void 0:L.handleLLMError(C)),C}return await(L==null?void 0:L.handleLLMEnd(k)),Object.defineProperty(k,Ae,{value:L?{runId:L==null?void 0:L.runId}:void 0,configurable:!0}),k}async generate(n,f,m){var U,w;if(!Array.isArray(n))throw new Error("Argument 'prompts' is expected to be a string[]");let _;if(Array.isArray(f)?_={stop:f}:f!=null&&f.timeout&&!f.signal?_={...f,signal:AbortSignal.timeout(f.timeout)}:_=f!=null?f:{},!this.cache)return this._generateUncached(n,_,m);let{cache:B}=this,L=this.serialize();L.stop=(U=_.stop)!=null?U:L.stop;let k=`${Object.entries(L).sort()}`,C=[],Y=await Promise.all(n.map(async(E,p)=>{let h=await B.lookup(E,k);return h||C.push(p),h})),K={};if(C.length>0){let E=await this._generateUncached(C.map(p=>n[p]),_,m);await Promise.all(E.generations.map(async(p,h)=>{let g=C[h];return Y[g]=p,B.update(n[g],k,p)})),K=(w=E.llmOutput)!=null?w:{}}return{generations:Y,llmOutput:K}}async call(n,f,m){let{generations:_}=await this.generate([n],f!=null?f:{},m);return _[0][0].text}async predict(n,f,m){return this.call(n,f,m)}async predictMessages(n,f,m){let _=Ee(n),B=await this.call(_,f,m);return new ve(B)}_identifyingParams(){return{}}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}_modelType(){return"base_llm"}static async deserialize(n){let{_type:f,_model:m,..._}=n;if(m&&m!=="base_llm")throw new Error(`Cannot load LLM with model ${m}`);let B={openai:(await import("./EIOFNBDW.js")).OpenAI}[f];if(B===void 0)throw new Error(`Cannot load  LLM with type ${f}`);return new B(_)}},ie=class extends re{async _generate(n,f,m){return{generations:await Promise.all(n.map(B=>this._call(B,f,m).then(L=>[{text:L}])))}}};var ae=pe(we(),1);var ee=class extends ie{get callKeys(){return["stop","signal","timeout","options"]}constructor(n,f){var C,Y,K,U,w,E,p,h,g,A,y,x,u,l,r,i,t,s,c;super(n!=null?n:{}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"prefixMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0});let m=(Y=n==null?void 0:n.openAIApiKey)!=null?Y:typeof process!="undefined"?(C=process.env)==null?void 0:C.OPENAI_API_KEY:void 0,_=(U=n==null?void 0:n.azureOpenAIApiKey)!=null?U:typeof process!="undefined"?(K=process.env)==null?void 0:K.AZURE_OPENAI_API_KEY:void 0;if(!_&&!m)throw new Error("(Azure) OpenAI API key not found");let B=(E=n==null?void 0:n.azureOpenAIApiInstanceName)!=null?E:typeof process!="undefined"?(w=process.env)==null?void 0:w.AZURE_OPENAI_API_INSTANCE_NAME:void 0,L=(h=n==null?void 0:n.azureOpenAIApiDeploymentName)!=null?h:typeof process!="undefined"?(p=process.env)==null?void 0:p.AZURE_OPENAI_API_DEPLOYMENT_NAME:void 0,k=(A=n==null?void 0:n.azureOpenAIApiVersion)!=null?A:typeof process!="undefined"?(g=process.env)==null?void 0:g.AZURE_OPENAI_API_VERSION:void 0;if(this.modelName=(y=n==null?void 0:n.modelName)!=null?y:this.modelName,this.prefixMessages=(x=n==null?void 0:n.prefixMessages)!=null?x:this.prefixMessages,this.modelKwargs=(u=n==null?void 0:n.modelKwargs)!=null?u:{},this.timeout=n==null?void 0:n.timeout,this.temperature=(l=n==null?void 0:n.temperature)!=null?l:this.temperature,this.topP=(r=n==null?void 0:n.topP)!=null?r:this.topP,this.frequencyPenalty=(i=n==null?void 0:n.frequencyPenalty)!=null?i:this.frequencyPenalty,this.presencePenalty=(t=n==null?void 0:n.presencePenalty)!=null?t:this.presencePenalty,this.n=(s=n==null?void 0:n.n)!=null?s:this.n,this.logitBias=n==null?void 0:n.logitBias,this.maxTokens=n==null?void 0:n.maxTokens,this.stop=n==null?void 0:n.stop,this.streaming=(c=n==null?void 0:n.streaming)!=null?c:!1,this.azureOpenAIApiVersion=k,this.azureOpenAIApiKey=_,this.azureOpenAIApiInstanceName=B,this.azureOpenAIApiDeploymentName=L,this.streaming&&this.n>1)throw new Error("Cannot stream results when n > 1");if(this.azureOpenAIApiKey){if(!this.azureOpenAIApiInstanceName)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found")}this.clientConfig={apiKey:m,...f}}invocationParams(){return{model:this.modelName,temperature:this.temperature,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,n:this.n,logit_bias:this.logitBias,max_tokens:this.maxTokens===-1?void 0:this.maxTokens,stop:this.stop,stream:this.streaming,...this.modelKwargs}}_identifyingParams(){return{model_name:this.modelName,...this.invocationParams(),...this.clientConfig}}identifyingParams(){return{model_name:this.modelName,...this.invocationParams(),...this.clientConfig}}formatMessages(n){let f={role:"user",content:n};return this.prefixMessages?[...this.prefixMessages,f]:[f]}async _call(n,f,m){var k,C;let{stop:_}=f,B=this.invocationParams();return B.stop=_!=null?_:B.stop,(C=(k=(B.stream?await new Promise((Y,K)=>{let U,w=!1,E=!1;this.completionWithRetry({...B,messages:this.formatMessages(n)},{signal:f.signal,...f.options,adapter:G,responseType:"stream",onmessage:p=>{var h,g,A,y,x,u,l,r,i,t;if(((g=(h=p.data)==null?void 0:h.trim)==null?void 0:g.call(h))==="[DONE]"){if(E)return;E=!0,Y(U)}else{let s=JSON.parse(p.data);U||(U={id:s.id,object:s.object,created:s.created,model:s.model,choices:[]});for(let c of s.choices)if(c!=null){let N=U.choices.find(j=>j.index===c.index);N||(N={index:c.index,finish_reason:(A=c.finish_reason)!=null?A:void 0},U.choices.push(N)),N.message||(N.message={role:(y=c.delta)==null?void 0:y.role,content:(u=(x=c.delta)==null?void 0:x.content)!=null?u:""}),N.message.content+=(r=(l=c.delta)==null?void 0:l.content)!=null?r:"",m==null||m.handleLLMNewToken((t=(i=c.delta)==null?void 0:i.content)!=null?t:"")}!E&&s.choices.every(c=>c.finish_reason!=null)&&(E=!0,Y(U))}}}).catch(p=>{w||(w=!0,K(p))})}):await this.completionWithRetry({...B,messages:this.formatMessages(n)},{signal:f.signal,...f.options})).choices[0].message)==null?void 0:k.content)!=null?C:""}async completionWithRetry(n,f){if(!this.client){let _=this.azureOpenAIApiKey?`https://${this.azureOpenAIApiInstanceName}.openai.azure.com/openai/deployments/${this.azureOpenAIApiDeploymentName}`:this.clientConfig.basePath,B=new ae.Configuration({...this.clientConfig,basePath:_,baseOptions:{timeout:this.timeout,...this.clientConfig.baseOptions}});this.client=new ae.OpenAIApi(B)}let m={adapter:oe()?void 0:G,...this.clientConfig.baseOptions,...f};return this.azureOpenAIApiKey&&(m.headers={"api-key":this.azureOpenAIApiKey,...m.headers},m.params={"api-version":this.azureOpenAIApiVersion,...m.params}),this.caller.call(this.client.createChatCompletion.bind(this.client),n,m).then(_=>_.data)}_llmType(){return"openai"}},he=class extends ee{constructor(n){var f,m,_;if(super(n),Object.defineProperty(this,"promptLayerApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"plTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.plTags=(f=n==null?void 0:n.plTags)!=null?f:[],this.promptLayerApiKey=(_=n==null?void 0:n.promptLayerApiKey)!=null?_:typeof process!="undefined"?(m=process.env)==null?void 0:m.PROMPTLAYER_API_KEY:void 0,!this.promptLayerApiKey)throw new Error("Missing PromptLayer API key")}async completionWithRetry(n,f){var L;if(n.stream)return super.completionWithRetry(n,f);let m=Date.now(),_=await super.completionWithRetry(n),B=Date.now();return await this.caller.call(fetch,"https://api.promptlayer.com/track-request",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({function_name:"openai.ChatCompletion.create",args:[],kwargs:{engine:n.model,messages:n.messages},tags:(L=this.plTags)!=null?L:[],request_response:_,request_start_time:Math.floor(m/1e3),request_end_time:Math.floor(B/1e3),api_key:this.promptLayerApiKey})}),_}};var me=class extends re{get callKeys(){return["stop","signal","timeout","options"]}constructor(n,f){var C,Y,K,U,w,E,p,h,g,A,y,x,u,l,r,i,t,s,c,N,j,T,O,z,M;if((C=n==null?void 0:n.modelName)!=null&&C.startsWith("gpt-3.5-turbo")||(Y=n==null?void 0:n.modelName)!=null&&Y.startsWith("gpt-4")||(K=n==null?void 0:n.modelName)!=null&&K.startsWith("gpt-4-32k"))return new ee(n,f);super(n!=null?n:{}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:.7}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:256}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"bestOf",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"text-davinci-003"}),Object.defineProperty(this,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchSize",{enumerable:!0,configurable:!0,writable:!0,value:20}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0});let m=(w=n==null?void 0:n.openAIApiKey)!=null?w:typeof process!="undefined"?(U=process.env)==null?void 0:U.OPENAI_API_KEY:void 0,_=(p=n==null?void 0:n.azureOpenAIApiKey)!=null?p:typeof process!="undefined"?(E=process.env)==null?void 0:E.AZURE_OPENAI_API_KEY:void 0;if(!_&&!m)throw new Error("(Azure) OpenAI API key not found");let B=(g=n==null?void 0:n.azureOpenAIApiInstanceName)!=null?g:typeof process!="undefined"?(h=process.env)==null?void 0:h.AZURE_OPENAI_API_INSTANCE_NAME:void 0,L=(x=(n==null?void 0:n.azureOpenAIApiCompletionsDeploymentName)||(n==null?void 0:n.azureOpenAIApiDeploymentName))!=null?x:typeof process!="undefined"?((A=process.env)==null?void 0:A.AZURE_OPENAI_API_COMPLETIONS_DEPLOYMENT_NAME)||((y=process.env)==null?void 0:y.AZURE_OPENAI_API_DEPLOYMENT_NAME):void 0,k=(l=n==null?void 0:n.azureOpenAIApiVersion)!=null?l:typeof process!="undefined"?(u=process.env)==null?void 0:u.AZURE_OPENAI_API_VERSION:void 0;if(this.modelName=(r=n==null?void 0:n.modelName)!=null?r:this.modelName,this.modelKwargs=(i=n==null?void 0:n.modelKwargs)!=null?i:{},this.batchSize=(t=n==null?void 0:n.batchSize)!=null?t:this.batchSize,this.timeout=n==null?void 0:n.timeout,this.temperature=(s=n==null?void 0:n.temperature)!=null?s:this.temperature,this.maxTokens=(c=n==null?void 0:n.maxTokens)!=null?c:this.maxTokens,this.topP=(N=n==null?void 0:n.topP)!=null?N:this.topP,this.frequencyPenalty=(j=n==null?void 0:n.frequencyPenalty)!=null?j:this.frequencyPenalty,this.presencePenalty=(T=n==null?void 0:n.presencePenalty)!=null?T:this.presencePenalty,this.n=(O=n==null?void 0:n.n)!=null?O:this.n,this.bestOf=(z=n==null?void 0:n.bestOf)!=null?z:this.bestOf,this.logitBias=n==null?void 0:n.logitBias,this.stop=n==null?void 0:n.stop,this.streaming=(M=n==null?void 0:n.streaming)!=null?M:!1,this.azureOpenAIApiVersion=k,this.azureOpenAIApiKey=_,this.azureOpenAIApiInstanceName=B,this.azureOpenAIApiDeploymentName=L,this.streaming&&this.n>1)throw new Error("Cannot stream results when n > 1");if(this.streaming&&this.bestOf>1)throw new Error("Cannot stream results when bestOf > 1");if(this.azureOpenAIApiKey){if(!this.azureOpenAIApiInstanceName)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found")}this.clientConfig={apiKey:m,...f}}invocationParams(){return{model:this.modelName,temperature:this.temperature,max_tokens:this.maxTokens,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,n:this.n,best_of:this.bestOf,logit_bias:this.logitBias,stop:this.stop,stream:this.streaming,...this.modelKwargs}}_identifyingParams(){return{model_name:this.modelName,...this.invocationParams(),...this.clientConfig}}identifyingParams(){return this._identifyingParams()}async _generate(n,f,m){var K,U,w,E;let{stop:_}=f,B=le(n,this.batchSize),L=[],k={};if(this.stop&&_)throw new Error("Stop found in input and default params");let C=this.invocationParams();if(C.stop=_!=null?_:C.stop,C.max_tokens===-1){if(n.length!==1)throw new Error("max_tokens set to -1 not supported for multiple inputs");C.max_tokens=await Ie({prompt:n[0],modelName:this.modelName})}for(let p=0;p<B.length;p+=1){let h=C.stream?await new Promise((x,u)=>{let l=[],r,i=!1,t=!1;this.completionWithRetry({...C,prompt:B[p]},{signal:f.signal,...f.options,adapter:G,responseType:"stream",onmessage:s=>{var c,N,j,T,O;if(((N=(c=s.data)==null?void 0:c.trim)==null?void 0:N.call(c))==="[DONE]"){if(t)return;t=!0,x({...r,choices:l})}else{let z=JSON.parse(s.data);r||(r={id:z.id,object:z.object,created:z.created,model:z.model});for(let M of z.choices)if(M!=null&&M.index!=null){l[M.index]||(l[M.index]={});let D=l[M.index];D.text=((j=D.text)!=null?j:"")+((T=M.text)!=null?T:""),D.finish_reason=M.finish_reason,D.logprobs=M.logprobs,m==null||m.handleLLMNewToken((O=M.text)!=null?O:"")}!t&&l.every(M=>M.finish_reason!=null)&&(t=!0,x({...r,choices:l}))}}}).catch(s=>{i||(i=!0,u(s))})}):await this.completionWithRetry({...C,prompt:B[p]},{signal:f.signal,...f.options});L.push(...h.choices);let{completion_tokens:g,prompt_tokens:A,total_tokens:y}=(K=h.usage)!=null?K:{};g&&(k.completionTokens=((U=k.completionTokens)!=null?U:0)+g),A&&(k.promptTokens=((w=k.promptTokens)!=null?w:0)+A),y&&(k.totalTokens=((E=k.totalTokens)!=null?E:0)+y)}return{generations:le(L,this.n).map(p=>p.map(h=>{var g;return{text:(g=h.text)!=null?g:"",generationInfo:{finishReason:h.finish_reason,logprobs:h.logprobs}}})),llmOutput:{tokenUsage:k}}}async completionWithRetry(n,f){if(!this.client){let _=this.azureOpenAIApiKey?`https://${this.azureOpenAIApiInstanceName}.openai.azure.com/openai/deployments/${this.azureOpenAIApiDeploymentName}`:this.clientConfig.basePath,B=new se.Configuration({...this.clientConfig,basePath:_,baseOptions:{timeout:this.timeout,...this.clientConfig.baseOptions}});this.client=new se.OpenAIApi(B)}let m={adapter:oe()?void 0:G,...this.clientConfig.baseOptions,...f};return this.azureOpenAIApiKey&&(m.headers={"api-key":this.azureOpenAIApiKey,...m.headers},m.params={"api-version":this.azureOpenAIApiVersion,...m.params}),this.caller.call(this.client.createCompletion.bind(this.client),n,m).then(_=>_.data)}_llmType(){return"openai"}},Le=class extends me{constructor(n){var f,m,_;if(super(n),Object.defineProperty(this,"promptLayerApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"plTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.plTags=(f=n==null?void 0:n.plTags)!=null?f:[],this.promptLayerApiKey=(_=n==null?void 0:n.promptLayerApiKey)!=null?_:typeof process!="undefined"?(m=process.env)==null?void 0:m.PROMPTLAYER_API_KEY:void 0,!this.promptLayerApiKey)throw new Error("Missing PromptLayer API key")}async completionWithRetry(n,f){var L;if(n.stream)return super.completionWithRetry(n,f);let m=Date.now(),_=await super.completionWithRetry(n),B=Date.now();return await this.caller.call(fetch,"https://api.promptlayer.com/track-request",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({function_name:"openai.Completion.create",args:[],kwargs:{engine:n.model,prompt:n.prompt},tags:(L=this.plTags)!=null?L:[],request_response:_,request_start_time:Math.floor(m/1e3),request_end_time:Math.floor(B/1e3),api_key:this.promptLayerApiKey})}),_}};export{ee as a,he as b,me as c,Le as d};
