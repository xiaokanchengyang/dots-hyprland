import{a}from"./BKPH2F7R.js";import{a as l}from"./24353KEQ.js";import{g as s}from"./EVSA3OY5.js";var p=class extends l{get inputKeys(){return this.prompt.inputVariables}get outputKeys(){return[this.outputKey]}constructor(t){var e,r;if(super(t),Object.defineProperty(this,"prompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"llm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:"text"}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.prompt=t.prompt,this.llm=t.llm,this.outputKey=(e=t.outputKey)!=null?e:this.outputKey,this.outputParser=(r=t.outputParser)!=null?r:this.outputParser,this.prompt.outputParser){if(this.outputParser)throw new Error("Cannot set both outputParser and prompt.outputParser");this.outputParser=this.prompt.outputParser}}async _getFinalOutput(t,e,r){let i=t[0].text,o;return this.outputParser?o=await this.outputParser.parseWithPrompt(i,e,r==null?void 0:r.getChild()):o=i,o}call(t,e){return super.call(t,e)}async _call(t,e){let r={...t},i={};for(let u of this.llm.callKeys)u in t&&(i[u]=t[u],delete r[u]);let o=await this.prompt.formatPromptValue(r),{generations:m}=await this.llm.generatePrompt([o],i,e==null?void 0:e.getChild());return{[this.outputKey]:await this._getFinalOutput(m[0],o,e)}}async predict(t,e){return(await this.call(t,e))[this.outputKey]}_chainType(){return"llm_chain"}static async deserialize(t){let{llm:e,prompt:r}=t;if(!e)throw new Error("LLMChain must have llm");if(!r)throw new Error("LLMChain must have prompt");return new p({llm:await s.deserialize(e),prompt:await a.deserialize(r)})}serialize(){return{_type:this._chainType(),llm:this.llm.serialize(),prompt:this.prompt.serialize()}}};export{p as a};
