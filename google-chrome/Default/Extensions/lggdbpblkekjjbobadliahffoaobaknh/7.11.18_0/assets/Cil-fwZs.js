import{f as w,g as v,a as h,u as M,C as $,m as E,b as H,v as R}from"./CavFI0yr.js";const c=(t,n=document)=>{var e;const o=n.defaultView||window;if(t instanceof o.Element&&T.includes(t.tagName))return null;if(t instanceof o.HTMLElement){const r=t.closest(w);if(r){const a=(e=r.parentElement)==null?void 0:e.closest(w);return a&&v(a)===h.option?a:r}const i=t.querySelector(M(h.combobox));if(i)return i;const s=t.closest(I);if(s)return s;if(t instanceof o.HTMLSlotElement)return c(t.parentElement,n);if(t.assignedSlot)return c(t.assignedSlot,n);if(t.tabIndex<0){const a=t.getRootNode(),l=a instanceof o.ShadowRoot?a.host:null;if(l)return c(l,n)}return t}return t instanceof o.Node?c(t.parentElement,n):null},T=["HTML","BODY","IFRAME"],I='[aria-label]:not([role="region"]),[aria-labelledby]:not([role="dialog"],[role="region"]),[aria-haspopup]',N=["d","style"],S="data-tango",x=(t,n=document)=>{const e=n.defaultView||window,o=t.getAttributeNames(),r={},i=t instanceof e.HTMLInputElement&&t.type==="password";for(const s of o)if(!N.includes(s)&&!s.startsWith(S)&&!(i&&s==="value")){const a=t.getAttribute(s);(a==null||a.length<800)&&(r[s]=a)}return r},u=()=>{try{return window.self!==window.top}catch{return!0}},g="||",U=t=>{const n=t.querySelector("svg");if(n)return P(n);const e=t.querySelector("img");return e?C(e):null},L=/(\s+)|"|<|>|\//g,P=t=>{const n=t.innerHTML.replace(L,""),e=n.length,o=n.slice(0,50);let r="";if(e>100){const s=e/2-50;r=n.slice(s,s+50)}const i=n.slice(-50);return["svg",e,o,r,i].filter(Boolean).join(g)},C=t=>{const n=t.src;if(!n||n.startsWith("blob:"))return null;const e=n.length,o=["img",e];if(e>150){const r=n.slice(0,75),i=n.slice(-75);o.push(r,i)}else o.push(n);return o.filter(Boolean).join(g)},p="receiveFramePosition",m="requestFramePosition";function b(t,n){return u()?y().then(e=>d(t,e.offset,n)).catch(e=>(console.warn(`Could not find parent iframe, error given: ${e}`),d(t,void 0,n))):d(t,void 0,n)}function d(t,n={top:0,left:0},e){var o;const r=e.defaultView||window;if(!(t instanceof r.Element))return null;let i=t.getBoundingClientRect();if(B(t,e)&&i.width<5&&i.height<5){const s=(o=t.labels)==null?void 0:o[0];s&&(i=s.getBoundingClientRect())}return!W(i,0)||i.width===0||i.height===0?null:{width:Math.round(i.width),height:Math.round(i.height),x:Math.round(i.x+n.left),y:Math.round(i.y+n.top)}}const W=function(t,n){const e=window.innerHeight;return!(Math.floor(100-(t.top>=0?0:t.top)/+-t.height*100)<n||Math.floor(100-(t.bottom-e)/t.height*100)<n)},B=(t,n)=>{const e=n.defaultView||window;return t instanceof e.HTMLInputElement&&(t.type==="checkbox"||t.type==="radio")},y=async()=>new Promise((t,n)=>{const e=setTimeout(()=>{window.removeEventListener("message",o),n(new Error("No response from parent frame"))},500),o=r=>{r.data&&r.data.type===p&&(clearTimeout(e),t({offset:r.data.offset}))};window.addEventListener("message",o,{once:!0}),window.parent.postMessage({type:m},"*")}),V=t=>{const n=t.getBoundingClientRect(),e=Math.round(parseFloat(window.getComputedStyle(t,null).getPropertyValue("border-top-width"))),o=Math.round(parseFloat(window.getComputedStyle(t,null).getPropertyValue("border-left-width")));return{top:n.top+(Number.isNaN(e)?0:e),left:n.left+(Number.isNaN(o)?0:o)}},k=async t=>{var n;if(((n=t.data)==null?void 0:n.type)!==m||!t.source)return;const e=[...document.querySelectorAll("iframe")].find(r=>r.contentWindow===t.source);if(!e)return;const o=V(e);if(u())try{const{offset:r}=await y();r&&(o.top+=r.top,o.left+=r.left)}catch(r){console.warn(`Could not find nested iframe, error given: ${r}`)}t.source.postMessage({type:p,offset:o},"*")},q=t=>{let n=0,e=t;for(;e;)n+=e.offsetTop||0,e=e.offsetParent;return Math.round(n)},F=100,D=async(t,n={})=>{const{doc:e=document,tabUrl:o,cssSelectors:r=!0}=n;if(!t)return{attributes:"{}",baseURI:e.baseURI,tag:"",text:"",xPath:void 0,iframeURI:u()?e.baseURI:void 0,windowWidth:window.innerWidth,windowHeight:window.innerHeight,bounds:null};let i=!r,s={};const a=$(t,e),l=E(t,e);try{s=r?await H(t,typeof r=="number"?r:void 0,e):{}}catch{i=!0}return{...f(t,s.target,e),bounds:await b(t,e),baseURI:o||t.baseURI,iframeURI:u()?t.baseURI:void 0,windowWidth:window.innerWidth,windowHeight:window.innerHeight,parent:a?await A(a,s.parent,e):void 0,labelledBy:l?f(l,s.label,e):void 0,iconHash:U(t)||void 0,offsetTop:q(t),cssSelectorGenerationTimedOut:i}},f=(t,n,e)=>({attributes:JSON.stringify(x(t,e)),tag:t.nodeName,text:O(t,e),xPath:n}),A=async(t,n,e)=>{const o=f(t,n,e);return R(t)&&(o.bounds=await b(t,e)),o},O=(t,n)=>{const e=n.defaultView||window;return t instanceof e.HTMLElement?t.innerText.slice(0,F):""};export{F as E,D as W,q as f,k as g,U as i,c as l,u as r,x as u};
//# sourceMappingURL=Cil-fwZs.js.map
