import{r as y,R as ge}from"./bVFUYZgl.js";import{m as P,s as Le,a as Dr}from"./DieEiE9e.js";import{f as $,b as He,h as Pi}from"./DlLMD6w7.js";import{ad as Di,v as $r,n as $i,d as Ri,ae as Ui,e as At,af as Mi,A as Li,l as ji}from"./Cm1H3WaY.js";import{l as Ie}from"./BAD7DE-7.js";import{j as pt}from"./CMhnKYCA.js";import{a as je,M as ue,b as mt}from"./SHnOzo4l.js";import{r as Wi}from"./BjgJiouD.js";import{i as Fi}from"./Cjbr4oTZ.js";import{t as Hi}from"./BTyHENqi.js";import{g as zi}from"./CqgvlWIA.js";import{a as Bi,u as It}from"./Dph_3Rnf.js";import{d as Ki}from"./DvGmMwA7.js";import{d as Vi}from"./QipNwzXz.js";var qi=Object.defineProperty,Yi=(e,t)=>{for(var n in t)qi(e,n,{get:t[n],enumerable:!0})},Rr="@liveblocks/core",et="2.7.0",Gi="esm",vt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},Qi="https://liveblocks.io/docs/errors/cross-linked",Ji="https://liveblocks.io/docs/errors/dupes",Hn=" ";function zn(e){console.error(e)}function _n(e,t,n){const r=Symbol.for(e),o=n?`${t||"dev"} (${n})`:t||"dev";if(!vt[r])vt[r]=o;else if(vt[r]!==o){const i=[`Multiple copies of Liveblocks are being loaded in your project. This will cause issues! See ${Ji+Hn}`,"","Conflicts:",`- ${e} ${vt[r]} (already loaded)`,`- ${e} ${o} (trying to load this now)`].join(`
`);zn(i)}t&&et&&t!==et&&zn([`Cross-linked versions of Liveblocks found, which will cause issues! See ${Qi+Hn}`,"","Conflicts:",`- ${Rr} is at ${et}`,`- ${e} is at ${t}`,"","Always upgrade all Liveblocks packages to the same version number."].join(`
`))}function oe(e,t){throw new Error(t)}function O(e,t="Expected value to be non-nullable"){return e}function Ur(){let e,t;return[new Promise((r,o)=>{e=r,t=o}),e,t]}function Mr(){const[e,t,n]=Ur();return{promise:e,resolve:t,reject:n}}function L(){const e=new Set,t=new Set;let n=null;function r(){n=[]}function o(){if(n!==null){for(const b of n)u(b);n=null}}function i(b){return t.add(b),()=>t.delete(b)}function s(b){return e.add(b),()=>e.delete(b)}async function a(b){let w;return new Promise(S=>{w=i(E=>{(b===void 0||b(E))&&S(E)})}).finally(()=>w?.())}function c(b){n!==null?n.push(b):u(b)}function u(b){e.forEach(w=>w(b)),e.clear(),t.forEach(w=>w(b))}function l(){e.clear(),t.clear()}function f(){return e.size+t.size}return{notify:c,subscribe:i,subscribeOnce:s,clear:l,count:f,waitUntil:a,pause:r,unpause:o,observable:{subscribe:i,subscribeOnce:s,waitUntil:a}}}var We={};Yi(We,{error:()=>Wr,errorWithTitle:()=>Hr,warn:()=>ee,warnWithTitle:()=>Zi});var Lr="background:#0e0d12;border-radius:9999px;color:#fff;padding:3px 7px;font-family:sans-serif;font-weight:600;",Xi="font-weight:600";function jr(e){return typeof window>"u"?console[e]:(t,...n)=>console[e]("%cLiveblocks",Lr,t,...n)}var ee=jr("warn"),Wr=jr("error");function Fr(e){return typeof window>"u"?console[e]:(t,n,...r)=>console[e](`%cLiveblocks%c ${t}`,Lr,Xi,n,...r)}var Zi=Fr("warn"),Hr=Fr("error");function es(e,t){if(e===t)return[0,0];const n=e.split("."),r=t.split("."),o=Math.min(n.length,r.length);let i=0;for(;i<o&&n[i]===r[i];i++);const s=n.length-i,a=r.length-i;return[s,a]}function ts(e,t){const n=e.split(".");if(t<1||t>n.length+1)throw new Error("Invalid number of levels");const r=[];t>n.length&&r.push("*");for(let o=n.length-t+1;o<n.length;o++){const i=n.slice(0,o);i.length>0&&r.push(i.join(".")+".*")}return r.push(e),r}var ns=class{constructor(e){this.curr=e}get current(){return this.curr}allowPatching(e){const t=this;let n=!0;const r={...this.curr,patch(o){if(n){t.curr=Object.assign({},t.curr,o);for(const i of Object.entries(o)){const[s,a]=i;s!=="patch"&&(this[s]=a)}}else throw new Error("Can no longer patch stale context")}};e(r),n=!1}},rs=1,os=class{get initialState(){const e=this.states.values()[Symbol.iterator]().next();if(e.done)throw new Error("No states defined yet");return e.value}get currentState(){if(this.currentStateOrNull===null)throw this.runningState===0?new Error("Not started yet"):new Error("Already stopped");return this.currentStateOrNull}start(){if(this.runningState!==0)throw new Error("State machine has already started");return this.runningState=1,this.currentStateOrNull=this.initialState,this.enter(null),this}stop(){if(this.runningState!==1)throw new Error("Cannot stop a state machine that hasn't started yet");this.exit(null),this.runningState=2,this.currentStateOrNull=null}constructor(e){this.id=rs++,this.runningState=0,this.currentStateOrNull=null,this.states=new Set,this.enterFns=new Map,this.cleanupStack=[],this.knownEventTypes=new Set,this.allowedTransitions=new Map,this.currentContext=new ns(e),this.eventHub={didReceiveEvent:L(),willTransition:L(),didIgnoreEvent:L(),willExitState:L(),didEnterState:L()},this.events={didReceiveEvent:this.eventHub.didReceiveEvent.observable,willTransition:this.eventHub.willTransition.observable,didIgnoreEvent:this.eventHub.didIgnoreEvent.observable,willExitState:this.eventHub.willExitState.observable,didEnterState:this.eventHub.didEnterState.observable}}get context(){return this.currentContext.current}addState(e){if(this.runningState!==0)throw new Error("Already started");return this.states.add(e),this}onEnter(e,t){if(this.runningState!==0)throw new Error("Already started");if(this.enterFns.has(e))throw new Error(`enter/exit function for ${e} already exists`);return this.enterFns.set(e,t),this}onEnterAsync(e,t,n,r){return this.onEnter(e,()=>{const o=new AbortController,i=o.signal;let s=!1;return t(this.currentContext.current,i).then(a=>{i.aborted||(s=!0,this.transition({type:"ASYNC_OK",data:a},n))},a=>{i.aborted||(s=!0,this.transition({type:"ASYNC_ERROR",reason:a},r))}),()=>{s||o.abort()}})}getStatesMatching(e){const t=[];if(e==="*")for(const n of this.states)t.push(n);else if(e.endsWith(".*")){const n=e.slice(0,-1);for(const r of this.states)r.startsWith(n)&&t.push(r)}else{const n=e;this.states.has(n)&&t.push(n)}if(t.length===0)throw new Error(`No states match ${JSON.stringify(e)}`);return t}addTransitions(e,t){if(this.runningState!==0)throw new Error("Already started");for(const n of this.getStatesMatching(e)){let r=this.allowedTransitions.get(n);r===void 0&&(r=new Map,this.allowedTransitions.set(n,r));for(const[o,i]of Object.entries(t)){if(r.has(o))throw new Error(`Trying to set transition "${o}" on "${n}" (via "${e}"), but a transition already exists there.`);const s=i;if(this.knownEventTypes.add(o),s!==void 0){const a=typeof s=="function"?s:()=>s;r.set(o,a)}}}return this}addTimedTransition(e,t,n){return this.onEnter(e,()=>{const r=typeof t=="function"?t(this.currentContext.current):t,o=setTimeout(()=>{this.transition({type:"TIMER"},n)},r);return()=>{clearTimeout(o)}})}getTargetFn(e){return this.allowedTransitions.get(this.currentState)?.get(e)}exit(e){this.eventHub.willExitState.notify(this.currentState),this.currentContext.allowPatching(t=>{e=e??this.cleanupStack.length;for(let n=0;n<e;n++)this.cleanupStack.pop()?.(t)})}enter(e){const t=ts(this.currentState,e??this.currentState.split(".").length+1);this.currentContext.allowPatching(n=>{for(const r of t){const i=this.enterFns.get(r)?.(n);typeof i=="function"?this.cleanupStack.push(i):this.cleanupStack.push(null)}}),this.eventHub.didEnterState.notify(this.currentState)}send(e){if(!this.knownEventTypes.has(e.type))throw new Error(`Invalid event ${JSON.stringify(e.type)}`);if(this.runningState===2)return;const t=this.getTargetFn(e.type);if(t!==void 0)return this.transition(e,t);this.eventHub.didIgnoreEvent.notify(e)}transition(e,t){this.eventHub.didReceiveEvent.notify(e);const n=this.currentState,o=(typeof t=="function"?t:()=>t)(e,this.currentContext.current);let i,s;if(o===null){this.eventHub.didIgnoreEvent.notify(e);return}if(typeof o=="string"?i=o:(i=o.target,s=Array.isArray(o.effect)?o.effect:[o.effect]),!this.states.has(i))throw new Error(`Invalid next state name: ${JSON.stringify(i)}`);this.eventHub.willTransition.notify({from:n,to:i});const[a,c]=es(this.currentState,i);if(a>0&&this.exit(a),this.currentStateOrNull=i,s!==void 0){const u=s;this.currentContext.allowPatching(l=>{for(const f of u)typeof f=="function"?f(l,e):l.patch(f)})}c>0&&this.enter(c)}};function is(e){throw new Error(e)}function Tn(e){return e!==null&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"}function zr(e){return Object.entries(e)}function ss(e,t){const n={};for(const r of Object.entries(e)){const o=r[0];if(o==="__proto__")continue;const i=r[1];n[o]=t(i,o)}return n}function En(e){try{return JSON.parse(e)}catch{return}}function tt(e){return JSON.parse(JSON.stringify(e))}function as(e){try{const t=e.replace(/-/g,"+").replace(/_/g,"/");return decodeURIComponent(atob(t).split("").map(function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)}).join(""))}catch{return atob(e)}}function sn(e){return e.filter(t=>t!=null)}function Lt(e){const t={...e};return Object.keys(e).forEach(n=>{const r=n;t[r]===void 0&&delete t[r]}),t}function cs(e){return new Promise(t=>setTimeout(t,e))}async function Bn(e,t,n){let r;const o=new Promise((i,s)=>{r=setTimeout(()=>{s(new Error(n))},t)});return Promise.race([e,o]).finally(()=>clearTimeout(r))}function an(e){let t=null;return()=>(t===null&&(t=e().catch(n=>{throw setTimeout(()=>{t=null},5e3),n})),t)}var ce=(e=>(e[e.UPDATE_PRESENCE=100]="UPDATE_PRESENCE",e[e.USER_JOINED=101]="USER_JOINED",e[e.USER_LEFT=102]="USER_LEFT",e[e.BROADCASTED_EVENT=103]="BROADCASTED_EVENT",e[e.ROOM_STATE=104]="ROOM_STATE",e[e.INITIAL_STORAGE_STATE=200]="INITIAL_STORAGE_STATE",e[e.UPDATE_STORAGE=201]="UPDATE_STORAGE",e[e.REJECT_STORAGE_OP=299]="REJECT_STORAGE_OP",e[e.UPDATE_YDOC=300]="UPDATE_YDOC",e[e.THREAD_CREATED=400]="THREAD_CREATED",e[e.THREAD_DELETED=407]="THREAD_DELETED",e[e.THREAD_METADATA_UPDATED=401]="THREAD_METADATA_UPDATED",e[e.THREAD_UPDATED=408]="THREAD_UPDATED",e[e.COMMENT_CREATED=402]="COMMENT_CREATED",e[e.COMMENT_EDITED=403]="COMMENT_EDITED",e[e.COMMENT_DELETED=404]="COMMENT_DELETED",e[e.COMMENT_REACTION_ADDED=405]="COMMENT_REACTION_ADDED",e[e.COMMENT_REACTION_REMOVED=406]="COMMENT_REACTION_REMOVED",e))(ce||{});function Kn(e){return e===4999||e>=4e3&&e<4100}function us(e){return e>=4100&&e<4200}function Vn(e){return e===1013||e>=4200&&e<4300}function ds(e){return e==="initial"||e==="disconnected"}function Br(e){const t=e.currentState;switch(t){case"@ok.connected":case"@ok.awaiting-pong":return"connected";case"@idle.initial":return"initial";case"@auth.busy":case"@auth.backoff":case"@connecting.busy":case"@connecting.backoff":case"@idle.zombie":return e.context.successCount>0?"reconnecting":"connecting";case"@idle.failed":return"disconnected";default:return oe(t,"Unknown state")}}var Kr=[250,500,1e3,2e3,4e3,8e3,1e4],gt=Kr[0]-1,ls=[2e3,3e4,6e4,3e5],fs=3e4,hs=2e3,ps=1e4,ms=1e4,Ee=class extends Error{constructor(e){super(e)}},vs=class extends Error{constructor(e,t){super(e),this.code=t}};function Vr(e,t){return t.find(n=>n>e)??t[t.length-1]}function xe(e){e.patch({backoffDelay:Vr(e.backoffDelay,Kr)})}function qn(e){e.patch({backoffDelay:Vr(e.backoffDelay,ls)})}function Yn(e){e.patch({successCount:0})}function Re(e,t){const n=e===2?Wr:e===1?ee:()=>{};return()=>{n(t)}}function Gn(e){const t="Connection to Liveblocks websocket server";return n=>{e instanceof Error?ee(`${t} could not be established. ${String(e)}`):ee(qr(e)?`${t} closed prematurely (code: ${e.code}). Retrying in ${n.backoffDelay}ms.`:`${t} could not be established.`)}}function Yt(e){const t=[`code: ${e.code}`];return e.reason&&t.push(`reason: ${e.reason}`),n=>{ee(`Connection to Liveblocks websocket server closed (${t.join(", ")}). Retrying in ${n.backoffDelay}ms.`)}}var gs=Re(1,"Connection to WebSocket closed permanently. Won't retry.");function qr(e){return!(e instanceof Error)&&e.type==="close"}function ys(e){const t=new Date().getTime();function n(...o){ee(`${((new Date().getTime()-t)/1e3).toFixed(2)} [FSM #${e.id}]`,...o)}const r=[e.events.didReceiveEvent.subscribe(o=>n(`Event ${o.type}`)),e.events.willTransition.subscribe(({from:o,to:i})=>n("Transitioning",o,"→",i)),e.events.didIgnoreEvent.subscribe(o=>n("Ignored event",o.type,o,"(current state won't handle it)"))];return()=>{for(const o of r)o()}}function bs(e){const t=L(),n=L(),r=L();let o=null;const i=e.events.didEnterState.subscribe(()=>{const s=Br(e);s!==o&&t.notify(s),o==="connected"&&s!=="connected"?r.notify():o!=="connected"&&s==="connected"&&n.notify(),o=s});return{statusDidChange:t.observable,didConnect:n.observable,didDisconnect:r.observable,unsubscribe:i}}var yt=e=>t=>t.patch(e);function ws(e,t){const n=L();n.pause();const r=L();function o(p,v){return()=>{const k=new vs(p,v);r.notify(k)}}const i={successCount:0,authValue:null,socket:null,backoffDelay:gt},s=new os(i).addState("@idle.initial").addState("@idle.failed").addState("@idle.zombie").addState("@auth.busy").addState("@auth.backoff").addState("@connecting.busy").addState("@connecting.backoff").addState("@ok.connected").addState("@ok.awaiting-pong");s.addTransitions("*",{RECONNECT:{target:"@auth.backoff",effect:[xe,Yn]},DISCONNECT:"@idle.initial"}),s.onEnter("@idle.*",Yn).addTransitions("@idle.*",{CONNECT:(p,v)=>v.authValue!==null?"@connecting.busy":"@auth.busy"}),s.addTransitions("@auth.backoff",{NAVIGATOR_ONLINE:{target:"@auth.busy",effect:yt({backoffDelay:gt})}}).addTimedTransition("@auth.backoff",p=>p.backoffDelay,"@auth.busy").onEnterAsync("@auth.busy",()=>Bn(e.authenticate(),ps,"Timed out during auth"),p=>({target:"@connecting.busy",effect:yt({authValue:p.data})}),p=>p.reason instanceof Ee?{target:"@idle.failed",effect:[Re(2,p.reason.message),o(p.reason.message,-1)]}:{target:"@auth.backoff",effect:[xe,Re(2,`Authentication failed: ${p.reason instanceof Error?p.reason.message:String(p.reason)}`)]});const a=p=>s.send({type:"EXPLICIT_SOCKET_ERROR",event:p}),c=p=>s.send({type:"EXPLICIT_SOCKET_CLOSE",event:p}),u=p=>p.data==="pong"?s.send({type:"PONG"}):n.notify(p);function l(p){p&&(p.removeEventListener("error",a),p.removeEventListener("close",c),p.removeEventListener("message",u),p.close())}s.addTransitions("@connecting.backoff",{NAVIGATOR_ONLINE:{target:"@connecting.busy",effect:yt({backoffDelay:gt})}}).addTimedTransition("@connecting.backoff",p=>p.backoffDelay,"@connecting.busy").onEnterAsync("@connecting.busy",async(p,v)=>{let k=null,C=null;const x=new Promise((A,j)=>{if(p.authValue===null)throw new Error("No auth authValue");const M=e.createSocket(p.authValue);C=M;function q(R){k=R,M.removeEventListener("message",u),j(R)}const[be,fe]=Ur();t.waitForActorId||fe();function D(R){En(R.data)?.type===104&&fe()}M.addEventListener("message",u),t.waitForActorId&&M.addEventListener("message",D),M.addEventListener("error",q),M.addEventListener("close",q),M.addEventListener("open",()=>{M.addEventListener("error",a),M.addEventListener("close",c);const R=()=>{M.removeEventListener("error",q),M.removeEventListener("close",q),M.removeEventListener("message",D)};be.then(()=>{A([M,R])})})});return Bn(x,ms,"Timed out during websocket connection").then(([A,j])=>{if(j(),v.aborted)throw new Error("Aborted");if(k)throw k;return A}).catch(A=>{throw l(C),A})},p=>({target:"@ok.connected",effect:yt({socket:p.data,backoffDelay:gt})}),p=>{const v=p.reason;if(v instanceof Ee)return{target:"@idle.failed",effect:[Re(2,v.message),o(v.message,-1)]};if(qr(v)){if(v.code===4109)return"@auth.busy";if(Vn(v.code))return{target:"@connecting.backoff",effect:[qn,Gn(v)]};if(Kn(v.code))return{target:"@idle.failed",effect:[Re(2,v.reason),o(v.reason,v.code)]}}return{target:"@auth.backoff",effect:[xe,Gn(v)]}});const f={target:"@ok.awaiting-pong",effect:p=>{p.socket?.send("ping")}},b=()=>(typeof document<"u"?document:void 0)?.visibilityState==="hidden"&&e.canZombie()?"@idle.zombie":f;if(s.addTimedTransition("@ok.connected",fs,b).addTransitions("@ok.connected",{NAVIGATOR_OFFLINE:b,WINDOW_GOT_FOCUS:f}),s.addTransitions("@idle.zombie",{WINDOW_GOT_FOCUS:"@connecting.backoff"}),s.onEnter("@ok.*",p=>{p.patch({successCount:p.successCount+1});const v=setTimeout(n.unpause,0);return k=>{l(k.socket),k.patch({socket:null}),clearTimeout(v),n.pause()}}).addTransitions("@ok.awaiting-pong",{PONG:"@ok.connected"}).addTimedTransition("@ok.awaiting-pong",hs,{target:"@connecting.busy",effect:Re(1,"Received no pong from server, assume implicit connection loss.")}).addTransitions("@ok.*",{EXPLICIT_SOCKET_ERROR:(p,v)=>v.socket?.readyState===1?null:{target:"@connecting.backoff",effect:xe},EXPLICIT_SOCKET_CLOSE:p=>Kn(p.event.code)?{target:"@idle.failed",effect:[gs,o(p.event.reason,p.event.code)]}:us(p.event.code)?p.event.code===4109?"@auth.busy":{target:"@auth.backoff",effect:[xe,Yt(p.event)]}:Vn(p.event.code)?{target:"@connecting.backoff",effect:[qn,Yt(p.event)]}:{target:"@connecting.backoff",effect:[xe,Yt(p.event)]}}),typeof document<"u"){const p=typeof document<"u"?document:void 0,v=typeof window<"u"?window:void 0,k=v??p;s.onEnter("*",C=>{function x(){s.send({type:"NAVIGATOR_OFFLINE"})}function A(){s.send({type:"NAVIGATOR_ONLINE"})}function j(){p?.visibilityState==="visible"&&s.send({type:"WINDOW_GOT_FOCUS"})}return v?.addEventListener("online",A),v?.addEventListener("offline",x),k?.addEventListener("visibilitychange",j),()=>{k?.removeEventListener("visibilitychange",j),v?.removeEventListener("online",A),v?.removeEventListener("offline",x),l(C.socket)}})}const w=[],{statusDidChange:S,didConnect:E,didDisconnect:_,unsubscribe:g}=bs(s);return w.push(g),t.enableDebugLogging&&w.push(ys(s)),s.start(),{machine:s,cleanups:w,events:{statusDidChange:S,didConnect:E,didDisconnect:_,onMessage:n.observable,onLiveblocksError:r.observable}}}var _s=class{constructor(e,t=!1,n=!0){const{machine:r,events:o,cleanups:i}=ws(e,{waitForActorId:n,enableDebugLogging:t});this.machine=r,this.events=o,this.cleanups=i}getStatus(){try{return Br(this.machine)}catch{return"initial"}}get authValue(){return this.machine.context.authValue}connect(){this.machine.send({type:"CONNECT"})}reconnect(){this.machine.send({type:"RECONNECT"})}disconnect(){this.machine.send({type:"DISCONNECT"})}destroy(){this.machine.stop();let e;for(;e=this.cleanups.pop();)e()}send(e){const t=this.machine.context?.socket;t===null?ee("Cannot send: not connected yet",e):t.readyState!==1?ee("Cannot send: WebSocket no longer open",e):t.send(e)}_privateSendMachineEvent(e){this.machine.send(e)}};function cn(e){return e.includes("room:write")}function Yr(e){return e.includes("comments:write")||e.includes("room:write")}function Ts(e){return Tn(e)&&(e.k==="acc"||e.k==="id"||e.k==="sec-legacy")}function Qn(e){const t=e.split(".");if(t.length!==3)throw new Error("Authentication error: invalid JWT token");const n=En(as(t[1]));if(!(n&&Ts(n)))throw new Error("Authentication error: expected a valid token but did not get one. Hint: if you are using a callback, ensure the room is passed when creating the token. For more information: https://liveblocks.io/docs/api-reference/liveblocks-client#createClientCallback");return{raw:e,parsed:n}}function Es(e){const t=Ss(e),n=new Set,r=[],o=[],i=new Map;function s(){n.clear(),r.length=0,o.length=0,i.clear()}function a(f,b){return f==="comments:read"?b.includes("comments:read")||b.includes("comments:write")||b.includes("room:read")||b.includes("room:write"):f==="room:read"?b.includes("room:read")||b.includes("room:write"):!1}function c(f){const b=Math.ceil(Date.now()/1e3);for(let w=r.length-1;w>=0;w--){const S=r[w];if(o[w]<=b){r.splice(w,1),o.splice(w,1);continue}if(S.parsed.k==="id")return S;if(S.parsed.k==="acc"){if(!f.roomId&&Object.entries(S.parsed.perms).length===0)return S;for(const[_,g]of Object.entries(S.parsed.perms))if(f.roomId){if(_.includes("*")&&f.roomId.startsWith(_.replace("*",""))||f.roomId===_&&a(f.requestedScope,g))return S}else if(_.includes("*")&&a(f.requestedScope,g))return S}}}async function u(f){const b=e.polyfills?.fetch??(typeof window>"u"?void 0:window.fetch);if(t.type==="private"){if(b===void 0)throw new Ee("To use Liveblocks client in a non-DOM environment with a url as auth endpoint, you need to provide a fetch polyfill.");const w=await ks(b,t.url,{room:f.roomId}),S=Qn(w.token);if(n.has(S.raw))throw new Ee("The same Liveblocks auth token was issued from the backend before. Caching Liveblocks tokens is not supported.");return S}if(t.type==="custom"){const w=await t.callback(f.roomId);if(w&&typeof w=="object"){if(typeof w.token=="string")return Qn(w.token);if(typeof w.error=="string"){const S=`Authentication failed: ${"reason"in w&&typeof w.reason=="string"?w.reason:"Forbidden"}`;throw w.error==="forbidden"?new Ee(S):new Error(S)}}throw new Error('Your authentication callback function should return a token, but it did not. Hint: the return value should look like: { token: "..." }')}throw new Error("Unexpected authentication type. Must be private or custom.")}async function l(f){if(t.type==="public")return{type:"public",publicApiKey:t.publicApiKey};const b=c(f);if(b!==void 0)return{type:"secret",token:b};let w;f.roomId?(w=i.get(f.roomId),w===void 0&&(w=u(f),i.set(f.roomId,w))):(w=i.get("liveblocks-user-token"),w===void 0&&(w=u(f),i.set("liveblocks-user-token",w)));try{const S=await w,_=Math.floor(Date.now()/1e3)+(S.parsed.exp-S.parsed.iat)-30;return n.add(S.raw),S.parsed.k!=="sec-legacy"&&(r.push(S),o.push(_)),{type:"secret",token:S}}finally{f.roomId?i.delete(f.roomId):i.delete("liveblocks-user-token")}}return{reset:s,getAuthValue:l}}function Ss(e){const{publicApiKey:t,authEndpoint:n}=e;if(n!==void 0&&t!==void 0)throw new Error("You cannot simultaneously use `publicApiKey` and `authEndpoint` options. Please pick one and leave the other option unspecified. For more information: https://liveblocks.io/docs/api-reference/liveblocks-client#createClient");if(typeof t=="string"){if(t.startsWith("sk_"))throw new Error("Invalid `publicApiKey` option. The value you passed is a secret key, which should not be used from the client. Please only ever pass a public key here. For more information: https://liveblocks.io/docs/api-reference/liveblocks-client#createClientPublicKey");if(!t.startsWith("pk_"))throw new Error("Invalid key. Please use the public key format: pk_<public key>. For more information: https://liveblocks.io/docs/api-reference/liveblocks-client#createClientPublicKey");return{type:"public",publicApiKey:t}}if(typeof n=="string")return{type:"private",url:n};if(typeof n=="function")return{type:"custom",callback:n};throw n!==void 0?new Error("The `authEndpoint` option must be a string or a function. For more information: https://liveblocks.io/docs/api-reference/liveblocks-client#createClientAuthEndpoint"):new Error("Invalid Liveblocks client options. Please provide either a `publicApiKey` or `authEndpoint` option. They cannot both be empty. For more information: https://liveblocks.io/docs/api-reference/liveblocks-client#createClient")}async function ks(e,t,n){const r=await e(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!r.ok){const s=`${(await r.text()).trim()||"reason not provided in auth response"} (${r.status} returned by POST ${t})`;throw r.status===401||r.status===403?new Ee(`Unauthorized: ${s}`):new Error(`Failed to authenticate: ${s}`)}let o;try{o=await r.json()}catch(s){throw new Error(`Expected a JSON response when doing a POST request on "${t}". ${String(s)}`)}if(!Tn(o)||typeof o.token!="string")throw new Error(`Expected a JSON response of the form \`{ token: "..." }\` when doing a POST request on "${t}", but got ${JSON.stringify(o)}`);const{token:i}=o;return{token:i}}var Is="https://api.liveblocks.io",le=Symbol(),Cs=L();Cs.observable;function Nt(e,...t){if(typeof e!="object"||e===null||Array.isArray(e))return JSON.stringify(e,...t);const n=Object.keys(e).sort().reduce((r,o)=>(r[o]=e[o],r),{});return JSON.stringify(n,...t)}var Os=50,xs=class{constructor(e){this.input=e;const{promise:t,resolve:n,reject:r}=Mr();this.promise=t,this.resolve=n,this.reject=r}},Sn=class{constructor(e,t){this.queue=[],this.error=!1,this.callback=e,this.size=t.size??Os,this.delay=t.delay}clearDelayTimeout(){this.delayTimeoutId!==void 0&&(clearTimeout(this.delayTimeoutId),this.delayTimeoutId=void 0)}schedule(){this.queue.length===this.size?this.flush():this.queue.length===1&&(this.clearDelayTimeout(),this.delayTimeoutId=setTimeout(()=>void this.flush(),this.delay))}async flush(){if(this.queue.length===0)return;const e=this.queue.splice(0),t=e.map(n=>n.input);try{const n=await this.callback(t);this.error=!1,e.forEach((r,o)=>{const i=n?.[o];Array.isArray(n)?e.length!==n.length?r.reject(new Error(`Callback must return an array of the same length as the number of provided items. Expected ${e.length}, but got ${n.length}.`)):i instanceof Error?r.reject(i):r.resolve(i):r.reject(new Error("Callback must return an array."))})}catch(n){this.error=!0,e.forEach(r=>{r.reject(n)})}}get(e){const t=this.queue.find(r=>Nt(r.input)===Nt(e));if(t)return t.promise;const n=new xs(e);return this.queue.push(n),this.schedule(),n.promise}clear(){this.queue=[],this.error=!1,this.clearDelayTimeout()}};function Jn(e,t){const n=new Sn(e,t),r=new Map,o=L();function i(u){return Nt(u)}function s(u,l){r.set(u,l),o.notify()}async function a(u){const l=i(u);if(!r.has(l))try{s(l,{isLoading:!0});const f=await n.get(u);s(l,{isLoading:!1,data:f})}catch(f){s(l,{isLoading:!1,error:f})}}function c(u){const l=i(u);return r.get(l)}return{...o.observable,get:a,getState:c}}function Gr(e){let t=!0,n=!1,r=e;const o=new Set;function i(){return r}function s(l){const f=r,b=l(f);b!==f&&(r=b,n=!0),t&&a()}function a(){if(n){n=!1;for(const l of o)l(r)}}function c(l){if(t===!1)return l();t=!1;try{l()}finally{t=!0,a()}}function u(l){return o.add(l),l(r),()=>{o.delete(l)}}return{get:i,set:s,batch:c,subscribe:u}}function un(e){const t=e.editedAt?new Date(e.editedAt):void 0,n=new Date(e.createdAt),r=e.reactions.map(o=>({...o,createdAt:new Date(o.createdAt)}));if(e.body)return{...e,reactions:r,createdAt:n,editedAt:t};{const o=new Date(e.deletedAt);return{...e,reactions:r,createdAt:n,editedAt:t,deletedAt:o}}}function ve(e){const t=e.updatedAt?new Date(e.updatedAt):void 0,n=new Date(e.createdAt),r=e.comments.map(o=>un(o));return{...e,createdAt:n,updatedAt:t,comments:r}}function As(e){return{...e,createdAt:new Date(e.createdAt)}}function Te(e){const t=new Date(e.notifiedAt),n=e.readAt?new Date(e.readAt):null;if("activities"in e){const r=e.activities.map(o=>({...o,createdAt:new Date(o.createdAt)}));return{...e,notifiedAt:t,readAt:n,activities:r}}return{...e,notifiedAt:t,readAt:n}}function dn(e){const t=new Date(e.deletedAt);return{...e,deletedAt:t}}function ln(e){const t=new Date(e.deletedAt);return{...e,deletedAt:t}}function Ns(e){const t=new URLSearchParams;for(const[n,r]of Object.entries(e))r!=null&&t.set(n,r.toString());return t}function Qr(e,t,n){const r=new URL(t,e);return n!==void 0&&(r.search=(n instanceof URLSearchParams?n:Ns(n)).toString()),r.toString()}var Ps=50;function Ds({baseUrl:e,authManager:t,currentUserIdStore:n,fetcher:r}){async function o(_,g,p){const v=await t.getAuthValue({requestedScope:"comments:read"});if(v.type==="secret"&&v.token.parsed.k==="acc"){const A=v.token.parsed.uid;n.set(()=>A)}const k=Qr(e,`/v2/c${_}`,p),C=await r(k.toString(),{...g,headers:{...g?.headers,Authorization:`Bearer ${gn(v)}`}});if(!C.ok&&C.status>=400&&C.status<600){let A;try{const j=await C.json();A=new rt(j.message,C.status,j)}catch{A=new rt(C.statusText,C.status)}throw A}let x;try{x=await C.json()}catch{x={}}return x}async function i(){const _=await o("/inbox-notifications",void 0,{});return{threads:_.threads.map(ve),inboxNotifications:_.inboxNotifications.map(Te),requestedAt:new Date(_.meta.requestedAt)}}async function s(_){const g=await o("/inbox-notifications",void 0,{since:_.since.toISOString()});return{threads:{updated:g.threads.map(ve),deleted:g.deletedThreads.map(dn)},inboxNotifications:{updated:g.inboxNotifications.map(Te),deleted:g.deletedInboxNotifications.map(ln)},requestedAt:new Date(g.meta.requestedAt)}}async function a(){const{count:_}=await o("/inbox-notifications/count");return _}async function c(){await o("/inbox-notifications/read",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({inboxNotificationIds:"all"})})}async function u(_){await o("/inbox-notifications/read",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({inboxNotificationIds:_})})}const l=new Sn(async _=>{const g=_.flat();return await u(g),g},{delay:Ps});async function f(_){await l.get(_)}async function b(){await o("/inbox-notifications",{method:"DELETE"})}async function w(_){await o(`/inbox-notifications/${encodeURIComponent(_)}`,{method:"DELETE"})}async function S(_){let g;_?.query&&(g=mn(_.query));const p=await o("/threads",void 0,{query:g});return{threads:p.threads.map(ve),inboxNotifications:p.inboxNotifications.map(Te),requestedAt:new Date(p.meta.requestedAt)}}async function E(_){let g;_?.query&&(g=mn(_.query));const p=await o("/threads",void 0,{since:_.since.toISOString(),query:g});return{threads:{updated:p.threads.map(ve),deleted:p.deletedThreads.map(dn)},inboxNotifications:{updated:p.inboxNotifications.map(Te),deleted:p.deletedInboxNotifications.map(ln)},requestedAt:new Date(p.meta.requestedAt)}}return{getInboxNotifications:i,getInboxNotificationsSince:s,getUnreadInboxNotificationsCount:a,markAllInboxNotificationsAsRead:c,markInboxNotificationAsRead:f,deleteAllInboxNotifications:b,deleteInboxNotification:w,getThreads:S,getThreadsSince:E}}var Z=32,ye=126,$s=ye-Z+1,kn=In(0),jt=In(1),Rs=kn+In(-1);function In(e){const t=Z+(e<0?$s+e:e);if(t<Z||t>ye)throw new Error(`Invalid n value: ${e}`);return String.fromCharCode(t)}function ae(e,t){return e!==void 0&&t!==void 0?Ls(e,t):e!==void 0?Ms(e):t!==void 0?Us(t):jt}function Us(e){const t=e.length-1;for(let n=0;n<=t;n++){const r=e.charCodeAt(n);if(!(r<=Z))return n===t?r===Z+1?e.substring(0,n)+Rs:e.substring(0,n)+String.fromCharCode(r-1):e.substring(0,n+1)}return jt}function Ms(e){for(let t=0;t<=e.length-1;t++){const n=e.charCodeAt(t);if(!(n>=ye))return e.substring(0,t)+String.fromCharCode(n+1)}return e+jt}function Ls(e,t){if(e<t)return fn(e,t);if(e>t)return fn(t,e);throw new Error("Cannot compute value between two equal positions")}function fn(e,t){let n=0;const r=e.length,o=t.length;for(;;){const i=n<r?e.charCodeAt(n):Z,s=n<o?t.charCodeAt(n):ye;if(i===s){n++;continue}if(s-i===1){const a=n+1;let c=e.substring(0,a);c.length<a&&(c+=kn.repeat(a-c.length));const u=e.substring(a);return c+fn(u,"")}else return js(e,n)+String.fromCharCode(s+i>>1)}}function js(e,t){return t<e.length?e.substring(0,t):e+kn.repeat(t-e.length)}var Ws=Z+1;function Fs(e){if(e==="")return!1;const t=e.length-1,n=e.charCodeAt(t);if(n<Ws||n>ye)return!1;for(let r=0;r<t;r++){const o=e.charCodeAt(r);if(o<Z||o>ye)return!1}return!0}function Hs(e){const t=[];for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);t.push(r<Z?Z:r>ye?ye:r)}for(;t.length>0&&t[t.length-1]===Z;)t.length--;return t.length>0?String.fromCharCode(...t):jt}function nt(e){return Fs(e)?e:Hs(e)}function zs(e){return e.type===5&&e.id==="ACK"}function Xn(e,t,n=nt(t)){return Object.freeze({type:"HasParent",node:e,key:t,pos:n})}var Zn=Object.freeze({type:"NoParent"});function Bs(e,t=nt(e)){return Object.freeze({type:"Orphaned",oldKey:e,oldPos:t})}var Wt=class{constructor(){this._parent=Zn}_getParentKeyOrThrow(){switch(this.parent.type){case"HasParent":return this.parent.key;case"NoParent":throw new Error("Parent key is missing");case"Orphaned":return this.parent.oldKey;default:return oe(this.parent,"Unknown state")}}get _parentPos(){switch(this.parent.type){case"HasParent":return this.parent.pos;case"NoParent":throw new Error("Parent key is missing");case"Orphaned":return this.parent.oldPos;default:return oe(this.parent,"Unknown state")}}get _pool(){return this.__pool}get roomId(){return this.__pool?this.__pool.roomId:null}get _id(){return this.__id}get parent(){return this._parent}get _parentKey(){switch(this.parent.type){case"HasParent":return this.parent.key;case"NoParent":return null;case"Orphaned":return this.parent.oldKey;default:return oe(this.parent,"Unknown state")}}_apply(e,t){switch(e.type){case 5:return this.parent.type==="HasParent"?this.parent.node._detachChild(this):{modified:!1}}return{modified:!1}}_setParentLink(e,t){switch(this.parent.type){case"HasParent":if(this.parent.node!==e)throw new Error("Cannot set parent: node already has a parent");this._parent=Xn(e,t);return;case"Orphaned":case"NoParent":{this._parent=Xn(e,t);return}default:return oe(this.parent,"Unknown state")}}_attach(e,t){if(this.__id||this.__pool)throw new Error("Cannot attach node: already attached");t.addNode(e,this),this.__id=e,this.__pool=t}_detach(){switch(this.__pool&&this.__id&&this.__pool.deleteNode(this.__id),this.parent.type){case"HasParent":{this._parent=Bs(this.parent.key,this.parent.pos);break}case"NoParent":{this._parent=Zn;break}case"Orphaned":break;default:oe(this.parent,"Unknown state")}this.__pool=void 0}invalidate(){(this._cachedImmutable!==void 0||this._cachedTreeNode!==void 0)&&(this._cachedImmutable=void 0,this._cachedTreeNode=void 0,this.parent.type==="HasParent"&&this.parent.node.invalidate())}toTreeNode(e){return(this._cachedTreeNode===void 0||this._cachedTreeNodeKey!==e)&&(this._cachedTreeNodeKey=e,this._cachedTreeNode=this._toTreeNode(e)),this._cachedTreeNode}toImmutable(){return this._cachedImmutable===void 0&&(this._cachedImmutable=this._toImmutable()),this._cachedImmutable}};function Ks(e){return e.type===0&&!Vs(e)}function Vs(e){return e.parentId!==void 0&&e.parentKey!==void 0}var ze=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((t,n)=>t+=(n&=63)<36?n.toString(36):n<62?(n-26).toString(36).toUpperCase():n<63?"_":"-",""),Ce=class Jr extends Wt{constructor(t){super(),this._data=t}get data(){return this._data}static _deserialize([t,n],r,o){const i=new Jr(n.data);return i._attach(t,o),i}_toOps(t,n,r){if(this._id===void 0)throw new Error("Cannot serialize register if parentId or parentKey is undefined");return[{type:8,opId:r?.generateOpId(),id:this._id,parentId:t,parentKey:n,data:this.data}]}_serialize(){if(this.parent.type!=="HasParent")throw new Error("Cannot serialize LiveRegister if parent is missing");return{type:3,parentId:O(this.parent.node._id,"Parent node expected to have ID"),parentKey:this.parent.key,data:this.data}}_attachChild(t){throw new Error("Method not implemented.")}_detachChild(t){throw new Error("Method not implemented.")}_apply(t,n){return super._apply(t,n)}_toTreeNode(t){return{type:"Json",id:this._id??ze(),key:t,payload:this._data}}_toImmutable(){return this._data}clone(){return tt(this.data)}};function qs(e,t){const n=e._parentPos,r=t._parentPos;return n===r?0:n<r?-1:1}var Be=class hn extends Wt{constructor(t){super(),this._items=[],this._implicitlyDeletedItems=new WeakSet,this._unacknowledgedSets=new Map;let n;for(const r of t){const o=ae(n),i=Me(r);i._setParentLink(this,o),this._items.push(i),n=o}}static _deserialize([t],n,r){const o=new hn([]);o._attach(t,r);const i=n.get(t);if(i===void 0)return o;for(const[s,a]of i){const c=eo([s,a],n,r);c._setParentLink(o,a.parentKey),o._insertAndSort(c)}return o}_toOps(t,n,r){if(this._id===void 0)throw new Error("Cannot serialize item is not attached");const o=[],i={id:this._id,opId:r?.generateOpId(),type:2,parentId:t,parentKey:n};o.push(i);for(const s of this._items){const a=s._getParentKeyOrThrow(),c=wt(s._toOps(this._id,a,r),void 0),u=c[0].opId;u!==void 0&&this._unacknowledgedSets.set(a,u),o.push(...c)}return o}_insertAndSort(t){this._items.push(t),this._sortItems()}_sortItems(){this._items.sort(qs),this.invalidate()}_indexOfPosition(t){return this._items.findIndex(n=>n._getParentKeyOrThrow()===t)}_attach(t,n){super._attach(t,n);for(const r of this._items)r._attach(n.generateId(),n)}_detach(){super._detach();for(const t of this._items)t._detach()}_applySetRemote(t){if(this._pool===void 0)throw new Error("Can't attach child if managed pool is not present");const{id:n,parentKey:r}=t,o=Ze(t);o._attach(n,this._pool),o._setParentLink(this,r);const i=t.deletedId,s=this._indexOfPosition(r);if(s!==-1){const a=this._items[s];if(a._id===i)return a._detach(),this._items[s]=o,{modified:F(this,[Ae(s,o)]),reverse:[]};{this._implicitlyDeletedItems.add(a),this._items[s]=o;const c=[Ae(s,o)],u=this._detachItemAssociatedToSetOperation(t.deletedId);return u&&c.push(u),{modified:F(this,c),reverse:[]}}}else{const a=[],c=this._detachItemAssociatedToSetOperation(t.deletedId);return c&&a.push(c),this._insertAndSort(o),a.push(re(this._indexOfPosition(r),o)),{reverse:[],modified:F(this,a)}}}_applySetAck(t){if(this._pool===void 0)throw new Error("Can't attach child if managed pool is not present");const n=[],r=this._detachItemAssociatedToSetOperation(t.deletedId);r&&n.push(r);const o=this._unacknowledgedSets.get(t.parentKey);if(o!==void 0){if(o!==t.opId)return n.length===0?{modified:!1}:{modified:F(this,n),reverse:[]};this._unacknowledgedSets.delete(t.parentKey)}const i=this._indexOfPosition(t.parentKey),s=this._items.find(a=>a._id===t.id);if(s!==void 0){if(s._parentKey===t.parentKey)return{modified:n.length>0?F(this,n):!1,reverse:[]};i!==-1&&(this._implicitlyDeletedItems.add(this._items[i]),this._items.splice(i,1),n.push(bt(i)));const a=this._items.indexOf(s);s._setParentLink(this,t.parentKey),this._sortItems();const c=this._items.indexOf(s);return c!==a&&n.push(we(a,c,s)),{modified:n.length>0?F(this,n):!1,reverse:[]}}else{const a=this._pool.getNode(t.id);if(a&&this._implicitlyDeletedItems.has(a)){a._setParentLink(this,t.parentKey),this._implicitlyDeletedItems.delete(a),this._insertAndSort(a);const c=this._items.indexOf(a);return{modified:F(this,[i===-1?re(c,a):Ae(c,a),...n]),reverse:[]}}else{i!==-1&&this._items.splice(i,1);const{newItem:c,newIndex:u}=this._createAttachItemAndSort(t,t.parentKey);return{modified:F(this,[i===-1?re(u,c):Ae(u,c),...n]),reverse:[]}}}}_detachItemAssociatedToSetOperation(t){if(t===void 0||this._pool===void 0)return null;const n=this._pool.getNode(t);if(n===void 0)return null;const r=this._detachChild(n);return r.modified===!1?null:r.modified.updates[0]}_applyRemoteInsert(t){if(this._pool===void 0)throw new Error("Can't attach child if managed pool is not present");const n=nt(t.parentKey),r=this._indexOfPosition(n);r!==-1&&this._shiftItemPosition(r,n);const{newItem:o,newIndex:i}=this._createAttachItemAndSort(t,n);return{modified:F(this,[re(i,o)]),reverse:[]}}_applyInsertAck(t){const n=this._items.find(i=>i._id===t.id),r=nt(t.parentKey),o=this._indexOfPosition(r);if(n){if(n._parentKey===r)return{modified:!1};{const i=this._items.indexOf(n);o!==-1&&this._shiftItemPosition(o,r),n._setParentLink(this,r),this._sortItems();const s=this._indexOfPosition(r);return s===i?{modified:!1}:{modified:F(this,[we(i,s,n)]),reverse:[]}}}else{const i=O(this._pool).getNode(t.id);if(i&&this._implicitlyDeletedItems.has(i)){i._setParentLink(this,r),this._implicitlyDeletedItems.delete(i),this._insertAndSort(i);const s=this._indexOfPosition(r);return{modified:F(this,[re(s,i)]),reverse:[]}}else{o!==-1&&this._shiftItemPosition(o,r);const{newItem:s,newIndex:a}=this._createAttachItemAndSort(t,r);return{modified:F(this,[re(a,s)]),reverse:[]}}}}_applyInsertUndoRedo(t){const{id:n,parentKey:r}=t,o=Ze(t);if(this._pool?.getNode(n)!==void 0)return{modified:!1};o._attach(n,O(this._pool)),o._setParentLink(this,r);const i=this._indexOfPosition(r);let s=r;if(i!==-1){const c=this._items[i]?._parentPos,u=this._items[i+1]?._parentPos;s=ae(c,u),o._setParentLink(this,s)}this._insertAndSort(o);const a=this._indexOfPosition(s);return{modified:F(this,[re(a,o)]),reverse:[{type:5,id:n}]}}_applySetUndoRedo(t){const{id:n,parentKey:r}=t,o=Ze(t);if(this._pool?.getNode(n)!==void 0)return{modified:!1};this._unacknowledgedSets.set(r,O(t.opId));const i=this._indexOfPosition(r);o._attach(n,O(this._pool)),o._setParentLink(this,r);const s=r;if(i!==-1){const a=this._items[i];a._detach(),this._items[i]=o;const c=wt(a._toOps(O(this._id),r,this._pool),t.id),u=[Ae(i,o)],l=this._detachItemAssociatedToSetOperation(t.deletedId);return l&&u.push(l),{modified:F(this,u),reverse:c}}else{this._insertAndSort(o),this._detachItemAssociatedToSetOperation(t.deletedId);const a=this._indexOfPosition(s);return{reverse:[{type:5,id:n}],modified:F(this,[re(a,o)])}}}_attachChild(t,n){if(this._pool===void 0)throw new Error("Can't attach child if managed pool is not present");let r;return t.intent==="set"?n===1?r=this._applySetRemote(t):n===2?r=this._applySetAck(t):r=this._applySetUndoRedo(t):n===1?r=this._applyRemoteInsert(t):n===2?r=this._applyInsertAck(t):r=this._applyInsertUndoRedo(t),r.modified!==!1&&this.invalidate(),r}_detachChild(t){if(t){const n=O(t._parentKey),r=t._toOps(O(this._id),n,this._pool),o=this._items.indexOf(t);return o===-1?{modified:!1}:(this._items.splice(o,1),this.invalidate(),t._detach(),{modified:F(this,[bt(o)]),reverse:r})}return{modified:!1}}_applySetChildKeyRemote(t,n){if(this._implicitlyDeletedItems.has(n)){this._implicitlyDeletedItems.delete(n),n._setParentLink(this,t),this._insertAndSort(n);const i=this._items.indexOf(n);return{modified:F(this,[re(i,n)]),reverse:[]}}const r=n._parentKey;if(t===r)return{modified:!1};const o=this._indexOfPosition(t);if(o===-1){const i=this._items.indexOf(n);n._setParentLink(this,t),this._sortItems();const s=this._items.indexOf(n);return s===i?{modified:!1}:{modified:F(this,[we(i,s,n)]),reverse:[]}}else{this._items[o]._setParentLink(this,ae(t,this._items[o+1]?._parentPos));const i=this._items.indexOf(n);n._setParentLink(this,t),this._sortItems();const s=this._items.indexOf(n);return s===i?{modified:!1}:{modified:F(this,[we(i,s,n)]),reverse:[]}}}_applySetChildKeyAck(t,n){const r=O(n._parentKey);if(this._implicitlyDeletedItems.has(n)){const o=this._indexOfPosition(t);return this._implicitlyDeletedItems.delete(n),o!==-1&&this._items[o]._setParentLink(this,ae(t,this._items[o+1]?._parentPos)),n._setParentLink(this,t),this._insertAndSort(n),{modified:!1}}else{if(t===r)return{modified:!1};const o=this._items.indexOf(n),i=this._indexOfPosition(t);i!==-1&&this._items[i]._setParentLink(this,ae(t,this._items[i+1]?._parentPos)),n._setParentLink(this,t),this._sortItems();const s=this._items.indexOf(n);return o===s?{modified:!1}:{modified:F(this,[we(o,s,n)]),reverse:[]}}}_applySetChildKeyUndoRedo(t,n){const r=O(n._parentKey),o=this._items.indexOf(n),i=this._indexOfPosition(t);i!==-1&&this._items[i]._setParentLink(this,ae(t,this._items[i+1]?._parentPos)),n._setParentLink(this,t),this._sortItems();const s=this._items.indexOf(n);return o===s?{modified:!1}:{modified:F(this,[we(o,s,n)]),reverse:[{type:1,id:O(n._id),parentKey:r}]}}_setChildKey(t,n,r){return r===1?this._applySetChildKeyRemote(t,n):r===2?this._applySetChildKeyAck(t,n):this._applySetChildKeyUndoRedo(t,n)}_apply(t,n){return super._apply(t,n)}_serialize(){if(this.parent.type!=="HasParent")throw new Error("Cannot serialize LiveList if parent is missing");return{type:1,parentId:O(this.parent.node._id,"Parent node expected to have ID"),parentKey:this.parent.key}}get length(){return this._items.length}push(t){return this._pool?.assertStorageIsWritable(),this.insert(t,this.length)}insert(t,n){if(this._pool?.assertStorageIsWritable(),n<0||n>this._items.length)throw new Error(`Cannot insert list item at index "${n}". index should be between 0 and ${this._items.length}`);const r=this._items[n-1]?this._items[n-1]._parentPos:void 0,o=this._items[n]?this._items[n]._parentPos:void 0,i=ae(r,o),s=Me(t);if(s._setParentLink(this,i),this._insertAndSort(s),this._pool&&this._id){const a=this._pool.generateId();s._attach(a,this._pool),this._pool.dispatch(s._toOps(this._id,i,this._pool),[{type:5,id:a}],new Map([[this._id,F(this,[re(n,s)])]]))}}move(t,n){if(this._pool?.assertStorageIsWritable(),n<0)throw new Error("targetIndex cannot be less than 0");if(n>=this._items.length)throw new Error("targetIndex cannot be greater or equal than the list length");if(t<0)throw new Error("index cannot be less than 0");if(t>=this._items.length)throw new Error("index cannot be greater or equal than the list length");let r=null,o=null;t<n?(o=n===this._items.length-1?void 0:this._items[n+1]._parentPos,r=this._items[n]._parentPos):(o=this._items[n]._parentPos,r=n===0?void 0:this._items[n-1]._parentPos);const i=ae(r,o),s=this._items[t],a=s._getParentKeyOrThrow();if(s._setParentLink(this,i),this._sortItems(),this._pool&&this._id){const c=new Map([[this._id,F(this,[we(t,n,s)])]]);this._pool.dispatch([{type:1,id:O(s._id),opId:this._pool.generateOpId(),parentKey:i}],[{type:1,id:O(s._id),parentKey:a}],c)}}delete(t){if(this._pool?.assertStorageIsWritable(),t<0||t>=this._items.length)throw new Error(`Cannot delete list item at index "${t}". index should be between 0 and ${this._items.length-1}`);const n=this._items[t];if(n._detach(),this._items.splice(t,1),this.invalidate(),this._pool){const r=n._id;if(r){const o=new Map;o.set(O(this._id),F(this,[bt(t)])),this._pool.dispatch([{id:r,opId:this._pool.generateOpId(),type:5}],n._toOps(O(this._id),n._getParentKeyOrThrow()),o)}}}clear(){if(this._pool?.assertStorageIsWritable(),this._pool){const t=[],n=[],r=[];for(const i of this._items){i._detach();const s=i._id;s&&(t.push({type:5,id:s,opId:this._pool.generateOpId()}),n.push(...i._toOps(O(this._id),i._getParentKeyOrThrow())),r.push(bt(0)))}this._items=[],this.invalidate();const o=new Map;o.set(O(this._id),F(this,r)),this._pool.dispatch(t,n,o)}else{for(const t of this._items)t._detach();this._items=[],this.invalidate()}}set(t,n){if(this._pool?.assertStorageIsWritable(),t<0||t>=this._items.length)throw new Error(`Cannot set list item at index "${t}". index should be between 0 and ${this._items.length-1}`);const r=this._items[t],o=r._getParentKeyOrThrow(),i=r._id;r._detach();const s=Me(n);if(s._setParentLink(this,o),this._items[t]=s,this.invalidate(),this._pool&&this._id){const a=this._pool.generateId();s._attach(a,this._pool);const c=new Map;c.set(this._id,F(this,[Ae(t,s)]));const u=wt(s._toOps(this._id,o,this._pool),i);this._unacknowledgedSets.set(o,O(u[0].opId));const l=wt(r._toOps(this._id,o,void 0),a);this._pool.dispatch(u,l,c)}}toArray(){return this._items.map(t=>Se(t))}every(t){return this.toArray().every(t)}filter(t){return this.toArray().filter(t)}find(t){return this.toArray().find(t)}findIndex(t){return this.toArray().findIndex(t)}forEach(t){return this.toArray().forEach(t)}get(t){if(!(t<0||t>=this._items.length))return Se(this._items[t])}indexOf(t,n){return this.toArray().indexOf(t,n)}lastIndexOf(t,n){return this.toArray().lastIndexOf(t,n)}map(t){return this._items.map((n,r)=>t(Se(n),r))}some(t){return this.toArray().some(t)}[Symbol.iterator](){return new Ys(this._items)}_createAttachItemAndSort(t,n){const r=Ze(t);r._attach(t.id,O(this._pool)),r._setParentLink(this,n),this._insertAndSort(r);const o=this._indexOfPosition(n);return{newItem:r,newIndex:o}}_shiftItemPosition(t,n){const r=ae(n,this._items.length>t+1?this._items[t+1]?._parentPos:void 0);this._items[t]._setParentLink(this,r)}_toTreeNode(t){return{type:"LiveList",id:this._id??ze(),key:t,payload:this._items.map((n,r)=>n.toTreeNode(r.toString()))}}toImmutable(){return super.toImmutable()}_toImmutable(){return this._items.map(n=>n.toImmutable())}clone(){return new hn(this._items.map(t=>t.clone()))}},Ys=class{constructor(e){this._innerIterator=e[Symbol.iterator]()}[Symbol.iterator](){return this}next(){const e=this._innerIterator.next();return e.done?{done:!0,value:void 0}:{value:Se(e.value)}}};function F(e,t){return{node:e,type:"LiveList",updates:t}}function Ae(e,t){return{index:e,type:"set",item:t instanceof Ce?t.data:t}}function bt(e){return{index:e,type:"delete"}}function re(e,t){return{index:e,type:"insert",item:t instanceof Ce?t.data:t}}function we(e,t,n){return{index:t,type:"move",previousIndex:e,item:n instanceof Ce?n.data:n}}function wt(e,t){return e.map((n,r)=>r===0?{...n,intent:"set",deletedId:t}:n)}var de=e=>e,Ke=class pn extends Wt{constructor(t){if(super(),this.unacknowledgedSet=new Map,t){const n=[];for(const[r,o]of t){const i=Me(o);i._setParentLink(this,r),n.push([r,i])}this._map=new Map(n)}else this._map=new Map}_toOps(t,n,r){if(this._id===void 0)throw new Error("Cannot serialize item is not attached");const o=[],i={id:this._id,opId:r?.generateOpId(),type:7,parentId:t,parentKey:n};o.push(i);for(const[s,a]of this._map)o.push(...a._toOps(this._id,s,r));return o}static _deserialize([t,n],r,o){const i=new pn;i._attach(t,o);const s=r.get(t);if(s===void 0)return i;for(const[a,c]of s){const u=eo([a,c],r,o);u._setParentLink(i,c.parentKey),i._map.set(c.parentKey,u),i.invalidate()}return i}_attach(t,n){super._attach(t,n);for(const[r,o]of this._map)K(o)&&o._attach(n.generateId(),n)}_attachChild(t,n){if(this._pool===void 0)throw new Error("Can't attach child if managed pool is not present");const{id:r,parentKey:o,opId:i}=t,s=o,a=Ze(t);if(this._pool.getNode(r)!==void 0)return{modified:!1};if(n===2){const l=this.unacknowledgedSet.get(s);if(l===i)return this.unacknowledgedSet.delete(s),{modified:!1};if(l!==void 0)return{modified:!1}}else n===1&&this.unacknowledgedSet.delete(s);const c=this._map.get(s);let u;if(c){const l=O(this._id);u=c._toOps(l,s),c._detach()}else u=[{type:5,id:r}];return a._setParentLink(this,s),a._attach(r,this._pool),this._map.set(s,a),this.invalidate(),{modified:{node:this,type:"LiveMap",updates:{[s]:{type:"update"}}},reverse:u}}_detach(){super._detach();for(const t of this._map.values())t._detach()}_detachChild(t){const n=O(this._id),r=O(t._parentKey),o=t._toOps(n,r,this._pool);for(const[s,a]of this._map)a===t&&(this._map.delete(s),this.invalidate());return t._detach(),{modified:{node:this,type:"LiveMap",updates:{[r]:{type:"delete"}}},reverse:o}}_serialize(){if(this.parent.type!=="HasParent")throw new Error("Cannot serialize LiveMap if parent is missing");return{type:2,parentId:O(this.parent.node._id,"Parent node expected to have ID"),parentKey:this.parent.key}}get(t){const n=this._map.get(t);if(n!==void 0)return Se(n)}set(t,n){this._pool?.assertStorageIsWritable();const r=this._map.get(t);r&&r._detach();const o=Me(n);if(o._setParentLink(this,t),this._map.set(t,o),this.invalidate(),this._pool&&this._id){const i=this._pool.generateId();o._attach(i,this._pool);const s=new Map;s.set(this._id,{node:this,type:"LiveMap",updates:{[t]:{type:"update"}}});const a=o._toOps(this._id,t,this._pool);this.unacknowledgedSet.set(t,O(a[0].opId)),this._pool.dispatch(o._toOps(this._id,t,this._pool),r?r._toOps(this._id,t):[{type:5,id:i}],s)}}get size(){return this._map.size}has(t){return this._map.has(t)}delete(t){this._pool?.assertStorageIsWritable();const n=this._map.get(t);if(n===void 0)return!1;if(n._detach(),this._map.delete(t),this.invalidate(),this._pool&&n._id){const r=O(this._id),o=new Map;o.set(r,{node:this,type:"LiveMap",updates:{[t]:{type:"delete"}}}),this._pool.dispatch([{type:5,id:n._id,opId:this._pool.generateOpId()}],n._toOps(r,t),o)}return!0}entries(){const t=this._map.entries();return{[Symbol.iterator](){return this},next(){const n=t.next();if(n.done)return{done:!0,value:void 0};const o=n.value[0],i=Se(n.value[1]);return{value:[o,i]}}}}[Symbol.iterator](){return this.entries()}keys(){return this._map.keys()}values(){const t=this._map.values();return{[Symbol.iterator](){return this},next(){const n=t.next();return n.done?{done:!0,value:void 0}:{value:Se(n.value)}}}}forEach(t){for(const n of this)t(n[1],n[0],this)}_toTreeNode(t){return{type:"LiveMap",id:this._id??ze(),key:t,payload:Array.from(this._map.entries()).map(([n,r])=>r.toTreeNode(n))}}toImmutable(){return super.toImmutable()}_toImmutable(){const t=new Map;for(const[n,r]of this._map)t.set(n,r.toImmutable());return de(t)}clone(){return new pn(Array.from(this._map).map(([t,n])=>[t,n.clone()]))}},Oe=class Xe extends Wt{static _buildRootAndParentToChildren(t){const n=new Map;let r=null;for(const[o,i]of t)if(Ks(i))r=[o,i];else{const s=[o,i],a=n.get(i.parentId);a!==void 0?a.push(s):n.set(i.parentId,[s])}if(r===null)throw new Error("Root can't be null");return[r,n]}static _fromItems(t,n){const[r,o]=Xe._buildRootAndParentToChildren(t);return Xe._deserialize(r,o,n)}constructor(t={}){super(),this._propToLastUpdate=new Map;const n=Lt(t);for(const r of Object.keys(n)){const o=n[r];K(o)&&o._setParentLink(this,r)}this._map=new Map(Object.entries(n))}_toOps(t,n,r){if(this._id===void 0)throw new Error("Cannot serialize item is not attached");const o=r?.generateOpId(),i=[],s={type:4,id:this._id,opId:o,parentId:t,parentKey:n,data:{}};i.push(s);for(const[a,c]of this._map)K(c)?i.push(...c._toOps(this._id,a,r)):s.data[a]=c;return i}static _deserialize([t,n],r,o){const i=new Xe(n.data);return i._attach(t,o),this._deserializeChildren(i,r,o)}static _deserializeChildren(t,n,r){const o=n.get(O(t._id));if(o===void 0)return t;for(const[i,s]of o){const a=Gs([i,s],n,r);Ue(a)&&a._setParentLink(t,s.parentKey),t._map.set(s.parentKey,a),t.invalidate()}return t}_attach(t,n){super._attach(t,n);for(const[r,o]of this._map)K(o)&&o._attach(n.generateId(),n)}_attachChild(t,n){if(this._pool===void 0)throw new Error("Can't attach child if managed pool is not present");const{id:r,opId:o,parentKey:i}=t,s=Xr(t);if(this._pool.getNode(r)!==void 0)return this._propToLastUpdate.get(i)===o&&this._propToLastUpdate.delete(i),{modified:!1};if(n===0)this._propToLastUpdate.set(i,O(o));else if(this._propToLastUpdate.get(i)!==void 0)return this._propToLastUpdate.get(i)===o?(this._propToLastUpdate.delete(i),{modified:!1}):{modified:!1};const a=O(this._id),c=this._map.get(i);let u;return K(c)?(u=c._toOps(a,i),c._detach()):c===void 0?u=[{type:6,id:a,key:i}]:u=[{type:3,id:a,data:{[i]:c}}],this._map.set(i,s),this.invalidate(),Ue(s)&&(s._setParentLink(this,i),s._attach(r,this._pool)),{reverse:u,modified:{node:this,type:"LiveObject",updates:{[i]:{type:"update"}}}}}_detachChild(t){if(t){const n=O(this._id),r=O(t._parentKey),o=t._toOps(n,r,this._pool);for(const[s,a]of this._map)a===t&&(this._map.delete(s),this.invalidate());return t._detach(),{modified:{node:this,type:"LiveObject",updates:{[r]:{type:"delete"}}},reverse:o}}return{modified:!1}}_detach(){super._detach();for(const t of this._map.values())K(t)&&t._detach()}_apply(t,n){return t.type===3?this._applyUpdate(t,n):t.type===6?this._applyDeleteObjectKey(t,n):super._apply(t,n)}_serialize(){const t={};for(const[n,r]of this._map)K(r)||(t[n]=r);return this.parent.type==="HasParent"&&this.parent.node._id?{type:0,parentId:this.parent.node._id,parentKey:this.parent.key,data:t}:{type:0,data:t}}_applyUpdate(t,n){let r=!1;const o=O(this._id),i=[],s={type:3,id:o,data:{}};for(const c in t.data){const u=this._map.get(c);K(u)?(i.push(...u._toOps(o,c)),u._detach()):u!==void 0?s.data[c]=u:u===void 0&&i.push({type:6,id:o,key:c})}const a={};for(const c in t.data){const u=t.data[c];if(u===void 0)continue;if(n)this._propToLastUpdate.set(c,O(t.opId));else if(this._propToLastUpdate.get(c)===void 0)r=!0;else if(this._propToLastUpdate.get(c)===t.opId){this._propToLastUpdate.delete(c);continue}else continue;const l=this._map.get(c);K(l)&&l._detach(),r=!0,a[c]={type:"update"},this._map.set(c,u),this.invalidate()}return Object.keys(s.data).length!==0&&i.unshift(s),r?{modified:{node:this,type:"LiveObject",updates:a},reverse:i}:{modified:!1}}_applyDeleteObjectKey(t,n){const r=t.key;if(this._map.has(r)===!1)return{modified:!1};if(!n&&this._propToLastUpdate.get(r)!==void 0)return{modified:!1};const o=this._map.get(r),i=O(this._id);let s=[];return K(o)?(s=o._toOps(i,t.key),o._detach()):o!==void 0&&(s=[{type:3,id:i,data:{[r]:o}}]),this._map.delete(r),this.invalidate(),{modified:{node:this,type:"LiveObject",updates:{[t.key]:{type:"delete"}}},reverse:s}}toObject(){return Object.fromEntries(this._map)}set(t,n){this._pool?.assertStorageIsWritable(),this.update({[t]:n})}get(t){return this._map.get(t)}delete(t){this._pool?.assertStorageIsWritable();const n=t,r=this._map.get(n);if(r===void 0)return;if(this._pool===void 0||this._id===void 0){K(r)&&r._detach(),this._map.delete(n),this.invalidate();return}let o;K(r)?(r._detach(),o=r._toOps(this._id,n)):o=[{type:3,data:{[n]:r},id:this._id}],this._map.delete(n),this.invalidate();const i=new Map;i.set(this._id,{node:this,type:"LiveObject",updates:{[t]:{type:"delete"}}}),this._pool.dispatch([{type:6,key:n,id:this._id,opId:this._pool.generateOpId()}],o,i)}update(t){if(this._pool?.assertStorageIsWritable(),this._pool===void 0||this._id===void 0){for(const u in t){const l=t[u];if(l===void 0)continue;const f=this._map.get(u);K(f)&&f._detach(),K(l)&&l._setParentLink(this,u),this._map.set(u,l),this.invalidate()}return}const n=[],r=[],o=this._pool.generateOpId(),i={},s={id:this._id,type:3,data:{}},a={};for(const u in t){const l=t[u];if(l===void 0)continue;const f=this._map.get(u);if(K(f)?(r.push(...f._toOps(this._id,u)),f._detach()):f===void 0?r.push({type:6,id:this._id,key:u}):s.data[u]=f,K(l)){l._setParentLink(this,u),l._attach(this._pool.generateId(),this._pool);const b=l._toOps(this._id,u,this._pool),w=b.find(S=>S.parentId===this._id);w&&this._propToLastUpdate.set(u,O(w.opId)),n.push(...b)}else i[u]=l,this._propToLastUpdate.set(u,o);this._map.set(u,l),this.invalidate(),a[u]={type:"update"}}Object.keys(s.data).length!==0&&r.unshift(s),Object.keys(i).length!==0&&n.unshift({opId:o,id:this._id,type:3,data:i});const c=new Map;c.set(this._id,{node:this,type:"LiveObject",updates:a}),this._pool.dispatch(n,r,c)}toImmutable(){return super.toImmutable()}toTreeNode(t){return super.toTreeNode(t)}_toTreeNode(t){const n=this._id??ze();return{type:"LiveObject",id:n,key:t,payload:Array.from(this._map.entries()).map(([r,o])=>K(o)?o.toTreeNode(r):{type:"Json",id:`${n}:${r}`,key:r,payload:o})}}_toImmutable(){const t={};for(const[n,r]of this._map)t[n]=Ue(r)?r.toImmutable():r;return t}clone(){return new Xe(Object.fromEntries(Array.from(this._map).map(([t,n])=>[t,Ue(n)?n.clone():tt(n)])))}};function Ze(e){return Me(Xr(e))}function Xr(e){switch(e.type){case 8:return e.data;case 4:return new Oe(e.data);case 7:return new Ke;case 2:return new Be([]);default:return oe(e,"Unknown creation Op")}}function Zr(e,t){return e===t?!0:e.parent.type==="HasParent"?Zr(e.parent.node,t):!1}function eo([e,t],n,r){switch(t.type){case 0:return Oe._deserialize([e,t],n,r);case 1:return Be._deserialize([e,t],n,r);case 2:return Ke._deserialize([e,t],n,r);case 3:return Ce._deserialize([e,t],n,r);default:throw new Error("Unexpected CRDT type")}}function Gs([e,t],n,r){switch(t.type){case 0:return Oe._deserialize([e,t],n,r);case 1:return Be._deserialize([e,t],n,r);case 2:return Ke._deserialize([e,t],n,r);case 3:return t.data;default:throw new Error("Unexpected CRDT type")}}function Ue(e){return to(e)||Qs(e)||Js(e)}function K(e){return Ue(e)||Xs(e)}function to(e){return e instanceof Be}function Qs(e){return e instanceof Ke}function Js(e){return e instanceof Oe}function Xs(e){return e instanceof Ce}function Zs(e){return e===void 0?void 0:Ue(e)?e.clone():tt(e)}function Se(e){return e instanceof Ce?e.data:e instanceof Be||e instanceof Ke||e instanceof Oe?e:oe(e,"Unknown AbstractCrdt")}function Me(e){return e instanceof Oe||e instanceof Ke||e instanceof Be?e:new Ce(e)}function ea(e,t){const n=[];return e.forEach((r,o)=>{t.get(o)||n.push({type:5,id:o})}),t.forEach((r,o)=>{const i=e.get(o);if(i)r.type===0&&(i.type!==0||JSON.stringify(r.data)!==JSON.stringify(i.data))&&n.push({type:3,id:o,data:r.data}),r.parentKey!==i.parentKey&&n.push({type:1,id:o,parentKey:O(r.parentKey,"Parent key must not be missing")});else switch(r.type){case 3:n.push({type:8,id:o,parentId:r.parentId,parentKey:r.parentKey,data:r.data});break;case 1:n.push({type:2,id:o,parentId:r.parentId,parentKey:r.parentKey});break;case 0:if(r.parentId===void 0||r.parentKey===void 0)throw new Error("Internal error. Cannot serialize storage root into an operation");n.push({type:4,id:o,parentId:r.parentId,parentKey:r.parentKey,data:r.data});break;case 2:n.push({type:7,id:o,parentId:r.parentId,parentKey:r.parentKey});break}}),n}function ta(e,t){const n=e.updates;for(const[r,o]of zr(t.updates))n[r]=o;return{...t,updates:n}}function na(e,t){const n=e.updates;for(const[r,o]of zr(t.updates))n[r]=o;return{...t,updates:n}}function ra(e,t){const n=e.updates;return{...t,updates:n.concat(t.updates)}}function Gt(e,t){return e===void 0?t:e.type==="LiveObject"&&t.type==="LiveObject"?ta(e,t):e.type==="LiveMap"&&t.type==="LiveMap"?na(e,t):e.type==="LiveList"&&t.type==="LiveList"?ra(e,t):t}var oa="th",ia="cm";function no(e){return`${e}_${ze()}`}function ro(){return no(oa)}function Pt(){return no(ia)}function sa(e){return e===null||typeof e=="string"||typeof e=="number"||typeof e=="boolean"}function oo(e){return Array.isArray(e)}function aa(e){return!sa(e)&&!oo(e)}var ca=/^[a-zA-Z_][a-zA-Z0-9_]*$/;function mn(e){let t=[];const n=Object.entries(e),r=[],o=[],i=[];return n.forEach(([s,a])=>{if(!ca.test(s))throw new Error("Key must only contain letters, numbers, _");nr(a)?r.push([s,a]):rr(a)?o.push([s,a]):typeof a=="object"&&!("startsWith"in a)&&i.push([s,a])}),t=[...er(r),...tr(o)],i.forEach(([s,a])=>{const c=Object.entries(a),u=[],l=[];c.forEach(([f,b])=>{if(io(f))throw new Error("Key cannot be empty");nr(b)?u.push([or(s,f),b]):rr(b)&&l.push([or(s,f),b])}),t=[...t,...er(u),...tr(l)]}),t.map(({key:s,operator:a,value:c})=>ua(s,a,da(c))).join(" AND ")}var er=e=>{const t=[];return e.forEach(([n,r])=>{t.push({key:n,operator:":",value:r})}),t},tr=e=>{const t=[];return e.forEach(([n,r])=>{"startsWith"in r&&typeof r.startsWith=="string"&&t.push({key:n,operator:"^",value:r.startsWith})}),t},nr=e=>typeof e=="string"||typeof e=="number"||typeof e=="boolean",rr=e=>typeof e=="object"&&e!==null&&"startsWith"in e,ua=(e,t,n)=>`${e}${t}${n}`,or=(e,t)=>t?`${e}[${JSON.stringify(t)}]`:e,da=e=>{if(typeof e=="string"){if(io(e))throw new Error("Value cannot be empty");return JSON.stringify(e)}return e.toString()},io=e=>!e||e.toString().trim()==="";function so(e,t){let n=!1;const r={...e};return Object.keys(t).forEach(o=>{const i=o,s=t[i];r[i]!==s&&(s===void 0?delete r[i]:r[i]=s,n=!0)}),n?r:e}var Ft=class{constructor(){this._ev=L()}get didInvalidate(){return this._ev.observable}invalidate(){this._cache!==void 0&&(this._cache=void 0,this._ev.notify())}get current(){return this._cache??(this._cache=this._toImmutable())}};function la(e,t){const{connectionId:n,id:r,info:o}=e,i=cn(e.scopes);return de(Lt({connectionId:n,id:r,info:o,canWrite:i,canComment:Yr(e.scopes),isReadOnly:!i,presence:t}))}var fa=class extends Ft{constructor(){super(),this._connections=new Map,this._presences=new Map,this._users=new Map}connectionIds(){return this._connections.keys()}_toImmutable(){return sn(Array.from(this._presences.keys()).map(t=>this.getUser(Number(t))))}clearOthers(){this._connections=new Map,this._presences=new Map,this._users=new Map,this.invalidate()}_getUser(e){const t=this._connections.get(e),n=this._presences.get(e);if(t!==void 0&&n!==void 0)return la(t,n)}getUser(e){const t=this._users.get(e);if(t)return t;const n=this._getUser(e);if(n)return this._users.set(e,n),n}_invalidateUser(e){this._users.has(e)&&this._users.delete(e),this.invalidate()}setConnection(e,t,n,r){this._connections.set(e,de({connectionId:e,id:t,info:n,scopes:r})),this._presences.has(e)&&this._invalidateUser(e)}removeConnection(e){this._connections.delete(e),this._presences.delete(e),this._invalidateUser(e)}setOther(e,t){this._presences.set(e,de(Lt(t))),this._connections.has(e)&&this._invalidateUser(e)}patchOther(e,t){const n=this._presences.get(e);if(n===void 0)return;const r=so(n,t);n!==r&&(this._presences.set(e,de(r)),this._invalidateUser(e))}},ha=class extends Ft{constructor(e){super(),this._data=de(Lt(e))}_toImmutable(){return this._data}patch(e){const t=this._data,n=so(t,e);t!==n&&(this._data=de(n),this.invalidate())}},ir=class extends Ft{constructor(e){super(),this._value=de(e)}_toImmutable(){return this._value}set(e){this._value=de(e),this.invalidate()}},Qt=class extends Ft{constructor(...e){super();const t=e.pop(),n=e;this._refs=n,this._refs.forEach(r=>{r.didInvalidate.subscribe(()=>this.invalidate())}),this._transform=t}_toImmutable(){return this._transform(...this._refs.map(e=>e.current))}},pa=1024*1024-1024;function ma(e){let t=0;return()=>`${e}:${t++}`}function sr(e,t){return{type:"User",id:`${t.connectionId}`,key:e,payload:{connectionId:t.connectionId,id:t.id,info:t.info,presence:t.presence,isReadOnly:!t.canWrite}}}function va(){const e=typeof document<"u"?document:void 0,t={current:null};function n(){e?.visibilityState==="hidden"?t.current=t.current??Date.now():t.current=null}return e?.addEventListener("visibilitychange",n),[t,()=>{e?.removeEventListener("visibilitychange",n)}]}var vn=class extends Error{constructor(e,t,n){super(e),this.message=e,this.status=t,this.details=n}},ga=50;function ya(e,t){const n=e.initialPresence,r=e.initialStorage,[o,i]=va(),s={...t.delegates,canZombie(){return t.backgroundKeepAliveTimeout!==void 0&&o.current!==null&&Date.now()>o.current+t.backgroundKeepAliveTimeout&&ut()!=="synchronizing"}},a=new _s(s,t.enableDebugLogging),c={buffer:{flushTimerID:void 0,lastFlushedAt:0,presenceUpdates:{type:"full",data:n},messages:[],storageOperations:[]},staticSessionInfo:new ir(null),dynamicSessionInfo:new ir(null),myPresence:new ha(n),others:new fa,initialStorage:r,idFactory:null,provider:void 0,onProviderUpdate:L(),clock:0,opClock:0,nodes:new Map,root:void 0,undoStack:[],redoStack:[],pausedHistory:null,activeBatch:null,unacknowledgedOps:new Map,opStackTraces:void 0},u=d=>d(),l=t.unstable_batchedUpdates??u;let f;function b(d){const h=a.authValue;if(h!==null){const m=gn(h);if(m!==f)if(f=m,h.type==="secret"){const T=h.token.parsed;c.staticSessionInfo.set({userId:T.k==="sec-legacy"?T.id:T.uid,userInfo:T.k==="sec-legacy"?T.info:T.ui})}else c.staticSessionInfo.set({userId:void 0,userInfo:void 0})}l(()=>{v.status.notify(d),H(u)})}let w,S=!1;function E(d){d==="reconnecting"?w=setTimeout(()=>{l(()=>{v.lostConnection.notify("lost"),S=!0,c.others.clearOthers(),se({others:[{type:"reset"}]},u)})},t.lostConnectionTimeout):(clearTimeout(w),S&&(l(d==="disconnected"?()=>{v.lostConnection.notify("failed")}:()=>{v.lostConnection.notify("restored")}),S=!1))}function _(){c.buffer.presenceUpdates={type:"full",data:{...c.myPresence.current}},Ye!==null&&Rn({flush:!1}),Q()}function g(){clearTimeout(c.buffer.flushTimerID)}a.events.onMessage.subscribe(Zo),a.events.statusDidChange.subscribe(b),a.events.statusDidChange.subscribe(E),a.events.didConnect.subscribe(_),a.events.didDisconnect.subscribe(g),a.events.onLiveblocksError.subscribe(d=>{l(()=>{v.error.notify(d)})});const p={roomId:t.roomId,getNode:d=>c.nodes.get(d),addNode:(d,h)=>void c.nodes.set(d,h),deleteNode:d=>void c.nodes.delete(d),generateId:()=>`${On()}:${c.clock++}`,generateOpId:()=>`${On()}:${c.opClock++}`,dispatch(d,h,m){const T=c.activeBatch;if(T){for(const I of d)T.ops.push(I);for(const[I,N]of m)T.updates.storageUpdates.set(I,Gt(T.updates.storageUpdates.get(I),N));T.reverseOps.unshift(...h)}else l(()=>{ct(h,u),c.redoStack.length=0,Pn(d),se({storageUpdates:m},u)})},assertStorageIsWritable:()=>{const d=c.dynamicSessionInfo.current?.scopes;if(d===void 0)return;if(!cn(d))throw new Error("Cannot write to storage with a read only user, please ensure the user has write permissions")}},v={status:L(),lostConnection:L(),customEvent:L(),self:L(),myPresence:L(),others:L(),error:L(),storageBatch:L(),history:L(),storageDidLoad:L(),storageStatus:L(),ydoc:L(),comments:L()};async function k(d,h,m,T,I){const N=Qr(t.baseUrl,`/v2/c/rooms/${encodeURIComponent(d)}${h}`,I);return await(t.polyfills?.fetch||fetch)(N,{...T,headers:{...T?.headers,Authorization:`Bearer ${gn(m)}`}})}async function C(d,h){return k(h,"/storage",d,{method:"GET",headers:{"Content-Type":"application/json"}})}async function x(d,h){if(!a.authValue)throw new Error("Not authorized");return k(t.roomId,d,a.authValue,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)})}async function A(d,h){if(!a.authValue)throw new Error("Not authorized");return k(t.roomId,"/text-mentions",a.authValue,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:d,mentionId:h})})}async function j(d){if(!a.authValue)throw new Error("Not authorized");return k(t.roomId,`/text-mentions/${d}`,a.authValue,{method:"DELETE"})}async function M(d,h){const m=await s.authenticate();return k(t.roomId,"/text-metadata",m,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:d,rootKey:h})})}async function q(){const d=await s.authenticate();return k(t.roomId,"/versions/",d,{method:"GET"})}async function be(d){const h=await s.authenticate();return k(t.roomId,`/y-version/${encodeURIComponent(d)}`,h,{method:"GET"})}async function fe(){const d=await s.authenticate();return k(t.roomId,"/version",d,{method:"POST"})}function D(d){const h=JSON.stringify(d),m=c.dynamicSessionInfo.current?.nonce;if(t.unstable_fallbackToHTTP&&m&&new TextEncoder().encode(h).length>pa){x("/send-message",{nonce:m,messages:d}).then(I=>{!I.ok&&I.status===403&&a.reconnect()}),ee("Message was too large for websockets and sent over HTTP instead");return}a.send(h)}const R=new Qt(c.staticSessionInfo,c.dynamicSessionInfo,c.myPresence,(d,h,m)=>{if(d===null||h===null)return null;{const T=cn(h.scopes);return{connectionId:h.actor,id:d.userId,info:d.userInfo,presence:m,canWrite:T,canComment:Yr(h.scopes)}}});let W;function H(d){const h=R.current;h!==null&&h!==W&&(d(()=>{v.self.notify(h)}),W=h)}const he=new Qt(R,d=>d!==null?sr("Me",d):null);function Kt(d,h){if(d.items.length===0)throw new Error("Internal error: cannot load storage without items");c.root!==void 0?at(d.items,h):c.root=Oe._fromItems(d.items,p);const m=R.current?.canWrite??!0,T=c.undoStack.length;for(const I in c.initialStorage)c.root.get(I)===void 0&&(m?c.root.set(I,Zs(c.initialStorage[I])):ee(`Attempted to populate missing storage key '${I}', but current user has no write access`));c.undoStack.length=T}function at(d,h){if(c.root===void 0)return;const m=new Map;for(const[N,V]of c.nodes)m.set(N,V._serialize());const T=ea(m,new Map(d)),I=qe(T,!1);se(I.updates,h)}function Ve(d,h){c.undoStack.length>=50&&c.undoStack.shift(),c.undoStack.push(d),Vt(h)}function ct(d,h){c.pausedHistory!==null?c.pausedHistory.unshift(...d):Ve(d,h)}function se(d,h){const m=d.storageUpdates,T=d.others;h(()=>{if(T!==void 0&&T.length>0){const I=c.others.current;for(const N of T)v.others.notify({...N,others:I})}if((d.presence??!1)&&(H(u),v.myPresence.notify(c.myPresence.current)),m!==void 0&&m.size>0){const I=Array.from(m.values());v.storageBatch.notify(I)}dt()})}function On(){const d=c.dynamicSessionInfo.current;if(d)return d.actor;throw new Error("Internal. Tried to get connection id but connection was never open")}function qe(d,h){const m={reverse:[],storageUpdates:new Map,presence:!1},T=new Set,I=d.map(N=>N.type!=="presence"&&!N.opId?{...N,opId:p.generateOpId()}:N);for(const N of I)if(N.type==="presence"){const V={type:"presence",data:{}};for(const J in N.data)V.data[J]=c.myPresence.current[J];if(c.myPresence.patch(N.data),c.buffer.presenceUpdates===null)c.buffer.presenceUpdates={type:"partial",data:N.data};else for(const J in N.data)c.buffer.presenceUpdates.data[J]=N.data[J];m.reverse.unshift(V),m.presence=!0}else{let V;if(h)V=0;else{const ht=O(N.opId);V=c.unacknowledgedOps.delete(ht)?2:1}const J=Ko(N,V);if(J.modified){const ht=J.modified.node._id;ht&&T.has(ht)||(m.storageUpdates.set(O(J.modified.node._id),Gt(m.storageUpdates.get(O(J.modified.node._id)),J.modified)),m.reverse.unshift(...J.reverse)),(N.type===2||N.type===7||N.type===4)&&T.add(O(N.id))}}return{ops:I,reverse:m.reverse,updates:{storageUpdates:m.storageUpdates,presence:m.presence}}}function Ko(d,h){if(zs(d))return{modified:!1};switch(d.type){case 6:case 3:case 5:{const m=c.nodes.get(d.id);return m===void 0?{modified:!1}:m._apply(d,h===0)}case 1:{const m=c.nodes.get(d.id);return m===void 0?{modified:!1}:m.parent.type==="HasParent"&&to(m.parent.node)?m.parent.node._setChildKey(nt(d.parentKey),m,h):{modified:!1}}case 4:case 2:case 7:case 8:{if(d.parentId===void 0)return{modified:!1};const m=c.nodes.get(d.parentId);return m===void 0?{modified:!1}:m._attachChild(d,h)}}}function Vo(d,h){const m={};c.buffer.presenceUpdates===null&&(c.buffer.presenceUpdates={type:"partial",data:{}});for(const T in d){const I=d[T];I!==void 0&&(c.buffer.presenceUpdates.data[T]=I,m[T]=c.myPresence.current[T])}c.myPresence.patch(d),c.activeBatch?(h?.addToHistory&&c.activeBatch.reverseOps.unshift({type:"presence",data:m}),c.activeBatch.updates.presence=!0):(Q(),l(()=>{h?.addToHistory&&ct([{type:"presence",data:m}],u),se({presence:!0},u)}))}function qo(d){if(d.targetActor!==void 0){const m=c.others.getUser(d.actor);c.others.setOther(d.actor,d.data);const T=c.others.getUser(d.actor);if(m===void 0&&T!==void 0)return{type:"enter",user:T}}else c.others.patchOther(d.actor,d.data);const h=c.others.getUser(d.actor);if(h)return{type:"update",updates:d.data,user:h}}function Yo(d){const h=c.others.getUser(d.actor);return h?(c.others.removeConnection(d.actor),{type:"leave",user:h}):null}function Go(d,h){c.dynamicSessionInfo.set({actor:d.actor,nonce:d.nonce,scopes:d.scopes}),c.idFactory=ma(d.actor),H(h);for(const m of c.others.connectionIds())d.users[m]===void 0&&c.others.removeConnection(m);for(const m in d.users){const T=d.users[m],I=Number(m);c.others.setConnection(I,T.id,T.info,T.scopes)}return{type:"reset"}}function xn(){return c.undoStack.length>0}function An(){return c.redoStack.length>0}function Vt(d){d(()=>{v.history.notify({canUndo:xn(),canRedo:An()})})}function Qo(d){c.others.setConnection(d.actor,d.id,d.info,d.scopes),c.buffer.messages.push({type:100,data:c.myPresence.current,targetActor:d.actor}),Q();const h=c.others.getUser(d.actor);return h?{type:"enter",user:h}:void 0}function Nn(d){return aa(d)?d:null}function Jo(d){const h=En(d);return h===void 0?null:oo(h)?sn(h.map(m=>Nn(m))):sn([Nn(h)])}function Xo(d,h){if(d.size===0)return;const m=[],T=Array.from(d.values()),I=qe(T,!0);m.push({type:201,ops:I.ops}),se(I.updates,h),D(m)}function Zo(d){if(typeof d.data!="string")return;const h=Jo(d.data);if(h===null||h.length===0)return;const m={storageUpdates:new Map,others:[]};l(()=>{for(const T of h)switch(T.type){case 101:{const I=Qo(T);I&&m.others.push(I);break}case 100:{const I=qo(T);I&&m.others.push(I);break}case 103:{const I=c.others.current;v.customEvent.notify({connectionId:T.actor,user:T.actor<0?null:I.find(N=>N.connectionId===T.actor)??null,event:T.event});break}case 102:{const I=Yo(T);I&&m.others.push(I);break}case 300:{v.ydoc.notify(T);break}case 104:{m.others.push(Go(T,u));break}case 200:{$n(T);break}case 201:{const I=qe(T.ops,!1);for(const[N,V]of I.updates.storageUpdates)m.storageUpdates.set(N,Gt(m.storageUpdates.get(N),V));break}case 299:{Hr("Storage mutation rejection error",T.reason);break}case 400:case 407:case 401:case 408:case 405:case 406:case 402:case 403:case 404:{v.comments.notify(T);break}}se(m,u)})}function Q(){const d=c.buffer.storageOperations;if(d.length>0){for(const T of d)c.unacknowledgedOps.set(O(T.opId),T);dt()}if(a.getStatus()!=="connected"){c.buffer.storageOperations=[];return}const h=Date.now(),m=h-c.buffer.lastFlushedAt;if(m>=t.throttleDelay){const T=ei();if(T.length===0)return;D(T),c.buffer={flushTimerID:void 0,lastFlushedAt:h,messages:[],storageOperations:[],presenceUpdates:null}}else clearTimeout(c.buffer.flushTimerID),c.buffer.flushTimerID=setTimeout(Q,t.throttleDelay-m)}function ei(){const d=[];c.buffer.presenceUpdates&&d.push(c.buffer.presenceUpdates.type==="full"?{type:100,targetActor:-1,data:c.buffer.presenceUpdates.data}:{type:100,data:c.buffer.presenceUpdates.data});for(const h of c.buffer.messages)d.push(h);return c.buffer.storageOperations.length>0&&d.push({type:201,ops:c.buffer.storageOperations}),d}function ti(d,h){const m={type:301,update:d,guid:h};c.buffer.messages.push(m),v.ydoc.notify(m),Q()}function ni(d,h={shouldQueueEventIfNotReady:!1}){a.getStatus()!=="connected"&&!h.shouldQueueEventIfNotReady||(c.buffer.messages.push({type:103,event:d}),Q())}function Pn(d){const{storageOperations:h}=c.buffer;for(const m of d)h.push(m);Q()}let Ye=null,Dn=null;function $n(d){const h=new Map(c.unacknowledgedOps);Kt(d,u),Xo(h,u),Dn?.(),dt(),v.storageDidLoad.notify()}async function ri(){if(!a.authValue)return;const h=await(await C(a.authValue,t.roomId)).json();$n({type:200,items:h})}function Rn(d){const h=c.buffer.messages;t.unstable_streamData?ri():h.some(m=>m.type===200)||h.push({type:200}),d.flush&&Q()}function Un(){return Ye===null&&(Rn({flush:!0}),Ye=new Promise(d=>{Dn=d}),dt()),Ye}function Mn(){const d=c.root;return d!==void 0?d:(Un(),null)}async function Ln(){return c.root!==void 0?Promise.resolve({root:c.root}):(await Un(),{root:O(c.root)})}function oi(d,h){c.buffer.messages.find(m=>m.type===300&&m.vector===d&&m.guid===h)||c.buffer.messages.push({type:300,vector:d,guid:h}),Q()}function ii(){if(c.activeBatch)throw new Error("undo is not allowed during a batch");const d=c.undoStack.pop();if(d===void 0)return;c.pausedHistory=null;const h=qe(d,!0);l(()=>{se(h.updates,u),c.redoStack.push(h.reverse),Vt(u)});for(const m of h.ops)m.type!=="presence"&&c.buffer.storageOperations.push(m);Q()}function si(){if(c.activeBatch)throw new Error("redo is not allowed during a batch");const d=c.redoStack.pop();if(d===void 0)return;c.pausedHistory=null;const h=qe(d,!0);l(()=>{se(h.updates,u),c.undoStack.push(h.reverse),Vt(u)});for(const m of h.ops)m.type!=="presence"&&c.buffer.storageOperations.push(m);Q()}function ai(){c.undoStack.length=0,c.redoStack.length=0}function ci(d){if(c.activeBatch)return d();let h;return l(()=>{c.activeBatch={ops:[],updates:{storageUpdates:new Map,presence:!1,others:[]},reverseOps:[]};try{h=d()}finally{const m=c.activeBatch;c.activeBatch=null,m.reverseOps.length>0&&ct(m.reverseOps,u),m.ops.length>0&&(c.redoStack.length=0),m.ops.length>0&&Pn(m.ops),se(m.updates,u),Q()}}),h}function ui(){c.pausedHistory===null&&(c.pausedHistory=[])}function di(){const d=c.pausedHistory;c.pausedHistory=null,d!==null&&d.length>0&&Ve(d,l)}function ut(){return c.root===void 0?Ye===null?"not-loaded":"loading":c.unacknowledgedOps.size===0?"synchronized":"synchronizing"}let jn=ut();function dt(){const d=ut();jn!==d&&(jn=d,v.storageStatus.notify(d))}function Wn(){return R.current!==null}async function li(){for(;!Wn();){const{promise:d,resolve:h}=Mr(),m=lt.self.subscribeOnce(h),T=lt.status.subscribeOnce(h);await d,m(),T()}}function Fn(){return Mn()!==null}async function fi(){for(;!Fn();)await Ln()}const hi=new Qt(c.others,d=>d.map((h,m)=>sr(`Other ${m}`,h))),lt={status:v.status.observable,lostConnection:v.lostConnection.observable,customEvent:v.customEvent.observable,others:v.others.observable,self:v.self.observable,myPresence:v.myPresence.observable,error:v.error.observable,storage:v.storageBatch.observable,storageBatch:v.storageBatch.observable,history:v.history.observable,storageDidLoad:v.storageDidLoad.observable,storageStatus:v.storageStatus.observable,ydoc:v.ydoc.observable,comments:v.comments.observable};async function ft(d,h,m){const T=await s.authenticate();return k(t.roomId,d,T,m,h)}async function ne(d,h,m){const T=await ft(d,m,h);if(!T.ok&&T.status>=400&&T.status<600){let N;try{const V=await T.json();N=new vn(V.message,T.status,V)}catch{N=new vn(T.statusText,T.status)}throw N}let I;try{I=await T.json()}catch{I={}}return I}async function pi(d){const h=await ft("/threads",{since:d?.since?.toISOString()},{headers:{"Content-Type":"application/json"}});if(h.ok){const m=await h.json();return{threads:{updated:m.data.map(ve),deleted:m.deletedThreads.map(dn)},inboxNotifications:{updated:m.inboxNotifications.map(Te),deleted:m.deletedInboxNotifications.map(ln)},requestedAt:new Date(m.meta.requestedAt)}}else{if(h.status===404)return{threads:{updated:[],deleted:[]},inboxNotifications:{updated:[],deleted:[]},requestedAt:new Date};throw new Error("There was an error while getting threads.")}}async function mi(d){let h;d?.query&&(h=mn(d.query));const m=await ft("/threads",{query:h},{headers:{"Content-Type":"application/json"}});if(m.ok){const T=await m.json();return{threads:T.data.map(ve),inboxNotifications:T.inboxNotifications.map(Te),requestedAt:new Date(T.meta.requestedAt)}}else{if(m.status===404)return{threads:[],inboxNotifications:[],deletedThreads:[],deletedInboxNotifications:[],requestedAt:new Date};throw new Error("There was an error while getting threads.")}}async function vi(d){const h=await ft(`/thread-with-notification/${d}`);if(h.ok){const m=await h.json();return{thread:ve(m.thread),inboxNotification:m.inboxNotification?Te(m.inboxNotification):void 0}}else{if(h.status===404)return{thread:void 0,inboxNotification:void 0};throw new Error(`There was an error while getting thread ${d}.`)}}async function gi({metadata:d,body:h,commentId:m=Pt(),threadId:T=ro()}){const I=await ne("/threads",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:T,comment:{id:m,body:h},metadata:d})});return ve(I)}async function yi(d){await ne(`/threads/${encodeURIComponent(d)}`,{method:"DELETE"})}async function bi({metadata:d,threadId:h}){return await ne(`/threads/${encodeURIComponent(h)}/metadata`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)})}async function wi(d){await ne(`/threads/${encodeURIComponent(d)}/mark-as-resolved`,{method:"POST"})}async function _i(d){await ne(`/threads/${encodeURIComponent(d)}/mark-as-unresolved`,{method:"POST"})}async function Ti({threadId:d,commentId:h=Pt(),body:m}){const T=await ne(`/threads/${encodeURIComponent(d)}/comments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:h,body:m})});return un(T)}async function Ei({threadId:d,commentId:h,body:m}){const T=await ne(`/threads/${encodeURIComponent(d)}/comments/${encodeURIComponent(h)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({body:m})});return un(T)}async function Si({threadId:d,commentId:h}){await ne(`/threads/${encodeURIComponent(d)}/comments/${encodeURIComponent(h)}`,{method:"DELETE"})}async function ki({threadId:d,commentId:h,emoji:m}){const T=await ne(`/threads/${encodeURIComponent(d)}/comments/${encodeURIComponent(h)}/reactions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({emoji:m})});return As(T)}async function Ii({threadId:d,commentId:h,emoji:m}){await ne(`/threads/${encodeURIComponent(d)}/comments/${encodeURIComponent(h)}/reactions/${encodeURIComponent(m)}`,{method:"DELETE"})}async function qt(d,h){const m=await s.authenticate(),T=await k(t.roomId,d,m,h);if(!T.ok&&T.status>=400&&T.status<600){let N;try{const V=await T.json();N=new rt(V.message,T.status,V)}catch{N=new rt(T.statusText,T.status)}throw N}let I;try{I=await T.json()}catch{I={}}return I}function Ci(){return qt("/notification-settings")}function Oi(d){return qt("/notification-settings",{method:"POST",body:JSON.stringify(d),headers:{"Content-Type":"application/json"}})}async function xi(d){await qt("/inbox-notifications/read",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({inboxNotificationIds:d})})}const Ai=new Sn(async d=>{const h=d.flat();return await xi(h),h},{delay:ga});async function Ni(d){await Ai.get(d)}return Object.defineProperty({[le]:{get presenceBuffer(){return tt(c.buffer.presenceUpdates?.data??null)},get undoStack(){return tt(c.undoStack)},get nodeCount(){return c.nodes.size},getProvider(){return c.provider},setProvider(d){c.provider=d,c.onProviderUpdate.notify()},onProviderUpdate:c.onProviderUpdate.observable,reportTextEditor:M,createTextMention:A,deleteTextMention:j,listTextVersions:q,getTextVersion:be,createTextVersion:fe,getSelf_forDevTools:()=>he.current,getOthers_forDevTools:()=>hi.current,simulate:{explicitClose:d=>a._privateSendMachineEvent({type:"EXPLICIT_SOCKET_CLOSE",event:d}),rawSend:d=>a.send(d)}},id:t.roomId,subscribe:ba(lt),connect:()=>a.connect(),reconnect:()=>a.reconnect(),disconnect:()=>a.disconnect(),destroy:()=>{i(),a.destroy()},updatePresence:Vo,updateYDoc:ti,broadcastEvent:ni,batch:ci,history:{undo:ii,redo:si,canUndo:xn,canRedo:An,clear:ai,pause:ui,resume:di},fetchYDoc:oi,getStorage:Ln,getStorageSnapshot:Mn,getStorageStatus:ut,isPresenceReady:Wn,isStorageReady:Fn,waitUntilPresenceReady:an(li),waitUntilStorageReady:an(fi),events:lt,getStatus:()=>a.getStatus(),getSelf:()=>R.current,getPresence:()=>c.myPresence.current,getOthers:()=>c.others.current,getThreads:mi,getThreadsSince:pi,getThread:vi,createThread:gi,deleteThread:yi,editThreadMetadata:bi,markThreadAsResolved:wi,markThreadAsUnresolved:_i,createComment:Ti,editComment:Ei,deleteComment:Si,addReaction:ki,removeReaction:Ii,getNotificationSettings:Ci,updateNotificationSettings:Oi,markInboxNotificationAsRead:Ni},le,{enumerable:!1})}function ba(e){function t(o,i){return e.storageBatch.subscribe(s=>{const a=s.filter(c=>Zr(c.node,o));a.length>0&&i(a)})}function n(o,i){return e.storageBatch.subscribe(s=>{for(const a of s)a.node._id===o._id&&i(a.node)})}function r(o,i,s){if(typeof o=="string"&&wa(o)){if(typeof i!="function")throw new Error("Second argument must be a callback function");const a=i;switch(o){case"event":return e.customEvent.subscribe(a);case"my-presence":return e.myPresence.subscribe(a);case"others":{const c=a;return e.others.subscribe(u=>{const{others:l,...f}=u;return c(l,f)})}case"error":return e.error.subscribe(a);case"status":return e.status.subscribe(a);case"lost-connection":return e.lostConnection.subscribe(a);case"history":return e.history.subscribe(a);case"storage-status":return e.storageStatus.subscribe(a);case"comments":return e.comments.subscribe(a);default:return oe(o,`"${String(o)}" is not a valid event name`)}}if(i===void 0||typeof o=="function")if(typeof o=="function"){const a=o;return e.storageBatch.subscribe(a)}else throw new Error("Please specify a listener callback");if(K(o)){const a=o;return s?.isDeep?t(a,i):n(a,i)}throw new Error(`${String(o)} is not a value that can be subscribed to.`)}return r}function wa(e){return e==="my-presence"||e==="others"||e==="event"||e==="error"||e==="history"||e==="status"||e==="storage-status"||e==="lost-connection"||e==="connection"||e==="comments"}function _a(e,t){return async()=>t.getAuthValue({requestedScope:"room:read",roomId:e})}function Ta(e,t,n){return r=>{const o=n??(typeof WebSocket>"u"?void 0:WebSocket);if(o===void 0)throw new Ee("To use Liveblocks client in a non-DOM environment, you need to provide a WebSocket polyfill.");const i=new URL(t);if(i.protocol=i.protocol==="http:"?"ws":"wss",i.pathname="/v7",i.searchParams.set("roomId",e),r.type==="secret")i.searchParams.set("tok",r.token.raw);else if(r.type==="public")i.searchParams.set("pubkey",r.publicApiKey);else return oe(r,"Unhandled case");return i.searchParams.set("version",et),new o(i.toString())}}var Ea=16,Sa=1e3,ka=100,Ia=15e3,Ca=200,Oa=1e3,xa=3e4,Aa=5e3,Na=50,Pa=50;function Da(e){return typeof e=="string"&&e.startsWith("http")?e:Is}function gn(e){return e.type==="public"?e.publicApiKey:e.token.raw}function $a(e){const t=e,n=Ua(t.throttle??ka),r=Ma(t.lostConnectionTimeout??Aa),o=Ra(t.backgroundKeepAliveTimeout),i=Da(t.baseUrl),s=Es(e),a=new Map;function c(D){D.id,a.delete(D.id),D.destroy()}function u(D){const R=()=>{const W=R;D.unsubs.delete(W)?D.unsubs.size===0&&c(D.room):ee("This leave function was already called. Calling it more than once has no effect.")};return D.unsubs.add(R),{room:D.room,leave:R}}function l(D,...R){const W=a.get(D);if(W!==void 0)return u(W);const H=R[0]??{},he=(typeof H.initialPresence=="function"?H.initialPresence(D):H.initialPresence)??{},Kt=(typeof H.initialStorage=="function"?H.initialStorage(D):H.initialStorage)??{},at=ya({initialPresence:he,initialStorage:Kt},{roomId:D,throttleDelay:n,lostConnectionTimeout:r,backgroundKeepAliveTimeout:o,polyfills:t.polyfills,delegates:t.mockedDelegates??{createSocket:Ta(D,i,t.polyfills?.WebSocket),authenticate:_a(D,s)},enableDebugLogging:t.enableDebugLogging,unstable_batchedUpdates:H?.unstable_batchedUpdates,baseUrl:i,unstable_fallbackToHTTP:!!t.unstable_fallbackToHTTP,unstable_streamData:!!t.unstable_streamData}),Ve={room:at,unsubs:new Set};if(a.set(D,Ve),H.autoConnect??!0){if(typeof atob>"u"){if(t.polyfills?.atob===void 0)throw new Error("You need to polyfill atob to use the client in your environment. Please follow the instructions at https://liveblocks.io/docs/errors/liveblocks-client/atob-polyfill");global.atob=t.polyfills.atob}at.connect()}return u(Ve)}function f(D){const R=a.get(D)?.room;return R||null}function b(){s.reset();for(const{room:D}of a.values())ds(D.getStatus())||D.reconnect()}const w=Gr(null),{getInboxNotifications:S,getInboxNotificationsSince:E,getUnreadInboxNotificationsCount:_,markAllInboxNotificationsAsRead:g,markInboxNotificationAsRead:p,deleteAllInboxNotifications:v,deleteInboxNotification:k,getThreads:C,getThreadsSince:x}=Ds({baseUrl:i,fetcher:t.polyfills?.fetch||fetch,authManager:s,currentUserIdStore:w}),A=t.resolveUsers,j=ar(()=>!A,"Set the resolveUsers option in createClient to specify user info."),M=Jn(async D=>{const R=D.flat(),W=await A?.({userIds:R});return j(),W??R.map(()=>{})},{delay:Na}),q=t.resolveRoomsInfo,be=ar(()=>!q,"Set the resolveRoomsInfo option in createClient to specify room info."),fe=Jn(async D=>{const R=D.flat(),W=await q?.({roomIds:R});return be(),W??R.map(()=>{})},{delay:Pa});return Object.defineProperty({enterRoom:l,getRoom:f,logout:b,getInboxNotifications:S,getInboxNotificationsSince:E,getUnreadInboxNotificationsCount:_,markAllInboxNotificationsAsRead:g,markInboxNotificationAsRead:p,deleteAllInboxNotifications:v,deleteInboxNotification:k,getThreads:C,[le]:{currentUserIdStore:w,resolveMentionSuggestions:t.resolveMentionSuggestions,usersStore:M,roomsInfoStore:fe,getRoomIds(){return Array.from(a.keys())},getThreads:C,getThreadsSince:x}},le,{enumerable:!1})}var rt=class extends Error{constructor(e,t,n){super(e),this.message=e,this.status=t,this.details=n}};function Cn(e,t,n,r,o){if(typeof t!="number"||t<n||r!==void 0&&t>r)throw new Error(r!==void 0?`${e} should be between ${o??n} and ${r}.`:`${e} should be at least ${o??n}.`);return t}function Ra(e){if(e!==void 0)return Cn("backgroundKeepAliveTimeout",e,Ia)}function Ua(e){return Cn("throttle",e,Ea,Sa)}function Ma(e){return Cn("lostConnectionTimeout",e,Ca,xa,Oa)}function ar(e,...t){return()=>{}}var La={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};new RegExp(Object.keys(La).map(e=>`\\${e}`).join("|"),"g");var ja={_:"\\_","*":"\\*","#":"\\#","`":"\\`","~":"\\~","!":"\\!","|":"\\|","(":"\\(",")":"\\)","{":"\\{","}":"\\}","[":"\\[","]":"\\]"};new RegExp(Object.keys(ja).map(e=>`\\${e}`).join("|"),"g");function yn(e){let t={state:"stopped",timeoutHandle:null,interval:null,lastScheduledAt:null,remainingInterval:null};function n(){t.state==="running"&&r(t.interval),e()}function r(l){t={state:"running",interval:t.state!=="stopped"?t.interval:l,lastScheduledAt:performance.now(),timeoutHandle:setTimeout(n,l),remainingInterval:null}}function o(l){t.state==="paused"&&(t={state:"running",interval:t.interval,lastScheduledAt:t.lastScheduledAt,timeoutHandle:setTimeout(n,l),remainingInterval:null})}function i(l){t.state!=="running"&&r(l)}function s(l){u(),i(l)}function a(){t.state==="running"&&(clearTimeout(t.timeoutHandle),t={state:"paused",interval:t.interval,lastScheduledAt:t.lastScheduledAt,timeoutHandle:null,remainingInterval:t.interval-(performance.now()-t.lastScheduledAt)})}function c(){t.state==="paused"&&o(t.remainingInterval)}function u(){t.state!=="stopped"&&(t.timeoutHandle&&clearTimeout(t.timeoutHandle),t={state:"stopped",interval:null,lastScheduledAt:null,timeoutHandle:null,remainingInterval:null})}return{start:i,restart:s,pause:a,resume:c,stop:u}}function Wa(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!Object.is(e[n],t[n]))return!1;return!0}function Fa(e,t){if(typeof e!="object"||e===null||typeof t!="object"||t===null||Object.prototype.toString.call(e)!=="[object Object]"||Object.prototype.toString.call(t)!=="[object Object]")return!1;const n=Object.keys(e);return n.length!==Object.keys(t).length?!1:n.every(r=>Object.prototype.hasOwnProperty.call(t,r)&&Object.is(e[r],t[r]))}function ao(e,t){if(Object.is(e,t))return!0;const n=Array.isArray(e),r=Array.isArray(t);return n||r?!n||!r?!1:Wa(e,t):Fa(e,t)}_n(Rr,et,Gi);var Ha="@liveblocks/client",za="2.7.0",Ba="esm";_n(Ha,za,Ba);var co={exports:{}},uo={},lo={exports:{}},fo={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fe=y;function Ka(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Va=typeof Object.is=="function"?Object.is:Ka,qa=Fe.useState,Ya=Fe.useEffect,Ga=Fe.useLayoutEffect,Qa=Fe.useDebugValue;function Ja(e,t){var n=t(),r=qa({inst:{value:n,getSnapshot:t}}),o=r[0].inst,i=r[1];return Ga(function(){o.value=n,o.getSnapshot=t,Jt(o)&&i({inst:o})},[e,n,t]),Ya(function(){return Jt(o)&&i({inst:o}),e(function(){Jt(o)&&i({inst:o})})},[e]),Qa(n),n}function Jt(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Va(e,n)}catch{return!0}}function Xa(e,t){return t()}var Za=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Xa:Ja;fo.useSyncExternalStore=Fe.useSyncExternalStore!==void 0?Fe.useSyncExternalStore:Za;lo.exports=fo;var ec=lo.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ht=y,tc=ec;function nc(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var rc=typeof Object.is=="function"?Object.is:nc,oc=tc.useSyncExternalStore,ic=Ht.useRef,sc=Ht.useEffect,ac=Ht.useMemo,cc=Ht.useDebugValue;uo.useSyncExternalStoreWithSelector=function(e,t,n,r,o){var i=ic(null);if(i.current===null){var s={hasValue:!1,value:null};i.current=s}else s=i.current;i=ac(function(){function c(w){if(!u){if(u=!0,l=w,w=r(w),o!==void 0&&s.hasValue){var S=s.value;if(o(S,w))return f=S}return f=w}if(S=f,rc(l,w))return S;var E=r(w);return o!==void 0&&o(S,E)?S:(l=w,f=E)}var u=!1,l,f,b=n===void 0?null:n;return[function(){return c(t())},b===null?void 0:function(){return c(b())}]},[t,n,r,o]);var a=oc(e,i[0],i[1]);return sc(function(){s.hasValue=!0,s.value=a},[a]),cc(a),a};co.exports=uo;var zt=co.exports,uc="@liveblocks/react",dc="2.7.0",lc="esm",fc=class extends Error{constructor(e,t){super("Create thread failed."),this.cause=e,this.context=t,this.name="CreateThreadError"}},hc=class extends Error{constructor(e,t){super("Delete thread failed."),this.cause=e,this.context=t,this.name="DeleteThreadError"}},pc=class extends Error{constructor(e,t){super("Edit thread metadata failed."),this.cause=e,this.context=t,this.name="EditThreadMetadataError"}},mc=class extends Error{constructor(e,t){super("Create comment failed."),this.cause=e,this.context=t,this.name="CreateCommentError"}},vc=class extends Error{constructor(e,t){super("Edit comment failed."),this.cause=e,this.context=t,this.name="EditCommentError"}},gc=class extends Error{constructor(e,t){super("Delete comment failed."),this.cause=e,this.context=t,this.name="DeleteCommentError"}},yc=class extends Error{constructor(e,t){super("Add reaction failed."),this.cause=e,this.context=t,this.name="AddReactionError"}},bc=class extends Error{constructor(e,t){super("Remove reaction failed."),this.cause=e,this.context=t,this.name="RemoveReactionError"}},wc=class extends Error{constructor(e,t){super("Mark inbox notification as read failed."),this.cause=e,this.context=t,this.name="MarkInboxNotificationAsReadError"}};function ho(e,t){return po(e,t)<0}function po(e,t){return(t.updatedAt??t.createdAt).getTime()-(e.updatedAt??e.createdAt).getTime()}function _c(e){return Tn(e)&&mo(e.startsWith)}function mo(e){return typeof e=="string"}function Tc(e){return t=>Ec(t,e)&&Sc(t,e)}function Ec(e,t){return t.resolved===void 0||e.resolved===t.resolved}function Sc(e,t){const n=e.metadata;return t.metadata===void 0||Object.entries(t.metadata).every(([r,o])=>o===void 0||kc(n[r],o))}function kc(e,t){return _c(t)?mo(e)&&e.startsWith(t.startsWith):e===t}var Ic=5,Cc=5e3;function Ct(e,t){if(t>=Ic)return;const n=Math.pow(2,t)*Cc;setTimeout(()=>{e()},n)}async function Oc(e,t,n){const r=n.length>0?n[n.length-1]:0;let o=0;for(;;){o++;const i=e();try{return await i}catch(a){if(o>=t)throw new Error(`Failed after ${t} attempts: ${String(a)}`)}const s=n[o-1]??r;await cs(s)}}function xc(e){const t=y.useRef(e);return y.useEffect(()=>{t.current=e},[e]),t}var Ac=e=>e;function X(e){return y.useReducer(Ac,e)[0]}function _t(e){const t=X(e);if(typeof t=="function"){const n=xc(e);return y.useCallback((...r)=>n.current(...r),[n])}else return t}var Nc=class{constructor(){this._store=Gr({threads:{},queries:{},optimisticUpdates:[],inboxNotifications:{},notificationSettings:{},versions:{}}),this.get=this.get.bind(this),this.subscribe=this.subscribe.bind(this)}get(){return this._store.get()}subscribe(e){return this._store.subscribe(e)}updateThreadsCache(e){this._store.set(t=>{const n=e(t.threads);return n!==t.threads?{...t,threads:n}:t})}updateInboxNotificationsCache(e){this._store.set(t=>{const n=e(t.inboxNotifications);return n!==t.inboxNotifications?{...t,inboxNotifications:n}:t})}setNotificationSettings(e,t){this._store.set(n=>({...n,notificationSettings:{...n.notificationSettings,[e]:t}}))}setVersions(e,t){this._store.set(n=>({...n,versions:{...n.versions,[e]:t}}))}setQueryState(e,t){this._store.set(n=>({...n,queries:{...n.queries,[e]:t}}))}updateOptimisticUpdatesCache(e){this._store.set(t=>({...t,optimisticUpdates:e(t.optimisticUpdates)}))}force_set(e){return this._store.set(e)}updateInboxNotification(e,t,n){this._store.batch(()=>{this.removeOptimisticUpdate(t),this.updateInboxNotificationsCache(r=>{const o=r[e];return o?{...r,[e]:n(o)}:r})})}updateAllInboxNotifications(e,t){this._store.batch(()=>{this.removeOptimisticUpdate(e),this.updateInboxNotificationsCache(n=>ss(n,t))})}deleteInboxNotification(e,t){this._store.batch(()=>{this.removeOptimisticUpdate(t),this.updateInboxNotificationsCache(n=>{const{[e]:r,...o}=n;return r===void 0?n:o})})}deleteAllInboxNotifications(e){this._store.batch(()=>{this.removeOptimisticUpdate(e),this.updateInboxNotificationsCache(()=>({}))})}createThread(e,t){this._store.batch(()=>{this.removeOptimisticUpdate(e),this.updateThreadsCache(n=>({...n,[t.id]:t}))})}updateThread(e,t,n,r){this._store.batch(()=>{t!==null&&this.removeOptimisticUpdate(t),this.updateThreadsCache(o=>{const i=o[e];return!i||i.deletedAt!==void 0||r&&i.updatedAt&&i.updatedAt>r?o:{...o,[e]:n(i)}})})}deleteThread(e,t){return this.updateThread(e,t,n=>({...n,updatedAt:new Date,deletedAt:new Date}))}createComment(e,t){this._store.batch(()=>{this.removeOptimisticUpdate(t);const n=this._store.get().threads[e.threadId];n&&(this.updateThreadsCache(r=>({...r,[e.threadId]:Dt(n,e)})),this.updateInboxNotificationsCache(r=>{const o=Object.values(r).find(i=>i.kind==="thread"&&i.threadId===e.threadId);return o?{...r,[o.id]:{...o,notifiedAt:e.createdAt,readAt:e.createdAt}}:r}))})}updateThreadAndNotification(e,t){this._store.batch(()=>{this.updateThreadsCache(n=>{const r=n[e.id];return r===void 0||ho(e,r)?{...n,[e.id]:e}:n}),t!==void 0&&this.updateInboxNotificationsCache(n=>({...n,[t.id]:t}))})}updateThreadsAndNotifications(e,t,n,r,o){this._store.batch(()=>{this.updateThreadsCache(i=>Pc(i,{newThreads:e,deletedThreads:n})),this.updateInboxNotificationsCache(i=>Dc(i,{newInboxNotifications:t,deletedNotifications:r})),o!==void 0&&this.setQueryOK(o)})}updateRoomInboxNotificationSettings2(e,t,n){this._store.batch(()=>{this.removeOptimisticUpdate(t),this.setNotificationSettings(e,n)})}updateRoomInboxNotificationSettings(e,t,n){this._store.batch(()=>{this.setQueryOK(n),this.setNotificationSettings(e,t)})}updateRoomVersions(e,t,n){this._store.batch(()=>{this.setVersions(e,t),n!==void 0&&this.setQueryOK(n)})}addOptimisticUpdate(e){const t=ze(),n={...e,id:t};return this.updateOptimisticUpdatesCache(r=>[...r,n]),t}removeOptimisticUpdate(e){this.updateOptimisticUpdatesCache(t=>t.filter(n=>n.id!==e))}setQueryLoading(e){this.setQueryState(e,{isLoading:!0})}setQueryOK(e){this.setQueryState(e,{isLoading:!1,data:void 0})}setQueryError(e,t){this.setQueryState(e,{isLoading:!1,error:t})}};function vo(e){const t={threads:{...e.threads},inboxNotifications:{...e.inboxNotifications},notificationSettings:{...e.notificationSettings}};for(const n of e.optimisticUpdates)switch(n.type){case"create-thread":{t.threads[n.thread.id]=n.thread;break}case"edit-thread-metadata":{const r=t.threads[n.threadId];if(r===void 0||r.deletedAt!==void 0||r.updatedAt!==void 0&&r.updatedAt>n.updatedAt)break;t.threads[r.id]={...r,updatedAt:n.updatedAt,metadata:{...r.metadata,...n.metadata}};break}case"mark-thread-as-resolved":{const r=t.threads[n.threadId];if(r===void 0||r.deletedAt!==void 0)break;t.threads[r.id]={...r,resolved:!0};break}case"mark-thread-as-unresolved":{const r=t.threads[n.threadId];if(r===void 0||r.deletedAt!==void 0)break;t.threads[r.id]={...r,resolved:!1};break}case"create-comment":{const r=t.threads[n.comment.threadId];if(r===void 0)break;t.threads[r.id]=Dt(r,n.comment);const o=Object.values(t.inboxNotifications).find(i=>i.kind==="thread"&&i.threadId===r.id);if(o===void 0)break;t.inboxNotifications[o.id]={...o,notifiedAt:n.comment.createdAt,readAt:n.comment.createdAt};break}case"edit-comment":{const r=t.threads[n.comment.threadId];if(r===void 0)break;t.threads[r.id]=Dt(r,n.comment);break}case"delete-comment":{const r=t.threads[n.threadId];if(r===void 0)break;t.threads[r.id]=go(r,n.commentId,n.deletedAt);break}case"delete-thread":{if(t.threads[n.threadId]===void 0)break;t.threads[n.threadId]={...t.threads[n.threadId],deletedAt:n.deletedAt,updatedAt:n.deletedAt,comments:[]};break}case"add-reaction":{const r=t.threads[n.threadId];if(r===void 0)break;t.threads[r.id]=yo(r,n.commentId,n.reaction);break}case"remove-reaction":{const r=t.threads[n.threadId];if(r===void 0)break;t.threads[r.id]=bo(r,n.commentId,n.emoji,n.userId,n.removedAt);break}case"mark-inbox-notification-as-read":{t.inboxNotifications[n.inboxNotificationId]={...e.inboxNotifications[n.inboxNotificationId],readAt:n.readAt};break}case"mark-all-inbox-notifications-as-read":{for(const r in t.inboxNotifications)t.inboxNotifications[r]={...t.inboxNotifications[r],readAt:n.readAt};break}case"delete-inbox-notification":{const{[n.inboxNotificationId]:r,...o}=t.inboxNotifications;t.inboxNotifications=o;break}case"delete-all-inbox-notifications":{t.inboxNotifications={};break}case"update-notification-settings":t.notificationSettings[n.roomId]={...t.notificationSettings[n.roomId],...n.settings}}return t}function Pc(e,t){const n={...e};return t.newThreads.forEach(r=>{const o=n[r.id];o&&ho(o,r)||(n[r.id]=r)}),t.deletedThreads.forEach(({id:r,deletedAt:o})=>{const i=n[r];i!==void 0&&(i.deletedAt=o,i.updatedAt=o,i.comments=[])}),n}function Dc(e,t){const n={...e};return t.newInboxNotifications.forEach(r=>{const o=n[r.id];o&&$c(o,r)===1||(n[r.id]=r)}),t.deletedNotifications.forEach(({id:r})=>delete n[r]),n}function $c(e,t){return e.notifiedAt>t.notifiedAt?1:e.notifiedAt<t.notifiedAt?-1:e.readAt&&t.readAt?e.readAt>t.readAt?1:e.readAt<t.readAt?-1:0:e.readAt||t.readAt?e.readAt?1:-1:0}function Dt(e,t){if(e.deletedAt!==void 0)return e;if(t.threadId!==e.id)return We.warn(`Comment ${t.id} does not belong to thread ${e.id}`),e;const n=e.comments.find(r=>r.id===t.id);if(n===void 0){const r=new Date(Math.max(e.updatedAt?.getTime()||0,t.createdAt.getTime()));return{...e,updatedAt:r,comments:[...e.comments,t]}}if(n.deletedAt!==void 0)return e;if(n.editedAt===void 0||t.editedAt===void 0||n.editedAt<=t.editedAt){const r=e.comments.map(i=>i.id===t.id?t:i);return{...e,updatedAt:new Date(Math.max(e.updatedAt?.getTime()||0,t.editedAt?.getTime()||t.createdAt.getTime())),comments:r}}return e}function go(e,t,n){if(e.deletedAt!==void 0)return e;const r=e.comments.find(i=>i.id===t);if(r===void 0||r.deletedAt!==void 0)return e;const o=e.comments.map(i=>i.id===t?{...i,deletedAt:n,body:void 0}:i);return o.some(i=>i.deletedAt===void 0)?{...e,updatedAt:n,comments:o}:{...e,deletedAt:n,updatedAt:n,comments:[]}}function yo(e,t,n){if(e.deletedAt!==void 0)return e;const r=e.comments.find(i=>i.id===t);if(r===void 0||r.deletedAt!==void 0)return e;const o=e.comments.map(i=>i.id===t?{...i,reactions:Rc(i.reactions,n)}:i);return{...e,updatedAt:new Date(Math.max(n.createdAt.getTime(),e.updatedAt?.getTime()||0)),comments:o}}function bo(e,t,n,r,o){if(e.deletedAt!==void 0)return e;const i=e.comments.find(a=>a.id===t);if(i===void 0||i.deletedAt!==void 0)return e;const s=e.comments.map(a=>a.id===t?{...a,reactions:a.reactions.map(c=>c.emoji===n?{...c,users:c.users.filter(u=>u.id!==r)}:c).filter(c=>c.users.length>0)}:a);return{...e,updatedAt:new Date(Math.max(o.getTime(),e.updatedAt?.getTime()||0)),comments:s}}function Rc(e,t){const n=e.find(r=>r.emoji===t.emoji);return n===void 0?[...e,{emoji:t.emoji,createdAt:t.createdAt,users:[{id:t.userId}]}]:n.users.some(r=>r.id===t.userId)===!1?e.map(r=>r.emoji===t.emoji?{...r,users:[...r.users,{id:t.userId}]}:r):e}var wo=y.createContext(null);function Uc(e){return new Error(`resolveUsers didn't return anything for user '${e}'`)}var cr=new WeakMap,ur=new WeakMap,Xt=60*1e3,Ge="INBOX_NOTIFICATIONS",_o="USER_THREADS";function Mc(e,t){const n=vo(e);let r=Object.values(n.threads).filter(i=>!i.deletedAt);const o=t.query;return o&&(r=r.filter(Tc(o))),r.sort(po)}function Lc(e,t){return e===void 0||e?.isLoading?e??{isLoading:!0}:e.error?e:e.data?{isLoading:!1,user:e.data}:{isLoading:!1,error:Uc(t)}}function jc(e){const t=vo(e);return Object.values(t.inboxNotifications).sort((n,r)=>r.notifiedAt.getTime()-n.notifiedAt.getTime())}function To(e){let t=cr.get(e);return t||(t=new Nc,cr.set(e,t)),t}function dr(e){let t=ur.get(e);return t||(t=Wc(e),ur.set(e,t)),t}function Wc(e){const t=To(e);let n;async function r(){if(n===void 0){const g=await e.getInboxNotifications();t.updateThreadsAndNotifications(g.threads,g.inboxNotifications,[],[],Ge),n=g.requestedAt}else{const g=await e.getInboxNotificationsSince({since:n});t.updateThreadsAndNotifications(g.threads.updated,g.inboxNotifications.updated,g.threads.deleted,g.inboxNotifications.deleted,Ge),n<g.requestedAt&&(n=g.requestedAt)}}let o=0;const i=yn(async()=>{try{await s(),await r()}catch(g){console.warn(`Polling new inbox notifications failed: ${String(g)}`)}}),s=an(async()=>{t.setQueryLoading(Ge);try{await Oc(()=>r(),5,[5e3,5e3,1e4,15e3])}catch(g){throw t.setQueryError(Ge,g),g}});function a(){s().catch(()=>{})}function c(){y.useEffect(()=>(o++,i.start(Xt),()=>{if(o<=0){console.warn(`Internal unexpected behavior. Cannot decrease subscriber count for query "${Ge}"`);return}o--,o<=0&&i.stop()}),[])}const u=yn(f);let l=!1;async function f(){const g=E;if(!(g===void 0||l))try{l=!0;const p=await e[le].getThreadsSince({since:g});l=!1,t.updateThreadsAndNotifications(p.threads.updated,[],p.threads.deleted,[],_o),E=p.requestedAt}catch{l=!1;return}}const b=new Map,w=new Map;function S(g){const p=b.get(g)??0;return b.set(g,p+1),u.start(Xt),()=>{const v=b.get(g);if(v===void 0||v<=0){console.warn(`Internal unexpected behavior. Cannot decrease subscriber count for query "${g}"`);return}b.set(g,v-1);let k=0;for(const C of b.values())k+=C;k<=0&&u.stop()}}let E;async function _(g,p,{retryCount:v}={retryCount:0}){const k=w.get(g);if(k!==void 0)return k;const C=e[le].getThreads(p);w.set(g,C),t.setQueryLoading(g);try{const x=await C;t.updateThreadsAndNotifications(x.threads,x.inboxNotifications,[],[],g),(E===void 0||E<x.requestedAt)&&(E=x.requestedAt),u.start(Xt)}catch(x){w.delete(g),Ct(()=>{_(g,p,{retryCount:v+1})},v),t.setQueryError(g,x)}}return{store:t,useEnableInboxNotificationsPolling:c,waitUntilInboxNotificationsLoaded:s,loadInboxNotifications:a,incrementUserThreadsQuerySubscribers:S,getUserThreads:_}}function Fc(e,t){const n=e[le].usersStore,r=y.useCallback(()=>n.getState(t),[n,t]);y.useEffect(()=>{n.get(t)},[n,t]);const o=y.useCallback(i=>Lc(i,t),[t]);return zt.useSyncExternalStoreWithSelector(n.subscribe,r,r,o,ao)}function Hc(e){const t=Eo();if(!e?.allowNesting&&t!==null)throw new Error("You cannot nest multiple LiveblocksProvider instances in the same React tree.")}function Eo(){return y.useContext(wo)}function Y(){return Eo()??is("LiveblocksProvider is missing from the React tree.")}function zc(e){return Hc(e),ge.createElement(wo.Provider,{value:e.client},e.children)}function nf(e){const{children:t,...n}=e,r={publicApiKey:X(n.publicApiKey),throttle:X(n.throttle),lostConnectionTimeout:X(n.lostConnectionTimeout),backgroundKeepAliveTimeout:X(n.backgroundKeepAliveTimeout),polyfills:X(n.polyfills),unstable_fallbackToHTTP:X(n.unstable_fallbackToHTTP),unstable_streamData:X(n.unstable_streamData),authEndpoint:_t(n.authEndpoint),resolveMentionSuggestions:_t(n.resolveMentionSuggestions),resolveUsers:_t(n.resolveUsers),resolveRoomsInfo:_t(n.resolveRoomsInfo),baseUrl:X(n.baseUrl),enableDebugLogging:X(n.enableDebugLogging)},o=y.useMemo(()=>$a(r),[]);return ge.createElement(zc,{client:o},t)}function Bc(e={query:{metadata:{}}}){const t=ge.useMemo(()=>Vc(e.query),[e]),n=Y(),{store:r,getUserThreads:o}=dr(n);ge.useEffect(()=>{const{incrementUserThreadsQuerySubscribers:a}=dr(n);return a(t)},[n,t]);const i=r.get().queries[t];if(i===void 0||i.isLoading)throw o(t,e);if(i.error)throw i.error;const s=y.useCallback(a=>({threads:Mc(a,e),isLoading:!1}),[e]);return zt.useSyncExternalStoreWithSelector(r.subscribe,r.get,r.get,s,ao)}function Kc(e){const t=Y();return Fc(t,e)}var rf=Kc,of=Bc,Vc=e=>`${_o}:${Nt(e)}`,qc=e=>e,lr=5*60*1e3;function Yc(){return null}function it(e){const t=e.getSelf();return t===null||t.id===void 0?"anonymous":t.id}function fr(e){const t=`Request failed with status ${e.status}: ${e.message}`;if(e.details?.error==="FORBIDDEN"){const n=[t,e.details.suggestion,e.details.docs].filter(Boolean).join(`
`);We.error(n)}return new Error(t)}var hr=new WeakMap;function G(e){let t=hr.get(e);return t||(t=Gc(e),hr.set(e,t)),t}function Gc(e){const t=To(e),n=2e3,r=new Map,o=new Map,i=new Map,s=new Map,a=yn(c);async function c(){const _=[];e[le].getRoomIds().map(g=>{const p=e.getRoom(g);p!==null&&_.push(l(p.id))}),await Promise.allSettled(_)}function u(_){const g=s.get(_)??0;return s.set(_,g+1),a.start(lr),()=>{const p=s.get(_);if(p===void 0||p<=0){We.warn(`Internal unexpected behavior. Cannot decrease subscriber count for query "${_}"`);return}s.set(_,p-1);let v=0;for(const k of s.values())v+=k;v<=0&&a.stop()}}async function l(_){const g=e.getRoom(_);if(g===null)return;const p=r.get(g.id);if(!(p===void 0||(i.get(g.id)??!1)===!0))try{i.set(g.id,!0);const k=await g.getThreadsSince({since:p});setTimeout(()=>{i.set(g.id,!1)},n),t.updateThreadsAndNotifications(k.threads.updated,k.inboxNotifications.updated,k.threads.deleted,k.inboxNotifications.deleted),r.set(g.id,k.requestedAt)}catch{i.set(g.id,!1);return}}async function f(_,{retryCount:g}={retryCount:0}){const p=ou(_.id),v=o.get(p);if(v!==void 0)return v;const k=_[le].listTextVersions();o.set(p,k),t.setQueryLoading(p);try{const A=(await(await k).json()).versions.map(({createdAt:j,...M})=>({createdAt:new Date(j),...M}));t.updateRoomVersions(_.id,A,p),o.delete(p)}catch(C){o.delete(p),Ct(()=>{f(_,{retryCount:g+1})},g),t.setQueryError(p,C)}}async function b(_,g,p,{retryCount:v}={retryCount:0}){const k=o.get(g);if(k!==void 0)return k;const C=_.getThreads(p);o.set(g,C),t.setQueryLoading(g);try{const x=await C;t.updateThreadsAndNotifications(x.threads,x.inboxNotifications,[],[],g);const A=r.get(_.id);(A===void 0||A>x.requestedAt)&&r.set(_.id,x.requestedAt),a.start(lr)}catch(x){o.delete(g),Ct(()=>{b(_,g,p,{retryCount:v+1})},v),t.setQueryError(g,x)}}async function w(_,g,{retryCount:p}={retryCount:0}){const v=o.get(g);if(v!==void 0)return v;try{const k=_.getNotificationSettings();o.set(g,k),t.setQueryLoading(g);const C=await k;t.updateRoomInboxNotificationSettings(_.id,C,g)}catch(k){o.delete(g),Ct(()=>{w(_,g,{retryCount:p+1})},p),t.setQueryError(g,k)}}const S=L();function E(_,g,p){if(t.removeOptimisticUpdate(g),_ instanceof vn){const v=fr(_);S.notify(p(v));return}if(_ instanceof rt){fr(_);return}throw _}return{store:t,incrementQuerySubscribers:u,commentsErrorEventSource:S,getThreadsUpdates:l,getThreadsAndInboxNotifications:b,getInboxNotificationSettings:w,getRoomVersions:f,onMutationFailure:E}}var So=y.createContext(null);function Qc(e){const t=Y(),[n]=y.useState(()=>new Map),r=y.useCallback((o,i)=>{const s=n.get(o);if(s)return s;const a=t.enterRoom(o,i),c=a.leave;return a.leave=()=>{c(),n.delete(o)},n.set(o,a),a},[t,n]);return y.createElement(Jc,{...e,stableEnterRoom:r})}function Jc(e){const t=Y(),{id:n,stableEnterRoom:r}=e,o=X({initialPresence:e.initialPresence,initialStorage:e.initialStorage,unstable_batchedUpdates:e.unstable_batchedUpdates,autoConnect:e.autoConnect??typeof window<"u"}),[{room:i},s]=y.useState(()=>r(n,{...o,autoConnect:!1}));return y.useEffect(()=>{const{store:a}=G(t);async function c(u){if(u.type===ce.THREAD_DELETED){a.deleteThread(u.threadId,null);return}const l=await i.getThread(u.threadId);if(!l.thread){a.deleteThread(u.threadId,null);return}const{thread:f,inboxNotification:b}=l,w=a.get().threads[u.threadId];switch(u.type){case ce.COMMENT_EDITED:case ce.THREAD_METADATA_UPDATED:case ce.THREAD_UPDATED:case ce.COMMENT_REACTION_ADDED:case ce.COMMENT_REACTION_REMOVED:case ce.COMMENT_DELETED:if(!w)break;a.updateThreadAndNotification(f,b);break;case ce.COMMENT_CREATED:a.updateThreadAndNotification(f,b);break}}return i.events.comments.subscribe(u=>void c(u))},[t,i]),y.useEffect(()=>{const{getThreadsUpdates:a}=G(t);a(i.id)},[t,i.id]),y.useEffect(()=>{function a(){const{getThreadsUpdates:c}=G(t);c(i.id)}return window.addEventListener("online",a),()=>{window.removeEventListener("online",a)}},[t,i.id]),y.useEffect(()=>{const a=r(n,o);s(a);const{room:c,leave:u}=a;return o.autoConnect&&c.connect(),()=>{u()}},[n,o,r]),y.createElement(So.Provider,{value:i},e.children)}function te(){const e=ru();if(e===null)throw new Error("RoomProvider is missing from the React tree.");return e}function Xc(e,t){const n=te(),r=n.events.self.subscribe,o=n.getSelf,i=e??qc,s=y.useCallback(c=>c!==null?i(c):null,[i]),a=Yc;return zt.useSyncExternalStoreWithSelector(r,o,a,s,t)}function Zc(){const e=Y(),t=te();return y.useCallback(n=>{const r=n.body,o=n.metadata??{},i=ro(),s=Pt(),a=new Date,c={id:s,threadId:i,roomId:t.id,createdAt:a,type:"comment",userId:it(t),body:r,reactions:[]},u={id:i,type:"thread",createdAt:a,updatedAt:a,roomId:t.id,metadata:o,comments:[c],resolved:!1},{store:l,onMutationFailure:f}=G(e),b=l.addOptimisticUpdate({type:"create-thread",thread:u,roomId:t.id});return t.createThread({threadId:i,commentId:s,body:r,metadata:o}).then(w=>{l.createThread(b,w)},w=>f(w,b,S=>new fc(S,{roomId:t.id,threadId:i,commentId:s,body:r,metadata:o}))),u},[e,t])}function eu(){const e=Y(),t=te();return y.useCallback(n=>{const{store:r,onMutationFailure:o}=G(e),i=r.get().threads[n],s=it(t);if(i?.comments?.[0]?.userId!==s)throw new Error("Only the thread creator can delete the thread");const a=r.addOptimisticUpdate({type:"delete-thread",roomId:t.id,threadId:n,deletedAt:new Date});t.deleteThread(n).then(()=>{r.deleteThread(n,a)},c=>o(c,a,u=>new hc(u,{roomId:t.id,threadId:n})))},[e,t])}function tu(){const e=Y(),t=te();return y.useCallback(n=>{if(!n.metadata)return;const r=n.threadId,o=n.metadata,i=new Date,{store:s,onMutationFailure:a}=G(e),c=s.addOptimisticUpdate({type:"edit-thread-metadata",metadata:o,threadId:r,updatedAt:i});t.editThreadMetadata({threadId:r,metadata:o}).then(u=>s.updateThread(r,c,l=>({...l,metadata:u}),i),u=>a(u,c,l=>new pc(l,{roomId:t.id,threadId:r,metadata:o})))},[e,t])}function sf(){const e=Y(),t=te();return y.useCallback(({threadId:n,body:r})=>{const o=Pt(),i=new Date,s={id:o,threadId:n,roomId:t.id,type:"comment",createdAt:i,userId:it(t),body:r,reactions:[]},{store:a,onMutationFailure:c}=G(e),u=a.addOptimisticUpdate({type:"create-comment",comment:s});return t.createComment({threadId:n,commentId:o,body:r}).then(l=>{a.createComment(l,u)},l=>c(l,u,f=>new mc(f,{roomId:t.id,threadId:n,commentId:o,body:r}))),s},[e,t])}function af(){const e=Y(),t=te();return y.useCallback(({threadId:n,commentId:r,body:o})=>{const i=new Date,{store:s,onMutationFailure:a}=G(e),c=s.get().threads[n];if(c===void 0){We.warn(`Internal unexpected behavior. Cannot edit comment in thread "${n}" because the thread does not exist in the cache.`);return}const u=c.comments.find(f=>f.id===r);if(u===void 0||u.deletedAt!==void 0){We.warn(`Internal unexpected behavior. Cannot edit comment "${r}" in thread "${n}" because the comment does not exist in the cache.`);return}const l=s.addOptimisticUpdate({type:"edit-comment",comment:{...u,editedAt:i,body:o}});t.editComment({threadId:n,commentId:r,body:o}).then(f=>{s.updateThread(n,l,b=>Dt(b,f))},f=>a(f,l,b=>new vc(b,{roomId:t.id,threadId:n,commentId:r,body:o})))},[e,t])}function cf(){const e=Y(),t=te();return y.useCallback(({threadId:n,commentId:r})=>{const o=new Date,{store:i,onMutationFailure:s}=G(e),a=i.addOptimisticUpdate({type:"delete-comment",threadId:n,commentId:r,deletedAt:o,roomId:t.id});t.deleteComment({threadId:n,commentId:r}).then(()=>{i.updateThread(n,a,c=>go(c,r,o),o)},c=>s(c,a,u=>new gc(u,{roomId:t.id,threadId:n,commentId:r})))},[e,t])}function nu(){const e=Y(),t=te();return y.useCallback(({threadId:n,commentId:r,emoji:o})=>{const i=new Date,s=it(t),{store:a,onMutationFailure:c}=G(e),u=a.addOptimisticUpdate({type:"add-reaction",threadId:n,commentId:r,reaction:{emoji:o,userId:s,createdAt:i}});t.addReaction({threadId:n,commentId:r,emoji:o}).then(l=>{a.updateThread(n,u,f=>yo(f,r,l),i)},l=>c(l,u,f=>new yc(f,{roomId:t.id,threadId:n,commentId:r,emoji:o})))},[e,t])}function uf(){const e=Y(),t=te();return y.useCallback(({threadId:n,commentId:r,emoji:o})=>{const i=it(t),s=new Date,{store:a,onMutationFailure:c}=G(e),u=a.addOptimisticUpdate({type:"remove-reaction",threadId:n,commentId:r,emoji:o,userId:i,removedAt:s});t.removeReaction({threadId:n,commentId:r,emoji:o}).then(()=>{a.updateThread(n,u,l=>bo(l,r,o,i,s),s)},l=>c(l,u,f=>new bc(f,{roomId:t.id,threadId:n,commentId:r,emoji:o})))},[e,t])}function df(){const e=Y(),t=te();return y.useCallback(n=>{const{store:r,onMutationFailure:o}=G(e),i=Object.values(r.get().inboxNotifications).find(c=>c.kind==="thread"&&c.threadId===n);if(!i)return;const s=new Date,a=r.addOptimisticUpdate({type:"mark-inbox-notification-as-read",inboxNotificationId:i.id,readAt:s});t.markInboxNotificationAsRead(i.id).then(()=>{r.updateInboxNotification(i.id,a,c=>({...c,readAt:s}))},c=>{o(c,a,u=>new wc(u,{inboxNotificationId:i.id}))})},[e,t])}function lf(e){const t=Y(),{store:n}=G(t),r=y.useCallback(o=>{const i=jc(o).find(a=>a.kind==="thread"&&a.threadId===e),s=o.threads[e];return i===void 0||s===void 0?{status:"not-subscribed"}:{status:"subscribed",unreadSince:i.readAt}},[e]);return zt.useSyncExternalStoreWithSelector(n.subscribe,n.get,n.get,r)}function ru(){return y.useContext(So)}function ou(e){return`${e}-VERSIONS`}var ff=Qc,hf=te,pf=nu,mf=Zc,vf=eu,gf=tu;function yf(...e){return Xc(...e)}_n(uc,dc,lc);const bf=e=>{const[t,n]=y.useState(!1),[r,o]=y.useState(!1),i=y.useId(),s=e.id||`input-${i}`,a=`input-description-${i}`;return{inputId:s,descriptionId:a,hasErrorMessage:t,hasHelperText:r,isDisabled:!!e.isDisabled,isInvalid:!!e.isInvalid,isRequired:!!e.isRequired,setHasErrorMessage:n,setHasHelperText:o}},iu=y.createContext(void 0),su=()=>y.useContext(iu),au=e=>{const t=e.reduce((n,r)=>(r&&(n[r.name]||(n[r.name]={alt:r.name,src:uu(r)})),n),{});return Object.values(t)},cu=e=>e.includes("icons.tango.us/undefined"),uu=({iconURL:e,name:t},n)=>{if(!e){const r=new URL(`https://icons.tango.us/${t}`);return n!=null&&n.format&&r.searchParams.append("format",n?.format),n!=null&&n.size?r.searchParams.append("size",n?.size):r.searchParams.append("size","small"),r.toString()}return cu(e)?e.replace("undefined",t):e},ko=e=>P.jsx(Ie,{icon:P.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",fill:"none",viewBox:"0 0 40 40",children:[P.jsx("path",{fill:"currentColor",d:"M31.667 8.333v23.334H8.333V8.333h23.334Zm0-3.333H8.333A3.343 3.343 0 0 0 5 8.333v23.334C5 33.5 6.5 35 8.333 35h23.334C33.5 35 35 33.5 35 31.667V8.333C35 6.5 33.5 5 31.667 5Z"}),P.jsx("path",{fill:"currentColor",d:"M23.333 28.333H11.667V25h11.666v3.333Zm5-6.666H11.667v-3.334h16.666v3.334Zm0-6.667H11.667v-3.333h16.666V15Z"})]}),...e});ko.displayName="IconArticleOutline";const du=e=>{const{children:t,size:n="md",max:r,portalledTooltip:o=!0}=e;return t.length===0?P.jsx(Le,{alignItems:"center",css:{bg:$.colors.gray100,borderRadius:$.radii.full,height:24,width:24},justifyContent:"center",children:P.jsx(ko,{color:$.colors.gray600.value,size:14})}):P.jsxs(Le,{alignItems:"center",as:"ul",css:{m:0,p:0},gap:"1",children:[ge.Children.map(t,(i,s)=>r&&s>=r?null:ge.isValidElement(i)&&Di(i,$r)?P.jsx($i,{content:i.props.alt,portalled:o,children:P.jsx(Ri,{css:{flexShrink:0},"data-testid":"avatar-image",children:ge.cloneElement(i,{size:n})})}):null),r&&t.length>r?P.jsxs(Dr,{css:{color:"$gray600",ml:$.space[1]},size:"2",children:["+",t.length-r]}):null]})},lu=du,fu=e=>{const{apps:t,size:n="md",max:r,portalledTooltip:o=!0}=e,i=y.useMemo(()=>au(t),[t]);return P.jsx(lu,{max:r,portalledTooltip:o,size:n,children:i.map((s,a)=>P.jsx($r,{...s},`${s.src}-${a}`))})},wf=fu;function _f(e,t,n){var r;if(typeof e=="string"){let o=document;t&&(Ui(!!t.current),o=t.current),n?((r=n[e])!==null&&r!==void 0||(n[e]=o.querySelectorAll(e)),e=n[e]):e=o.querySelectorAll(e)}else e instanceof Element&&(e=[e]);return Array.from(e||[])}const hu=e=>P.jsx(Ie,{icon:P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",fill:"none",viewBox:"0 0 40 40",children:P.jsx("path",{fill:"currentColor",d:"M10 31.667C10 33.5 11.5 35 13.333 35h13.334C28.5 35 30 33.5 30 31.667V15c0-1.833-1.5-3.333-3.333-3.333H13.333A3.343 3.343 0 0 0 10 15v16.667ZM15 15h10c.917 0 1.667.75 1.667 1.667V30c0 .917-.75 1.667-1.667 1.667H15c-.917 0-1.667-.75-1.667-1.667V16.667c0-.917.75-1.667 1.667-1.667Zm10.833-8.333L24.65 5.483c-.3-.3-.733-.483-1.167-.483h-6.966c-.434 0-.867.183-1.167.483l-1.183 1.184H10c-.917 0-1.667.75-1.667 1.666C8.333 9.25 9.083 10 10 10h20c.917 0 1.667-.75 1.667-1.667 0-.916-.75-1.666-1.667-1.666h-4.167Z"})}),...e});hu.displayName="IconDeleteOutline";function ot(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()}function $t(e){"@babel/helpers - typeof";return $t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$t(e)}function z(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function B(e){z(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||$t(e)==="object"&&t==="[object Date]"?new Date(e.getTime()):typeof e=="number"||t==="[object Number]"?new Date(e):((typeof e=="string"||t==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function pr(e){z(1,arguments);var t=B(e);return t.setHours(0,0,0,0),t}var pu=864e5;function mu(e,t){z(2,arguments);var n=pr(e),r=pr(t),o=n.getTime()-ot(n),i=r.getTime()-ot(r);return Math.round((o-i)/pu)}function vu(e,t){return z(2,arguments),B(e).getTime()-B(t).getTime()}var mr={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(e){return e<0?Math.ceil(e):Math.floor(e)}},gu="trunc";function yu(e){return e?mr[e]:mr[gu]}function bu(e,t,n){z(2,arguments);var r=vu(e,t)/1e3;return yu(n?.roundingMethod)(r)}var wu={};function st(){return wu}function _u(e,t){z(2,arguments);var n=B(e),r=B(t),o=n.getTime()-r.getTime();return o<0?-1:o>0?1:o}function Io(e,t){if(e==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}function Tu(e){return Io({},e)}var Eu={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Su=function(e,t,n){var r,o=Eu[e];return typeof o=="string"?r=o:t===1?r=o.one:r=o.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function Zt(e){return function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=t.width?String(t.width):e.defaultWidth,r=e.formats[n]||e.formats[e.defaultWidth];return r}}var ku={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Iu={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Cu={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Ou={date:Zt({formats:ku,defaultWidth:"full"}),time:Zt({formats:Iu,defaultWidth:"full"}),dateTime:Zt({formats:Cu,defaultWidth:"full"})};const xu=Ou;var Au={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Nu=function(e,t,n,r){return Au[e]};const Pu=Nu;function Qe(e){return function(t,n){var r=n!=null&&n.context?String(n.context):"standalone",o;if(r==="formatting"&&e.formattingValues){var i=e.defaultFormattingWidth||e.defaultWidth,s=n!=null&&n.width?String(n.width):i;o=e.formattingValues[s]||e.formattingValues[i]}else{var a=e.defaultWidth,c=n!=null&&n.width?String(n.width):e.defaultWidth;o=e.values[c]||e.values[a]}var u=e.argumentCallback?e.argumentCallback(t):t;return o[u]}}var Du={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},$u={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Ru={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Uu={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Mu={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Lu={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},ju=function(e,t){var n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},Wu={ordinalNumber:ju,era:Qe({values:Du,defaultWidth:"wide"}),quarter:Qe({values:$u,defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:Qe({values:Ru,defaultWidth:"wide"}),day:Qe({values:Uu,defaultWidth:"wide"}),dayPeriod:Qe({values:Mu,defaultWidth:"wide",formattingValues:Lu,defaultFormattingWidth:"wide"})};const Fu=Wu;function Je(e){return function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=n.width,o=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],i=t.match(o);if(!i)return null;var s=i[0],a=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(a)?zu(a,function(f){return f.test(s)}):Hu(a,function(f){return f.test(s)}),u;u=e.valueCallback?e.valueCallback(c):c,u=n.valueCallback?n.valueCallback(u):u;var l=t.slice(s.length);return{value:u,rest:l}}}function Hu(e,t){for(var n in e)if(e.hasOwnProperty(n)&&t(e[n]))return n}function zu(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return n}function Bu(e){return function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.match(e.matchPattern);if(!r)return null;var o=r[0],i=t.match(e.parsePattern);if(!i)return null;var s=e.valueCallback?e.valueCallback(i[0]):i[0];s=n.valueCallback?n.valueCallback(s):s;var a=t.slice(o.length);return{value:s,rest:a}}}var Ku=/^(\d+)(th|st|nd|rd)?/i,Vu=/\d+/i,qu={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Yu={any:[/^b/i,/^(a|c)/i]},Gu={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Qu={any:[/1/i,/2/i,/3/i,/4/i]},Ju={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Xu={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Zu={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},ed={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},td={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},nd={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},rd={ordinalNumber:Bu({matchPattern:Ku,parsePattern:Vu,valueCallback:function(e){return parseInt(e,10)}}),era:Je({matchPatterns:qu,defaultMatchWidth:"wide",parsePatterns:Yu,defaultParseWidth:"any"}),quarter:Je({matchPatterns:Gu,defaultMatchWidth:"wide",parsePatterns:Qu,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:Je({matchPatterns:Ju,defaultMatchWidth:"wide",parsePatterns:Xu,defaultParseWidth:"any"}),day:Je({matchPatterns:Zu,defaultMatchWidth:"wide",parsePatterns:ed,defaultParseWidth:"any"}),dayPeriod:Je({matchPatterns:td,defaultMatchWidth:"any",parsePatterns:nd,defaultParseWidth:"any"})};const od=rd;var Co={code:"en-US",formatDistance:Su,formatLong:xu,formatRelative:Pu,localize:Fu,match:od,options:{weekStartsOn:0,firstWeekContainsDate:1}},vr=1e3*60,Rt=60*24,gr=Rt*30,yr=Rt*365;function id(e,t,n){var r,o,i;z(2,arguments);var s=st(),a=(r=(o=n?.locale)!==null&&o!==void 0?o:s.locale)!==null&&r!==void 0?r:Co;if(!a.formatDistance)throw new RangeError("locale must contain localize.formatDistance property");var c=_u(e,t);if(isNaN(c))throw new RangeError("Invalid time value");var u=Io(Tu(n),{addSuffix:!!(n!=null&&n.addSuffix),comparison:c}),l,f;c>0?(l=B(t),f=B(e)):(l=B(e),f=B(t));var b=String((i=n?.roundingMethod)!==null&&i!==void 0?i:"round"),w;if(b==="floor")w=Math.floor;else if(b==="ceil")w=Math.ceil;else if(b==="round")w=Math.round;else throw new RangeError("roundingMethod must be 'floor', 'ceil' or 'round'");var S=f.getTime()-l.getTime(),E=S/vr,_=ot(f)-ot(l),g=(S-_)/vr,p=n?.unit,v;if(p?v=String(p):E<1?v="second":E<60?v="minute":E<Rt?v="hour":g<gr?v="day":g<yr?v="month":v="year",v==="second"){var k=w(S/1e3);return a.formatDistance("xSeconds",k,u)}else if(v==="minute"){var C=w(E);return a.formatDistance("xMinutes",C,u)}else if(v==="hour"){var x=w(E/60);return a.formatDistance("xHours",x,u)}else if(v==="day"){var A=w(g/Rt);return a.formatDistance("xDays",A,u)}else if(v==="month"){var j=w(g/gr);return j===12&&p!=="month"?a.formatDistance("xYears",1,u):a.formatDistance("xMonths",j,u)}else if(v==="year"){var M=w(g/yr);return a.formatDistance("xYears",M,u)}throw new RangeError("unit must be 'second', 'minute', 'hour', 'day', 'month' or 'year'")}function sd(e){return z(1,arguments),e instanceof Date||$t(e)==="object"&&Object.prototype.toString.call(e)==="[object Date]"}function ad(e){if(z(1,arguments),!sd(e)&&typeof e!="number")return!1;var t=B(e);return!isNaN(Number(t))}function ke(e){if(e===null||e===!0||e===!1)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function cd(e,t){z(2,arguments);var n=B(e).getTime(),r=ke(t);return new Date(n+r)}function ud(e,t){z(2,arguments);var n=ke(t);return cd(e,-n)}var dd=864e5;function ld(e){z(1,arguments);var t=B(e),n=t.getTime();t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0);var r=t.getTime(),o=n-r;return Math.floor(o/dd)+1}function Ut(e){z(1,arguments);var t=1,n=B(e),r=n.getUTCDay(),o=(r<t?7:0)+r-t;return n.setUTCDate(n.getUTCDate()-o),n.setUTCHours(0,0,0,0),n}function Oo(e){z(1,arguments);var t=B(e),n=t.getUTCFullYear(),r=new Date(0);r.setUTCFullYear(n+1,0,4),r.setUTCHours(0,0,0,0);var o=Ut(r),i=new Date(0);i.setUTCFullYear(n,0,4),i.setUTCHours(0,0,0,0);var s=Ut(i);return t.getTime()>=o.getTime()?n+1:t.getTime()>=s.getTime()?n:n-1}function fd(e){z(1,arguments);var t=Oo(e),n=new Date(0);n.setUTCFullYear(t,0,4),n.setUTCHours(0,0,0,0);var r=Ut(n);return r}var hd=6048e5;function pd(e){z(1,arguments);var t=B(e),n=Ut(t).getTime()-fd(t).getTime();return Math.round(n/hd)+1}function Mt(e,t){var n,r,o,i,s,a,c,u;z(1,arguments);var l=st(),f=ke((n=(r=(o=(i=t?.weekStartsOn)!==null&&i!==void 0?i:t==null||(s=t.locale)===null||s===void 0||(a=s.options)===null||a===void 0?void 0:a.weekStartsOn)!==null&&o!==void 0?o:l.weekStartsOn)!==null&&r!==void 0?r:(c=l.locale)===null||c===void 0||(u=c.options)===null||u===void 0?void 0:u.weekStartsOn)!==null&&n!==void 0?n:0);if(!(f>=0&&f<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var b=B(e),w=b.getUTCDay(),S=(w<f?7:0)+w-f;return b.setUTCDate(b.getUTCDate()-S),b.setUTCHours(0,0,0,0),b}function xo(e,t){var n,r,o,i,s,a,c,u;z(1,arguments);var l=B(e),f=l.getUTCFullYear(),b=st(),w=ke((n=(r=(o=(i=t?.firstWeekContainsDate)!==null&&i!==void 0?i:t==null||(s=t.locale)===null||s===void 0||(a=s.options)===null||a===void 0?void 0:a.firstWeekContainsDate)!==null&&o!==void 0?o:b.firstWeekContainsDate)!==null&&r!==void 0?r:(c=b.locale)===null||c===void 0||(u=c.options)===null||u===void 0?void 0:u.firstWeekContainsDate)!==null&&n!==void 0?n:1);if(!(w>=1&&w<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var S=new Date(0);S.setUTCFullYear(f+1,0,w),S.setUTCHours(0,0,0,0);var E=Mt(S,t),_=new Date(0);_.setUTCFullYear(f,0,w),_.setUTCHours(0,0,0,0);var g=Mt(_,t);return l.getTime()>=E.getTime()?f+1:l.getTime()>=g.getTime()?f:f-1}function md(e,t){var n,r,o,i,s,a,c,u;z(1,arguments);var l=st(),f=ke((n=(r=(o=(i=t?.firstWeekContainsDate)!==null&&i!==void 0?i:t==null||(s=t.locale)===null||s===void 0||(a=s.options)===null||a===void 0?void 0:a.firstWeekContainsDate)!==null&&o!==void 0?o:l.firstWeekContainsDate)!==null&&r!==void 0?r:(c=l.locale)===null||c===void 0||(u=c.options)===null||u===void 0?void 0:u.firstWeekContainsDate)!==null&&n!==void 0?n:1),b=xo(e,t),w=new Date(0);w.setUTCFullYear(b,0,f),w.setUTCHours(0,0,0,0);var S=Mt(w,t);return S}var vd=6048e5;function gd(e,t){z(1,arguments);var n=B(e),r=Mt(n,t).getTime()-md(n,t).getTime();return Math.round(r/vd)+1}function U(e,t){for(var n=e<0?"-":"",r=Math.abs(e).toString();r.length<t;)r="0"+r;return n+r}var yd={y:function(e,t){var n=e.getUTCFullYear(),r=n>0?n:1-n;return U(t==="yy"?r%100:r,t.length)},M:function(e,t){var n=e.getUTCMonth();return t==="M"?String(n+1):U(n+1,2)},d:function(e,t){return U(e.getUTCDate(),t.length)},a:function(e,t){var n=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h:function(e,t){return U(e.getUTCHours()%12||12,t.length)},H:function(e,t){return U(e.getUTCHours(),t.length)},m:function(e,t){return U(e.getUTCMinutes(),t.length)},s:function(e,t){return U(e.getUTCSeconds(),t.length)},S:function(e,t){var n=t.length,r=e.getUTCMilliseconds(),o=Math.floor(r*Math.pow(10,n-3));return U(o,t.length)}};const pe=yd;var Ne={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},bd={G:function(e,t,n){var r=e.getUTCFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if(t==="yo"){var r=e.getUTCFullYear(),o=r>0?r:1-r;return n.ordinalNumber(o,{unit:"year"})}return pe.y(e,t)},Y:function(e,t,n,r){var o=xo(e,r),i=o>0?o:1-o;if(t==="YY"){var s=i%100;return U(s,2)}return t==="Yo"?n.ordinalNumber(i,{unit:"year"}):U(i,t.length)},R:function(e,t){var n=Oo(e);return U(n,t.length)},u:function(e,t){var n=e.getUTCFullYear();return U(n,t.length)},Q:function(e,t,n){var r=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return U(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){var r=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return U(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){var r=e.getUTCMonth();switch(t){case"M":case"MM":return pe.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){var r=e.getUTCMonth();switch(t){case"L":return String(r+1);case"LL":return U(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){var o=gd(e,r);return t==="wo"?n.ordinalNumber(o,{unit:"week"}):U(o,t.length)},I:function(e,t,n){var r=pd(e);return t==="Io"?n.ordinalNumber(r,{unit:"week"}):U(r,t.length)},d:function(e,t,n){return t==="do"?n.ordinalNumber(e.getUTCDate(),{unit:"date"}):pe.d(e,t)},D:function(e,t,n){var r=ld(e);return t==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):U(r,t.length)},E:function(e,t,n){var r=e.getUTCDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){var o=e.getUTCDay(),i=(o-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return U(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(o,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(o,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(o,{width:"short",context:"formatting"});case"eeee":default:return n.day(o,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){var o=e.getUTCDay(),i=(o-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return U(i,t.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(o,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(o,{width:"narrow",context:"standalone"});case"cccccc":return n.day(o,{width:"short",context:"standalone"});case"cccc":default:return n.day(o,{width:"wide",context:"standalone"})}},i:function(e,t,n){var r=e.getUTCDay(),o=r===0?7:r;switch(t){case"i":return String(o);case"ii":return U(o,t.length);case"io":return n.ordinalNumber(o,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){var r=e.getUTCHours(),o=r/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(o,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(o,{width:"wide",context:"formatting"})}},b:function(e,t,n){var r=e.getUTCHours(),o;switch(r===12?o=Ne.noon:r===0?o=Ne.midnight:o=r/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(o,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(o,{width:"wide",context:"formatting"})}},B:function(e,t,n){var r=e.getUTCHours(),o;switch(r>=17?o=Ne.evening:r>=12?o=Ne.afternoon:r>=4?o=Ne.morning:o=Ne.night,t){case"B":case"BB":case"BBB":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(o,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(o,{width:"wide",context:"formatting"})}},h:function(e,t,n){if(t==="ho"){var r=e.getUTCHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return pe.h(e,t)},H:function(e,t,n){return t==="Ho"?n.ordinalNumber(e.getUTCHours(),{unit:"hour"}):pe.H(e,t)},K:function(e,t,n){var r=e.getUTCHours()%12;return t==="Ko"?n.ordinalNumber(r,{unit:"hour"}):U(r,t.length)},k:function(e,t,n){var r=e.getUTCHours();return r===0&&(r=24),t==="ko"?n.ordinalNumber(r,{unit:"hour"}):U(r,t.length)},m:function(e,t,n){return t==="mo"?n.ordinalNumber(e.getUTCMinutes(),{unit:"minute"}):pe.m(e,t)},s:function(e,t,n){return t==="so"?n.ordinalNumber(e.getUTCSeconds(),{unit:"second"}):pe.s(e,t)},S:function(e,t){return pe.S(e,t)},X:function(e,t,n,r){var o=r._originalDate||e,i=o.getTimezoneOffset();if(i===0)return"Z";switch(t){case"X":return wr(i);case"XXXX":case"XX":return _e(i);case"XXXXX":case"XXX":default:return _e(i,":")}},x:function(e,t,n,r){var o=r._originalDate||e,i=o.getTimezoneOffset();switch(t){case"x":return wr(i);case"xxxx":case"xx":return _e(i);case"xxxxx":case"xxx":default:return _e(i,":")}},O:function(e,t,n,r){var o=r._originalDate||e,i=o.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+br(i,":");case"OOOO":default:return"GMT"+_e(i,":")}},z:function(e,t,n,r){var o=r._originalDate||e,i=o.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+br(i,":");case"zzzz":default:return"GMT"+_e(i,":")}},t:function(e,t,n,r){var o=r._originalDate||e,i=Math.floor(o.getTime()/1e3);return U(i,t.length)},T:function(e,t,n,r){var o=r._originalDate||e,i=o.getTime();return U(i,t.length)}};function br(e,t){var n=e>0?"-":"+",r=Math.abs(e),o=Math.floor(r/60),i=r%60;if(i===0)return n+String(o);var s=t||"";return n+String(o)+s+U(i,2)}function wr(e,t){if(e%60===0){var n=e>0?"-":"+";return n+U(Math.abs(e)/60,2)}return _e(e,t)}function _e(e,t){var n=t||"",r=e>0?"-":"+",o=Math.abs(e),i=U(Math.floor(o/60),2),s=U(o%60,2);return r+i+n+s}var _r=function(e,t){switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},Ao=function(e,t){switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},wd=function(e,t){var n=e.match(/(P+)(p+)?/)||[],r=n[1],o=n[2];if(!o)return _r(e,t);var i;switch(r){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",_r(r,t)).replace("{{time}}",Ao(o,t))},_d={p:Ao,P:wd},Td=["D","DD"],Ed=["YY","YYYY"];function Sd(e){return Td.indexOf(e)!==-1}function kd(e){return Ed.indexOf(e)!==-1}function Tr(e,t,n){if(e==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(t,"`) for formatting years to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(t,"`) for formatting years to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(t,"`) for formatting days of the month to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(t,"`) for formatting days of the month to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var Id=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Cd=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Od=/^'([^]*?)'?$/,xd=/''/g,Ad=/[a-zA-Z]/;function Nd(e,t,n){var r,o,i,s,a,c,u,l,f,b,w,S,E,_,g,p,v,k;z(2,arguments);var C=String(t),x=st(),A=(r=(o=n?.locale)!==null&&o!==void 0?o:x.locale)!==null&&r!==void 0?r:Co,j=ke((i=(s=(a=(c=n?.firstWeekContainsDate)!==null&&c!==void 0?c:n==null||(u=n.locale)===null||u===void 0||(l=u.options)===null||l===void 0?void 0:l.firstWeekContainsDate)!==null&&a!==void 0?a:x.firstWeekContainsDate)!==null&&s!==void 0?s:(f=x.locale)===null||f===void 0||(b=f.options)===null||b===void 0?void 0:b.firstWeekContainsDate)!==null&&i!==void 0?i:1);if(!(j>=1&&j<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var M=ke((w=(S=(E=(_=n?.weekStartsOn)!==null&&_!==void 0?_:n==null||(g=n.locale)===null||g===void 0||(p=g.options)===null||p===void 0?void 0:p.weekStartsOn)!==null&&E!==void 0?E:x.weekStartsOn)!==null&&S!==void 0?S:(v=x.locale)===null||v===void 0||(k=v.options)===null||k===void 0?void 0:k.weekStartsOn)!==null&&w!==void 0?w:0);if(!(M>=0&&M<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!A.localize)throw new RangeError("locale must contain localize property");if(!A.formatLong)throw new RangeError("locale must contain formatLong property");var q=B(e);if(!ad(q))throw new RangeError("Invalid time value");var be=ot(q),fe=ud(q,be),D={firstWeekContainsDate:j,weekStartsOn:M,locale:A,_originalDate:q},R=C.match(Cd).map(function(W){var H=W[0];if(H==="p"||H==="P"){var he=_d[H];return he(W,A.formatLong)}return W}).join("").match(Id).map(function(W){if(W==="''")return"'";var H=W[0];if(H==="'")return Pd(W);var he=bd[H];if(he)return!(n!=null&&n.useAdditionalWeekYearTokens)&&kd(W)&&Tr(W,t,String(e)),!(n!=null&&n.useAdditionalDayOfYearTokens)&&Sd(W)&&Tr(W,t,String(e)),he(fe,W,A.localize,D);if(H.match(Ad))throw new RangeError("Format string contains an unescaped latin alphabet character `"+H+"`");return W}).join("");return R}function Pd(e){var t=e.match(Od);return t?t[1].replace(xd,"'"):e}const Dd="MMMM d, yyyy",Tf=e=>{const t=Date.now(),n=new Date(e),r=mu(t,n)<4;return bu(t,n)<60?"Just now":r?`${id(t,n)} ago`:Nd(n,Dd)};var Ef=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Sf(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function kf(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var o=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,o.get?o:{enumerable:!0,get:function(){return e[r]}})}),n}function $d(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function No(...e){return t=>e.forEach(n=>$d(n,t))}function Rd(...e){return y.useCallback(No(...e),e)}const Po=y.forwardRef((e,t)=>{const{children:n,...r}=e,o=y.Children.toArray(n),i=o.find(Md);if(i){const s=i.props.children,a=o.map(c=>c===i?y.Children.count(s)>1?y.Children.only(null):y.isValidElement(s)?s.props.children:null:c);return y.createElement(bn,At({},r,{ref:t}),y.isValidElement(s)?y.cloneElement(s,void 0,a):null)}return y.createElement(bn,At({},r,{ref:t}),n)});Po.displayName="Slot";const bn=y.forwardRef((e,t)=>{const{children:n,...r}=e;return y.isValidElement(n)?y.cloneElement(n,{...Ld(r,n.props),ref:t?No(t,n.ref):n.ref}):y.Children.count(n)>1?y.Children.only(null):null});bn.displayName="SlotClone";const Ud=({children:e})=>y.createElement(y.Fragment,null,e);function Md(e){return y.isValidElement(e)&&e.type===Ud}function Ld(e,t){const n={...t};for(const r in t){const o=e[r],i=t[r];/^on[A-Z]/.test(r)?o&&i?n[r]=(...s)=>{i(...s),o(...s)}:o&&(n[r]=o):r==="style"?n[r]={...o,...i}:r==="className"&&(n[r]=[o,i].filter(Boolean).join(" "))}return{...e,...n}}const jd=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Wd=jd.reduce((e,t)=>{const n=y.forwardRef((r,o)=>{const{asChild:i,...s}=r,a=i?Po:t;return y.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),y.createElement(a,At({},s,{ref:o}))});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function Er(e){const t=y.useRef(e);return y.useEffect(()=>{t.current=e}),y.useMemo(()=>(...n)=>{var r;return(r=t.current)===null||r===void 0?void 0:r.call(t,...n)},[])}const en="focusScope.autoFocusOnMount",tn="focusScope.autoFocusOnUnmount",Sr={bubbles:!1,cancelable:!0},If=y.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:o,onUnmountAutoFocus:i,...s}=e,[a,c]=y.useState(null),u=Er(o),l=Er(i),f=y.useRef(null),b=Rd(t,E=>c(E)),w=y.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;y.useEffect(()=>{if(r){let E=function(v){if(w.paused||!a)return;const k=v.target;a.contains(k)?f.current=k:me(f.current,{select:!0})},_=function(v){if(w.paused||!a)return;const k=v.relatedTarget;k!==null&&(a.contains(k)||me(f.current,{select:!0}))},g=function(v){if(document.activeElement===document.body)for(const k of v)k.removedNodes.length>0&&me(a)};document.addEventListener("focusin",E),document.addEventListener("focusout",_);const p=new MutationObserver(g);return a&&p.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",E),document.removeEventListener("focusout",_),p.disconnect()}}},[r,a,w.paused]),y.useEffect(()=>{if(a){Ir.add(w);const E=document.activeElement;if(!a.contains(E)){const _=new CustomEvent(en,Sr);a.addEventListener(en,u),a.dispatchEvent(_),_.defaultPrevented||(Fd(Vd(Do(a)),{select:!0}),document.activeElement===E&&me(a))}return()=>{a.removeEventListener(en,u),setTimeout(()=>{const _=new CustomEvent(tn,Sr);a.addEventListener(tn,l),a.dispatchEvent(_),_.defaultPrevented||me(E??document.body,{select:!0}),a.removeEventListener(tn,l),Ir.remove(w)},0)}}},[a,u,l,w]);const S=y.useCallback(E=>{if(!n&&!r||w.paused)return;const _=E.key==="Tab"&&!E.altKey&&!E.ctrlKey&&!E.metaKey,g=document.activeElement;if(_&&g){const p=E.currentTarget,[v,k]=Hd(p);v&&k?!E.shiftKey&&g===k?(E.preventDefault(),n&&me(v,{select:!0})):E.shiftKey&&g===v&&(E.preventDefault(),n&&me(k,{select:!0})):g===p&&E.preventDefault()}},[n,r,w.paused]);return y.createElement(Wd.div,At({tabIndex:-1},s,{ref:b,onKeyDown:S}))});function Fd(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(me(r,{select:t}),document.activeElement!==n)return}function Hd(e){const t=Do(e),n=kr(t,e),r=kr(t.reverse(),e);return[n,r]}function Do(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const o=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||o?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function kr(e,t){for(const n of e)if(!zd(n,{upTo:t}))return n}function zd(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function Bd(e){return e instanceof HTMLInputElement&&"select"in e}function me(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&Bd(e)&&t&&e.select()}}const Ir=Kd();function Kd(){let e=[];return{add(t){const n=e[0];t!==n&&n?.pause(),e=Cr(e,t),e.unshift(t)},remove(t){var n;e=Cr(e,t),(n=e[0])===null||n===void 0||n.resume()}}}function Cr(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function Vd(e){return e.filter(t=>t.tagName!=="A")}var qd=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Pe=new WeakMap,Tt=new WeakMap,Et={},nn=0,Cf=function(e,t,n){t===void 0&&(t=qd(e)),n===void 0&&(n="data-aria-hidden");var r=Array.isArray(e)?e:[e];Et[n]||(Et[n]=new WeakMap);var o=Et[n],i=[],s=new Set,a=function(u){!u||s.has(u)||(s.add(u),a(u.parentNode))};r.forEach(a);var c=function(u){!u||r.indexOf(u)>=0||Array.prototype.forEach.call(u.children,function(l){if(s.has(l))c(l);else{var f=l.getAttribute("aria-hidden"),b=f!==null&&f!=="false",w=(Pe.get(l)||0)+1,S=(o.get(l)||0)+1;Pe.set(l,w),o.set(l,S),i.push(l),w===1&&b&&Tt.set(l,!0),S===1&&l.setAttribute(n,"true"),b||l.setAttribute("aria-hidden","true")}})};return c(t),s.clear(),nn++,function(){i.forEach(function(u){var l=Pe.get(u)-1,f=o.get(u)-1;Pe.set(u,l),o.set(u,f),l||(Tt.has(u)||u.removeAttribute("aria-hidden"),Tt.delete(u)),f||u.removeAttribute(n)}),nn--,nn||(Pe=new WeakMap,Pe=new WeakMap,Tt=new WeakMap,Et={})}},ie=function(){return ie=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},ie.apply(this,arguments)};function $o(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]]);return n}function Yd(e,t,n){if(n||arguments.length===2)for(var r=0,o=t.length,i;r<o;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}var Ot="right-scroll-bar-position",xt="width-before-scroll-bar",Gd="with-scroll-bars-hidden",Qd="--removed-body-scroll-bar-size";function Jd(e){return e}function Xd(e,t){t===void 0&&(t=Jd);var n=[],r=!1,o={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(i){var s=t(i,r);return n.push(s),function(){n=n.filter(function(a){return a!==s})}},assignSyncMedium:function(i){for(r=!0;n.length;){var s=n;n=[],s.forEach(i)}n={push:function(a){return i(a)},filter:function(){return n}}},assignMedium:function(i){r=!0;var s=[];if(n.length){var a=n;n=[],a.forEach(i),s=n}var c=function(){var l=s;s=[],l.forEach(i)},u=function(){return Promise.resolve().then(c)};u(),n={push:function(l){s.push(l),u()},filter:function(l){return s=s.filter(l),n}}}};return o}function Zd(e){e===void 0&&(e={});var t=Xd(null);return t.options=ie({async:!0,ssr:!1},e),t}var Ro=Zd();function el(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function tl(e,t){var n=y.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var o=n.value;o!==r&&(n.value=r,n.callback(r,o))}}}})[0];return n.callback=t,n.facade}function nl(e,t){return tl(t||null,function(n){return e.forEach(function(r){return el(r,n)})})}var rn=function(){},Bt=y.forwardRef(function(e,t){var n=y.useRef(null),r=y.useState({onScrollCapture:rn,onWheelCapture:rn,onTouchMoveCapture:rn}),o=r[0],i=r[1],s=e.forwardProps,a=e.children,c=e.className,u=e.removeScrollBar,l=e.enabled,f=e.shards,b=e.sideCar,w=e.noIsolation,S=e.inert,E=e.allowPinchZoom,_=e.as,g=_===void 0?"div":_,p=$o(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),v=b,k=nl([n,t]),C=ie(ie({},p),o);return y.createElement(y.Fragment,null,l&&y.createElement(v,{sideCar:Ro,removeScrollBar:u,shards:f,noIsolation:w,inert:S,setCallbacks:i,allowPinchZoom:!!E,lockRef:n}),s?y.cloneElement(y.Children.only(a),ie(ie({},C),{ref:k})):y.createElement(g,ie({},C,{className:c,ref:k}),a))});Bt.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Bt.classNames={fullWidth:xt,zeroRight:Ot};var rl=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function ol(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=rl();return t&&e.setAttribute("nonce",t),e}function il(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function sl(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var al=function(){var e=0,t=null;return{add:function(n){e==0&&(t=ol())&&(il(t,n),sl(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},cl=function(){var e=al();return function(t,n){y.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},Uo=function(){var e=cl(),t=function(n){var r=n.styles,o=n.dynamic;return e(r,o),null};return t},ul={left:0,top:0,right:0,gap:0},on=function(e){return parseInt(e||"",10)||0},dl=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],o=t[e==="padding"?"paddingRight":"marginRight"];return[on(n),on(r),on(o)]},ll=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return ul;var t=dl(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},fl=Uo(),hl=function(e,t,n,r){var o=e.left,i=e.top,s=e.right,a=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(Gd,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(a,"px ").concat(r,`;
  }
  body {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(o,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(s,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Ot,` {
    right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(xt,` {
    margin-right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(Ot," .").concat(Ot,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(xt," .").concat(xt,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body {
    `).concat(Qd,": ").concat(a,`px;
  }
`)},pl=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,o=r===void 0?"margin":r,i=y.useMemo(function(){return ll(o)},[o]);return y.createElement(fl,{styles:hl(i,!t,o,n?"":"!important")})},wn=!1;if(typeof window<"u")try{var St=Object.defineProperty({},"passive",{get:function(){return wn=!0,!0}});window.addEventListener("test",St,St),window.removeEventListener("test",St,St)}catch{wn=!1}var De=wn?{passive:!1}:!1,ml=function(e){return e.tagName==="TEXTAREA"},Mo=function(e,t){var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!ml(e)&&n[t]==="visible")},vl=function(e){return Mo(e,"overflowY")},gl=function(e){return Mo(e,"overflowX")},Or=function(e,t){var n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var r=Lo(e,n);if(r){var o=jo(e,n),i=o[1],s=o[2];if(i>s)return!0}n=n.parentNode}while(n&&n!==document.body);return!1},yl=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},bl=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},Lo=function(e,t){return e==="v"?vl(t):gl(t)},jo=function(e,t){return e==="v"?yl(t):bl(t)},wl=function(e,t){return e==="h"&&t==="rtl"?-1:1},_l=function(e,t,n,r,o){var i=wl(e,window.getComputedStyle(t).direction),s=i*r,a=n.target,c=t.contains(a),u=!1,l=s>0,f=0,b=0;do{var w=jo(e,a),S=w[0],E=w[1],_=w[2],g=E-_-i*S;(S||g)&&Lo(e,a)&&(f+=g,b+=S),a=a.parentNode}while(!c&&a!==document.body||c&&(t.contains(a)||t===a));return(l&&(o&&f===0||!o&&s>f)||!l&&(o&&b===0||!o&&-s>b))&&(u=!0),u},kt=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},xr=function(e){return[e.deltaX,e.deltaY]},Ar=function(e){return e&&"current"in e?e.current:e},Tl=function(e,t){return e[0]===t[0]&&e[1]===t[1]},El=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},Sl=0,$e=[];function kl(e){var t=y.useRef([]),n=y.useRef([0,0]),r=y.useRef(),o=y.useState(Sl++)[0],i=y.useState(function(){return Uo()})[0],s=y.useRef(e);y.useEffect(function(){s.current=e},[e]),y.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(o));var E=Yd([e.lockRef.current],(e.shards||[]).map(Ar),!0).filter(Boolean);return E.forEach(function(_){return _.classList.add("allow-interactivity-".concat(o))}),function(){document.body.classList.remove("block-interactivity-".concat(o)),E.forEach(function(_){return _.classList.remove("allow-interactivity-".concat(o))})}}},[e.inert,e.lockRef.current,e.shards]);var a=y.useCallback(function(E,_){if("touches"in E&&E.touches.length===2)return!s.current.allowPinchZoom;var g=kt(E),p=n.current,v="deltaX"in E?E.deltaX:p[0]-g[0],k="deltaY"in E?E.deltaY:p[1]-g[1],C,x=E.target,A=Math.abs(v)>Math.abs(k)?"h":"v";if("touches"in E&&A==="h"&&x.type==="range")return!1;var j=Or(A,x);if(!j)return!0;if(j?C=A:(C=A==="v"?"h":"v",j=Or(A,x)),!j)return!1;if(!r.current&&"changedTouches"in E&&(v||k)&&(r.current=C),!C)return!0;var M=r.current||C;return _l(M,_,E,M==="h"?v:k,!0)},[]),c=y.useCallback(function(E){var _=E;if(!(!$e.length||$e[$e.length-1]!==i)){var g="deltaY"in _?xr(_):kt(_),p=t.current.filter(function(C){return C.name===_.type&&C.target===_.target&&Tl(C.delta,g)})[0];if(p&&p.should){_.cancelable&&_.preventDefault();return}if(!p){var v=(s.current.shards||[]).map(Ar).filter(Boolean).filter(function(C){return C.contains(_.target)}),k=v.length>0?a(_,v[0]):!s.current.noIsolation;k&&_.cancelable&&_.preventDefault()}}},[]),u=y.useCallback(function(E,_,g,p){var v={name:E,delta:_,target:g,should:p};t.current.push(v),setTimeout(function(){t.current=t.current.filter(function(k){return k!==v})},1)},[]),l=y.useCallback(function(E){n.current=kt(E),r.current=void 0},[]),f=y.useCallback(function(E){u(E.type,xr(E),E.target,a(E,e.lockRef.current))},[]),b=y.useCallback(function(E){u(E.type,kt(E),E.target,a(E,e.lockRef.current))},[]);y.useEffect(function(){return $e.push(i),e.setCallbacks({onScrollCapture:f,onWheelCapture:f,onTouchMoveCapture:b}),document.addEventListener("wheel",c,De),document.addEventListener("touchmove",c,De),document.addEventListener("touchstart",l,De),function(){$e=$e.filter(function(E){return E!==i}),document.removeEventListener("wheel",c,De),document.removeEventListener("touchmove",c,De),document.removeEventListener("touchstart",l,De)}},[]);var w=e.removeScrollBar,S=e.inert;return y.createElement(y.Fragment,null,S?y.createElement(i,{styles:El(o)}):null,w?y.createElement(pl,{gapMode:"margin"}):null)}var Wo=function(e){var t=e.sideCar,n=$o(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return y.createElement(r,ie({},n))};Wo.isSideCarExport=!0;function Il(e,t){return e.useMedium(t),Wo}const Cl=Il(Ro,kl);var Fo=y.forwardRef(function(e,t){return y.createElement(Bt,ie({},e,{ref:t,sideCar:Cl}))});Fo.classNames=Bt.classNames;const Of=Fo,Ol=He(Le,{borderRadius:$.radii.sm,$$borderColor:$.colors.gray300,$$outlineColor:"transparent",$$backgroundColor:$.colors.white,border:"1px solid $$borderColor",width:"100%",alignItems:"center",transition:"border-color 0.3s, outline-color 0.3s",outline:"3px solid $$outlineColor",height:36,bg:"$$backgroundColor",overflow:"hidden",variants:{isInvalid:{true:{$$borderColor:$.colors.red500,"&:focus-within":{$$outlineColor:$.colors.red300}}},isFocused:{true:{$$borderColor:$.colors.primary500,$$outlineColor:$.colors.primary300}},isDisabled:{true:{$$borderColor:$.colors.gray200,$$backgroundColor:$.colors.gray100,cursor:"not-allowed","& input::placeholder":{color:$.colors.gray300}}}},compoundVariants:[{isInvalid:!0,isFocused:!0,css:{$$borderColor:$.colors.red500}}]}),xl=He("input",{fontSize:$.fontSizes[2],fontFamily:"$sans",width:"100%",height:"100%",px:12,py:8,bg:"none",border:0,color:$.colors.gray700,"&:focus":{outline:"none"},"&::placeholder":{color:$.colors.gray300},"&:disabled":{cursor:"not-allowed",color:$.colors.gray400}}),Nr=He(Le,{px:$.space[2],variants:{position:{start:{pr:0},end:{pl:0}}}}),Al=He(Le,{alignItems:"center",width:"fit-content",gap:$.space[1],variants:{direction:{vertical:{flexDirection:"column"},horizontal:{flexDirection:"row"}},size:{sm:{borderRadius:$.radii.sm},md:{borderRadius:$.radii.md}},showBackground:{true:{boxShadow:"0px 4px 6px -1px rgba(37, 31, 45, 0.10), 0px 2px 4px -2px rgba(37, 31, 45, 0.10)"}},inverted:{true:{}}},compoundVariants:[{size:"sm",showBackground:!0,css:{p:$.space[1]}},{size:"md",showBackground:!0,css:{p:6}},{inverted:!0,showBackground:!0,css:{bg:$.colors["gray600-a"],border:"1px solid #D4B5FF2B"}},{inverted:!1,showBackground:!0,css:{bg:$.colors.gray50,border:`1px solid ${$.colors.gray200}`}}]}),Ho=e=>{const{children:t,direction:n="horizontal",size:r="md",wrapper:o=!0,inverted:i=!1,...s}=e;return P.jsx(Mi.Provider,{value:{size:r,inverted:i},children:P.jsx(Al,{direction:n,inverted:i,showBackground:o,size:r,...s,children:t})})};Ho.displayName="IconButtonMenu";const xf=Ho,Nl=ge.forwardRef((e,t)=>{const{id:n,EndElement:r,StartElement:o,isInvalid:i,required:s,disabled:a,...c}=e,[u,l]=y.useState(!1),f=su(),b={isInvalid:!!(i||f!=null&&f.isInvalid),isRequired:!!(s||f!=null&&f.isRequired),isDisabled:!!(a||f!=null&&f.isDisabled)},w=n||f?.inputId,S=g=>{var p;(p=e.onBlur)==null||p.call(e,g),l(!1)},E=g=>{var p;(p=e.onFocus)==null||p.call(e,g),l(!0)},_=()=>{if(f!=null&&f.hasErrorMessage||f!=null&&f.hasHelperText)return f?.descriptionId};return P.jsx(P.Fragment,{children:P.jsxs(Ol,{isDisabled:!!b.isDisabled,isFocused:u,isInvalid:!!b.isInvalid,children:[o&&P.jsx(Nr,{alignItems:"center",position:"start",children:o}),P.jsx(xl,{...c,"aria-describedby":_(),disabled:b.isDisabled,id:w,onBlur:S,onFocus:E,ref:t,required:b.isRequired}),r&&P.jsx(Nr,{alignItems:"center",position:"end",children:r})]})})}),Af=He(Nl),Pl=Pi({"50%":{opacity:.5}}),Dl=He("div",{animation:`${Pl} 2s cubic-bezier(.4,0,.6,1) infinite`,borderRadius:"$sm",background:"$gray100"}),Nf=Dl,zo=e=>P.jsx(Ie,{icon:P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",fill:"none",viewBox:"0 0 40 40",children:P.jsx("path",{fill:"currentColor",d:"m14.667 26.508-5.834-5.833a1.64 1.64 0 0 0-2.333 0 1.64 1.64 0 0 0 0 2.333l6.983 6.984c.65.65 1.7.65 2.35 0L33.5 12.342a1.64 1.64 0 0 0 0-2.334 1.64 1.64 0 0 0-2.333 0l-16.5 16.5Z"})}),...e});zo.displayName="IconCheck";const Pf=()=>{try{return Bo().href}catch{return window.location.href}},$l=()=>{try{return Bo().hostname}catch{return window.location.hostname}},Bo=()=>Fi()?window.top.location:window.location,Rl=async()=>await je({name:ue.KLAuth,domain:Hi($l())}),Df={authEndpoint:Rl,resolveUsers:async e=>{try{const t=await je({name:ue.GetProfiles,userIds:e.userIds}),n=new Map(t.map(i=>[i.id,i]));return e.userIds.map(i=>n.get(i)).map(i=>({id:i.id,name:`${i.firstName} ${i.lastName}`,avatar:i.profilePictureURL}))}catch(t){Wi(`Error fetching profiles: ${t.message}`)}},resolveMentionSuggestions:async e=>(await je({name:ue.GetWorkspaceUsers,query:e.text})).users.map(r=>r.userId)},Ul=e=>P.jsx(Ie,{icon:P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",fill:"none",viewBox:"0 0 40 40",children:P.jsx("path",{fill:"currentColor",d:"M28.333 11.667h-5c-.916 0-1.666.75-1.666 1.666 0 .917.75 1.667 1.666 1.667h5c2.75 0 5 2.25 5 5s-2.25 5-5 5h-5c-.916 0-1.666.75-1.666 1.667 0 .916.75 1.666 1.666 1.666h5c4.6 0 8.334-3.733 8.334-8.333s-3.734-8.333-8.334-8.333Zm-15 8.333c0 .917.75 1.667 1.667 1.667h10c.917 0 1.667-.75 1.667-1.667s-.75-1.667-1.667-1.667H15c-.917 0-1.667.75-1.667 1.667Zm3.334 5h-5c-2.75 0-5-2.25-5-5s2.25-5 5-5h5c.916 0 1.666-.75 1.666-1.667 0-.916-.75-1.666-1.666-1.666h-5A8.336 8.336 0 0 0 3.333 20c0 4.6 3.734 8.333 8.334 8.333h5c.916 0 1.666-.75 1.666-1.666 0-.917-.75-1.667-1.666-1.667Z"})}),...e});Ul.displayName="IconLink";const Ml=e=>P.jsx(Ie,{icon:P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",fill:"none",viewBox:"0 0 40 40",children:P.jsx("path",{fill:"currentColor",d:"M23.92 25.923v3.738a2.357 2.357 0 0 1-4.024 1.666l-4.226-4.226-6.031 6.032a3.549 3.549 0 0 1-2.51 1.04.887.887 0 0 1-.887-.888c0-.94.374-1.843 1.04-2.509l6.031-6.032-4.226-4.226a2.357 2.357 0 0 1 1.667-4.023h3.738l8.25-8.25a1.667 1.667 0 0 1 2.356-2.357l9.428 9.428a1.667 1.667 0 0 1-2.357 2.357l-8.25 8.25Zm-10.784-6.07 7.425 7.425v-2.71l9.251-9.252-4.714-4.714-9.25 9.252h-2.712Z"})}),...e});Ml.displayName="IconPinOnOutline";const Ll=e=>P.jsx(Ie,{icon:P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",fill:"none",viewBox:"0 0 40 40",children:P.jsx("path",{fill:"currentColor",d:"M20.69 10.707v3.162c0 .804-.963 1.197-1.515.625l-4.97-4.983a.886.886 0 0 1 0-1.269l4.97-4.983c.552-.554 1.514-.16 1.514.625v3.469c3.72.092 6.89 1.463 9.506 4.113 2.712 2.746 4.068 6.053 4.068 9.92 0 3.66-1.238 6.82-3.714 9.48-2.05 2.201-4.49 3.593-7.321 4.175-.971.2-1.822-.59-1.822-1.582 0-.861.65-1.571 1.488-1.775a10.277 10.277 0 0 0 5.331-3.192c1.78-1.983 2.671-4.351 2.671-7.105 0-2.91-.998-5.396-2.995-7.455-1.958-2.02-4.362-3.095-7.212-3.225ZM7.498 15.188a13.132 13.132 0 0 1 2.774-3.669c.613-.567 1.56-.466 2.12.153.655.726.51 1.858-.172 2.558a9.85 9.85 0 0 0-1.617 2.212 10.253 10.253 0 0 0-1.26 4.945c0 2.754.908 5.129 2.725 7.126 1.473 1.62 3.243 2.679 5.311 3.177.84.203 1.496.912 1.496 1.776 0 .988-.848 1.775-1.815 1.577-2.836-.582-5.281-1.974-7.337-4.177C7.241 28.206 6 25.046 6 21.386c0-2.188.5-4.254 1.498-6.198Z"})}),...e});Ll.displayName="IconRestart";const jl=e=>P.jsx(Ie,{icon:P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",fill:"none",viewBox:"0 0 40 40",children:P.jsx("path",{fill:"currentColor",d:"M26.628 24.12H25.31l-.467-.45c2-2.334 3.034-5.517 2.467-8.9-.783-4.634-4.65-8.334-9.317-8.9-7.05-.867-12.983 5.066-12.116 12.116.566 4.667 4.266 8.533 8.9 9.317a10.834 10.834 0 0 0 8.9-2.467l.45.467v1.316l7.083 7.084a1.76 1.76 0 0 0 2.483 0 1.76 1.76 0 0 0 0-2.484l-7.066-7.1Zm-10 0a7.49 7.49 0 0 1-7.5-7.5c0-4.15 3.35-7.5 7.5-7.5s7.5 3.35 7.5 7.5-3.35 7.5-7.5 7.5Z"})}),...e});jl.displayName="IconSearch";function $f(e=!1){const[t,n]=y.useState(void 0);return y.useEffect(()=>{je({name:ue.EdgeConfig,force:e}).then(r=>{r&&n(r)})},[e]),t}const Pr={[mt.Admin]:500,[mt.Creator]:100,[mt.Sidekick]:50,[mt.Guest]:20};function Wl(e,t){return e?Pr[e]>=Pr[t]:!1}function Rf(e){const{user:t,loading:n,currentWorkspace:r}=Bi();if(n||!r)return null;const{role:o}=zi(r.id,t);return!n&&!t?!1:Wl(o,e)}const Uf=()=>{const[e,t]=y.useState(Ki),n=y.useCallback(r=>{r.message.name===ue.ToggleUserPreference&&t(r.message.preferences)},[]);return It(n),y.useEffect(()=>{(async()=>{const o=await je({name:ue.GetUserPreferences});t(o?.preferences)})()},[]),{preferences:e}},Mf=e=>{const[t,n]=y.useState(null),[r,o]=y.useState(null),[i,s]=y.useState(""),[a,c]=y.useState(!1),u=y.useCallback(async()=>{try{const b=await je({name:ue.GetSuggestedWorkflows,bustCache:e?.bustCache});n(b?.workflows??null),s(b?.searchUrl??""),o(b?.workspaces??null)}finally{c(!0)}},[e?.bustCache]),l=y.useCallback(Vi(u,600),[]),f=y.useCallback(b=>{b.message.name===ue.WorkflowsFound&&(n(b.message.workflows),s(b.message.searchUrl)),b.message.name===ue.WorkspacesFound&&o(b.message.workspaces)},[]);return It(f),It(()=>{c(!1),e?.listenForTabChanges&&l()},chrome.tabs?.onActivated),It(()=>{c(!1),e?.listenForTabChanges&&l()},chrome.tabs?.onUpdated),y.useEffect(()=>{u()},[u]),{workflows:t,searchUrl:i,workspaces:r,hasLoaded:a}},Lf=e=>{const{text:t}=e;return pt.jsx(Li,{children:t?pt.jsxs(Le,{alignItems:"center",as:ji.div,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},css:{position:"absolute",top:0,right:12,px:$.space[2],height:24,borderRadius:$.radii.xs,bg:$.colors.green100},gap:"1",children:[pt.jsx(zo,{color:$.colors.green500.value,size:16}),pt.jsx(Dr,{css:{color:$.colors.green600},size:"1",children:t})]}):null})};function jf(e){const[t,n]=y.useState(!1),r=y.useCallback(async o=>{await navigator.clipboard.writeText(o),n(!0)},[]);return y.useEffect(()=>{let o;return t&&e&&(o=setTimeout(()=>n(!1),e)),()=>{clearTimeout(o)}},[t,e]),[t,r]}export{cf as $,gf as A,lf as B,Lf as C,iu as D,Sf as E,ie as F,wf as G,Af as H,bf as I,Ol as J,xl as K,nf as L,_n as M,uc as N,lc as O,dc as P,Y as Q,hf as R,le as S,Nt as T,O as U,rf as V,mf as W,If as X,sf as Y,af as Z,ff as _,zo as a,vf as a0,pf as a1,uf as a2,df as a3,Uf as b,Rf as c,Cf as d,su as e,jf as f,Ul as g,Mf as h,Of as i,$f as j,ko as k,kf as l,Ml as m,jl as n,hu as o,Tf as p,Ll as q,_f as r,Nf as s,Df as t,Ef as u,of as v,$l as w,xf as x,Pf as y,yf as z};
//# sourceMappingURL=CpygsGpn.js.map
