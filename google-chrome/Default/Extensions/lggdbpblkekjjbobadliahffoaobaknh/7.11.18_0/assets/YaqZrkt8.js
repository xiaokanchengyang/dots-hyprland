import{d as Xe}from"./QipNwzXz.js";import{T as N,o as x,p as Ze,s as et,r as Te,C as De,b as tt}from"./BjgJiouD.js";import{a8 as rt,a9 as Pe,aa as nt,ab as st,ac as ot,ad as at,ae as it,af as ct,a6 as ut,b as G,ag as lt,E as Ge,O as dt,a as ft,M,ah as _e,ai as ht,_ as pt,R as C,G as gt,W as yt}from"./SHnOzo4l.js";import{c as mt,g as wt}from"./Cpj98o6Y.js";import{d as ne}from"./DxyQva6U.js";import{A as $}from"./ChlyaM6j.js";import{d as bt}from"./CRUnMUWV.js";import{s as p,c as Ce,b as K,g as le,e as I}from"./DaneALmD.js";import{h as Me,r as vt}from"./CTuBfHaM.js";import{i as Et}from"./uDekdLYy.js";import{g as kt}from"./CqgvlWIA.js";import{v as Tt}from"./D8aEg3BZ.js";function Ct(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const c in n)if(c!=="default"&&!(c in e)){const u=Object.getOwnPropertyDescriptor(n,c);u&&Object.defineProperty(e,c,u.get?u:{enumerable:!0,get:()=>n[c]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}function St(e){return`"${e.replace(At,It)}"`}const At=/[\x00-\x1f\x22\x5c\x7f-\x9f]/g;function It(e){return Ut[e.charCodeAt(0)]}const Ut=["\\u0000","\\u0001","\\u0002","\\u0003","\\u0004","\\u0005","\\u0006","\\u0007","\\b","\\t","\\n","\\u000B","\\f","\\r","\\u000E","\\u000F","\\u0010","\\u0011","\\u0012","\\u0013","\\u0014","\\u0015","\\u0016","\\u0017","\\u0018","\\u0019","\\u001A","\\u001B","\\u001C","\\u001D","\\u001E","\\u001F","","",'\\"',"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\\\","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\u007F","\\u0080","\\u0081","\\u0082","\\u0083","\\u0084","\\u0085","\\u0086","\\u0087","\\u0088","\\u0089","\\u008A","\\u008B","\\u008C","\\u008D","\\u008E","\\u008F","\\u0090","\\u0091","\\u0092","\\u0093","\\u0094","\\u0095","\\u0096","\\u0097","\\u0098","\\u0099","\\u009A","\\u009B","\\u009C","\\u009D","\\u009E","\\u009F"],Ot=Object.freeze({});function Rt(e,t,r=ot){const n=new Map;for(const U of Object.values(rt))n.set(U,Dt(t,U));let c,u=Array.isArray(e),i=[e],s=-1,a=[],d=e,g,E;const w=[],y=[];do{s++;const U=s===i.length,Q=U&&a.length!==0;if(U){if(g=y.length===0?void 0:w[w.length-1],d=E,E=y.pop(),Q)if(u){d=d.slice();let R=0;for(const[B,X]of a){const Z=B-R;X===null?(d.splice(Z,1),R++):d[Z]=X}}else{d=Object.defineProperties({},Object.getOwnPropertyDescriptors(d));for(const[R,B]of a)d[R]=B}s=c.index,i=c.keys,a=c.edits,u=c.inArray,c=c.prev}else if(E){if(g=u?s:i[s],d=E[g],d==null)continue;w.push(g)}let P;if(!Array.isArray(d)){var h,m;Pe(d)||nt(!1,`Invalid AST Node: ${st(d)}.`);const R=U?(h=n.get(d.kind))===null||h===void 0?void 0:h.leave:(m=n.get(d.kind))===null||m===void 0?void 0:m.enter;if(P=R?.call(t,d,g,E,w,y),P===Ot)break;if(P===!1){if(!U){w.pop();continue}}else if(P!==void 0&&(a.push([g,P]),!U))if(Pe(P))d=P;else{w.pop();continue}}if(P===void 0&&Q&&a.push([g,d]),U)w.pop();else{var k;c={inArray:u,index:s,keys:i,edits:a,prev:c},u=Array.isArray(d),i=u?d:(k=r[d.kind])!==null&&k!==void 0?k:[],s=-1,a=[],E&&y.push(E),E=d}}while(c!==void 0);return a.length!==0?a[a.length-1][1]:e}function Dt(e,t){const r=e[t];return typeof r=="object"?r:typeof r=="function"?{enter:r,leave:void 0}:{enter:e.enter,leave:e.leave}}function Pt(e){return Rt(e,xt)}const _t=80,xt={Name:{leave:e=>e.value},Variable:{leave:e=>"$"+e.name},Document:{leave:e=>f(e.definitions,`

`)},OperationDefinition:{leave(e){const t=v("(",f(e.variableDefinitions,", "),")"),r=f([e.operation,f([e.name,t]),f(e.directives," ")]," ");return(r==="query"?"":r+" ")+e.selectionSet}},VariableDefinition:{leave:({variable:e,type:t,defaultValue:r,directives:n})=>e+": "+t+v(" = ",r)+v(" ",f(n," "))},SelectionSet:{leave:({selections:e})=>D(e)},Field:{leave({alias:e,name:t,arguments:r,directives:n,selectionSet:c}){const u=v("",e,": ")+t;let i=u+v("(",f(r,", "),")");return i.length>_t&&(i=u+v(`(
`,se(f(r,`
`)),`
)`)),f([i,f(n," "),c]," ")}},Argument:{leave:({name:e,value:t})=>e+": "+t},FragmentSpread:{leave:({name:e,directives:t})=>"..."+e+v(" ",f(t," "))},InlineFragment:{leave:({typeCondition:e,directives:t,selectionSet:r})=>f(["...",v("on ",e),f(t," "),r]," ")},FragmentDefinition:{leave:({name:e,typeCondition:t,variableDefinitions:r,directives:n,selectionSet:c})=>`fragment ${e}${v("(",f(r,", "),")")} on ${t} ${v("",f(n," ")," ")}`+c},IntValue:{leave:({value:e})=>e},FloatValue:{leave:({value:e})=>e},StringValue:{leave:({value:e,block:t})=>t?at(e):St(e)},BooleanValue:{leave:({value:e})=>e?"true":"false"},NullValue:{leave:()=>"null"},EnumValue:{leave:({value:e})=>e},ListValue:{leave:({values:e})=>"["+f(e,", ")+"]"},ObjectValue:{leave:({fields:e})=>"{"+f(e,", ")+"}"},ObjectField:{leave:({name:e,value:t})=>e+": "+t},Directive:{leave:({name:e,arguments:t})=>"@"+e+v("(",f(t,", "),")")},NamedType:{leave:({name:e})=>e},ListType:{leave:({type:e})=>"["+e+"]"},NonNullType:{leave:({type:e})=>e+"!"},SchemaDefinition:{leave:({description:e,directives:t,operationTypes:r})=>v("",e,`
`)+f(["schema",f(t," "),D(r)]," ")},OperationTypeDefinition:{leave:({operation:e,type:t})=>e+": "+t},ScalarTypeDefinition:{leave:({description:e,name:t,directives:r})=>v("",e,`
`)+f(["scalar",t,f(r," ")]," ")},ObjectTypeDefinition:{leave:({description:e,name:t,interfaces:r,directives:n,fields:c})=>v("",e,`
`)+f(["type",t,v("implements ",f(r," & ")),f(n," "),D(c)]," ")},FieldDefinition:{leave:({description:e,name:t,arguments:r,type:n,directives:c})=>v("",e,`
`)+t+(xe(r)?v(`(
`,se(f(r,`
`)),`
)`):v("(",f(r,", "),")"))+": "+n+v(" ",f(c," "))},InputValueDefinition:{leave:({description:e,name:t,type:r,defaultValue:n,directives:c})=>v("",e,`
`)+f([t+": "+r,v("= ",n),f(c," ")]," ")},InterfaceTypeDefinition:{leave:({description:e,name:t,interfaces:r,directives:n,fields:c})=>v("",e,`
`)+f(["interface",t,v("implements ",f(r," & ")),f(n," "),D(c)]," ")},UnionTypeDefinition:{leave:({description:e,name:t,directives:r,types:n})=>v("",e,`
`)+f(["union",t,f(r," "),v("= ",f(n," | "))]," ")},EnumTypeDefinition:{leave:({description:e,name:t,directives:r,values:n})=>v("",e,`
`)+f(["enum",t,f(r," "),D(n)]," ")},EnumValueDefinition:{leave:({description:e,name:t,directives:r})=>v("",e,`
`)+f([t,f(r," ")]," ")},InputObjectTypeDefinition:{leave:({description:e,name:t,directives:r,fields:n})=>v("",e,`
`)+f(["input",t,f(r," "),D(n)]," ")},DirectiveDefinition:{leave:({description:e,name:t,arguments:r,repeatable:n,locations:c})=>v("",e,`
`)+"directive @"+t+(xe(r)?v(`(
`,se(f(r,`
`)),`
)`):v("(",f(r,", "),")"))+(n?" repeatable":"")+" on "+f(c," | ")},SchemaExtension:{leave:({directives:e,operationTypes:t})=>f(["extend schema",f(e," "),D(t)]," ")},ScalarTypeExtension:{leave:({name:e,directives:t})=>f(["extend scalar",e,f(t," ")]," ")},ObjectTypeExtension:{leave:({name:e,interfaces:t,directives:r,fields:n})=>f(["extend type",e,v("implements ",f(t," & ")),f(r," "),D(n)]," ")},InterfaceTypeExtension:{leave:({name:e,interfaces:t,directives:r,fields:n})=>f(["extend interface",e,v("implements ",f(t," & ")),f(r," "),D(n)]," ")},UnionTypeExtension:{leave:({name:e,directives:t,types:r})=>f(["extend union",e,f(t," "),v("= ",f(r," | "))]," ")},EnumTypeExtension:{leave:({name:e,directives:t,values:r})=>f(["extend enum",e,f(t," "),D(r)]," ")},InputObjectTypeExtension:{leave:({name:e,directives:t,fields:r})=>f(["extend input",e,f(t," "),D(r)]," ")}};function f(e,t=""){var r;return(r=e?.filter(n=>n).join(t))!==null&&r!==void 0?r:""}function D(e){return v(`{
`,se(f(e,`
`)),`
}`)}function v(e,t,r=""){return t!=null&&t!==""?e+t+r:""}function se(e){return v("  ",e.replace(/\n/g,`
  `))}function xe(e){var t;return(t=e?.some(r=>r.includes(`
`)))!==null&&t!==void 0?t:!1}const Se=JSON,qt=e=>e.toUpperCase(),Nt=e=>{const t={};return e.forEach((r,n)=>{t[n]=r}),t},Wt=(e,t,r)=>e.document?e:{document:e,variables:t,requestHeaders:r,signal:void 0},Bt=(e,t,r)=>e.query?e:{query:e,variables:t,requestHeaders:r,signal:void 0},Ft=(e,t)=>e.documents?e:{documents:e,requestHeaders:t,signal:void 0},qe=e=>{let t;const r=e.definitions.filter(n=>n.kind==="OperationDefinition");return r.length===1&&(t=r[0]?.name?.value),t},he=e=>{if(typeof e=="string"){let r;try{const n=it(e);r=qe(n)}catch{}return{query:e,operationName:r}}const t=qe(e);return{query:Pt(e),operationName:t}};class H extends Error{constructor(t,r){const n=`${H.extractMessage(t)}: ${JSON.stringify({response:t,request:r})}`;super(n),Object.setPrototypeOf(this,H.prototype),this.response=t,this.request=r,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,H)}static extractMessage(t){return t.errors?.[0]?.message??`GraphQL Error (Code: ${t.status})`}}var ve={exports:{}};(function(e,t){var r=typeof self<"u"?self:mt,n=function(){function u(){this.fetch=!1,this.DOMException=r.DOMException}return u.prototype=r,new u}();(function(u){(function(i){var s={searchParams:"URLSearchParams"in u,iterable:"Symbol"in u&&"iterator"in Symbol,blob:"FileReader"in u&&"Blob"in u&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in u,arrayBuffer:"ArrayBuffer"in u};function a(o){return o&&DataView.prototype.isPrototypeOf(o)}if(s.arrayBuffer)var d=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],g=ArrayBuffer.isView||function(o){return o&&d.indexOf(Object.prototype.toString.call(o))>-1};function E(o){if(typeof o!="string"&&(o=String(o)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(o))throw new TypeError("Invalid character in header field name");return o.toLowerCase()}function w(o){return typeof o!="string"&&(o=String(o)),o}function y(o){var l={next:function(){var b=o.shift();return{done:b===void 0,value:b}}};return s.iterable&&(l[Symbol.iterator]=function(){return l}),l}function h(o){this.map={},o instanceof h?o.forEach(function(l,b){this.append(b,l)},this):Array.isArray(o)?o.forEach(function(l){this.append(l[0],l[1])},this):o&&Object.getOwnPropertyNames(o).forEach(function(l){this.append(l,o[l])},this)}h.prototype.append=function(o,l){o=E(o),l=w(l);var b=this.map[o];this.map[o]=b?b+", "+l:l},h.prototype.delete=function(o){delete this.map[E(o)]},h.prototype.get=function(o){return o=E(o),this.has(o)?this.map[o]:null},h.prototype.has=function(o){return this.map.hasOwnProperty(E(o))},h.prototype.set=function(o,l){this.map[E(o)]=w(l)},h.prototype.forEach=function(o,l){for(var b in this.map)this.map.hasOwnProperty(b)&&o.call(l,this.map[b],b,this)},h.prototype.keys=function(){var o=[];return this.forEach(function(l,b){o.push(b)}),y(o)},h.prototype.values=function(){var o=[];return this.forEach(function(l){o.push(l)}),y(o)},h.prototype.entries=function(){var o=[];return this.forEach(function(l,b){o.push([b,l])}),y(o)},s.iterable&&(h.prototype[Symbol.iterator]=h.prototype.entries);function m(o){if(o.bodyUsed)return Promise.reject(new TypeError("Already read"));o.bodyUsed=!0}function k(o){return new Promise(function(l,b){o.onload=function(){l(o.result)},o.onerror=function(){b(o.error)}})}function U(o){var l=new FileReader,b=k(l);return l.readAsArrayBuffer(o),b}function Q(o){var l=new FileReader,b=k(l);return l.readAsText(o),b}function P(o){for(var l=new Uint8Array(o),b=new Array(l.length),A=0;A<l.length;A++)b[A]=String.fromCharCode(l[A]);return b.join("")}function R(o){if(o.slice)return o.slice(0);var l=new Uint8Array(o.byteLength);return l.set(new Uint8Array(o)),l.buffer}function B(){return this.bodyUsed=!1,this._initBody=function(o){this._bodyInit=o,o?typeof o=="string"?this._bodyText=o:s.blob&&Blob.prototype.isPrototypeOf(o)?this._bodyBlob=o:s.formData&&FormData.prototype.isPrototypeOf(o)?this._bodyFormData=o:s.searchParams&&URLSearchParams.prototype.isPrototypeOf(o)?this._bodyText=o.toString():s.arrayBuffer&&s.blob&&a(o)?(this._bodyArrayBuffer=R(o.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):s.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(o)||g(o))?this._bodyArrayBuffer=R(o):this._bodyText=o=Object.prototype.toString.call(o):this._bodyText="",this.headers.get("content-type")||(typeof o=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):s.searchParams&&URLSearchParams.prototype.isPrototypeOf(o)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},s.blob&&(this.blob=function(){var o=m(this);if(o)return o;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?m(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(U)}),this.text=function(){var o=m(this);if(o)return o;if(this._bodyBlob)return Q(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(P(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},s.formData&&(this.formData=function(){return this.text().then(Je)}),this.json=function(){return this.text().then(JSON.parse)},this}var X=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function Z(o){var l=o.toUpperCase();return X.indexOf(l)>-1?l:o}function q(o,l){l=l||{};var b=l.body;if(o instanceof q){if(o.bodyUsed)throw new TypeError("Already read");this.url=o.url,this.credentials=o.credentials,l.headers||(this.headers=new h(o.headers)),this.method=o.method,this.mode=o.mode,this.signal=o.signal,!b&&o._bodyInit!=null&&(b=o._bodyInit,o.bodyUsed=!0)}else this.url=String(o);if(this.credentials=l.credentials||this.credentials||"same-origin",(l.headers||!this.headers)&&(this.headers=new h(l.headers)),this.method=Z(l.method||this.method||"GET"),this.mode=l.mode||this.mode||null,this.signal=l.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&b)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(b)}q.prototype.clone=function(){return new q(this,{body:this._bodyInit})};function Je(o){var l=new FormData;return o.trim().split("&").forEach(function(b){if(b){var A=b.split("="),S=A.shift().replace(/\+/g," "),T=A.join("=").replace(/\+/g," ");l.append(decodeURIComponent(S),decodeURIComponent(T))}}),l}function Ye(o){var l=new h,b=o.replace(/\r?\n[\t ]+/g," ");return b.split(/\r?\n/).forEach(function(A){var S=A.split(":"),T=S.shift().trim();if(T){var ee=S.join(":").trim();l.append(T,ee)}}),l}B.call(q.prototype);function _(o,l){l||(l={}),this.type="default",this.status=l.status===void 0?200:l.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in l?l.statusText:"OK",this.headers=new h(l.headers),this.url=l.url||"",this._initBody(o)}B.call(_.prototype),_.prototype.clone=function(){return new _(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new h(this.headers),url:this.url})},_.error=function(){var o=new _(null,{status:0,statusText:""});return o.type="error",o};var Qe=[301,302,303,307,308];_.redirect=function(o,l){if(Qe.indexOf(l)===-1)throw new RangeError("Invalid status code");return new _(null,{status:l,headers:{location:o}})},i.DOMException=u.DOMException;try{new i.DOMException}catch{i.DOMException=function(l,b){this.message=l,this.name=b;var A=Error(l);this.stack=A.stack},i.DOMException.prototype=Object.create(Error.prototype),i.DOMException.prototype.constructor=i.DOMException}function de(o,l){return new Promise(function(b,A){var S=new q(o,l);if(S.signal&&S.signal.aborted)return A(new i.DOMException("Aborted","AbortError"));var T=new XMLHttpRequest;function ee(){T.abort()}T.onload=function(){var V={status:T.status,statusText:T.statusText,headers:Ye(T.getAllResponseHeaders()||"")};V.url="responseURL"in T?T.responseURL:V.headers.get("X-Request-URL");var fe="response"in T?T.response:T.responseText;b(new _(fe,V))},T.onerror=function(){A(new TypeError("Network request failed"))},T.ontimeout=function(){A(new TypeError("Network request failed"))},T.onabort=function(){A(new i.DOMException("Aborted","AbortError"))},T.open(S.method,S.url,!0),S.credentials==="include"?T.withCredentials=!0:S.credentials==="omit"&&(T.withCredentials=!1),"responseType"in T&&s.blob&&(T.responseType="blob"),S.headers.forEach(function(V,fe){T.setRequestHeader(fe,V)}),S.signal&&(S.signal.addEventListener("abort",ee),T.onreadystatechange=function(){T.readyState===4&&S.signal.removeEventListener("abort",ee)}),T.send(typeof S._bodyInit>"u"?null:S._bodyInit)})}return de.polyfill=!0,u.fetch||(u.fetch=de,u.Headers=h,u.Request=q,u.Response=_),i.Headers=h,i.Request=q,i.Response=_,i.fetch=de,Object.defineProperty(i,"__esModule",{value:!0}),i})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var c=n;t=c.fetch,t.default=c.fetch,t.fetch=c.fetch,t.Headers=c.Headers,t.Request=c.Request,t.Response=c.Response,e.exports=t})(ve,ve.exports);var ce=ve.exports;const oe=wt(ce),Lt=Ct({__proto__:null,default:oe},[ce]),F=e=>{let t={};return e&&(typeof Headers<"u"&&e instanceof Headers||Lt&&ce.Headers&&e instanceof ce.Headers?t=Nt(e):Array.isArray(e)?e.forEach(([r,n])=>{r&&n!==void 0&&(t[r]=n)}):t=e),t},Ne=e=>e.replace(/([\s,]|#[^\n\r]+)+/g," ").trim(),jt=e=>{if(!Array.isArray(e.query)){const n=e,c=[`query=${encodeURIComponent(Ne(n.query))}`];return e.variables&&c.push(`variables=${encodeURIComponent(n.jsonSerializer.stringify(n.variables))}`),n.operationName&&c.push(`operationName=${encodeURIComponent(n.operationName)}`),c.join("&")}if(typeof e.variables<"u"&&!Array.isArray(e.variables))throw new Error("Cannot create query with given variable type, array expected");const t=e,r=e.query.reduce((n,c,u)=>(n.push({query:Ne(c),variables:t.variables?t.jsonSerializer.stringify(t.variables[u]):void 0}),n),[]);return`query=${encodeURIComponent(t.jsonSerializer.stringify(r))}`},Gt=e=>async t=>{const{url:r,query:n,variables:c,operationName:u,fetch:i,fetchOptions:s,middleware:a}=t,d={...t.headers};let g="",E;e==="POST"?(E=Ht(n,c,u,s.jsonSerializer),typeof E=="string"&&(d["Content-Type"]="application/json")):g=jt({query:n,variables:c,operationName:u,jsonSerializer:s.jsonSerializer??Se});const w={method:e,headers:d,body:E,...s};let y=r,h=w;if(a){const m=await Promise.resolve(a({...w,url:r,operationName:u,variables:c})),{url:k,...U}=m;y=k,h=U}return g&&(y=`${y}?${g}`),await i(y,h)};class Mt{constructor(t,r={}){this.url=t,this.requestConfig=r,this.rawRequest=async(...n)=>{const[c,u,i]=n,s=Bt(c,u,i),{headers:a,fetch:d=oe,method:g="POST",requestMiddleware:E,responseMiddleware:w,...y}=this.requestConfig,{url:h}=this;s.signal!==void 0&&(y.signal=s.signal);const{operationName:m}=he(s.query);return pe({url:h,query:s.query,variables:s.variables,headers:{...F(ge(a)),...F(s.requestHeaders)},operationName:m,fetch:d,method:g,fetchOptions:y,middleware:E}).then(k=>(w&&w(k),k)).catch(k=>{throw w&&w(k),k})}}async request(t,...r){const[n,c]=r,u=Wt(t,n,c),{headers:i,fetch:s=oe,method:a="POST",requestMiddleware:d,responseMiddleware:g,...E}=this.requestConfig,{url:w}=this;u.signal!==void 0&&(E.signal=u.signal);const{query:y,operationName:h}=he(u.document);return pe({url:w,query:y,variables:u.variables,headers:{...F(ge(i)),...F(u.requestHeaders)},operationName:h,fetch:s,method:a,fetchOptions:E,middleware:d}).then(m=>(g&&g(m),m.data)).catch(m=>{throw g&&g(m),m})}batchRequests(t,r){const n=Ft(t,r),{headers:c,...u}=this.requestConfig;n.signal!==void 0&&(u.signal=n.signal);const i=n.documents.map(({document:a})=>he(a).query),s=n.documents.map(({variables:a})=>a);return pe({url:this.url,query:i,variables:s,headers:{...F(ge(c)),...F(n.requestHeaders)},operationName:void 0,fetch:this.requestConfig.fetch??oe,method:this.requestConfig.method||"POST",fetchOptions:u,middleware:this.requestConfig.requestMiddleware}).then(a=>(this.requestConfig.responseMiddleware&&this.requestConfig.responseMiddleware(a),a.data)).catch(a=>{throw this.requestConfig.responseMiddleware&&this.requestConfig.responseMiddleware(a),a})}setHeaders(t){return this.requestConfig.headers=t,this}setHeader(t,r){const{headers:n}=this.requestConfig;return n?n[t]=r:this.requestConfig.headers={[t]:r},this}setEndpoint(t){return this.url=t,this}}const pe=async e=>{const{query:t,variables:r,fetchOptions:n}=e,c=Gt(qt(e.method??"post")),u=Array.isArray(e.query),i=await c(e),s=await Vt(i,n.jsonSerializer??Se),a=Array.isArray(s)?!s.some(({data:g})=>!g):!!s.data,d=Array.isArray(s)||!s.errors||Array.isArray(s.errors)&&!s.errors.length||n.errorPolicy==="all"||n.errorPolicy==="ignore";if(i.ok&&d&&a){const{errors:g,...E}=(Array.isArray(s),s),w=n.errorPolicy==="ignore"?E:s;return{...u?{data:w}:w,headers:i.headers,status:i.status}}else{const g=typeof s=="string"?{error:s}:s;throw new H({...g,status:i.status,headers:i.headers},{query:t,variables:r})}},Ht=(e,t,r,n)=>{const c=n??Se;if(!Array.isArray(e))return c.stringify({query:e,variables:t,operationName:r});if(typeof t<"u"&&!Array.isArray(t))throw new Error("Cannot create request body with given variable type, array expected");const u=e.reduce((i,s,a)=>(i.push({query:s,variables:t?t[a]:void 0}),i),[]);return c.stringify(u)},Vt=async(e,t)=>{let r;return e.headers.forEach((n,c)=>{c.toLowerCase()==="content-type"&&(r=n)}),r&&(r.toLowerCase().startsWith("application/json")||r.toLowerCase().startsWith("application/graphql+json")||r.toLowerCase().startsWith("application/graphql-response+json"))?t.parse(await e.text()):e.text()},ge=e=>typeof e=="function"?e():e,We=[100,1e3],Ae=e=>{if(!e)throw new N("You are not authorized (no user set)",{type:"UnauthorizedException",code:401,retryable:!1});const t=e.graphqlEndpoint,r=e.token;if(!t)throw new N("You are not authorized (no endpoint set)",{type:"UnauthorizedException",code:401,retryable:!1});if(!r)throw new N("You are not authorized (no token set)",{type:"UnauthorizedException",code:401,retryable:!1});if(ke())throw je(),new N("You are not authorized",{type:"UnauthorizedException",code:401,retryable:!1});const n=new Mt(t,{fetch,headers:{Authorization:r,"x-tango-platform":`extension@${Ge}`}}),c=async s=>{try{if(ke())throw new N("You are not authorized",{type:"UnauthorizedException",code:401,retryable:!1});return await s()}catch(a){return u(a,s)}},u=async(s,a,d=0)=>{const g=Ze(s.message);if(g?.type==="UnauthorizedException"&&je(),d<=We.length-1&&(g?.retryable||!g)){await ne(We[d]);try{return await a()}catch(w){return u(w,a,d+1)}}throw s instanceof H?N.fromClientError(s,g):new N(s.message,g)},i=lt(n,c);return{async createWorkflow({workspaceId:s,folderId:a}){return(await i.createWorkflowV2({input:{name:"Untitled Workflow",workspaceId:s}})).createWorkflowV2},async addContentBlock(s,a){return(await i.addContentBlock({workflowId:s,input:a})).addContentBlockV2.contentBlock},async addComment(s){return(await i.createComment({input:s})).createComment},async listComments(s){return(await i.ListComments({workflowId:s})).listComments},async deleteComment(s,a,d){return(await i.DeleteComment({input:{workflowId:a,commentId:s,stepId:d}})).deleteComment},async updateContentBlock(s){return(await i.updateContentBlock({input:s})).updateContentBlock},async deleteContentBlock(s,a){await i.DeleteContentBlocks({workflowId:s,contentBlockIds:a})},async mergeContentBlocks(s,a){return(await i.MergeContentBlocks({workflowId:s,contentBlockIds:a})).mergeContentBlocks},async deleteWorkflows(s){await i.DeleteWorkflows({input:{ids:s}})},async getWorkflow(s){return(await i.GetWorkflow({id:s})).getWorkflow},async upsertWorkflowPin(s){await i.UpsertWorkflowPin({input:s})},async deleteWorkflowPin(s){await i.DeleteWorkflowPin({input:s})},async discoverWorkflowsByFilter(s,a,d=20){return await i.DiscoverWorkflows({query:s,filter:a,limit:d})},async listApps(){return await i.ListApps()},async searchWorkflows(s){return await i.SearchContent({query:s,limit:20})},async getWorkspaces(){return i.ListWorkspaces({limit:20})},async listSharedWorkflows({workspaceId:s,limit:a=20,offset:d=0}){return i.ListSharedWorkflows({workspaceId:s,limit:a,offset:d})},async listTeamWorkflows({workspaceId:s,limit:a=20,offset:d=0,sort:g=ut.CreatedAtDesc}){return i.ListTeamWorkflows({workspaceId:s,limit:a,sort:g,offset:d,filter:ct.Unfoldered})},async trackEvents(s){return i.TrackEvents({input:s})},async incrementGuidanceViewCount(s){return i.IncrementGuidanceViewCount({workspaceId:s})},async getSnapshotPresignedURL({snapshotType:s,workflowId:a,stepId:d,fileType:g,fileName:E,method:w}){return(await i.getGuidanceSnapshotPresignedURL({input:{snapshotType:s,workflowId:a,stepId:d,fileType:g,fileName:E,method:w}})).getGuidanceSnapshotPresignedURL},async getNuggetSnapshotPresignedUrl({workspaceId:s,nuggetId:a,fileType:d,fileName:g,snapshotType:E,method:w}){return(await i.GetNuggetSnapshotPresignedURL({input:{workspaceId:s,nuggetId:a,fileType:d,snapshotType:E,fileName:g,method:w}})).getNuggetSnapshotPresignedURL},async getStepScreenshotPresignedURL({workflowId:s,stepId:a,fileType:d}){return(await i.GetStepScreenshotPresignedURLs({fileType:d,workflowId:s,stepId:a})).getStepScreenshotPresignedURLs},async getNuggetPresignedUrl({workspaceId:s,fileName:a,fileType:d}){return(await i.GetNuggetPresignedURL({input:{workspaceId:s,fileName:a,fileType:d}})).getNuggetPresignedURL},async requestWorkspaceInvitation(s){return i.RequestWorkspaceInvitation({workspaceId:s})},async getProfiles(s){return(await i.GetProfiles({input:{userIds:s}})).profiles},async listWorkspaceUsers({workspaceId:s,search:a}){return(await i.GetWorkspaceUsersConnection({workspaceId:s,first:5,after:null,filter:{roles:[G.Admin,G.Sidekick,G.Creator],search:a?.trim()}})).getWorkspaceUsersConnection.edges.map(g=>g.node)},async getWorkspaceUserUserGroup(s,a){return(await i.GetWorkspaceUserUserGroup({workspaceId:s,userId:a,first:100,after:null})).getWorkspaceUser},async getUserGroupsConnection(s,a){return(await i.GetUserGroupsConnection({workspaceId:s,first:100,after:null,filter:a})).getUserGroupsConnection},async klAuth(s,a){return fetch(`${x.webUrl}api/kl/auth`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({room:s,groupIds:a})})},async sendNotification(s,a,d,g,E){return fetch(`${x.webUrl}api/notify`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({kind:s,userId:a,roomId:d,subjectId:g,activityData:E})})}}};class Ie{baseUrl="https://api.segment.io/v1";writeKey="";lastUserData=void 0;static load({writeKey:t}){const r=new Ie;if(r.writeKey=t,!t)throw new Error("No writeKey given for Analytics!");return r}async request(t,r){try{const n=await fetch(`${this.baseUrl}/${t}`,{method:"post",headers:{"Content-Type":"application/json",Authorization:`Basic ${btoa(this.writeKey)}`},body:JSON.stringify(r)});n.ok||console.warn("Request to Segment failed, info:",n);const c=await n.json();(!c||!c.success)&&console.warn("Request to Segment failed, response:",c)}catch(n){console.warn("Request to Segment failed, error:",n)}}async identify(t){const r={platform:"extension",ext_version:Ge};if(!t?.userId&&!x.anonymousTrackingId){const n=Tt();et(dt.AnonymousTrackingId,n),await this.request("identify",{anonymousId:n,traits:r});return}t&&((this.lastUserData?.userId!==t?.userId||this.lastUserData?.traits?.workspace_id!==t?.traits?.workspace_id)&&this.request("identify",{userId:t?.userId,anonymousId:x.anonymousTrackingId,traits:{...t?.traits,...r}}),this.lastUserData=t)}track(t,r){return this.request("track",{event:t,...r})}}const $t="7vxwIWJBNFGbytd1EwrdnGA8rtOyR2Qm";let J;J=Ie.load({writeKey:$t});let Y=[],z;const Ue=e=>{if(z=e?.id,!e?.currentWorkspaceId||!z){J?.identify();return}const{role:t,tier:r,workspaceTier:n}=kt(e?.currentWorkspaceId,e);J?.identify({userId:z,traits:{email:e.email,firstName:e.firstName,lastName:e.lastName,workspace_id:e.currentWorkspaceId,workspace_plan_name:r?.toString(),workspace_tier:n,user_role:t?.toString()}})},Hr=async()=>{p.workflowId&&Y.forEach(e=>{W(e.eventName,{timestamp:e.timestamp,workflow_id:p.workflowId,...e.properties}),Y=[]})},zt=(e,t)=>{p.workflowId?W(e,{workflow_id:p.workflowId,...t}):Y.push({eventName:e,properties:t,timestamp:new Date().toISOString()})},Kt=(e,t,r=0)=>{p.workflowId?(zt(e,{...t}),Y=[]):r<3?setTimeout(()=>{Kt(e,t,r+1)},500):Y=[]},W=(e,t)=>{if(!z){const r=x.anonymousTrackingId;if(r){J?.track(e,{anonymousId:r,properties:{...t}});return}}J?.track(e,{userId:z,properties:{...t}})};let j={};const Jt=()=>{const e=j;if(j={},!p.user)return;Ae(p.user).trackEvents(e).catch(r=>{Te(r,{extra:{input:JSON.stringify(e)}})})},Yt=Xe(Jt,500),Vr=e=>{e.stepTrackingEvents&&(j.stepTrackingEvents=(j.stepTrackingEvents||[]).concat(e.stepTrackingEvents)),e.workflowTrackingEvents&&(j.workflowTrackingEvents=(j.workflowTrackingEvents||[]).concat(e.workflowTrackingEvents)),Yt()},$r=e=>{if(!p.user||e.stepTrackingEvents||e.workflowTrackingEvents)return;const t=e.nuggetTrackingEvents||[];Ae(p.user).trackEvents({nuggetTrackingEvents:t}).catch(n=>{Te(n,{extra:{input:JSON.stringify(e)}})})};async function Qt(e){const t=await chrome.tabs.query({});for(const r of t)r.id&&Ce(r)&&chrome.tabs.sendMessage(r.id,{message:e},()=>{chrome.runtime.lastError})}async function zr(e,t){for(const r of t)r.id&&Ce(r)&&chrome.tabs.sendMessage(r.id,{message:e},()=>{chrome.runtime.lastError})}async function Kr(e){chrome.tabs.query({url:[x.webUrl+"*"]},t=>{Array.from(t).forEach(r=>{chrome.scripting.executeScript({args:[e],target:{tabId:r.id,allFrames:!0},func:n=>window.postMessage(n,window.origin)})})})}const Xt=chrome.runtime.getURL("panel/index.html"),He=()=>_e==null||_e>=116?"sidePanel"in chrome&&"getContexts"in chrome.runtime:!1;function Jr(e){chrome.windows.getCurrent(t=>{chrome.sidePanel.open({windowId:t.id}).catch(async r=>{await er()||(console.error("Error with opening panel",r),await chrome.action.setPopup({popup:"opensidepanel/index.html"}),await chrome.action.openPopup(),await chrome.action.setPopup({popup:""}),W($.OpenSidePanelError,{event_source:e}))})})}async function Zt(){await ft({name:M.ClosePanelInternal})}async function er(){if(!He())return!1;try{return(await chrome.runtime.getContexts({contextTypes:[chrome.runtime.ContextType.SIDE_PANEL]})).length>0}catch(e){if(e instanceof Error&&e.message.includes("Value must be one of"))return!1;throw e}}function Yr(){He()&&chrome.sidePanel.setOptions({path:Xt,enabled:!0})}function tr(){throw new Error("readFile cannot be called from the edge runtime.")}var ue={},Ve="@vercel/edge-config",$e="1.2.1",rr=Symbol.for("@vercel/edge-config:global-trace");function nr(){const e=Reflect.get(globalThis,rr);return e?.getTracer(Ve,$e)}function sr(e){return e!==null&&typeof e=="object"&&"then"in e&&typeof e.then=="function"}function O(e,t={name:e.name}){return function(...n){const c=nr();return c?ue.EDGE_CONFIG_TRACE_VERBOSE==="true"||t.isVerboseTrace===!1?c.startActiveSpan(t.name,i=>{t.attributes&&i.setAttributes(t.attributes);try{const s=e.apply(this,n);return sr(s)?s.then(a=>{t.attributesSuccess&&i.setAttributes(t.attributesSuccess(a)),i.setStatus({code:1}),i.end()}).catch(a=>{t.attributesError&&i.setAttributes(t.attributesError(a)),i.setStatus({code:2,message:a instanceof Error?a.message:void 0}),i.end()}):(t.attributesSuccess&&i.setAttributes(t.attributesSuccess(s)),i.setStatus({code:1}),i.end()),s}catch(s){throw t.attributesError&&i.setAttributes(t.attributesError(s)),i.setStatus({code:2,message:s instanceof Error?s.message:void 0}),i.end(),s}}):e.apply(this,n):e.apply(this,n)}}var L={UNAUTHORIZED:"@vercel/edge-config: Unauthorized",EDGE_CONFIG_NOT_FOUND:"@vercel/edge-config: Edge Config not found"},te=class extends Error{constructor(e){super(`@vercel/edge-config: Unexpected error due to response with status code ${e.status}`)}};function or(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function ar(e,t){const r={};return t.forEach(n=>{r[n]=e[n]}),r}function Be(e){if(typeof e!="string")throw new Error("@vercel/edge-config: Expected key to be a string")}function ye(e){return e.trim()===""}function Fe(e){if(!Array.isArray(e)||e.some(t=>typeof t!="string"))throw new Error("@vercel/edge-config: Expected keys to be an array of string")}O(function(t){return typeof structuredClone=="function"?structuredClone(t):t===void 0?t:JSON.parse(JSON.stringify(t))},{name:"clone"});function ir(e){try{const t=new URL(e);if(t.host!=="edge-config.vercel.com"||t.protocol!=="https:"||!t.pathname.startsWith("/ecfg"))return null;const r=t.pathname.split("/")[1];if(!r)return null;const n=t.searchParams.get("token");return!n||n===""?null:{type:"vercel",baseUrl:`https://edge-config.vercel.com/${r}`,id:r,version:"1",token:n}}catch{return null}}function cr(e){try{const t=new URL(e);let r=t.searchParams.get("id");const n=t.searchParams.get("token"),c=t.searchParams.get("version")||"1";return(!r||t.pathname.startsWith("/ecfg_"))&&(r=t.pathname.split("/")[1]||null),!r||!n?null:(t.search="",{type:"external",baseUrl:t.toString(),id:r,token:n,version:c})}catch{return null}}function ur(e){const t=ir(e);return t||cr(e)}function ze(e){return new Response(e.response,{headers:{...e.headers,Age:String(Math.max(1,Math.floor((Date.now()-e.time)/1e3)))},status:e.status})}function lr(e,t){return function(n){switch(n.status){case 500:case 502:case 503:case 504:return typeof t=="number"&&e.time<Date.now()+t*1e3?ze(e):n;default:return n}}}function dr(e,t){return function(n){if(typeof t=="number"&&e.time<Date.now()+t*1e3)return ze(e);throw n}}var me=new Map;function fr(e){if(!e)return null;const t=/stale-if-error=(?<staleIfError>\d+)/i.exec(e);return t?.groups?Number(t.groups.staleIfError):null}var ae=O(async function(t,r={}){const{headers:n=new Headers,...c}=r,u=n.get("Authorization"),i=`${t},${u||""}`,s=me.get(i);if(s){const{etag:g,response:E}=s,w=new Headers(n);w.set("If-None-Match",g);const y=fr(w.get("Cache-Control")),h=await fetch(t,{...c,headers:w}).then(lr(s,y),dr(s,y));if(h.status===304)return h.cachedResponseBody=JSON.parse(E),h;const m=h.headers.get("ETag");return h.ok&&m&&me.set(i,{etag:m,response:await h.clone().text(),headers:Object.fromEntries(h.headers.entries()),status:h.status,time:Date.now()}),h}const a=await fetch(t,r),d=a.headers.get("ETag");return a.ok&&d&&me.set(i,{etag:d,response:await a.clone().text(),headers:Object.fromEntries(a.headers.entries()),status:a.status,time:Date.now()}),a},{name:"fetchWithCachedResponse",attributesSuccess(e){return{status:e.status}}}),Le=new Map,hr=O(tr,{name:"readFile"}),pr=O(JSON.parse,{name:"JSON.parse"}),gr=Symbol.for("privateEdgeConfig"),yr=O((e,t)=>{const r=Le.get(e);if(r)return r;const n=pr(t);return Le.set(e,Object.freeze(n)),n},{name:"cached JSON.parse"}),mr=O(async function(t){if(t.type!=="vercel"||!ue.AWS_LAMBDA_FUNCTION_NAME)return null;try{const r=await hr(`/opt/edge-config/${t.id}.json`,"utf-8");return yr(t.id,r)}catch{return null}},{name:"getFileSystemEdgeConfig"}),wr=O(async function(t){const r=Reflect.get(globalThis,gr);return typeof r=="object"&&typeof r.get=="function"?r.get(t.id):null},{name:"getPrivateEdgeConfig"});function br(e,t,r,n){let c=null,u=null;return O(()=>e?(u||(u=ae(`${t.baseUrl}/items?version=${t.version}`,{headers:new Headers(r),cache:n}).then(async i=>{const s=i.headers.get("x-edge-config-digest");let a;if(i.ok)a=await i.json();else if(await ie(i),a=i.cachedResponseBody,!a)return null;return{digest:s,items:a}}),u.then(i=>{c=Promise.resolve(i),u=null},()=>{c=null,u=null})),c||(c=u),c):Promise.resolve(null),{name:"getInMemoryEdgeConfig"})}async function re(e){return await wr(e)||await mr(e)}async function ie(e){await e.arrayBuffer()}var vr=O(function(t,r={staleIfError:604800,cache:"no-store"}){if(!t)throw new Error("@vercel/edge-config: No connection string provided");const n=ur(t);if(!n)throw new Error("@vercel/edge-config: Invalid connection string provided");const c=n.id,u=n.baseUrl,i=n.version,s={Authorization:`Bearer ${n.token}`};typeof process<"u"&&ue.VERCEL_ENV&&(s["x-edge-config-vercel-env"]=ue.VERCEL_ENV),s["x-edge-config-sdk"]=`${Ve}@${$e}`,typeof r.staleIfError=="number"&&r.staleIfError>0&&(s["cache-control"]=`stale-if-error=${r.staleIfError}`);const a=r.cache||"no-store",d=!r.disableDevelopmentCache&&!1,g=br(d,n,s,a);return{...{get:O(async function(y){const h=await g()||await re(n);if(Be(y),!ye(y))return h?Promise.resolve(h.items[y]):ae(`${u}/item/${y}?version=${i}`,{headers:new Headers(s),cache:a}).then(async m=>{if(m.ok)return m.json();if(await ie(m),m.status===401)throw new Error(L.UNAUTHORIZED);if(m.status===404){if(m.headers.has("x-edge-config-digest"))return;throw new Error(L.EDGE_CONFIG_NOT_FOUND)}if(m.cachedResponseBody!==void 0)return m.cachedResponseBody;throw new te(m)})},{name:"get",isVerboseTrace:!1,attributes:{edgeConfigId:c}}),has:O(async function(y){const h=await g()||await re(n);return Be(y),ye(y)?!1:h?Promise.resolve(or(h.items,y)):fetch(`${u}/item/${y}?version=${i}`,{method:"HEAD",headers:new Headers(s),cache:a}).then(m=>{if(m.status===401)throw new Error(L.UNAUTHORIZED);if(m.status===404){if(m.headers.has("x-edge-config-digest"))return!1;throw new Error(L.EDGE_CONFIG_NOT_FOUND)}if(m.ok)return!0;throw new te(m)})},{name:"has",isVerboseTrace:!1,attributes:{edgeConfigId:c}}),getAll:O(async function(y){const h=await g()||await re(n);if(h)return y===void 0?Promise.resolve(h.items):(Fe(y),Promise.resolve(ar(h.items,y)));Array.isArray(y)&&Fe(y);const m=Array.isArray(y)?new URLSearchParams(y.filter(k=>typeof k=="string"&&!ye(k)).map(k=>["key",k])).toString():null;return m===""?Promise.resolve({}):ae(`${u}/items?version=${i}${m===null?"":`&${m}`}`,{headers:new Headers(s),cache:a}).then(async k=>{if(k.ok)return k.json();if(await ie(k),k.status===401)throw new Error(L.UNAUTHORIZED);if(k.status===404)throw new Error(L.EDGE_CONFIG_NOT_FOUND);if(k.cachedResponseBody!==void 0)return k.cachedResponseBody;throw new te(k)})},{name:"getAll",isVerboseTrace:!1,attributes:{edgeConfigId:c}}),digest:O(async function(){const y=await g()||await re(n);return y?Promise.resolve(y.digest):ae(`${u}/digest?version=${i}`,{headers:new Headers(s),cache:a}).then(async h=>{if(h.ok)return h.json();if(await ie(h),h.cachedResponseBody!==void 0)return h.cachedResponseBody;throw new te(h)})},{name:"digest",isVerboseTrace:!1,attributes:{edgeConfigId:c}})},connection:n}},{name:"createClient"});const Er=36e5,kr=async(e=!1)=>{const t=new Date().getTime();if(e||!p.latestEdgeConfigFetch||t-p.latestEdgeConfigFetch>Er)try{const n=await vr("https://edge-config.vercel.com/ecfg_en0csnhmrivqjsccxbkzezbhxnzv?token=6c5fc605-2c20-485f-8cbd-0b5515b57236").getAll(Object.keys(ht));K({edgeConfig:n,latestEdgeConfigFetch:t})}catch{}return p.edgeConfig},Qr=async(e,t)=>{const r=await le();if(r)return t.openInCurrentTab==="auto"&&r.url&&Me(e,r.url)?chrome.tabs.update(r.id,{active:!0}):t.openInCurrentTab===!0?chrome.tabs.update(r.id,{active:!0,url:e}):chrome.tabs.create({url:e,active:!0,openerTabId:r.id,windowId:r.windowId})},Tr=async e=>{const t=`${x.webUrl}${pt}/${e}`,r=await le();if(r)return r.url&&Me(t,r.url)?chrome.tabs.update(r.id,{active:!0}):new Promise(async n=>{const c=await chrome.tabs.create({url:t,active:!0,openerTabId:r.id,windowId:r.windowId});chrome.tabs.onUpdated.addListener(function u(i,s){i===c.id&&s.status==="complete"&&(chrome.tabs.onUpdated.removeListener(u),n())})})},Cr="2023-05-17",Xr=[C.Hidden,C.Viewing,C.Loading,C.Actions,C.DirectToGuidance],Sr=e=>{if(!e)return!0;const t=p.edgeConfig?.disallowedGuidanceDomains||[];return!(e.contentBlocks.reduce((c,u)=>{if(u.type===De.Heading||u.type===De.Step){const i=u.url,s=vt(i);s&&c.push(s)}return c},[]).filter(c=>t.some(u=>c.includes(u))).length>0)},Ar=e=>{if(!e)return!0;const t=p.edgeConfig?.guidanceMinDate?new Date(p.edgeConfig.guidanceMinDate):new Date(Cr);return new Date(e.createdAt)>=t&&e.contentBlocks.some(r=>Et(r)&&(!!r.targetDetails||!!r.children?.some(n=>!!n.targetDetails)))},Zr=({workspaceId:e})=>{const t=p.bgWorkspacesCache.workspaces?.find(c=>c.id===e);return{hasHitLimit:t?.workspaceUser?.role===G.Guest&&Number(t?.workspaceUser?.guidanceViewCount)>=gt,workspace:t}},en=({workspace:e,workflowId:t})=>{if(!e)return!1;if(t)return Tr(t).then(()=>{Ee(C.OutOfGuidedViews,{workspace:e})});Ee(C.OutOfGuidedViews,{workspace:e})};function Ir(e){return p.openTabId===e?p.currentRoute:C.Hidden}async function Ke(e,t,r){p.currentRoute=e,p.currentParams=t||{};const n=r??await le();let c;(await chrome.tabs.query({})).forEach(a=>{if(a.id&&Ce(a))if(a.active&&n&&a.windowId===n.windowId){c=a.id;const d={name:M.CurrentRoute,route:e,params:t,tabId:c};chrome.tabs.sendMessage(a.id,{message:d}).catch(we)}else{const d={name:M.CurrentRoute,route:C.Hidden,params:{isEnterpriseUser:Re(p.user?.currentWorkspaceId)},tabId:a.id};chrome.tabs.sendMessage(a.id,{message:d}).catch(we)}});const i=K({openTabId:c,currentRoute:e,currentParams:t||{}}),s={name:M.CurrentRoute,route:e,params:t};return await chrome.runtime.sendMessage({message:s}).catch(we),e!==C.Hidden&&kr(),i}async function Ee(e,t={}){let r={};if(e===C.Viewing){const n=t,c=await le();r={areWorkflowDomainsGuidanceAllowed:Sr(n.workflow),isWorkflowCompatibleWithGuidance:Ar(n.workflow),guidanceSessionId:n.guidanceSessionId||p.currentParams.guidanceSessionId,isGuidanceEnabled:n.isGuidanceEnabled??!0,eventSource:n.eventSource,newTab:n.newTab,currentTabId:c?.id,currentTabUrl:c?.url}}if(e===C.Recording){const n=p.edgeConfig?.inlineStylesSnapshotEnabledTeams??[];r={shouldTrackCapture:p.shouldTrackCapture,isInlineStylesSnapshotEnabled:n.includes(p.user?.currentWorkspaceId??"")}}return e===C.Hidden&&Re(p.user?.currentWorkspaceId)&&(r={isEnterpriseUser:!0}),Ke(e,Object.assign(r,t))}function tn(e){let t=p.currentRoute;return e.tab?.id&&(t=Ir(e.tab.id)),{route:t,params:p.currentParams}}const rn=()=>[C.Recording,C.Blurring,C.Paused,C.Finishing].includes(p.currentRoute),we=()=>{},be="auto_login_failures",Ur=10,Or=36e5,nn=async e=>{const t=e?e.user:null;if(t&&((!t.currentWorkspaceId||!t.workspaces?.some(r=>r.id===t.currentWorkspaceId))&&(t.currentWorkspaceId=t.workspaces?.[0].id),p.currentRoute===C.PendingSignIn&&(t?.workspaces?.find(n=>n.id===t.currentWorkspaceId)?.role===G.Sidekick&&chrome.tabs.query({active:!0,currentWindow:!0},function(n){const c=n[0];chrome.tabs.remove(c.id)}),Ke(C.Actions)),t.currentWorkspaceId||Te("User has no workspace after authenticating")),t||[C.Actions,C.Hidden,C.PendingSignIn].includes(p.currentRoute)||Zt(),Oe(t),Ue(t),I.tokenTabId&&(chrome.tabs.remove(I.tokenTabId),I.tokenTabId=null),I.ssoSignInTabId&&p.user){chrome.tabs.remove(I.ssoSignInTabId),I.ssoSignInTabId=null;const r=await chrome.storage.managed.get("IdpConnectUrl");W($.AutoLoginWithSSOSuccessful,{email:p.user.email,workspace_id:p.user.currentWorkspaceId,idp_connect_url:r.IdpConnectUrl})}},sn=(e,t)=>{if(!p.user)return;const r={...p.user,currentWorkspaceId:e,userGroups:t};Oe(r),Ue(r)},Rr=()=>{tt(p.user),Qt({name:M.CheckUser,user:p.user}),Ee(p.currentRoute,p.currentParams),chrome.runtime.sendMessage({message:{name:M.CheckUser,user:p.user}})},on=()=>Oe(null),Oe=async e=>{let t=!1;p.edgeConfig?.captureTrackingPercentage&&(t=Math.random()<p.edgeConfig.captureTrackingPercentage,bt(t?"Capture tracking enabled":"Capture tracking disabled","| Percentage:",p.edgeConfig.captureTrackingPercentage)),await K({user:e,shouldTrackCapture:t,bgWorkflowLatestAttempt:null}),e==null&&await K({bgWorkflows:{},bgAppListCache:{cacheTimestamp:0,apps:{}},bgWorkspacesCache:{cacheTimestamp:0,workspaces:[]}}),Rr()},an=async()=>{if(!I.tokenTabId&&ke()){const e=await chrome.tabs.create({url:x.webUrl,active:!1});I.tokenTabId=e.id||null}},cn=async()=>{if(p.user)return!1;const e=await chrome.storage.managed.get("IdpConnectUrl"),t=p.isForceInstalled,r=e.IdpConnectUrl;if(I.ssoSignInTabId||!t||!r)return!1;Ue(null);const c=(await chrome.storage.local.get(be))[be]||[];if(c.length>=Ur)return W($.AutoLoginWithSSOMaxAttemptsReached,{idp_connect_url:r}),!1;if(c.length>0){if(!p.edgeConfig?.retryFailedAutoLogin)return!1;const s=c[c.length-1],a=Date.now()-s,d=Or*Math.pow(2,c.length-1);if(a<d)return!1}const u=await chrome.tabs.create({url:r,active:!1,pinned:!0});I.ssoSignInTabId=u.id||null,W($.AutoLoginWithSSOAttempted,{idp_connect_url:r,past_failures_count:c.length});const i=6e4;return setTimeout(()=>{I.ssoSignInTabId&&(chrome.tabs.remove(I.ssoSignInTabId),I.ssoSignInTabId=null,W($.AutoLoginWithSSOFailed,{idp_connect_url:r,timeout:i}),c.push(Date.now()),chrome.storage.local.set({[be]:c}))},i),!0},je=()=>{p.user&&K({user:{...p.user,token:""}})},un=async()=>{I.tokenTabId&&(await ne(500),I.tokenTabId&&await ne(4e3),I.tokenTabId&&await ne(4e3))},ke=()=>{const e=p.user?.token;if(!e)return!0;const t=Dr(e);return!t||!t.exp?!0:t.exp*1e3<Date.now()},Dr=e=>{try{return JSON.parse(atob(e.split(".")[1]))}catch{return null}},Re=e=>p.user?.workspaces?.find(r=>p.user?.currentWorkspaceId===r.id)?.tier===yt.Enterprise,ln=async e=>{if(!p.user)return[];const t=Ae(p.user),r=p.user.id;return Re()?p.bgWorkspacesCache.workspaces?.some(s=>s.id===e&&s.workspaceUser?.role===G.Admin)?(await t.getUserGroupsConnection(e)).edges?.map(a=>a.node)||[]:(await t.getWorkspaceUserUserGroup(e,r)).userGroupsConnection?.edges?.map(s=>s.node)||[]:[]};export{sn as A,an as B,tn as C,Yr as D,nn as E,Rr as F,Xr as G,Ae as a,Zr as b,on as c,Qt as d,rn as e,Hr as f,Ke as g,zt as h,Re as i,Zt as j,Kt as k,er as l,Jr as m,Ee as n,Qr as o,cn as p,Kr as q,en as r,zr as s,W as t,Ue as u,$r as v,un as w,kr as x,Vr as y,ln as z};
//# sourceMappingURL=YaqZrkt8.js.map
