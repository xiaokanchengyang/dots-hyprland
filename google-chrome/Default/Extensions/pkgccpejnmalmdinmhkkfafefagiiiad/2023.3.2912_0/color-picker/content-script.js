window.colorpickerContentScript=function(){let e=window.FeHelper||{};e.elemTool={elm:function(e,t,i,o){var r,n,l=document.createElement(e);if(t&&(t.event||t.events)){var a=t.event||t.events;if("string"==typeof a[0])l.addEventListener(a[0],a[1],a[2]);else if(a.length)for(r=0,n=a.length;r<n;r++)l.addEventListener(a[r][0],a[r][1],a[r][2])}for(r in t)"event"==r.substring(0,5)||("checked"==r||"selected"==r?t[r]&&l.setAttribute(r,r):l.setAttribute(r,t[r]));if(i)for(r=0,n=i.length;r<n;r++)i[r]&&l.appendChild(i[r]);return o&&this.insertNode(l,o),l},txt:function(e){return document.createTextNode(e)},ent:function(e){return document.createTextNode(this.unescapeHtml(e))},paragraphs:function(e){for(var t=e.split("\n"),i=[],o=0,r=t.length;o<r;o++)i.push(elemTool.elm("p",{},[elemTool.ent(t[o])]));return i},insertNode:function(e,t,i){t||(t=document.body),i&&i.parentNode==t?t.insertBefore(e,i):t.appendChild(e)},insertNodes:function(e,t,i){if("array"!=typeof e)this.insertNode(e,t,i);else for(var o=0,r=e.length;o<r;o++)this.insertNode(e[o],t,i,!0)},empty:function(e){for(;e.lastChild;)e.removeChild(e.lastChild)},unescapeHtml:function(e){if(e.length<1)return e;var t=document.createElement("div");e=e.replace(/<\/?\w(?:[^"'>]|"[^"]*"|'[^']*')*>/gim,""),t.innerHTML=e;var i=t.childNodes[0].nodeValue;return this.empty(t),i}},e.ColorPicker=function(){if(document.documentElement instanceof HTMLElement){var t,i="fehelper-colorpicker-box",o="fehelper-colorpicker-result",r=!1,n=!1,l="F00BAF",a=null,c=0,d=0,s=!1,h=!1,u=!1,m="1px solid #666",p="",f=0,v=0,g=document.createElement("canvas"),A=g.getContext("2d"),y=1,x=1,k=!1,w=0,b=0,E=150;return function(e){e.setPickerImage?n.src=e.pickerImage:(Y(),F())}}function C(e){return document.getElementById(e)}function I(e,t,i){return o=R(e)+R(t)+R(i),u?o.toLowerCase():o;var o}function R(e){return null==e?"00":0==(e=parseInt(e))||isNaN(e)?"00":(e=Math.max(0,e),e=Math.min(e,255),e=Math.round(e),"0123456789ABCDEF".charAt((e-e%16)/16)+"0123456789ABCDEF".charAt(e%16))}function B(e){for(;e.lastChild;)e.removeChild(e.lastChild)}function T(){n.style.height="auto",n.style.width=innerWidth+"px",y=n.naturalWidth/innerWidth,x=n.naturalHeight/innerHeight,g.width=n.naturalWidth,g.height=n.naturalHeight,A.drawImage(n,0,0),setTimeout(function(){k=!1,n.style.visibility="visible",r.style.visibility="visible",document.body.style.cursor="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACEAAAAhCAYAAABX5MJvAAAA8ElEQVRYCe1WAQ6DIAwsm//e9rP9jOU2z0CpyWhlcQkkpoCld15rVcQ5cs5ZRLZrXbuiXVynDj40SVDQkBKfshChZdBe6yaRUkolmF6X934xxxsSGm4lQqjq8CRBQa6cBCwK9Bk4LzMdVO8USizW129k47HwFtX43i0YjiOIkIDGRGV/2/EezKGydxHBZY2btWntbT8mIMRhOe7s7RFo3IvYFSZqonEekQqAIO5KpMJETVRfw+rugIWFd4pXdJI4MtttZXdGn+mgYP+vBBoPnoaWT9Zr3UpoYL3uIeImARA2W9oe4NI3RKIMFJlPElTvBRTxXFcOwvQSAAAAAElFTkSuQmCC) 16 16,crosshair",P()},255)}function M(e){e.target.select()}function Q(){B(r),e.elemTool.elm("div",{},[e.elemTool.elm("input",{type:"text",size:7,style:"width:80px;height:20px;line-height:20px;font-size:10pt;border:"+m,id:"fehelper-colorpicker-cphexvl",value:"#"+l,event:["mouseover",M]}),e.elemTool.elm("img",{style:"width:20px;height:20px;position:absolute;top:-10px;right:-10px;cursor:pointer;",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAACwklEQVQ4Ea1US0tbQRg9kwmp8YXBi7hKyMZAcaFuFN26daFEUg1BEF24FQr9D/0BIqhbDe0/0I0LceNCQSIVIcZdLkrER2LUm6+caeZiEmkp7cDlMnfOOfM9zneB/7zUn/REJAEgXsfllVI/fscJvncoIhrAZwArrutGb25uoJRCb28vROQKwBqAr0opr5nfEqGIpGq12s7h4SH29vZQKpUMR2uN9vZ29PX1YWJiAsPDw7zkk1Iq+1a0QVBEkuVy+dvW1hYuLi58HKMLBoPo6uoyb+6j0ShmZmYQDodnlVLfLdgXFJGQ53nVjY0NnJ+fo1arMT2Do0BbWxs6OjoQCASMqOd5iMViSKVS0Fp/UEo9ExywygBWj4+PUSwWTWpDQ0MYHx/3jylE4cHBQSwuLiIUCqFQKODk5ISYVQt8K7jCujE1RtPf349kMomRkRGLRSKRwNTUlMng+dkEBHLYPAsyXRaRj9fX19H7+3sTBQ+Pjo5Miul0Gg8PD+aS6elp831/f9/ycXd3B3KpoZTKWdvEb29vfRBT4yKR0S4vL5uLTk9Psbu7619qCeQ6jkOv5t6mbM/Nm6J8WFfWj4sXsFG2WQ2E+sYK5nt6elrOHcfB/Py8sdDl5SUWFhZokxbROjdPASPI3B3Hueru7vZFCZqbm2N9sL29jc3NTVMv1pQdtpHSm+RSwxesq6yNjY35grQMm5TNZvHy8oKnpyesr6/Tc6bz3L++vmJ0dJQcjqJZLcamAP1F+7B2lUoFj4+PRpBRdXZ2mm9kDwwMYGlp6X1j0+la61lag2PF26vVqpkYToVdtBD38XgcmUyGYhy9X6YE4EdoCfw5eJ63wwk4ODiA67ool8tGhJhIJILJyUmwPFrrlp+D1Wl4c65F5IuIFFzXlbOzM8nlclIsFoXf6mehBlJ90xJhM+hvf7DN/H/e/wRZ4k9klRmUggAAAABJRU5ErkJggg==",alt:"Close",title:"[esc]键可直接关闭",id:"fehelper-colorpicker-exitbtn",event:["click",L,!0]})],r),C("fehelper-colorpicker-cphexvl")&&C("fehelper-colorpicker-cphexvl").select(),D()}function F(){h?(l,h=!1,B(r)):(h=!0,Q())}function L(){setTimeout(S,500)}function S(){s=!1,h=!1,document.removeEventListener("mousemove",X),removeEventListener("scroll",V),removeEventListener("resize",V),removeEventListener("keyup",U),W(),clearTimeout(w)}function W(){document.body&&(n=C(i),r=C(o),n&&document.body.removeChild(n),r&&document.body.removeChild(r),n=!1,r=!1,document.body.style.cursor="")}function U(e){s&&(27==e.keyCode?L():82==e.keyCode||74==e.keyCode?V():13==e.keyCode&&F())}function X(e){s&&(h||(f=e.pageX-pageXOffset,v=e.pageY-pageYOffset,c=Math.round(f*y),d=Math.round(v*x),P()))}function V(e){s&&(r.style.visibility="hidden",n.style.visibility="hidden",clearTimeout(w),w=setTimeout(function(){Z()},250))}function Y(){return S(),r?N():(W(),n=e.elemTool.elm("img",{id:i,src:p,style:"position:fixed;max-width:none!important;max-height:none!important;top:0px;left:0px;margin:0px;padding:0px;overflow:hidden;z-index:2147483646;",events:[["click",F,!0],["load",T]]},[],document.body),r=e.elemTool.elm("div",{id:o,style:"position:fixed;min-width:30px;max-width:300px;box-shadow:2px 2px 2px #666;border:"+m+";border-radius:5px;z-index:2147483646;cursor:default;padding:10px;text-align:center;"},[],document.body),document.addEventListener("mousemove",X),addEventListener("keyup",U),addEventListener("scroll",V),addEventListener("resize",V),H(),N(),!1)}function N(){return!!s||(r.style.visibility="hidden",n.style.visibility="hidden",h&&F(),document.body.style.cursor="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACEAAAAhCAYAAABX5MJvAAAA8ElEQVRYCe1WAQ6DIAwsm//e9rP9jOU2z0CpyWhlcQkkpoCld15rVcQ5cs5ZRLZrXbuiXVynDj40SVDQkBKfshChZdBe6yaRUkolmF6X934xxxsSGm4lQqjq8CRBQa6cBCwK9Bk4LzMdVO8USizW129k47HwFtX43i0YjiOIkIDGRGV/2/EezKGydxHBZY2btWntbT8mIMRhOe7s7RFo3IvYFSZqonEekQqAIO5KpMJETVRfw+rugIWFd4pXdJI4MtttZXdGn+mgYP+vBBoPnoaWT9Zr3UpoYL3uIeImARA2W9oe4NI3RKIMFJlPElTvBRTxXFcOwvQSAAAAAElFTkSuQmCC) 16 16,crosshair",s=!0,setTimeout(Z,1),!1)}function D(){r&&(r.style.top=v+8+"px",r.style.left=f+8+"px",r.clientWidth+r.offsetLeft+24>innerWidth&&(r.style.left=f-8-r.clientWidth+"px"),r.clientHeight+r.offsetTop+24>innerHeight&&(r.style.top=v-8-r.clientHeight+"px"))}function P(i){if(s){D();var o,n=A.getImageData(c,d,1,1).data;(function(e,t,i){e/=255,t/=255,i/=255;var o,r,n=Math.max(e,t,i),l=Math.min(e,t,i),a=(n+l)/2;if(n==l)o=r=0;else{var c=n-l;switch(r=a>.5?c/(2-n-l):c/(n+l),n){case e:o=(t-i)/c+(t<i?6:0);break;case t:o=(i-e)/c+2;break;case i:o=(e-t)/c+4}o/=6}return{h:Math.round(360*o),s:Math.round(100*r),v:Math.round(100*a)}})(n[0],n[1],n[2]),a={r:n[0],g:n[1],b:n[2]},o={hex:I(n[0],n[1],n[2])},r&&(l=o.hex?o.hex:l,r.style.backgroundColor="#"+l,h&&Q()),function(i){var o=c,n=d;if(k)return void!1;var s=Math.floor(.5*E),u=Math.round(o),p=Math.round(n);if(i){var f=O();f.scale(2,2),f.drawImage(g,.5*s-u,.5*s-p),f.scale(.5,.5),f.fillStyle="rgba(0,0,0,0.3)",f.fillRect(s,0,1,E),f.fillRect(0,s,E,1)}else{var f=O();f.drawImage(g,-u+s,-p+s);for(var v,A,y=15,x=0;x<s;x+=2){if(v=s-x,A=s+x,f.drawImage(b,A,0,v,E,A+1,0,v,E),f.drawImage(b,0,0,v+1,E,-1,0,v+1,E),f.drawImage(b,0,A,E,v,0,A+1,E,v),f.drawImage(b,0,0,E,v+1,0,-1,E,v+1),0==x){var w=f.getImageData(s,s,1,1).data,I=w[0]+w[1]+w[2];f.fillStyle=I>192?"rgba(30,30,30,0.8)":"rgba(225,225,225,0.8)"}else f.fillStyle="rgba(255,255,255,0.4)";for(var R=0;R<y&&!(++x>=s);R++)v=s-x,A=s+x,f.drawImage(b,A,0,v,E,A+1,0,v,E),f.drawImage(b,0,0,v+1,E,-1,0,v+1,E),f.drawImage(b,0,A,E,v,0,A+1,E,v),f.drawImage(b,0,0,E,v+1,0,-1,E,v+1);--y<1&&(y=1),f.fillRect(A+1,0,1,E),f.fillRect(v-1,0,1,E),f.fillRect(0,A+1,E,1),f.fillRect(0,v-1,E,1)}}t=b.toDataURL();var T=devicePixelRatio>1?38:19,Q=Math.floor(.5*T),F=document.createElement("canvas");F.width=T,F.height=T,F.getContext("2d").drawImage(b,s-Q,s-Q,T,T,0,0,T,T),F.toDataURL(),L=t,S=l,h||(l=S||l,!C("fehelper-colorpicker-cpimprev")||a&&!C("cprgbvl")?(B(r),e.elemTool.elm("div",{},[e.elemTool.elm("img",{id:"fehelper-colorpicker-cpimprev",height:150,width:150,src:L,style:"margin:0px;padding:0px;margin:0px;"}),e.elemTool.elm("br"),e.elemTool.elm("input",{type:"text",size:7,style:"width:60px;height:20px;line-height:20px;font-size:10pt;border:"+m,id:"fehelper-colorpicker-cphexvl",value:"#"+l,event:["mouseover",M]})],r),D()):(C("fehelper-colorpicker-cpimprev").src=L,C("fehelper-colorpicker-cpimprev").width=150,C("fehelper-colorpicker-cpimprev").height=150,C("fehelper-colorpicker-cphexvl").value=l,r.style.backgroundColor="#"+l)),!1;var L,S}()}}function Z(){if(s){if(k)return clearTimeout(w),void(w=setTimeout(function(){Z()},255));document.body.style.cursor="wait",k=!0,r.style.visibility="hidden",n.style.visibility="hidden",n.src=p;var e=innerWidth,t=innerHeight;n.style.width=e+"px",n.style.height=t+"px",setTimeout(function(){try{chrome.runtime.sendMessage({type:"fh-dynamic-any-thing",thing:"color-picker-capture",params:{url:location.href}})}catch(e){console.log("有错误发生，可提交此反馈到官网！",e)}},255)}}function O(){var e=b.getContext("2d");return e||(H(),b.getContext("2d"))}function H(){(b=document.createElement("canvas")).width=E,b.height=E}}(),window.colorpickerNoPage=function(t){e.ColorPicker(t)}};