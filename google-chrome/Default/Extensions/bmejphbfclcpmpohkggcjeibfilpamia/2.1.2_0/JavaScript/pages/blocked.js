(()=>{"use strict";const e=function(){const e="https://www.netcraft.com/glossary/#non-consensual-cryptocurrency-miners-(cryptojackers)",t="https://www.netcraft.com/glossary/#shopping-site-skimmers",r="attempted to load";return{toggleOptions:["installed","block","other-malicious-scripts","credential-leaks","analytics","cryptojackers","skimmers"],mirror:"https://mirror2.extension.netcraft.com/",toolbar:"https://mirror.toolbar.netcraft.com/",browserApp:"https://www.netcraft.com/apps/browser/",cryptojackersUrl:e,extensionStore:"https://chrome.google.com/webstore/detail/netcraft-anti-phishing-ex/bmejphbfclcpmpohkggcjeibfilpamia",logBlockedVisit:"https://toolbar.netcraft.com/blocked_visit",netblock:"https://sitereport.netcraft.com/netblock?q=",report:"https://sitereport.netcraft.com/?url=",reportAPI:"https://report.netcraft.com/api/v2/report/urls",reportMistake:"https://report.netcraft.com/report/mistake?url=",skimmersUrl:t,submissionURL:"https://report.netcraft.com/submission/",topsites:"https://trends.netcraft.com/topsites?s=",block:"blocked.html",check:"check_url/v4/",danger:"Images/danger.png",embed:"/embedded",evilJSPatternsFeed:"eviljspatterns",skimmerDomainWhitelistFeed:"eviljsskimmerwhitelist",evilResourcesFeed:"blockdb/netcraft_extension_evil_resource_encrypted-yppL7bVh/",flags:"Images/flags/",force:"/dodns",info:"/info",evilResourceTypes:["cryptojacker","skimmer","webinject"],evilResourcesSalt:"C4jhYHxW",maxRevisions:5,randomSaltLength:8,urlTypeInformationMappings:{"malicious_javascript/cryptojacker":["web miners",e],"malicious_javascript/skimmer":["shopping site skimmers",t],"malicious_javascript/webinject":["web inject malware","https://www.netcraft.com/glossary/#web-inject-malware"]},evilResourceOptionMappings:{cryptojacker:"cryptojackers",skimmer:"skimmers",webinject:"other-malicious-scripts"},optionUrlTypeMappings:{block:/^(?!malicious_javascript:)/,cryptojackers:/^malicious_javascript\/cryptojacker$/,"other-malicious-scripts":/^malicious_javascript\/(?!(skimmer|cryptojacker)$)/,skimmers:/^malicious_javascript\/skimmer$/},malwareSourceEmail:"extension-reported-malware@netcraft.com",malwareSourceUUID:"mwcCcApi89cobY9loJ9rWJ9HuOhlpwMj",extensionSourceUUID:"qBEQ3NhEnwK4sypmuSxBJzRqpxZLRXxe",reportErrorMessage:"An error occured with your submission. Please try again.",reportErrorMappings:{"Duplicate of a recent submission":"This URL has already been reported.","Supplied email is not valid":"Invalid email address. Please correct it and try again."},whitelistErrorMessages:{invalidHostname:"Invalid hostname, please correct it and try again",duplicate:"Protection is already disabled for this site"},iconNormal:{16:"/Images/action-normal-16.png",24:"/Images/action-normal-24.png",32:"/Images/action-normal-32.png"},iconDanger:{16:"/Images/action-danger-16.png",24:"/Images/action-danger-24.png",32:"/Images/action-danger-32.png"},iconDisabled:{16:"/Images/action-disabled-16.png",24:"/Images/action-disabled-24.png",32:"/Images/action-disabled-32.png"},errEvilResource:"EVILRESOURCE",errNoDetails:"NODETAILS",errNoInfo:"NOINFO",errBlocked:"BLOCKED",errPending:"PENDING",errServer:"ERROR",errTimeout:"TIMEOUT",noError:"OK",protocols:["^http","^https","^ftp"],msgNa:"NA",msgNewSite:"New Site",msgNoInfo:"Site information not available",msgNoServer:"Unable to contact Netcraft servers",msgBlocked:{"malicious_javascript/skimmer":{title:"Shopping Site Skimmer Detected",description:"shopping site skimmer"},"malicious_javascript/dropsite":{title:"Potential Credential Leak Detected",description:"potential credential leak"},"malicious_javascript/cryptojacker":{title:"Web Miner Detected",description:"web miner"},"malware_c2/infrastructure":{title:"Malicious URL",description:"malicious page"},default:{title:"Suspected Phishing",description:"suspected phishing site"}},urlTypeCrimeMappings:{"malicious_javascript/skimmer":r,"malicious_javascript/cryptojacker":r,"malicious_javascript/dropsite":" is blocked because we detected that sensitive information was leaked from"},timeout:9e5,account:"UA-2150242-8",gaCategory:"Popup load times",minInputSize:5,privateIPv4Blocks:["10.0.0.0","172.16.0.0","192.168.0.0"],disableButtonWhitelistKey:"disableButtonWhitelist",resourceBlocklistFetchKey:"resourceBlocklistFetch",localCredentialLeakWhitelistKey:"localCredentialLeakWhitelist"}}();function t(e,t){void 0===t?chrome.runtime.sendMessage(e):chrome.runtime.sendMessage(e,t)}function r(t){return Object.prototype.hasOwnProperty.call(e.msgBlocked,t)||(t="default"),e.msgBlocked[t].title||e.msgBlocked[Object.keys(e.msgBlocked).find((e=>t.startsWith(e)))].title}!function e(t){Object.freeze(t);for(const r of Object.getOwnPropertyNames(t))"object"==typeof t[r]&&e(t[r])}(e),document.addEventListener("DOMContentLoaded",(i=>{const o=new URLSearchParams(window.location.search),s=o.get("site"),a=parseInt(o.get("blockpageid"),10);isNaN(a)||t({type:"block",site:s,blockPageId:a},(i=>{const o=document.getElementById("urlContainer"),n=document.getElementById("visit"),c=document.getElementById("markSafe"),l=e=>e.parentNode.removeChild(e);if(document.getElementById("rate").href=e.extensionStore,!i)return l(o),l(n),void l(c);n.addEventListener("click",(e=>{t({type:"force",site:s,blockPageId:a},(e=>{window.location.href=e.url}))}));const m=i.url;document.getElementById("url").textContent=m.replace(/^http/,"hxxp");let p=e.msgBlocked.default.title,d=e.msgBlocked.default.description;const u=i.type;switch(i.reason){case e.errBlocked:p=i.message||r(u)||p;break;case e.errEvilResource:p=r(u)||p,d=e.msgBlocked[u].description||d,"malicious_javascript/dropsite"!==u&&l(c)}if(c.addEventListener("click",(t=>{let r=e.reportMistake+encodeURIComponent(i.url);if("malicious_javascript/dropsite"===u){let e=`Leaked credentials were allegedly sent by ${i.resource}.`;i.dropDomain&&(e+=`\n\nThe data was sent to the domain ${i.dropDomain}.`),r+=`&reason=${encodeURIComponent(e)}`}window.top.location.href=r})),u in e.urlTypeInformationMappings){const t=document.getElementById("additionalInformation"),r=e.urlTypeInformationMappings[u];t.classList.add("visible"),t.innerHTML=`For more information about ${r[0]} please see <a href="${r[1]}" target="_blank">our FAQs</a>.`}if(i.resource)document.getElementById("resourceInformation").classList.add("visible"),document.getElementById("resource").innerText=i.resource.replace(/^http/i,"hxxp"),document.getElementById("crime").innerText=e.urlTypeCrimeMappings[u];else if(i.subframe){document.getElementById("resourceInformation").classList.add("visible");let e="malicious";"Suspected Phishing"===p&&(e="phishing"),document.getElementById("resourceInformation").innerText=`This page was blocked because it loaded a ${e} resource.`}i.dropDomain&&(document.getElementById("leakInformation").classList.add("visible"),document.getElementById("dropDomain").innerText=i.dropDomain),document.getElementById("title").textContent=p;const g=function(e){return`Netcraft just protected me from a ${e}! Check out their free browser extension here:`}(d),h=function(e,t){const r=encodeURIComponent(t),i=encodeURIComponent(e);return{Facebook:`https://facebook.com/sharer/sharer.php?u=${i}`,HackerNews:`https://news.ycombinator.com/submitlink?u=${i}&t=${r}`,LinkedIn:`https://www.linkedin.com/sharing/share-offsite/?url=${i}`,Reddit:`https://www.reddit.com/submit?url=${i}&title=${r}`,Twitter:`https://twitter.com/intent/tweet/?text=${r}&url=${i}`}}(e.browserApp,g);for(const[e,t]of Object.entries(h))document.getElementById(`share${e}`).href=t}))}))})();