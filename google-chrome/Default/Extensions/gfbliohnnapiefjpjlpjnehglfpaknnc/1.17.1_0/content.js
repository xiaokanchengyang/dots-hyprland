(()=>{var e={114:function(e){
/*! @license DOMPurify 2.5.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.5.0/LICENSE */
e.exports=function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,n){return t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},t(e,n)}function n(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function o(e,r,i){return o=n()?Reflect.construct:function(e,n,o){var r=[null];r.push.apply(r,n);var i=new(Function.bind.apply(e,r));return o&&t(i,o.prototype),i},o.apply(null,arguments)}function r(e){return i(e)||a(e)||s(e)||l()}function i(e){if(Array.isArray(e))return c(e)}function a(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function s(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function l(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var u=Object.hasOwnProperty,d=Object.setPrototypeOf,f=Object.isFrozen,p=Object.getPrototypeOf,m=Object.getOwnPropertyDescriptor,h=Object.freeze,g=Object.seal,y=Object.create,v="undefined"!=typeof Reflect&&Reflect,w=v.apply,b=v.construct;w||(w=function(e,t,n){return e.apply(t,n)}),h||(h=function(e){return e}),g||(g=function(e){return e}),b||(b=function(e,t){return o(e,r(t))});var k=R(Array.prototype.forEach),S=R(Array.prototype.pop),E=R(Array.prototype.push),x=R(String.prototype.toLowerCase),C=R(String.prototype.toString),T=R(String.prototype.match),O=R(String.prototype.replace),N=R(String.prototype.indexOf),_=R(String.prototype.trim),L=R(RegExp.prototype.test),A=I(TypeError);function R(e){return function(t){for(var n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];return w(e,t,o)}}function I(e){return function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return b(e,n)}}function M(e,t,n){var o;n=null!==(o=n)&&void 0!==o?o:x,d&&d(e,null);for(var r=t.length;r--;){var i=t[r];if("string"==typeof i){var a=n(i);a!==i&&(f(t)||(t[r]=a),i=a)}e[i]=!0}return e}function P(e){var t,n=y(null);for(t in e)!0===w(u,e,[t])&&(n[t]=e[t]);return n}function U(e,t){for(;null!==e;){var n=m(e,t);if(n){if(n.get)return R(n.get);if("function"==typeof n.value)return R(n.value)}e=p(e)}function o(e){return console.warn("fallback value for",e),null}return o}var F=h(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),H=h(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),D=h(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),B=h(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),K=h(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),W=h(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),q=h(["#text"]),j=h(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),z=h(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),V=h(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),G=h(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),$=g(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Q=g(/<%[\w\W]*|[\w\W]*%>/gm),Y=g(/\${[\w\W]*}/gm),X=g(/^data-[\-\w.\u00B7-\uFFFF]/),J=g(/^aria-[\-\w]+$/),Z=g(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),ee=g(/^(?:\w+script|data):/i),te=g(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),ne=g(/^html$/i),oe=g(/^[a-z][.\w]*(-[.\w]+)+$/i),re=function(){return"undefined"==typeof window?null:window},ie=function(t,n){if("object"!==e(t)||"function"!=typeof t.createPolicy)return null;var o=null,r="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(r)&&(o=n.currentScript.getAttribute(r));var i="dompurify"+(o?"#"+o:"");try{return t.createPolicy(i,{createHTML:function(e){return e},createScriptURL:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+i+" could not be created."),null}};function ae(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re(),n=function(e){return ae(e)};if(n.version="2.5.0",n.removed=[],!t||!t.document||9!==t.document.nodeType)return n.isSupported=!1,n;var o=t.document,i=t.document,a=t.DocumentFragment,s=t.HTMLTemplateElement,c=t.Node,l=t.Element,u=t.NodeFilter,d=t.NamedNodeMap,f=void 0===d?t.NamedNodeMap||t.MozNamedAttrMap:d,p=t.HTMLFormElement,m=t.DOMParser,g=t.trustedTypes,y=l.prototype,v=U(y,"cloneNode"),w=U(y,"nextSibling"),b=U(y,"childNodes"),R=U(y,"parentNode");if("function"==typeof s){var I=i.createElement("template");I.content&&I.content.ownerDocument&&(i=I.content.ownerDocument)}var se=ie(g,o),ce=se?se.createHTML(""):"",le=i,ue=le.implementation,de=le.createNodeIterator,fe=le.createDocumentFragment,pe=le.getElementsByTagName,me=o.importNode,he={};try{he=P(i).documentMode?i.documentMode:{}}catch(e){}var ge={};n.isSupported="function"==typeof R&&ue&&void 0!==ue.createHTMLDocument&&9!==he;var ye,ve,we=$,be=Q,ke=Y,Se=X,Ee=J,xe=ee,Ce=te,Te=oe,Oe=Z,Ne=null,_e=M({},[].concat(r(F),r(H),r(D),r(K),r(q))),Le=null,Ae=M({},[].concat(r(j),r(z),r(V),r(G))),Re=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ie=null,Me=null,Pe=!0,Ue=!0,Fe=!1,He=!0,De=!1,Be=!0,Ke=!1,We=!1,qe=!1,je=!1,ze=!1,Ve=!1,Ge=!0,$e=!1,Qe="user-content-",Ye=!0,Xe=!1,Je={},Ze=null,et=M({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),tt=null,nt=M({},["audio","video","img","source","image","track"]),ot=null,rt=M({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),it="http://www.w3.org/1998/Math/MathML",at="http://www.w3.org/2000/svg",st="http://www.w3.org/1999/xhtml",ct=st,lt=!1,ut=null,dt=M({},[it,at,st],C),ft=["application/xhtml+xml","text/html"],pt="text/html",mt=null,ht=i.createElement("form"),gt=function(e){return e instanceof RegExp||e instanceof Function},yt=function(t){mt&&mt===t||(t&&"object"===e(t)||(t={}),t=P(t),ye=ye=-1===ft.indexOf(t.PARSER_MEDIA_TYPE)?pt:t.PARSER_MEDIA_TYPE,ve="application/xhtml+xml"===ye?C:x,Ne="ALLOWED_TAGS"in t?M({},t.ALLOWED_TAGS,ve):_e,Le="ALLOWED_ATTR"in t?M({},t.ALLOWED_ATTR,ve):Ae,ut="ALLOWED_NAMESPACES"in t?M({},t.ALLOWED_NAMESPACES,C):dt,ot="ADD_URI_SAFE_ATTR"in t?M(P(rt),t.ADD_URI_SAFE_ATTR,ve):rt,tt="ADD_DATA_URI_TAGS"in t?M(P(nt),t.ADD_DATA_URI_TAGS,ve):nt,Ze="FORBID_CONTENTS"in t?M({},t.FORBID_CONTENTS,ve):et,Ie="FORBID_TAGS"in t?M({},t.FORBID_TAGS,ve):{},Me="FORBID_ATTR"in t?M({},t.FORBID_ATTR,ve):{},Je="USE_PROFILES"in t&&t.USE_PROFILES,Pe=!1!==t.ALLOW_ARIA_ATTR,Ue=!1!==t.ALLOW_DATA_ATTR,Fe=t.ALLOW_UNKNOWN_PROTOCOLS||!1,He=!1!==t.ALLOW_SELF_CLOSE_IN_ATTR,De=t.SAFE_FOR_TEMPLATES||!1,Be=!1!==t.SAFE_FOR_XML,Ke=t.WHOLE_DOCUMENT||!1,je=t.RETURN_DOM||!1,ze=t.RETURN_DOM_FRAGMENT||!1,Ve=t.RETURN_TRUSTED_TYPE||!1,qe=t.FORCE_BODY||!1,Ge=!1!==t.SANITIZE_DOM,$e=t.SANITIZE_NAMED_PROPS||!1,Ye=!1!==t.KEEP_CONTENT,Xe=t.IN_PLACE||!1,Oe=t.ALLOWED_URI_REGEXP||Oe,ct=t.NAMESPACE||st,Re=t.CUSTOM_ELEMENT_HANDLING||{},t.CUSTOM_ELEMENT_HANDLING&&gt(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Re.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&gt(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Re.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Re.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),De&&(Ue=!1),ze&&(je=!0),Je&&(Ne=M({},r(q)),Le=[],!0===Je.html&&(M(Ne,F),M(Le,j)),!0===Je.svg&&(M(Ne,H),M(Le,z),M(Le,G)),!0===Je.svgFilters&&(M(Ne,D),M(Le,z),M(Le,G)),!0===Je.mathMl&&(M(Ne,K),M(Le,V),M(Le,G))),t.ADD_TAGS&&(Ne===_e&&(Ne=P(Ne)),M(Ne,t.ADD_TAGS,ve)),t.ADD_ATTR&&(Le===Ae&&(Le=P(Le)),M(Le,t.ADD_ATTR,ve)),t.ADD_URI_SAFE_ATTR&&M(ot,t.ADD_URI_SAFE_ATTR,ve),t.FORBID_CONTENTS&&(Ze===et&&(Ze=P(Ze)),M(Ze,t.FORBID_CONTENTS,ve)),Ye&&(Ne["#text"]=!0),Ke&&M(Ne,["html","head","body"]),Ne.table&&(M(Ne,["tbody"]),delete Ie.tbody),h&&h(t),mt=t)},vt=M({},["mi","mo","mn","ms","mtext"]),wt=M({},["foreignobject","desc","title","annotation-xml"]),bt=M({},["title","style","font","a","script"]),kt=M({},H);M(kt,D),M(kt,B);var St=M({},K);M(St,W);var Et=function(e){var t=R(e);t&&t.tagName||(t={namespaceURI:ct,tagName:"template"});var n=x(e.tagName),o=x(t.tagName);return!!ut[e.namespaceURI]&&(e.namespaceURI===at?t.namespaceURI===st?"svg"===n:t.namespaceURI===it?"svg"===n&&("annotation-xml"===o||vt[o]):Boolean(kt[n]):e.namespaceURI===it?t.namespaceURI===st?"math"===n:t.namespaceURI===at?"math"===n&&wt[o]:Boolean(St[n]):e.namespaceURI===st?!(t.namespaceURI===at&&!wt[o])&&!(t.namespaceURI===it&&!vt[o])&&!St[n]&&(bt[n]||!kt[n]):!("application/xhtml+xml"!==ye||!ut[e.namespaceURI]))},xt=function(e){E(n.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=ce}catch(t){e.remove()}}},Ct=function(e,t){try{E(n.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){E(n.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!Le[e])if(je||ze)try{xt(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},Tt=function(e){var t,n;if(qe)e="<remove></remove>"+e;else{var o=T(e,/^[\r\n\t ]+/);n=o&&o[0]}"application/xhtml+xml"===ye&&ct===st&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var r=se?se.createHTML(e):e;if(ct===st)try{t=(new m).parseFromString(r,ye)}catch(e){}if(!t||!t.documentElement){t=ue.createDocument(ct,"template",null);try{t.documentElement.innerHTML=lt?ce:r}catch(e){}}var a=t.body||t.documentElement;return e&&n&&a.insertBefore(i.createTextNode(n),a.childNodes[0]||null),ct===st?pe.call(t,Ke?"html":"body")[0]:Ke?t.documentElement:a},Ot=function(e){return de.call(e.ownerDocument||e,e,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null,!1)},Nt=function(e){return e instanceof p&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof f)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},_t=function(t){return"object"===e(c)?t instanceof c:t&&"object"===e(t)&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},Lt=function(e,t,o){ge[e]&&k(ge[e],(function(e){e.call(n,t,o,mt)}))},At=function(e){var t;if(Lt("beforeSanitizeElements",e,null),Nt(e))return xt(e),!0;if(L(/[\u0080-\uFFFF]/,e.nodeName))return xt(e),!0;var o=ve(e.nodeName);if(Lt("uponSanitizeElement",e,{tagName:o,allowedTags:Ne}),e.hasChildNodes()&&!_t(e.firstElementChild)&&(!_t(e.content)||!_t(e.content.firstElementChild))&&L(/<[/\w]/g,e.innerHTML)&&L(/<[/\w]/g,e.textContent))return xt(e),!0;if("select"===o&&L(/<template/i,e.innerHTML))return xt(e),!0;if(7===e.nodeType)return xt(e),!0;if(Be&&8===e.nodeType&&L(/<[/\w]/g,e.data))return xt(e),!0;if(!Ne[o]||Ie[o]){if(!Ie[o]&&It(o)){if(Re.tagNameCheck instanceof RegExp&&L(Re.tagNameCheck,o))return!1;if(Re.tagNameCheck instanceof Function&&Re.tagNameCheck(o))return!1}if(Ye&&!Ze[o]){var r=R(e)||e.parentNode,i=b(e)||e.childNodes;if(i&&r)for(var a=i.length-1;a>=0;--a)r.insertBefore(v(i[a],!0),w(e))}return xt(e),!0}return e instanceof l&&!Et(e)?(xt(e),!0):"noscript"!==o&&"noembed"!==o&&"noframes"!==o||!L(/<\/no(script|embed|frames)/i,e.innerHTML)?(De&&3===e.nodeType&&(t=e.textContent,t=O(t,we," "),t=O(t,be," "),t=O(t,ke," "),e.textContent!==t&&(E(n.removed,{element:e.cloneNode()}),e.textContent=t)),Lt("afterSanitizeElements",e,null),!1):(xt(e),!0)},Rt=function(e,t,n){if(Ge&&("id"===t||"name"===t)&&(n in i||n in ht))return!1;if(Ue&&!Me[t]&&L(Se,t));else if(Pe&&L(Ee,t));else if(!Le[t]||Me[t]){if(!(It(e)&&(Re.tagNameCheck instanceof RegExp&&L(Re.tagNameCheck,e)||Re.tagNameCheck instanceof Function&&Re.tagNameCheck(e))&&(Re.attributeNameCheck instanceof RegExp&&L(Re.attributeNameCheck,t)||Re.attributeNameCheck instanceof Function&&Re.attributeNameCheck(t))||"is"===t&&Re.allowCustomizedBuiltInElements&&(Re.tagNameCheck instanceof RegExp&&L(Re.tagNameCheck,n)||Re.tagNameCheck instanceof Function&&Re.tagNameCheck(n))))return!1}else if(ot[t]);else if(L(Oe,O(n,Ce,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==N(n,"data:")||!tt[e])if(Fe&&!L(xe,O(n,Ce,"")));else if(n)return!1;return!0},It=function(e){return"annotation-xml"!==e&&T(e,Te)},Mt=function(t){var o,r,i,a;Lt("beforeSanitizeAttributes",t,null);var s=t.attributes;if(s){var c={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Le};for(a=s.length;a--;){var l=o=s[a],u=l.name,d=l.namespaceURI;if(r="value"===u?o.value:_(o.value),i=ve(u),c.attrName=i,c.attrValue=r,c.keepAttr=!0,c.forceKeepAttr=void 0,Lt("uponSanitizeAttribute",t,c),r=c.attrValue,!c.forceKeepAttr&&(Ct(u,t),c.keepAttr))if(He||!L(/\/>/i,r)){De&&(r=O(r,we," "),r=O(r,be," "),r=O(r,ke," "));var f=ve(t.nodeName);if(Rt(f,i,r)){if(!$e||"id"!==i&&"name"!==i||(Ct(u,t),r=Qe+r),se&&"object"===e(g)&&"function"==typeof g.getAttributeType)if(d);else switch(g.getAttributeType(f,i)){case"TrustedHTML":r=se.createHTML(r);break;case"TrustedScriptURL":r=se.createScriptURL(r)}try{d?t.setAttributeNS(d,u,r):t.setAttribute(u,r),S(n.removed)}catch(e){}}}else Ct(u,t)}Lt("afterSanitizeAttributes",t,null)}},Pt=function e(t){var n,o=Ot(t);for(Lt("beforeSanitizeShadowDOM",t,null);n=o.nextNode();)Lt("uponSanitizeShadowNode",n,null),At(n)||(n.content instanceof a&&e(n.content),Mt(n));Lt("afterSanitizeShadowDOM",t,null)};return n.sanitize=function(r){var i,s,l,u,d,f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((lt=!r)&&(r="\x3c!--\x3e"),"string"!=typeof r&&!_t(r)){if("function"!=typeof r.toString)throw A("toString is not a function");if("string"!=typeof(r=r.toString()))throw A("dirty is not a string, aborting")}if(!n.isSupported){if("object"===e(t.toStaticHTML)||"function"==typeof t.toStaticHTML){if("string"==typeof r)return t.toStaticHTML(r);if(_t(r))return t.toStaticHTML(r.outerHTML)}return r}if(We||yt(f),n.removed=[],"string"==typeof r&&(Xe=!1),Xe){if(r.nodeName){var p=ve(r.nodeName);if(!Ne[p]||Ie[p])throw A("root node is forbidden and cannot be sanitized in-place")}}else if(r instanceof c)1===(s=(i=Tt("\x3c!----\x3e")).ownerDocument.importNode(r,!0)).nodeType&&"BODY"===s.nodeName||"HTML"===s.nodeName?i=s:i.appendChild(s);else{if(!je&&!De&&!Ke&&-1===r.indexOf("<"))return se&&Ve?se.createHTML(r):r;if(!(i=Tt(r)))return je?null:Ve?ce:""}i&&qe&&xt(i.firstChild);for(var m=Ot(Xe?r:i);l=m.nextNode();)3===l.nodeType&&l===u||At(l)||(l.content instanceof a&&Pt(l.content),Mt(l),u=l);if(u=null,Xe)return r;if(je){if(ze)for(d=fe.call(i.ownerDocument);i.firstChild;)d.appendChild(i.firstChild);else d=i;return(Le.shadowroot||Le.shadowrootmod)&&(d=me.call(o,d,!0)),d}var h=Ke?i.outerHTML:i.innerHTML;return Ke&&Ne["!doctype"]&&i.ownerDocument&&i.ownerDocument.doctype&&i.ownerDocument.doctype.name&&L(ne,i.ownerDocument.doctype.name)&&(h="<!DOCTYPE "+i.ownerDocument.doctype.name+">\n"+h),De&&(h=O(h,we," "),h=O(h,be," "),h=O(h,ke," ")),se&&Ve?se.createHTML(h):h},n.setConfig=function(e){yt(e),We=!0},n.clearConfig=function(){mt=null,We=!1},n.isValidAttribute=function(e,t,n){mt||yt({});var o=ve(e),r=ve(t);return Rt(o,r,n)},n.addHook=function(e,t){"function"==typeof t&&(ge[e]=ge[e]||[],E(ge[e],t))},n.removeHook=function(e){if(ge[e])return S(ge[e])},n.removeHooks=function(e){ge[e]&&(ge[e]=[])},n.removeAllHooks=function(){ge={}},n}return ae()}()}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var i=t[o]={exports:{}};return e[o].call(i.exports,i,i.exports,n),i.exports}(()=>{"use strict";var e=n(114);const t={keyCodesMac:{Minus:["-","_"],Equal:["=","+"],BracketLeft:["[","{"],BracketRight:["]","}"],Backslash:["\\","|"],Semicolon:[";",":"],Quote:["'",'"'],Comma:[",","<"],Period:[".",">"],Slash:["/","?"]},keyCodes:{ESC:27,backspace:8,deleteKey:46,enter:13,ctrlEnter:10,space:32,shiftKey:16,ctrlKey:17,f1:112,f12:123,comma:188,tab:9,downArrow:40,upArrow:38},modifierKeys:{16:"Shift",17:"Ctrl",18:"Alt",91:"Meta",92:"Meta",93:"ContextMenu",229:"Process"},keyNames:{8:"Backspace",9:"Tab",12:"NumLock",27:"Esc",32:"Space",46:"Delete"},keyIdentifierCorrectionMap:{"U+00C0":["U+0060","U+007E"],"U+0030":["U+0030","U+0029"],"U+0031":["U+0031","U+0021"],"U+0032":["U+0032","U+0040"],"U+0033":["U+0033","U+0023"],"U+0034":["U+0034","U+0024"],"U+0035":["U+0035","U+0025"],"U+0036":["U+0036","U+005E"],"U+0037":["U+0037","U+0026"],"U+0038":["U+0038","U+002A"],"U+0039":["U+0039","U+0028"],"U+00BD":["U+002D","U+005F"],"U+00BB":["U+003D","U+002B"],"U+00DB":["U+005B","U+007B"],"U+00DD":["U+005D","U+007D"],"U+00DC":["U+005C","U+007C"],"U+00BA":["U+003B","U+003A"],"U+00DE":["U+0027","U+0022"],"U+00BC":["U+002C","U+003C"],"U+00BE":["U+002E","U+003E"],"U+00BF":["U+002F","U+003F"]}};var o="Windows";function r(e,n){var o,r=0;return-1!==e.indexOf("Ctrl-")&&(r|=1),-1!==e.indexOf("Alt-")&&(r|=2),-1!==e.indexOf("Meta-")&&(r|=4),-1!==e.indexOf("Shift-")&&(r|=8),o=8192+((o=n.length>1?256+t.specialKeys.indexOf(n):n.charCodeAt(0))<<4)+r,String.fromCharCode(o)}"undefined"!=typeof navigator&&(-1!==navigator.platform.indexOf("Mac")?o="Mac":-1!==navigator.userAgent.indexOf("Linux")&&(o="Linux")),t.getKeyChar=function(e){var n;if(e.keyCode in this.modifierKeys)n="";else{if(this.keyNames.hasOwnProperty(e.keyCode))n="{0}".format(this.keyNames[e.keyCode]);else if(n=e.key||"",-1!==["Shift","Meta","Alt","Ctrl"].indexOf(n)&&(n=""),n)n.charCodeAt(0)>127||"Dead"===n?e.keyCode<127?(n=String.fromCharCode(e.keyCode),n=e.shiftKey?n:n.toLowerCase()):this.keyCodesMac.hasOwnProperty(e.code)&&(n=this.keyCodesMac[e.code][e.shiftKey?1:0]):"Unidentified"===n&&(n="");else if(e.keyIdentifier)if("U+"!==e.keyIdentifier.slice(0,2))n="{0}".format(e.keyIdentifier);else{var r=e.keyIdentifier;if(("Windows"===o||"Linux"===o)&&this.keyIdentifierCorrectionMap[r]){var i=this.keyIdentifierCorrectionMap[r];r=e.shiftKey?i[1]:i[0]}var a="0x"+r.substring(2);n=String.fromCharCode(parseInt(a)),n=e.shiftKey?n:n.toLowerCase()}e.shiftKey&&n.length>1&&(n="Shift-"+n),n.length>0&&(e.metaKey&&(n="Meta-"+n),e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n)),n.length>1&&(n="<{0}>".format(n))}return t.decodeKeystroke(t.encodeKeystroke(n))===n&&(n=t.encodeKeystroke(n)),n},t.isWordChar=function(e){return e.keyCode<123&&e.keyCode>=97||e.keyCode<91&&e.keyCode>=65||e.keyCode<58&&e.keyCode>=48},t.encodeKeystroke=function(e){for(var t,n=/<(?:Ctrl-)?(?:Alt-)?(?:Meta-)?(?:Shift-)?([^>]+|.)>/g,o="",i=0;null!==(t=n.exec(e));)o+=e.substr(i,t.index-i),o+=r(t[0],t[1]),i=n.lastIndex;return o+=e.substr(i)},t.specialKeys=["Esc","Space","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Backspace","Enter","Tab","Delete","End","Home","Insert","NumLock","PageDown","PageUp","Pause","ScrollLock","CapsLock","PrintScreen","Escape","Hyper"],t.decodeKeystroke=function(e){for(var n="",o=0;o<e.length;o++){var r=e[o].charCodeAt(0);if(r>8192){var i=(r-=8192)%4096>>4,a=15&r;r=r>>12?t.specialKeys[i%256]:String.fromCharCode(i),8&a&&(r="Shift-"+r),4&a&&(r="Meta-"+r),2&a&&(r="Alt-"+r),1&a&&(r="Ctrl-"+r),n+="<"+r+">"}else n+=e[o]}return n};const i=t;function a(e,t,n){void 0===n&&(n=document),n.dispatchEvent(new CustomEvent(`surfingkeys:${e}`,{detail:t}))}function s(e,t,n){(t=t||{}).action=e,-1!==["closeTab","nextTab","previousTab","moveTab","reloadTab","setZoom","closeTabLeft","closeTabRight","focusTabByIndex"].indexOf(e)&&(t.repeats=s.repeats,s.repeats=1);try{t.needResponse=void 0!==n,chrome.runtime.sendMessage(t,n),"read"===e&&d.on("onTtsEvent",n)}catch(e){a("front",["showPopup","[runtime exception] "+e])}}var c,l,u,d=(c={conf:{autoSpeakOnInlineQuery:!1,lastKeys:"",blocklistPattern:void 0,lurkingPattern:void 0,smartCase:!0,caseSensitive:!1,clickablePat:/(https?:\/\/|thunder:\/\/|magnet:)\S+/gi,clickableSelector:"",editableSelector:"div.CodeMirror-scroll,div.ace_content",cursorAtEndOfInput:!0,defaultSearchEngine:"g",defaultVoice:"Daniel",editableBodyCare:!0,enableAutoFocus:!0,enableEmojiInsertion:!1,experiment:!1,focusFirstCandidate:!1,focusOnSaved:!0,hintAlign:"center",hintExplicit:!1,hintShiftNonActive:!1,historyMUOrder:!0,language:void 0,lastQuery:"",modeAfterYank:"",nextLinkRegex:/(\b(next)\b)|下页|下一页|后页|下頁|下一頁|後頁|>>|»/i,digitForRepeat:!0,omnibarMaxResults:10,omnibarHistoryCacheSize:100,omnibarPosition:"middle",omnibarSuggestion:!0,omnibarSuggestionTimeout:200,omnibarTabsQuery:{},pageUrlRegex:[],prevLinkRegex:/(\b(prev|previous)\b)|上页|上一页|前页|上頁|上一頁|前頁|<<|«/i,richHintsForKeystroke:1e3,scrollStepSize:70,showModeStatus:!1,showProxyInStatusBar:!1,smartPageBoundary:!1,smoothScroll:!0,startToShowEmoji:2,stealFocusOnLoad:!0,tabsThreshold:100,verticalTabs:!0,textAnchorPat:/(^[\n\r\s]*\S{3,}|\b\S{4,})/g,ignoredFrameHosts:["https://tpc.googlesyndication.com"],scrollFriction:0,aceKeybindings:"vim",caretViewport:null,mouseSelectToQuery:[],useNeovim:!1,useLocalMarkdownAPI:!0}},l={},u=new Promise((function(e,t){window===top?e(window.location.href):s("getTopURL",null,(function(t){e(t.url)}))})),c.on=function(e,t){l[e]=t},c.updateHistory=function(e,t){var n=e+"History";s("getSettings",{key:n},(function(e){var o=e.settings[n]||[],r={};"Array"===t.constructor.name?(r[n]=t,s("updateSettings",{settings:r})):t.trim().length&&"."!==t&&((o=o.filter((function(e){return e.trim().length&&e!==t&&"."!==e}))).unshift(t),o.length>50&&o.pop(),r[n]=o,s("updateSettings",{settings:r}))}))},chrome.runtime.onMessage.addListener((function(e,t,n){l[e.subject]&&l[e.subject](e,t,n)})),c.getTopURL=function(e){u.then((function(t){e(t)}))},c.postTopMessage=function(e){u.then((function(t){window===top&&(t=window.location.origin),"null"!==t&&"file://"!==new URL(t).origin||(t="*"),top.postMessage({surfingkeys_uihost_data:e},t)}))},c.getCaseSensitive=function(e){return c.conf.caseSensitive||c.conf.smartCase&&/[A-Z]/.test(e)},c);function f(){if(-1!==window.navigator.userAgent.indexOf("Chrome"))return"Chrome";if(0===window.navigator.vendor.indexOf("Apple Computer, Inc.")){return/iPad|iPhone|iPod/.test(navigator.platform)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1?"Safari-iOS":"Safari"}return-1!==window.navigator.userAgent.indexOf("Firefox")?"Firefox":"Chrome"}function p(){return window!==top&&0===document.location.href.indexOf(chrome.runtime.getURL("/"))}function m(){var e=window.location.origin?window.location.origin:"*";return"file://"!==e&&"null"!==e||(e="*"),e}function h(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}function g(e,t,n){const o=[];let r;const i=document.createNodeIterator(e,t,null);for(;r=i.nextNode();)n(r)&&o.push(r),r.shadowRoot&&o.push(...g(r.shadowRoot,t,n));return o}function y(e){var t="a, button, select, input, textarea, summary, *[onclick], *[contenteditable=true], *.jfk-button, *.goog-flat-menu-button, *[role=button], *[role=link], *[role=menuitem], *[role=option], *[role=switch], *[role=tab], *[role=checkbox], *[role=combobox], *[role=menuitemcheckbox], *[role=menuitemradio]";return d.conf.clickableSelector.length&&(t+=", "+d.conf.clickableSelector),e.matches(t)||"pointer"===getComputedStyle(e).cursor||"url("===getComputedStyle(e).cursor.substr(0,4)||null!==e.closest("a, *[onclick], *[contenteditable=true], *.jfk-button, *.goog-flat-menu-button")}function v(e,t){a("front",["showBanner",e,t])}function w(e){a("front",["showPopup",e])}function b(e,t,n){const o={},r=n?{capture:!0}:{};return document.addEventListener(`surfingkeys:${e}`,(function(e){let r=e.detail;const i=r.shift();n&&r.push(e.target),o.hasOwnProperty(i)&&(o[i](...r),delete o[i]),t.hasOwnProperty(i)&&t[i](...r)}),r),o}function k(e,t,n){t.forEach((function(t){var o=new MouseEvent(t,{bubbles:!0,cancelable:!0,view:window,button:n?1:0});e.dispatchEvent(o)}))}function S(e){for(var t=e?e.target:document.activeElement;t&&t.shadowRoot;){if(!t.shadowRoot.activeElement){if(t.shadowRoot.querySelector("input, textarea, select")){t=t.shadowRoot.querySelector("input, textarea, select");break}break}t=t.shadowRoot.activeElement}return t===window&&(t=document.body),t}function E(){var e=S(),t=e.value;t.match(/^"|"$/)?e.value=t.replace(/^"?(.*?)"?$/,"$1"):e.value='"'+t+'"'}function x(e,t){chrome.storage.local.get(["logLevels"],(n=>{const o=n&&n.logLevels||["error"];-1!==["log","warn","error"].indexOf(e)&&-1!==o.indexOf(e)&&console[e](t)}))}function C(e){return e&&!e.disabled&&("textarea"===e.localName||"select"===e.localName||e.isContentEditable||e.matches&&e.matches(d.conf.editableSelector)||"input"===e.localName&&/^(?!button|checkbox|file|hidden|image|radio|reset|submit)/i.test(e.type))}function T(e,t){e=encodeURIComponent(e),t="%23%23+Error+details%0A%0A{0}%0A%0ASurfingKeys%3A+{1}%0A%0AChrome%3A+{2}%0A%0AURL%3A+{3}%0A%0A%23%23+Context%0A%0A%2A%2APlease+replace+this+with+a+description+of+how+you+were+using+SurfingKeys.%2A%2A".format(encodeURIComponent(t),chrome.runtime.getManifest().version,encodeURIComponent(navigator.userAgent),encodeURIComponent(window.location.href)),w('<h2>Uh-oh! The SurfingKeys extension encountered a bug.</h2> <p>Please click <a href="https://github.com/brookhong/Surfingkeys/issues/new?title={0}&body={1}" target=_blank>here</a> to start filing a new issue, append a description of how you were using SurfingKeys before this message appeared, then submit it.  Thanks for your help!</p>'.format(e,t))}function O(e,t){e.scrollIntoViewIfNeeded?e.scrollIntoViewIfNeeded():_(e,t)||e.scrollIntoView()}function N(e,t){var n=C(e)?1:4;return(t=t||e.getBoundingClientRect()).width>n&&t.height>n}function _(e,t){var n=e.getBoundingClientRect(),o=window.innerHeight||document.documentElement.clientHeight,r=window.innerWidth||document.documentElement.clientWidth;return(t||N(e,n))&&n.top<o&&n.bottom>0&&n.left<r&&n.right>0}function L(e){for(var t=Array.from(document.documentElement.getElementsByTagName("*")),n=[],o=0;o<t.length;o++){var r=t[o];if(r.shadowRoot)for(var i=r.shadowRoot.querySelectorAll("*"),a=0;a<i.length;a++)t.push(i[a]);var s=r.getBoundingClientRect();s.top<=window.innerHeight&&s.bottom>=0&&s.left<=window.innerWidth&&s.right>=0&&s.height>0&&"hidden"!==getComputedStyle(r).visibility&&e(r,n)}return n}function A(e){var t=document.getSelection(),n=[t.type,t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset],o=document.scrollingElement.scrollTop;e(t),document.scrollingElement.scrollTop=o,"None"===n[0]?t.empty():"Caret"===n[0]?t.setPosition(n[3],n[4]):"Range"===n[0]&&(t.setPosition(n[1],n[2]),t.extend(n[3],n[4]))}function R(e){if(0===e.length)return e;var t=[];return e.forEach((function(e,n){if(M(e))t.push(e);else{for(var o=0;o<t.length;o++){if(t[o].contains(e))return void("A"===t[o].tagName&&t[o].href||(t[o]=e));if(t[o].shadowRoot&&t[o].shadowRoot.contains(e))return;if(e.contains(t[o]))return void console.log("skip: ",e,t[o])}t.push(e)}})),t}function I(e){var t;return 0===e.childElementCount?3===(t=e.getClientRects()).length?t[1]:2===t.length?t[0]:e.getBoundingClientRect():1===e.childElementCount&&e.firstElementChild.textContent?(((t=e.firstElementChild.getBoundingClientRect()).width<4||t.height<4)&&(t=e.getBoundingClientRect()),t):e.getBoundingClientRect()}function M(e){return d.conf.clickableSelector&&e.matches(d.conf.clickableSelector)}function P(e){return R(e=e.filter((function(e){var t=I(e);if(e.disabled||e.readOnly||!N(e,t))return!1;if(e.matches("input, textarea, select, form")||"true"===e.contentEditable||M(e))return!0;var n=e.getRootNode().elementFromPoint(t.left+t.width/2,t.top+t.height/2);return!n||n.shadowRoot&&(0===n.childElementCount||n.shadowRoot.contains(e))||n.contains(e)||e.contains(n)})))}function U(e,t){return P(g(document.body,NodeFilter.SHOW_ELEMENT,(function(n){return n.offsetHeight&&n.offsetWidth&&"pointer"===getComputedStyle(n).cursor&&(n.matches(e)||t&&(t.test(n.textContent)||t.test(n.getAttribute("aria-label"))))})))}function F(e,t,n){var o=["script","style","noscript","surfingkeys_mark"],r=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode:function(e){if(!e.data.trim()||!e.parentNode.offsetParent||-1!==o.indexOf(e.parentNode.localName.toLowerCase())||!t.test(e.data))return t.lastIndex=0,NodeFilter.FILTER_REJECT;var n=e.parentNode.getBoundingClientRect();return n.width<4||n.height<4?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}},!1),i=[];if(1===n)i.push(r.firstChild());else if(-1===n)i.push(r.lastChild());else{if(0===n)return r;if(2===n)for(;r.nextNode();)i.push(r.currentNode.parentNode);else for(;r.nextNode();)i.push(r.currentNode)}return i}function H(e,t,n){var o=document.getSelection();o.setBaseAndExtent(e,t,e,n?t+n:e.data.length);var r=o.getRangeAt(0).getClientRects()[0],i={left:-1,top:-1};return r&&r.height>0&&r.width>0&&(i.left=r.left,i.top=r.top,i.width=r.width,i.height=r.height),i}var D=document.createRange();function B(){let e=[];try{let t=arguments[1];for(;0===e.length&&t>=0;)D.setStart(arguments[0],t),arguments.length>3?D.setEnd(arguments[2],arguments[3]):arguments.length>2?D.setEnd(arguments[0],arguments[2]):D.setEnd(arguments[0],arguments[1]),e=D.getClientRects(),t--}catch(e){return[]}return e}function K(e){let t=e.focusNode.parentElement;O(t,!0);var n=B(e.focusNode,e.focusOffset)[0];return n||(n=e.focusNode.getBoundingClientRect()),n?(((n={left:n.left,top:n.top,width:n.width,height:n.height}).left<0||n.left>=window.innerWidth)&&(t.scrollLeft+=n.left-window.innerWidth/2,n.left=window.innerWidth/2),(n.top<0||n.top>=window.innerHeight)&&(t.scrollTop+=n.top-window.innerHeight/2,n.top=window.innerHeight/2),n):null}var W=null;function q(e){var t=document.getSelection();if(t.focusNode&&t.focusNode.textContent){var n=function(e,t){var n=[0,e.length],o=/\W/;t<0?t=0:t>=e.length&&(t=e.length-1);var r=!0;if(o.test(e[t])){var i=0;for(r=!1;!r&&(t>i||t+i<e.length);)r=t-++i>=0&&!o.test(e[t-i])||t+i<e.length&&!o.test(e[t+i]);t=t-i>=0&&!o.test(e[t-i])?t-i:t+i}if(r){for(var a=t,s=t;a>=0&&!o.test(e[a]);)a--;for(;s<e.length&&!o.test(e[s]);)s++;n=[a+1,s-a-1]}return n}(t.focusNode.textContent,t.focusOffset),o=B(t.focusNode,n[0],n[0]+n[1])[0],r=t.focusNode.textContent.substr(n[0],n[1]);if(o&&r&&(!e||W&&o.has(W[0],W[1],0,0)))return r.trim()}return null}function j(e){var t=d.conf.language||window.navigator.language;"en-US"===t?e((function(e){return e})):fetch(chrome.runtime.getURL("pages/l10n.json")).then((function(e){return e.json()})).then((function(n){"object"==typeof n[t]?(n=n[t],e((function(e){return n[e]?n[e]:e}))):e((function(e){return e}))}))}function z(e){var t=e.annotation.match(/#(\d+)(.*)/);return null!==t&&(e.feature_group=parseInt(t[1]),e.annotation=t[2]),e}function V(e,t,n,o){n=i.encodeKeystroke(n);var r=e.mappings.find(n);if(r){t=i.encodeKeystroke(t),e.mappings.remove(t);var s=Object.assign({},r.meta);o&&(s=Object.assign(s,z({annotation:o}))),e.mappings.add(t,s),p()||a("front",["addMapkey",e.name,t,n])}return r}function G(e){return e.getWords().map((function(t){var n=e.find(t).meta;return{word:t,feature_group:n.feature_group,annotation:n.annotation}})).filter((function(e){return e.annotation&&e.annotation.length>0}))}function $(e,t){var n;t=t||5,(n=(n="Array"===e.constructor.name?e:e instanceof NodeList?Array.from(e).map((function(e){return e.href})):e.trim().split("\n")).map((function(e){return e.trim()})).filter((function(e){return e.length>0}))).slice(0,t).forEach((function(e){s("openLink",{tab:{tabbed:!0},url:e})})),n.length>t&&s("queueURLs",{urls:n.slice(t)})}function Q(e){return e.filter((function(e){return e.offsetHeight&&e.offsetWidth&&!e.getAttribute("disabled")&&_(e)&&"hidden"!==getComputedStyle(e).visibility}))}function Y(t,n){t.innerHTML=e.sanitize(n)}function X(e,t,n){var o=document.createElement(e);if(t&&Y(o,t),n)for(var r in n)o.setAttribute(r,n[r]);return o}document.addEventListener("mousedown",(e=>{W=[e.clientX,e.clientY]})),DOMRect.prototype.has=function(e,t,n,o){return t>this.top-o&&t<this.bottom+o&&e>this.left-n&&e<this.right+n},String.prototype.format=function(){for(var e=this,t=0;t<arguments.length;t++){var n=new RegExp("\\{"+t+"\\}","gi");e=e.replace(n,arguments[t])}return e},String.prototype.reverse=function(){return this.split("").reverse().join("")},RegExp.prototype.toJSON=function(){return{source:this.source,flags:this.flags}},Array.prototype.flatMap||(Array.prototype.flatMap=function(e){return Array.prototype.concat.apply([],this.map(e))});var J=document.createElement("div");function Z(e){return J.innerText=e,J.innerHTML}HTMLElement.prototype.one=function(e,t){this.addEventListener(e,(function n(){t.call(this),this.removeEventListener(e,n)}))},HTMLElement.prototype.show=function(){this.style.display=""},HTMLElement.prototype.hide=function(){this.style.display="none"},HTMLElement.prototype.removeAttributes=function(){for(;this.attributes.length>0;)this.removeAttribute(this.attributes[0].name)},HTMLElement.prototype.containsWithShadow=function(e){const t=[this];for(;t.length;){const n=t.shift();if(n.contains(e))return!0;if(t.push(...n.children),n.shadowRoot){if(n.shadowRoot.contains(e))return!0;t.push(...n.shadowRoot.children)}}return!1},NodeList.prototype.remove=function(){this.forEach((function(e){e.remove()}))},NodeList.prototype.show=function(){this.forEach((function(e){e.show()}))},NodeList.prototype.hide=function(){this.forEach((function(e){e.hide()}))};const ee=X("div","",{style:"position: fixed; box-shadow: 0px 0px 4px 2px #63b2ff; background: transparent; z-index: 2140000000"});function te(e,t){var n=I(e);ee.style.left=n.left+"px",ee.style.top=n.top+"px",ee.style.width=n.width+"px",ee.style.height=n.height+"px",document.body.appendChild(ee),setTimeout((()=>{ee.remove(),t()}),100)}function ne(e,t){const n={candidates:0};if(t.length>0)for(const o of e){const e=o.label;if(t===e){n.matched=o.link;break}0===e.indexOf(t)?(o.style.opacity=1,Y(o,`<span style="opacity: 0.2;">${t}</span>`+e.substr(t.length)),n.candidates++):o.style.opacity=0}else if(1===e.length)n.matched=e[0].link;else{for(const t of e)t.style.opacity=1,Y(t,t.label);n.candidates=e.length}return n}var oe=[];const re=function(e,t){this.name=e,this.statusLine=t,this.eventListeners={},this.addEventListener=function(e,t){return this.eventListeners[e]=t,ue.hasOwnProperty(e)||(ue[e]=function(t){se(e,t)},window.addEventListener(e,ue[e],!0)),this},this.enter=function(e,t){var n=oe.indexOf(this);if(this.priority||(this.priority=e||oe.length),-1===n)oe.unshift(this);else if(n>0)if(t)oe=oe.slice(n);else{var o=oe.map((function(e){return e.name})).join(",");T("Mode {0} pushed into mode stack again.".format(this.name),"Modes in stack: {0}".format(o))}return oe.sort((function(e,t){return e.priority<t.priority?1:t.priority<e.priority?-1:0})),this.onEnter&&this.onEnter(),re.showStatus(),n},this.exit=function(e){var t=oe.indexOf(this);if(-1!==t)if(this.priority=0,e)oe.splice(t,1);else{t++;oe.slice(0,t);oe=oe.slice(t)}re.showStatus(),this.onExit&&this.onExit(t)}};re.getCurrent=()=>oe[0],re.specialKeys={"<Alt-s>":["<Alt-s>"],"<Esc>":["<Esc>"]},re.isSpecialKeyOf=function(e,t){return-1!==re.specialKeys[e].indexOf(i.decodeKeystroke(t))};var ie=[];function ae(e,t){t.sk_stopPropagation&&(t.stopImmediatePropagation(),t.preventDefault())}function se(e,t,n){for(var o=0;o<oe.length&&!t.sk_stopPropagation;o++){var r=oe[o];if(!t.sk_suppressed&&r.eventListeners.hasOwnProperty(e))(0,r.eventListeners[e])(t),ae(0,t);if("Disabled"===r.name)break;n&&n(r)}}re.suppressKeyUp=function(e){-1===ie.indexOf(e)&&ie.push(e)};let ce=0;var le=0,ue={sentinel:e=>{ce++},keydown:function(e){if(e.sk_keyName=i.getKeyChar(e),0===oe.length&&window!==top)return a("iframeBoot"),void document.addEventListener("surfingkeys:userSettingsLoaded",(()=>{se("keydown",e)}),{once:!0});se("keydown",e)},keyup:function(e){se("keyup",e,(function(t){var n=ie.indexOf(e.keyCode);-1!==n&&(e.stopImmediatePropagation(),ie.splice(n,1))}))},scroll:function(e){le>0&&(e.stopImmediatePropagation(),e.preventDefault(),le--)}};function de(e){for(var t in oe=[],ue)window.addEventListener(t,ue[t],!0);e&&e()}re.hasScroll=function(e,t,n){var o="y"===t?["scrollTop","height"]:["scrollLeft","width"],r=e[o[0]];if(r<n){var i=e[o[0]];e[o[0]]=e.getBoundingClientRect()[o[1]],(r=e[o[0]])!==i&&le++,e[o[0]]=i}return r>=n},re.getScrollableElements=function(){var e=g(document.body,NodeFilter.SHOW_ELEMENT,(function(e){return re.hasScroll(e,"y",16)&&e.scrollHeight>200||re.hasScroll(e,"x",16)&&e.scrollWidth>200}));return e.sort((function(e,t){return t.contains(e)?1:e.contains(t)?-1:t.scrollHeight*t.scrollWidth-e.scrollHeight*e.scrollWidth})),document.scrollingElement&&(document.scrollingElement.scrollHeight>window.innerHeight||document.scrollingElement.scrollWidth>window.innerWidth)&&e.unshift(document.scrollingElement),e},re.init=e=>{"about:blank"!==window.location.href||!window.frameElement||document.body&&0!==document.body.childElementCount?de(e):window.frameElement.addEventListener("load",(function(t){try{de(e)}catch(e){console.log("Error on blank iframe loaded: "+e)}}))},re.showStatus=function(){if(document.hasFocus()&&oe.length){var e=oe[0],t=e.statusLine||(d.conf.showModeStatus?e.name:"");if(""!==t&&window!==top&&!p()){var n=window.location.pathname.split("/");n.length&&(t+=" - frame: "+n[n.length-1])}a("front",["showStatus",[t]])}},re.finish=function(e){var t=!1;return(e.map_node!==e.mappings||null!=e.pendingMap||e.repeats)&&(e.map_node=e.mappings,e.pendingMap=null,e.isTrustedEvent&&a("front",["hideKeystroke"]),e.repeats&&(e.repeats=""),t=!0),t},re.handleMapKey=function(e,t){var n=e.sk_keyName;this.isTrustedEvent=this.__trust_all_events__||e.isTrusted;var o=re.isSpecialKeyOf("<Esc>",n);o&&(n=i.encodeKeystroke("<Esc>"));var r=!1;if(o&&re.finish(this))e.sk_stopPropagation=!0,e.sk_suppressed=!0,r=!0;else if(this.pendingMap){this.setLastKeys&&this.setLastKeys(this.map_node.meta.word+n);var c=this.pendingMap.bind(this);e.sk_stopPropagation=!this.map_node.meta.stopPropagation||this.map_node.meta.stopPropagation(n),c(n),r=re.finish(this)}else if(void 0!==this.repeats&&this.map_node===this.mappings&&d.conf.digitForRepeat&&(n>="1"||""!==this.repeats&&n>="0")&&n<="9"&&this.map_node.getWords().length>0)this.repeats+=n,this.isTrustedEvent&&a("front",["showKeystroke",n,this]),e.sk_stopPropagation=!0;else{var l=this.map_node;if(this.map_node=this.map_node.find(n),this.map_node)if(this.map_node.meta){var u=this.map_node.meta.code;if(u.length)this.pendingMap=u,this.isTrustedEvent&&a("front",["showKeystroke",n,this]),e.sk_stopPropagation=!0;else{for(this.setLastKeys&&this.setLastKeys(this.map_node.meta.word),s.repeats=parseInt(this.repeats)||1,e.sk_stopPropagation=!this.map_node.meta.stopPropagation||this.map_node.meta.stopPropagation(n);s.repeats>0;)u(),s.repeats--;r=re.finish(this)}}else this.isTrustedEvent&&a("front",["showKeystroke",n,this]),e.sk_stopPropagation=!0;else t&&t(l),e.sk_suppressed=l!==this.mappings,r=re.finish(this)}return r},re.checkEventListener=e=>{const t=ce;window.dispatchEvent(new CustomEvent("sentinel")),t===ce&&(de(),e())};const fe=re;function pe(){arguments.length>0&&(this.stem=arguments[0]),arguments.length>1&&(this.meta=arguments[1])}pe.prototype={find:function(e){for(var t=this,n=e.length,o=0;o<n&&t;o++)t=t[e[o]];return t},add:function(e,t){for(var n=this,o=e.length,r=0;r<o;r++){var i=e[r];if(n.hasOwnProperty(i))n=n[i];else{var a=new pe(i);n[i]=a,n=a}}t.word=e,n.meta=t},remove:function(e){for(var t=this,n=e.length,o=[],r=0;r<n&&t;r++)o.push(t),t=t[e[r]];if(t){var i=o[r=o.length-1];delete i[t.stem];for(var a=i;a!==this&&1===Object.keys(a).length;)delete(i=o[--r])[a.stem],a=i}return t},getWords:function(e,t){var n=[];e=(e||"")+(t?"":this.stem||"");for(var o in this.hasOwnProperty("meta")&&n.push(e),this)1===o.length&&(n=n.concat(this[o].getWords(e)));return n},getMetas:function(e){var t=[];for(var n in this.hasOwnProperty("meta")&&e(this.meta)&&t.push(this.meta),this)1===n.length&&(t=t.concat(this[n].getMetas(e)));return t},getPrefixWord:function(){if(0===Object.keys(this).length)return"";for(var e="",t=this.stem,n=this;""===e;)for(var o=Object.keys(n),r=0;r<o.length;r++){if("meta"===o[r]){e=n.meta.word;break}if("stem"!==o[r]){t+=o[r],n=n[o[r]];break}}return e.substr(0,e.length-t.length+1)}};const me=pe;const he=function(e){var t=new fe("Normal");t.mappings=new me,t.map_node=t.mappings;var n=!1;let o;t.passFocus=function(e){n=e},t.startLurk=()=>{let e="lurking";return o?fe.getCurrent()!==o&&(e="enabled"):(t.exit(),o=function(e){const t=new fe("Lurk");function n(){e.enter(),window===top&&s("setSurfingkeysIcon",{status:"enabled"})}return t.mappings=new me,t.map_node=t.mappings,t.mappings.add(i.encodeKeystroke("<Alt-i>"),{annotation:"Enter normal mode",feature_group:16,code:n}),t.mappings.add("p",{annotation:"Enter ephemeral normal mode to temporarily enable SurfingKeys",feature_group:16,code:function(){n(),setTimeout((()=>{e.revertToLurk()}),1e3)}}),t.addEventListener("keydown",(function(e){!C(S(e))&&e.sk_keyName.length&&(fe.handleMapKey.call(t,e),e.sk_stopPropagation&&fe.suppressKeyUp(e.keyCode))})),t}(t),r.forEach((e=>{V(o,e[0],e[1]),o.mappings.remove(i.encodeKeystroke(e[1]))})),r=void 0,o.enter(0,!0)),e},t.revertToLurk=()=>{t.exit(!0),window===top&&s("setSurfingkeysIcon",{status:"lurking"})},t.getLurkMode=()=>o;let r=[];t.addLurkMap=(e,t)=>{r.push([e,t])};var c=!1;t.addEventListener("keydown",(function(n){var r=S(n);if(C(r)&&N(r)&&n.isTrusted)if(fe.isSpecialKeyOf("<Esc>",n.sk_keyName))r.blur(),e.exit();else if(d.conf.editableBodyCare&&r===document.body&&"i"!==n.key)t.statusLine="Press i to enter Insert mode",d.conf.showModeStatus=!0,n.sk_keyName.length&&fe.handleMapKey.call(t,n);else{n.sk_stopPropagation=d.conf.editableBodyCare&&r===document.body&&"i"===n.key,n.sk_stopPropagation&&(t.passFocus(!0),r.focus());var i=!1;if(!_(r)){for(var a=r;a!==document.documentElement&&!a.newlyCreated;)a=a.parentElement;i=a!==document.documentElement&&a.newlyCreated}i?(r.blur(),delete a.newlyCreated,fe.handleMapKey.call(t,n)):e.enter(r,!0)}else if(fe.isSpecialKeyOf("<Alt-s>",n.sk_keyName))t.toggleBlocklist(),fe.finish(t),n.sk_stopPropagation=!0;else if(n.sk_keyName.length){var s=fe.handleMapKey.call(t,n,(()=>{fe.isSpecialKeyOf("<Esc>",n.sk_keyName)&&o&&t.revertToLurk()}));c&&s&&(c=!1,t.exit())}n.sk_stopPropagation&&fe.suppressKeyUp(n.keyCode)})),t.addEventListener("blur",(function(e){m=0})),t.addEventListener("focus",(function(e){if(fe.showStatus(),d.conf.stealFocusOnLoad&&!p()){var t=S(e);C(t)&&(n||t.enableAutoFocus?d.conf.enableAutoFocus||(n=!1):(t.blur(),e.sk_stopPropagation=!0))}})),t.addEventListener("keyup",(function(e){setTimeout((function(){m=0}),0)})),t.addEventListener("mousedown",(function(n){d.conf.enableAutoFocus?t.passFocus(!0):t.passFocus(n.isTrusted);var o=S(n);C(o)?e.enter(o,!0):e.exit()})),t.toggleBlocklist=function(){0!==document.location.href.indexOf(chrome.runtime.getURL("/"))?s("toggleBlocklist",{blocklistPattern:d.conf.blocklistPattern?d.conf.blocklistPattern:""},(function(e){"disabled"===e.state?e.blocklist.hasOwnProperty(".*")?v("Surfingkeys is globally disabled, please enable it globally from popup menu.",3e3):v("Surfingkeys turned OFF for "+e.url,3e3):v("Surfingkeys turned ON for "+e.url,3e3)})):v("You could not toggle Surfingkeys on its own pages.",3e3)};const l=function(){var e,t,n=new fe("PassThrough");return n.addEventListener("keydown",(function(o){o.sk_suppressed=!0,fe.isSpecialKeyOf("<Esc>",o.sk_keyName)?(n.exit(),o.sk_stopPropagation=!0):t>0&&(e&&(clearTimeout(e),e=void 0),e=setTimeout((function(){n.exit()}),t))})).addEventListener("mousedown",(function(e){e.sk_suppressed=!0})),n.addEventListener("focus",(function(e){e.sk_suppressed=!0})),n.onEnter=function(){t>0?(e=setTimeout((function(){n.exit()}),t),n.statusLine=`ephemeral(${t}ms) pass through`):n.statusLine="pass through"},n.setTimeout=function(e){t=e},n}();t.passThrough=function(e){return l.setTimeout(e),l.enter(),l},t.once=()=>{c=!0,t.enter()},t.mappings.add(i.encodeKeystroke("<Alt-i>"),{annotation:"Enter PassThrough mode to temporarily suppress SurfingKeys",feature_group:0,code:function(){t.passThrough()}}),t.mappings.add("p",{annotation:"Enter ephemeral PassThrough mode to temporarily suppress SurfingKeys",feature_group:0,code:function(){t.passThrough(1e3)}}),t.repeats="";var u,f,m=0,h=0,g=[];function b(){u&&0!==u.length||((u=fe.getScrollableElements()).forEach((function(e){e.removeEventListener("mousedown",k),e.addEventListener("mousedown",k),e.dataset.hint_scrollable=!0})),h=0)}function k(e){if(e.currentTarget.contains(e.target)){for(var t=u.lastIndexOf(e.target),n=u.length-1;n>=0&&-1===t;n--)u[n]!==document.body&&u[n].contains(e.target)&&(t=n);-1!==t&&(h=t)}}function E(){s("localData",{data:{lastKeys:f}})}t.highlightElement=function(e){var t;a("front",["highlightElement",{duration:200,rect:{top:(t=document.scrollingElement===e?{top:0,left:0,width:window.innerWidth,height:window.innerHeight}:e.getBoundingClientRect()).top,left:t.left,width:t.width,height:t.height}}])},t.scroll=function(e){b();var n=document.scrollingElement;if(u.length>0&&(n=u[h])!==document.scrollingElement&&n!==document.body){var o=n.getBoundingClientRect();0!==o.width&&0!==o.height&&_(n)&&(fe.hasScroll(n,"x",16)||fe.hasScroll(n,"y",16))||(t.refreshScrollableElements(),n=u[h])}if(n||document.scrollingElement||!document.body||(document.body.style.overflow="visible",n=document.scrollingElement),n){var r;n.skScrollBy||((r=n).skScrollBy=function(e,t){if(d.conf.smartPageBoundary&&(this===document.scrollingElement||1===u.length&&this===u[0])){if(0===this.scrollTop&&t<0)return a("hints",["topBoundaryHit"]);if(this.scrollHeight-this.scrollTop<=this.clientHeight+1&&t>0)return a("hints",["bottomBoundaryHit"])}if(s.repeats>1&&(e=s.repeats*e,t=s.repeats*t,s.repeats=0),d.conf.smoothScroll){var n=Math.max(100,20*Math.log(Math.abs(e||t)));r.smoothScrollBy(e,t,n)}else a("hints",["scrollStarted"]),r.scrollBy({behavior:"instant",left:e,top:t}),a("hints",["scrollDone"])},r.safeScroll_=(e,t,n)=>{const o=r===document.scrollingElement?window.innerHeight:r.clientHeight,i=r===document.scrollingElement?window.innerWidth:r.clientWidth,a="scrollTop"===e?[0,r.scrollHeight-o]:[0,r.scrollWidth-i],s=n?a[1]:a[0];return t>=a[0]&&t<=a[1]?(r[e]=t,!1):(r[e]=s,!0)},r.smoothScrollBy=function(e,t,n){if(!m){var[o,i]=t?["scrollTop",t]:["scrollLeft",e],s=n,c=0,l=r[o],u=!1;function f(e){if(0===c)return c=e,a("hints",["scrollStarted"]),window.requestAnimationFrame(f);var t=r[o],n=(e-c)*i/s;let p=!1;Math.abs(t+n-l)>=Math.abs(i)?(u=!0,m>d.conf.scrollFriction?(p=r.safeScroll_(o,t+n,i>0),l=r[o]):m>0?m++:p=r.safeScroll_(o,l+i,i>0)):p=r.safeScroll_(o,t+n,i>0),c=e,m||!p&&!u?window.requestAnimationFrame(f):(r.style.scrollBehavior="",a("hints",["scrollDone"]))}m=1,r.style.scrollBehavior="auto",window.requestAnimationFrame(f)}},g.push(r));var i=n===document.scrollingElement?[window.innerWidth,window.innerHeight]:[n.offsetWidth,n.offsetHeight];switch(n.lastScrollTop=n.scrollTop,n.lastScrollLeft=n.scrollLeft,e){case"down":n.skScrollBy(0,d.conf.scrollStepSize);break;case"up":n.skScrollBy(0,-d.conf.scrollStepSize);break;case"pageDown":n.skScrollBy(0,Math.round(i[1]/2));break;case"fullPageDown":n.skScrollBy(0,i[1]);break;case"pageUp":n.skScrollBy(0,-Math.round(i[1]/2));break;case"fullPageUp":n.skScrollBy(0,-i[1]);break;case"top":n.skScrollBy(0,-n.scrollTop);break;case"bottom":n.skScrollBy(n.scrollLeft,n.scrollHeight-n.scrollTop);break;case"left":n.skScrollBy(-Math.round(d.conf.scrollStepSize/2),0);break;case"right":n.skScrollBy(Math.round(d.conf.scrollStepSize/2),0);break;case"leftmost":n.skScrollBy(-n.scrollLeft-10,0);break;case"rightmost":n.skScrollBy(n.scrollWidth-n.scrollLeft-i[0]+20,0);break;case"byRatio":var c=parseInt(s.repeats*n.scrollHeight/100)-i[1]/2-n.scrollTop;s.repeats=0,n.skScrollBy(0,c)}a("observer",["turnOff"])}},t.refreshScrollableElements=function(){return u=null,b(),u},t.addScrollableElement=function(e){u&&(e.contains(u[h])||-1!==u.indexOf(e))||(b(),u.push(e),h=u.length-1)},t.rotateFrame=function(){s("nextFrame",{frameId:window.frameId})},t.feedkeys=function(e){setTimeout((function(){for(var n=new Event("keydown"),o=0;o<e.length;o++)n.sk_keyName=e[o],fe.handleMapKey.call(t,n)}),1)},t.setLastKeys=function(e){!this.map_node.meta.repeatIgnore&&e.length>1&&(f=[e],E())},t.appendKeysForRepeat=function(e,t){f&&f.length>0&&(f.push("{0}\t{1}".format(e,t)),E())},t.addVIMark=function(e,t){t=t||window.location.href;var n={};n[e]={url:t,scrollLeft:document.scrollingElement.scrollLeft,scrollTop:document.scrollingElement.scrollTop},s("addVIMark",{mark:n}),v("Mark '{0}' added for: {1}.".format(e,t))},t.jumpVIMark=function(e){if("'"===e){let e=document.scrollingElement;if(b(),u.length>0&&(e=u[h],void 0!==e.lastScrollTop&&void 0!==e.lastScrollLeft)){const t=e.scrollTop,n=e.scrollLeft;e.scrollTop=e.lastScrollTop,e.scrollLeft=e.lastScrollLeft,e.lastScrollTop=t,e.lastScrollLeft=n}}else s("jumpVIMark",{mark:e})},t.moveTab=function(e){s("moveTab",{position:e})},t.captureElement=function(e){s("getCaptureSize",null,(function(t){var n=t.width/window.innerWidth;e.scrollTop=0,e.scrollLeft=0;var o=-1,r=-1,i=e.style.overflowY;e.style.overflowY="hidden";var c=e.style.overflowX;e.style.overflowX="hidden";var l=e.style.borderStyle;e.style.borderStyle="none",a("front",["toggleStatus",!1]);var u,d,f,p,m,h,g=0,y=0,v=e.scrollHeight,b=e.scrollWidth;if(e===document.scrollingElement)m=window.innerWidth,h=window.innerHeight,u=0,d=0;else{var k=e.getBoundingClientRect(),S=[Math.max(k.left,0),Math.max(k.top,0),Math.min(k.right,window.innerWidth),Math.min(k.bottom,window.innerHeight)];m=S[2]-S[0],h=S[3]-S[1],u=S[0]*n,d=S[1]*n}f=m*n,p=h*n;var E=document.createElement("canvas");E.width=b*n,E.height=v*n;var x=E.getContext("2d"),C=(k=e.getBoundingClientRect(),document.createElement("img"));C.onload=function(){x.drawImage(C,u,d,f,p,g,y,f,p),o===e.scrollTop?r===e.scrollLeft?(a("front",["toggleStatus",!0]),w("<img src='{0}' />".format(E.toDataURL("image/png"))),e.style.overflowY=i,e.style.overflowX=c,e.style.borderStyle=l):(o=-1,e.scrollTop=0,y=0,r=e.scrollLeft,e.scrollLeft+2*m<b?(e.scrollLeft+=m,g+=m*n):(e.scrollLeft+=b%m,g=e.scrollLeft*n),setTimeout((function(){s("captureVisibleTab",null,(function(e){C.src=e.dataUrl}))}),1e3)):(o=e.scrollTop,e.scrollTop+2*h<v?(e.scrollTop+=h,y+=h*n):(e.scrollTop+=v%h,y=e.scrollTop*n),setTimeout((function(){s("captureVisibleTab",null,(function(e){C.src=e.dataUrl}))}),1e3))},setTimeout((function(){s("captureVisibleTab",null,(function(e){C.src=e.dataUrl}))}),500)}))},t.mappings.add("yG",{annotation:"Capture current full page",feature_group:7,code:function(){t.captureElement(document.scrollingElement)}}),t.mappings.add("yS",{annotation:"Capture scrolling element",feature_group:7,code:function(){var e=document.scrollingElement;b(),u.length>0&&(e=u[h]),t.captureElement(e)}}),t.mappings.add("cS",{annotation:"Reset scroll target",feature_group:2,code:function(){if(u=null,b(),u.length>0){var e=u[h];t.highlightElement(e)}}});const x=e=>{const n=t.scroll.bind(t,e);return n.isSKScrollInHints=!0,n};function T(e){-1===d.conf.mouseSelectToQuery.indexOf(window.origin)||y(e.target)||e.target.matches(".cm-matchhighlight")||setTimeout((()=>{a("front",["querySelectedWord"])}),1)}t.isScrollKeyInHints=e=>{const n=t.mappings[e];return n&&n.meta&&n.meta.code&&n.meta.code.isSKScrollInHints},t.mappings.add("e",{annotation:"Scroll half page up",feature_group:2,repeatIgnore:!0,code:t.scroll.bind(t,"pageUp")}),t.mappings.add("U",{annotation:"Scroll full page up",feature_group:2,repeatIgnore:!0,code:t.scroll.bind(t,"fullPageUp")}),t.mappings.add("d",{annotation:"Scroll half page down",feature_group:2,repeatIgnore:!0,code:t.scroll.bind(t,"pageDown")}),t.mappings.add("P",{annotation:"Scroll full page down",feature_group:2,repeatIgnore:!0,code:t.scroll.bind(t,"fullPageDown")}),t.mappings.add("gg",{annotation:"Scroll to the top of the page",feature_group:2,repeatIgnore:!0,code:t.scroll.bind(t,"top")}),t.mappings.add("G",{annotation:"Scroll to the bottom of the page",feature_group:2,repeatIgnore:!0,code:x("bottom")}),t.mappings.add("j",{annotation:"Scroll down",feature_group:2,repeatIgnore:!0,code:x("down")}),t.mappings.add("k",{annotation:"Scroll up",feature_group:2,repeatIgnore:!0,code:x("up")}),t.mappings.add("h",{annotation:"Scroll left",feature_group:2,repeatIgnore:!0,code:x("left")}),t.mappings.add("l",{annotation:"Scroll right",feature_group:2,repeatIgnore:!0,code:x("right")}),t.mappings.add("0",{annotation:"Scroll all the way to the left",feature_group:2,repeatIgnore:!0,code:x("leftmost")}),t.mappings.add("$",{annotation:"Scroll all the way to the right",feature_group:2,repeatIgnore:!0,code:x("rightmost")}),t.mappings.add("%",{annotation:"Scroll to percentage of current page",feature_group:2,repeatIgnore:!0,code:t.scroll.bind(t,"byRatio")}),t.mappings.add("cs",{annotation:"Change scroll target",feature_group:2,repeatIgnore:!0,code:function(){!function(e){if((u=fe.getScrollableElements()).length>0){h=(h+1)%u.length;var n=u[h];O(n),e||t.highlightElement(n)}}()}}),t.mappings.add("/",{annotation:"Find in current page",feature_group:9,repeatIgnore:!0,code:function(){a("front",["openFinder"])}}),t.mappings.add("E",{annotation:"Go one tab left",feature_group:3,repeatIgnore:!0,code:function(){s("previousTab")}}),t.mappings.add("R",{annotation:"Go one tab right",feature_group:3,repeatIgnore:!0,code:function(){s("nextTab")}});var L=null;return t.disable=function(){L||(L=function(e){const t=new fe("Disabled");return t.statusLine="",t.priority=99,t.addEventListener("keydown",(function(n){n.sk_suppressed=!0,fe.isSpecialKeyOf("<Alt-s>",n.sk_keyName)&&(e.toggleBlocklist(),t.exit(),n.sk_stopPropagation=!0)})),t}(t),L.enter(0,!0)),a("observer",["turnOff"]),document.removeEventListener("mouseup",T)},t.enable=function(){L&&(L.exit(),L=null),document.addEventListener("mouseup",T)},t.enable(),t.onExit=function(){a("observer",["turnOff"]),g.forEach((function(e){delete e.skScrollBy,delete e.smoothScrollBy}))},t};const ge=function(e){var t=void 0,n=new MutationObserver((function(n){var o=[];for(var r of n)for(var i of r.addedNodes)i.nodeType!==Node.ELEMENT_NODE||i.fromSurfingKeys||(i.newlyCreated=!0,o.push(i));o.length&&(t&&(clearTimeout(t),t=void 0),t=setTimeout((function(){var t=L((function(e,t){var n=e.getBoundingClientRect();n.width>300&&n.height>300&&n.width<=window.innerWidth&&n.height<=window.innerHeight&&n.top>=0&&n.left>=0&&fe.hasScroll(e,"y",16)&&function(e){for(;e!==document.body;){if("relative"===getComputedStyle(e).position)return!0;e=e.parentElement}return!1}(e)&&t.push(e)}));t.length&&e.addScrollableElement(t[0])}),200))}));n.isConnected=!1,b("observer",{turnOn:()=>{n.isConnected||(n.observe(document,{childList:!0,subtree:!0}),n.isConnected=!0)},turnOff:()=>{n.isConnected&&(n.disconnect(),n.isConnected=!1)}})};const ye=function(){var e=new fe("Insert");function t(){var e=S();if(void 0!==e.setSelectionRange)try{e.setSelectionRange(e.value.length,e.value.length)}catch(e){if(!(e instanceof DOMException&&"InvalidStateError"===e.name))throw e}else if(C(e)&&e.childNodes.length>0){var t=e.childNodes[e.childNodes.length-1];if(t.nodeType===Node.TEXT_NODE)document.getSelection().setPosition(t,t.data.length);else{t.querySelector(".CodeMirror-line")?function(e){let t=document.createRange();t.selectNodeContents(e),t.collapse(!1);let n=window.getSelection();n.removeAllRanges(),n.addRange(t)}(e):document.getSelection().setPosition(t,t.childNodes.length)}}}e.mappings=new me,e.map_node=e.mappings,e.mappings.add(i.encodeKeystroke("<Ctrl-e>"),{annotation:"Move the cursor to the end of the line",feature_group:15,code:t}),e.mappings.add(i.encodeKeystroke("<Ctrl-f>"),{annotation:"Move the cursor to the beginning of the line",feature_group:15,code:function(){var e=S();if(void 0!==e.setSelectionRange)e.setSelectionRange(0,0);else{var t=document.getSelection();t.setPosition(t.focusNode,0)}}}),e.mappings.add(i.encodeKeystroke("<Ctrl-u>"),{annotation:"Delete all entered characters before the cursor",feature_group:15,code:function(){var e=S();if(void 0!==e.setSelectionRange)e.value=e.value.substr(e.selectionStart),e.setSelectionRange(0,0);else{var t=document.getSelection();t.focusNode.data=t.focusNode.data.substr(t.focusOffset)}}}),e.mappings.add(i.encodeKeystroke("<Alt-b>"),{annotation:"Move the cursor Backward 1 word",feature_group:15,code:function(){var e=S();if(void 0!==e.setSelectionRange){var t=l(e.value,-1,e.selectionStart);e.setSelectionRange(t,t)}else document.getSelection().modify("move","backward","word")}}),e.mappings.add(i.encodeKeystroke("<Alt-f>"),{annotation:"Move the cursor Forward 1 word",feature_group:15,code:function(){var e=S();if(void 0!==e.setSelectionRange){var t=l(e.value,1,e.selectionStart);e.setSelectionRange(t,t)}else document.getSelection().modify("move","forward","word")}}),e.mappings.add(i.encodeKeystroke("<Alt-w>"),{annotation:"Delete a word backwards",feature_group:15,code:function(){var e=S();if(void 0!==e.setSelectionRange){var t=u(e.value,-1,e.selectionStart);e.value=t[0],e.setSelectionRange(t[1],t[1])}else{var n=document.getSelection(),o=n.focusOffset;document.getSelection().modify("move","backward","word");var r=n.focusNode.data,i=n.focusOffset;n.focusNode.data=r.substr(0,i)+r.substr(o),n.setPosition(n.focusNode,i)}}}),e.mappings.add(i.encodeKeystroke("<Alt-d>"),{annotation:"Delete a word forwards",feature_group:15,code:function(){var e=S();if(void 0!==e.setSelectionRange){var t=u(e.value,1,e.selectionStart);e.value=t[0],e.setSelectionRange(t[1],t[1])}else{var n=document.getSelection(),o=n.focusOffset;document.getSelection().modify("move","forward","word");var r=n.focusNode.data,i=n.focusOffset;n.focusNode.data=r.substr(0,o)+r.substr(i),n.setPosition(n.focusNode,o)}}}),e.mappings.add(i.encodeKeystroke("<Esc>"),{annotation:"Exit insert mode",feature_group:15,stopPropagation:function(e){return e.charCodeAt(0)<256},code:function(){S().blur(),e.exit()}});var n,o=X("div","",{id:"sk_emoji",style:"display: block; opacity: 1;"}),r=-1;function a(){var e=S(),t="",i=!0;if(void 0!==e.selectionStart&&void 0!==e.value)t=e.value.substr(r,e.selectionStart-r);else{i=!1;var a=document.getSelection();t=a.focusNode.data.substr(r,a.focusOffset-r)}if(t.length<d.conf.startToShowEmoji||" "===t[0])o.remove();else{var s=n.filter((function(e){return-1!==e.indexOf(t)})).slice(0,5).map((function(e){var t=e.split("\t"),n=String.fromCodePoint.apply(null,t[0].split(","));return"<div><span>{0}</span>{1}</div>".format(n,t[1])})).join("");if(""===s)o.remove();else{Y(o,s),document.body.append(o),o.style.display="",o.querySelector("#sk_emoji>div").classList.add("selected");var c=i?function(e){var t=getComputedStyle(e),n=e.getBoundingClientRect(),o=document.createElement("div"),r=document.createElement("span");o.style.font=t.font,o.style.position="fixed",Y(o,e.value),o.style.left=e.clientLeft+n.left+"px",o.style.top=e.clientTop+n.top+"px",o.style.color="red",o.style.overflow="scroll",o.style.visibility="hidden",o.style.whiteSpace="pre-wrap",o.style.padding=t.padding,o.style.width=t.width,o.style.height=t.height,r.innerText="I";var i=e.selectionStart;if(i===e.value.length)o.appendChild(r);else{var a=o.childNodes[0].splitText(i);o.insertBefore(r,a)}return document.body.appendChild(o),O(r),n=r.getBoundingClientRect(),o.remove(),n}(e):K(document.getSelection()),l=c.top+c.height+4;window.innerHeight-l<o.offsetHeight&&(l=c.top-o.offsetHeight),o.style.position="fixed",o.style.top=l+"px",o.style.left=c.left+"px"}}}e.enableEmojiInsertion=()=>{e.mappings.add(":",{annotation:"Input emoji",feature_group:15,stopPropagation:function(){return!1},code:function(){var e=S();r=void 0!==e.selectionStart?e.selectionStart+1:document.getSelection().focusOffset+1,fetch(chrome.runtime.getURL("pages/emoji.tsv")).then((e=>Promise.all([e.text()]))).then((e=>{n=e[0].split("\n"),a()}))}})};var s,c=!1;function l(e,t,n){var o=/\W/;for(n=t>0?n:n+t;;){if(n<0){n=0;break}if(n>=e.length){n=e.length;break}if(o.test(e[n]))break;n+=t}return n}function u(e,t,n){var o=l(e,t,n);return[o>n?e.substr(0,n)+e.substr(o):o<n?e.substr(0,o)+e.substr(n):e.substr(0,o)+e.substr(o+1),t>0?n:o]}e.addEventListener("keydown",(function(t){if(t.key&&t.key.charCodeAt(0)>127)t.sk_suppressed=!0;else{var n,a,s,l,u=S(t);if(o.offsetHeight>0){if(fe.isSpecialKeyOf("<Esc>",t.sk_keyName))o.remove(),r=-1;else if(t.keyCode===i.keyCodes.tab||t.keyCode===i.keyCodes.upArrow||t.keyCode===i.keyCodes.downArrow)n=t.shiftKey||t.keyCode===i.keyCodes.upArrow,a=o.querySelector("#sk_emoji>div.selected"),s=Array.from(o.querySelectorAll("#sk_emoji>div")),l=(s.indexOf(a)+(n?-1:1))%s.length,a.classList.remove("selected"),s[l].classList.add("selected"),c=!0,t.sk_stopPropagation=!0;else if(t.keyCode===i.keyCodes.enter){var d=o.querySelector("#sk_emoji>div.selected>span").innerHTML;if(void 0!==u.setSelectionRange){var f=u.value;u.value=f.substr(0,r-1)+d+f.substr(u.selectionStart),u.setSelectionRange(r,r)}else{var p=document.getSelection();f=p.focusNode.data;p.focusNode.data=f.substr(0,r-1)+d+f.substr(p.focusOffset),p.setPosition(p.focusNode,r)}o.remove(),r=-1,t.sk_stopPropagation=!0}}else C(u)?t.sk_keyName.length&&fe.handleMapKey.call(e,t,(function(e){var t=e.getPrefixWord();if(t){var n=S(),o=n.value,r=n.selectionStart;if(void 0!==o&&void 0!==r)n.value=o.substr(0,n.selectionStart)+t+o.substr(n.selectionEnd),r+=t.length,n.setSelectionRange(r,r);else{var i=(n=document.getSelection()).getRangeAt(0),a=document.createTextNode(t);"Caret"===n.type?void 0===(o=n.focusNode.data)?(i.insertNode(a),n.setPosition(a,a.length)):(r=n.focusOffset,n.focusNode.data=o.substr(0,r)+t+o.substr(r),n.setPosition(n.focusNode,r+t.length)):(i.deleteContents(),i.insertNode(a),n.setPosition(a,a.length))}}})):e.exit();t.sk_suppressed=!0}})),e.addEventListener("keyup",(function(e){var t=S(e);if(!c&&-1!==r){var n,i;if(void 0!==t.selectionStart&&void 0!==t.value)n=t.value,i=t.selectionStart;else{var s=document.getSelection();n=s.focusNode.data,i=s.focusOffset}i<r||":"!==n[r-1]?o.remove():a()}c=!1})),e.addEventListener("focus",(function(t){var n=S(t);t.target==window||C(n)?t.sk_suppressed=!0:e.exit()}));var f=e.enter;return e.enter=function(n,o){n===document.body&&(d.conf.showModeStatus=!1);var r=-1===f.call(e,0,!0);s!==n&&(s=n,r=!0),r&&!o&&d.conf.cursorAtEndOfInput&&"SELECT"!==n.nodeName&&t()},e};const ve=function(e,t){var n=new fe("Visual");n.addEventListener("keydown",(function(e){if(b){var t=!1;e.sk_stopPropagation=!0,e.sk_suppressed=!0,i.isWordChar(e)?(E(b,e.sk_keyName),S=[b,e.sk_keyName],t=!0):fe.isSpecialKeyOf("<Esc>",e.sk_keyName)&&(t=!0),t&&(n.statusLine=n.name+" - "+y[g],fe.showStatus(),b=0)}else e.sk_keyName.length&&(fe.handleMapKey.call(n,e),e.sk_stopPropagation?e.sk_suppressed=!0:fe.isSpecialKeyOf("<Esc>",e.sk_keyName)&&(g>1?(n.hideCursor(),p.collapse(p.anchorNode,p.anchorOffset),n.showCursor()):(n.visualClear(),n.exit()),g--,I(),e.sk_stopPropagation=!0,e.sk_suppressed=!0))})),n.addEventListener("click",(function(e){switch(p.type){case"None":n.hideCursor(),g=0;break;case"Caret":g&&(n.hideCursor(),0===g&&(g=1),n.showCursor());break;case"Range":g&&(n.hideCursor(),g=2,n.showCursor())}I()})),n.addEventListener("resize",(function(e){d.conf.lastQuery&&n.visualUpdate(d.conf.lastQuery),m[h]&&x(m[h])}));let o=null;const r=()=>{o&&o.forEach((e=>{e.remove()}))};n.addEventListener("selectionchange",(function(e){var t,n,i,a;r(),t=p.anchorNode,n=p.anchorOffset,i=p.focusNode,a=p.focusOffset,o=O("surfingkeys_selection_mark",t,n,i,a)})),n.mappings=new me,n.map_node=n.mappings,n.repeats="",n.mappings.add("l",{annotation:"forward character",feature_group:9,code:C}),n.mappings.add("h",{annotation:"backward character",feature_group:9,code:C}),n.mappings.add("j",{annotation:"forward line",feature_group:9,code:C}),n.mappings.add("k",{annotation:"backward line",feature_group:9,code:C}),n.mappings.add("w",{annotation:"forward word",feature_group:9,code:C}),n.mappings.add("e",{annotation:"forward word",feature_group:9,code:C}),n.mappings.add("b",{annotation:"backward word",feature_group:9,code:C}),n.mappings.add(")",{annotation:"forward sentence",feature_group:9,code:C}),n.mappings.add("(",{annotation:"backward sentence",feature_group:9,code:C}),n.mappings.add("}",{annotation:"forward paragraphboundary",feature_group:9,code:C}),n.mappings.add("{",{annotation:"backward paragraphboundary",feature_group:9,code:C}),n.mappings.add("0",{annotation:"backward lineboundary",feature_group:9,code:C}),n.mappings.add("$",{annotation:"forward lineboundary",feature_group:9,code:C}),n.mappings.add("G",{annotation:"forward documentboundary",feature_group:9,code:function(){document.scrollingElement.scrollTop=document.scrollingElement.scrollHeight,"Firefox"!==f()?C():(n.hideCursor(),p.setPosition(document.body.lastChild,0),n.showCursor()),m.length&&a("front",["showStatus",[void 0,void 0,(h=m.length-1)+1+" / "+m.length]])}}),n.mappings.add("gg",{annotation:"backward documentboundary",feature_group:9,code:function(){document.scrollingElement.scrollTop=0,h=0,m.length&&a("front",["showStatus",[void 0,void 0,h+1+" / "+m.length]]),"Firefox"!==f()?C():(n.hideCursor(),p.setPosition(document.body.firstChild,0),n.showCursor())}}),n.mappings.add("o",{annotation:"Go to Other end of highlighted text",feature_group:9,code:function(){n.hideCursor();var e=[p.anchorNode,p.anchorOffset];p.collapse(p.focusNode,p.focusOffset),p.extend(e[0],e[1]),n.showCursor()}});var s={w:"word",l:"lineboundary",s:"sentence",p:"paragraphboundary"};function c(e){if("Firefox"!==f()||"p"!==e&&"s"!==e){var t=s[e];p.modify("extend","forward",t)}}var l=[{},{annotation:"Yank a word(w) or line(l) or sentence(s) or paragraph(p)",feature_group:9,code:function(t){var o=[p.focusNode,p.focusOffset];n.hideCursor(),c(t),e.write(p.toString()),p.collapseToStart(),p.setPosition(o[0],o[1]),n.showCursor()}},{annotation:"Copy selected text",feature_group:9,code:function(){var t=[p.focusNode,p.focusOffset];e.write(p.toString()),"Caret"===d.conf.modeAfterYank?(p.setPosition(t[0],t[1]),n.showCursor(),g=1,I()):"Normal"===d.conf.modeAfterYank&&(g=2,n.toggle())}}];function u(e,t){te(e,(()=>{k(e,["click"],t)}))}n.mappings.add("*",{annotation:"Search word under the cursor",feature_group:9,code:function(){n.star()}}),n.mappings.add(i.encodeKeystroke("<Enter>"),{annotation:"Click on node under cursor.",feature_group:9,code:function(){u(p.focusNode.parentNode,!1)}}),n.mappings.add(i.encodeKeystroke("<Shift-Enter>"),{annotation:"Click on node under cursor.",feature_group:9,code:function(){u(p.focusNode.parentNode,!0)}}),n.mappings.add("zt",{annotation:"make cursor at top of window.",feature_group:9,code:function(){var e=w.getBoundingClientRect().top;n.hideCursor(),document.scrollingElement.scrollTop+=e,n.showCursor()}}),n.mappings.add("zz",{annotation:"make cursor at center of window.",feature_group:9,code:function(){var e=w.getBoundingClientRect().top-window.innerHeight/2;n.hideCursor(),document.scrollingElement.scrollTop+=e,n.showCursor()}}),n.mappings.add("zb",{annotation:"make cursor at bottom of window.",feature_group:9,code:function(){var e=window.innerHeight-w.getBoundingClientRect().bottom;n.hideCursor(),document.scrollingElement.scrollTop-=e,n.showCursor()}}),n.mappings.add("f",{annotation:"Forward to next char.",feature_group:9,code:function(){n.statusLine=n.name+" - "+y[g]+" - forward",fe.showStatus(),b=1}}),n.mappings.add("F",{annotation:"Backward to next char.",feature_group:9,code:function(){n.statusLine=n.name+" - "+y[g]+" - backward",fe.showStatus(),b=-1}}),n.mappings.add(";",{annotation:"Repeat latest f, F",feature_group:9,code:function(){S&&E(S[0],S[1])}}),n.mappings.add(",",{annotation:"Repeat latest f, F in opposite direction",feature_group:9,code:function(){S&&E(-S[0],S[1])}}),n.mappings.add("p",{annotation:"Expand selection to parent element",feature_group:9,code:function(){for(var e=p.focusNode;e!==document.body;){var t=F(e=e.parentElement,/./),o=t[t.length-1],r=p.getRangeAt(0);if(-1===r.comparePoint(t[0],0)||1===r.comparePoint(o,o.length)){n.hideCursor(),g=2,I(),p.setBaseAndExtent(t[0],0,o,o.length),n.showCursor();break}}}}),n.mappings.add("V",{annotation:"Select a word(w) or line(l) or sentence(s) or paragraph(p)",feature_group:9,code:function(e){n.hideCursor(),g=2,I(),c(e),n.showCursor()}});var p=document.getSelection(),m=[],h=0,g=0,y=["","Caret","Range"],v=document.createElement("div"),w=document.createElement("div");w.className="surfingkeys_cursor",w.style.zIndex=2147483299;var b=0,S=null;function E(e,t){n.hideCursor();var o=[p.anchorNode,p.anchorOffset];if(p.focusNode&&p.focusNode.textContent&&p.focusNode.textContent.length&&p.focusNode.textContent[p.focusOffset]===t&&1===e&&p.setPosition(p.focusNode,p.focusOffset+1),P(t,!0,-1===e))if(1===g)p.setPosition(p.focusNode,p.focusOffset-1);else{var r=[p.focusNode,p.focusOffset-1];p.collapseToStart(),p.setPosition(o[0],o[1]),p.extend(r[0],r[1])}else p.setPosition(o[0],o[1]);n.showCursor()}function x(e){n.hideCursor(),p.anchorNode&&2===g?p.extend(e[0],e[1]):p.setPosition(e[0],e[1]),n.showCursor()}function C(){var e=n.map_node.meta.annotation.split(" "),t=2===g?"extend":"move";n.hideCursor();var o=[p.focusNode,p.focusOffset];p.modify(t,e[0],e[1]),o[0]===p.focusNode&&o[1]===p.focusOffset&&p.modify(t,e[0],"word"),n.showCursor()}n.hideCursor=function(){document.body.contains(w)&&(w.remove(),a("front",["hideBubble"]))},n.showCursor=function(){if(p.focusNode&&(p.focusNode.offsetHeight>0||p.focusNode.parentNode.offsetHeight>0)){let e=K(p);e&&(w.style.position="fixed",w.style.left=e.left+"px",w.style.top=e.top+"px",w.style.height=e.height+"px"),document.body.appendChild(w)}},n.getCursorPixelPos=function(){return w.getBoundingClientRect()};const T=document.createElement("div");function O(e,t,n,o,r){let i=B(t,n,o,r);if(i.length>100)return[];const a=Array.from(i).map((t=>{if(t.width>0&&t.height>0){var n=v.cloneNode(!1);return n.className=e,n.style.position="absolute",n.style.zIndex=2147483299,n.style.left=document.scrollingElement.scrollLeft+t.left+"px",n.style.top=document.scrollingElement.scrollTop+t.top+"px",n.style.width=t.width+"px",n.style.height=t.height+"px",T.appendChild(n),n}return null})).filter((e=>null!==e));return a.length&&!document.documentElement.contains(T)&&document.documentElement.prepend(T),a}function N(e,t,n,o){const r=O("surfingkeys_match_mark",e,t,n,o);r.length&&m.push([e,t,r])}function _(e){F(document.body,e).forEach((function(t){for(var n;null!==(n=e.exec(t.data));){var o=n[0];if(!o.length)break;var r=e.lastIndex-o.length;N(t,r,t,r+o.length)}}));var t=document.scrollingElement.scrollTop;p.setPosition(null,0);for(var n=null;P(e.source,-1===e.flags.indexOf("i"),!1)&&n!=p.anchorNode;)n=p.anchorNode,p.anchorNode!==p.focusNode&&N(p.anchorNode,p.anchorOffset,p.focusNode,p.focusOffset);if(document.scrollingElement.scrollTop=t,m.length){h=0;for(var o=0;o<m.length;o++){if(m[o][2][0].getBoundingClientRect().top>0){h=o;break}}a("front",["showStatus",[void 0,void 0,h+1+" / "+m.length]])}}function I(){n.mappings.add("y",l[g]),n.statusLine=n.name+" - "+y[g],fe.showStatus()}function M(){g=(g+1)%3,I()}function P(e,t,n){for(var o=!1,r=null;window.find(e,t,n);){if(p.anchorNode.splitText){o=!0;break}if(null===r)r=p.anchorNode;else if(r===p.anchorNode)break}return o}n.visualClear=function(){r(),n.hideCursor(),m=[],U.forEach((function(e){e.onscroll=null})),U=[],Y(T,""),T.remove(),a("front",["showStatus",[void 0,void 0,""]])},n.emptySelection=function(){document.getSelection().empty()},n.onEnter=function(){M()},n.onExit=function(){n.visualClear()},n.restore=function(){p&&p.anchorNode&&(p.setPosition(p.anchorNode,p.anchorOffset),n.showCursor(),n.enter())},n.toggle=function(e){switch(g){case 1:p.extend(p.anchorNode,p.anchorOffset),M();break;case 2:n.hideCursor(),p.collapse(p.focusNode,p.focusOffset),n.exit(),M();break;default:t.create(d.conf.textAnchorPat,(function(t){setTimeout((function(){p.setPosition(t[0],t[1]),n.enter(),"z"===e&&(0===t[1]?p.extend(t[0],t[0].textContent.length):p.extend(t[0],t[1]+t[2].length),M()),n.showCursor()}),0)}))}},n.star=function(){if(p.focusNode&&p.focusNode.nodeValue){var e=q();if(e.length&&"."!==e){n.hideCursor();var t=[p.focusNode,p.focusOffset];d.updateHistory("find",e),n.visualClear(),_(new RegExp(e,"g"+(d.getCaseSensitive(e)?"":"i"))),p.setPosition(t[0],t[1]),n.showCursor()}}},n.next=function(e){m.length?(0===g&&n.enter(),h=(e?m.length+h-1:h+1)%m.length,x(m[h]),a("front",["showStatus",[void 0,void 0,h+1+" / "+m.length]])):d.conf.lastQuery&&(_(new RegExp(d.conf.lastQuery,"g"+(d.getCaseSensitive(d.conf.lastQuery)?"":"i"))),n.visualEnter(d.conf.lastQuery))},n.feedkeys=function(e){setTimeout((function(){for(var t=new Event("keydown"),o=0;o<e.length;o++)t.sk_keyName=e[o],fe.handleMapKey.call(n,t)}),1)},n.visualUpdate=function(e){n.visualClear(),p.setPosition(function(e){for(var t=null,n=F(document.body,/./,0);n.nextNode();)if(n.currentNode.parentNode.getBoundingClientRect().top>window.innerHeight*e){t=n.currentNode;break}return t}(0),0);var t=document.scrollingElement.scrollTop,o=[p.anchorNode,p.anchorOffset],r=d.getCaseSensitive(e);if(P(e,r,!1)?p.setPosition(o[0],o[1]):p.setPosition(document.body.firstChild,0),P(e,r,!1)){for(document.scrollingElement.scrollTop!==t&&(t=document.scrollingElement.scrollTop,o=[p.anchorNode,p.anchorOffset]),N(p.anchorNode,p.anchorOffset,p.focusNode,p.focusOffset);document.scrollingElement.scrollTop===t&&P(e,r,!1);)N(p.anchorNode,p.anchorOffset,p.focusNode,p.focusOffset);document.scrollingElement.scrollTop=t,p.setPosition(o[0],o[1])}};var U=[];n.visualEnter=function(e){0!==e.length&&"."!==e&&(n.visualClear(),_(new RegExp(e,"g"+(d.getCaseSensitive(e)?"":"i"))),m.length?(n.enter(),x(m[h])):a("front",["showStatus",[void 0,void 0,"Pattern not found: {0}".format(e)],1e3]),fe.getScrollableElements().forEach((function(e){e!==document.scrollingElement&&(e.onscroll=function(){m.forEach((function(e){var t=B(e[0],e[1])[0];e[2].forEach((e=>{e.style.left=document.scrollingElement.scrollLeft+t.left+"px",e.style.top=document.scrollingElement.scrollTop+t.top+"px"}))}))},U.push(e))})))},n.findSentenceOf=function(e){var t=new RegExp("\\b"+e+"\\b"),n=L((function(e,n){t.test(e.innerText)&&n.push(e)}));n=R(n);var o="";return A((function(t){t.setPosition(n[0],0),window.find(e,!1,!1,!0,!0)&&(c("s"),o=t.toString())})),o};var H={};return n.style=function(e,t){H[e]=t,w.setAttribute("style",H.cursor||""),v.setAttribute("style",H.marks||"")},n};const we=function(e,t){var n=new fe("Hints"),o=document.createElement("div");o.className="surfingkeys_hints_host",o.attachShadow({mode:"open"});var r=X("style","\ndiv {\n    position: absolute;\n    display: block;\n    font-size: 8pt;\n    font-weight: bold;\n    padding: 0px 2px 0px 2px;\n    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#FFF785), color-stop(100%,#FFC542));\n    color: #000;\n    border: solid 1px #C38A22;\n    border-radius: 3px;\n    box-shadow: 0px 3px 7px 0px rgba(0, 0, 0, 0.3);\n    width: auto;\n}\ndiv:empty {\n    display: none;\n}\n[mode=text] div {\n    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#aaa), color-stop(100%,#fff));\n}\ndiv.hint-scrollable {\n    background: rgba(170, 170, 255, 0.85);\n}\n[mode=text] div.begin {\n    color: #00f;\n}\n[mode=input] div {\n    background: rgba(255, 217, 0, 0.25);\n}\n[mode=input] div.activeInput {\n    background: rgba(0, 0, 255, 0.25);\n}");o.shadowRoot.appendChild(r);let c=!1;n.setNumeric=function(){c=!0};let l="asdfgqwertzxcvb",u=[];n.setCharacters=function(e){l=e;for(const n of e)t.isScrollKeyInHints(n)&&u.push(n)},n.getCharacters=()=>l,n.addEventListener("keydown",(function(n){var o=v.querySelectorAll("div");n.sk_stopPropagation=!0;var r=v.querySelector("[mode=input]>div.activeInput");if(null===r){if(fe.isSpecialKeyOf("<Esc>",n.sk_keyName))_();else if(n.keyCode===i.keyCodes.space)v.style.display="none";else if(n.keyCode===i.keyCodes.shiftKey)!function(){var e=v.querySelectorAll("div");e[0].style.zIndex==e[0].zIndex?e.forEach((function(t,n){var o=parseInt(t.style.zIndex);t.style.zIndex=e.length-n+2147483e3-o})):e.forEach((function(e,t){e.style.zIndex=e.zIndex}))}();else if(o.length>0)if(n.keyCode===i.keyCodes.backspace)p.length>0?(p=p.substr(0,p.length-1),O(n)):m.length>0&&(m=m.substr(0,m.length-1),N());else{var a=n.sk_keyName;(function(e){return e===e.toUpperCase()&&e!==e.toLowerCase()})(a)&&(w=!0),""!==a&&(c?(a>="0"&&a<="9"?p+=a:(m+=a,N()),O(n)):-1!==l.toLowerCase().indexOf(a.toLowerCase())?(p+=a.toUpperCase(),O(n)):t.isScrollKeyInHints(a)&&-1===u.indexOf(a)?n.sk_stopPropagation=!1:_())}}else{var s=r.link;fe.isSpecialKeyOf("<Esc>",n.sk_keyName)?(s.blur(),_()):n.keyCode===i.keyCodes.tab?(r.classList.remove("activeInput"),S.activeInput=(S.activeInput+(n.shiftKey?-1:1))%o.length,(r=o[S.activeInput]).classList.add("activeInput"),(s=r.link).focus()):n.keyCode!==i.keyCodes.shiftKey&&(n.sk_stopPropagation=!1,_(),e.enter(s))}})),n.addEventListener("keyup",(function(e){e.keyCode===i.keyCodes.space&&(v.style.display="")})),n.dispatchMouseClick=function(o){if(C(o))n.exit(),t.passFocus(!0),o.focus(),e.enter(o);else{g.multipleHits||n.exit();var r=g.tabbed,i=g.active;if(g.multipleHits){const e=o.getAttribute("href");null!==e&&"#"!==e&&(r=!0,i=!1)}w&&d.conf.hintShiftNonActive?(r=!0,i=!1):w&&"Firefox"===f()&&(r=!0,i=!0),te(o,(()=>{r?s("openLink",{tab:{tabbed:r,active:i},url:R(o)}):(n.mouseoutLastElement(),k(o,g.mouseEvents,w),a("observer",["turnOn"]),h=o),g.multipleHits&&setTimeout(A,300)}))}o.classList.remove("surfingkeys--hints--clicking")};var p="",m="",h=null,g={mouseEvents:["mouseover","mousedown","mouseup","click"]},v=X("section","",{style:"display: block; opacity: 1;"}),w=!1,S={},E=n.dispatchMouseClick,x="";function T(e){var t=0;do{var n=parseInt(getComputedStyle(e).getPropertyValue("z-index"));t+=isNaN(n)||n<0?0:n,e=e.parentNode}while(e&&e!==document.body&&e!==document&&e.nodeType!==e.DOCUMENT_FRAGMENT_NODE);return t}function O(e){const n=v.querySelectorAll("div:not(:empty)"),o=ne(n,p);o.matched?(t.appendKeysForRepeat("Hints",p),"function"==typeof E?E(o.matched):a("user",["onHintClicked"],o.matched),g.multipleHits?ne(n,p=""):_()):0===o.candidates&&_(),e&&(fe.suppressKeyUp(e.keyCode),e.stopImmediatePropagation(),e.preventDefault())}function N(){var e=v.querySelectorAll("div");e=Array.from(e),m.length>0&&(e=e.filter((function(e){e.label="",Y(e,"");var t=e.link,n=t.innerText;return void 0===n&&(n=t[0]?t[0].textContent:""),-1!==n.indexOf(m)})));var t=n.genLabels(e.length);e.forEach((function(e,n){e.label=t[n],Y(e,t[n])}))}function _(){g={active:!0,tabbed:!1,mouseEvents:["mouseover","mousedown","mouseup","click"],multipleHits:!1},Y(v,""),v.remove(),o.remove(),p="",m="",w=!1,n.exit()}function A(){if(document.documentElement.contains(o)){var e=(new Date).getTime(),t=K(x,S);t>0&&(n.statusLine+=" - "+((new Date).getTime()-e)+"ms / "+t,fe.showStatus())}}function R(e){for(var t=e.href;!t&&e;)t=(e=e.parentElement).href;return t}function M(e){for(var t=0;t<d.conf.pageUrlRegex.length;t++){var n=window.location.href.match(d.conf.pageUrlRegex[t]);if(n&&4===n.length){var o=parseInt(n[2]);if(o<4294967295)return window.location.href=n[1]+(o+e)+n[3],!0}}return!1}function F(e){let t={};return e.forEach((function(e){let n=e.getAttribute("href");t[n]||(t[n]=e)})),Object.values(t)}function D(e){Y(v,""),v.setAttribute("mode",e),v.style.display=""}function B(e){D("click");var t=n.genLabels(e.length),r=n.coordinate(),i=X("style",q);v.prepend(i);var a=e.map((function(e,n){var o,i=I(e),a=T(e),s=Math.min(i.width,window.innerWidth);(o="right"===d.conf.hintAlign?window.pageXOffset+i.left-r.left+s:"left"===d.conf.hintAlign?window.pageXOffset+i.left-r.left:window.pageXOffset+i.left-r.left+s/2)<window.pageXOffset?o=window.pageXOffset:o+32>window.pageXOffset+window.innerWidth&&(o=window.pageXOffset+window.innerWidth-32);var c=X("div",t[n]);return e.dataset.hint_scrollable&&c.classList.add("hint-scrollable"),c.style.top=Math.max(i.top+window.pageYOffset-r.top,0)+"px",c.style.left=o+"px",c.style.zIndex=a+9999,c.zIndex=c.style.zIndex,c.label=t[n],c.link=e,c}));a.forEach((function(e){v.appendChild(e)}));for(var s=v.querySelectorAll("div"),c=I(s[0]),l=1;l<s.length;l++){var u=s[l],f=I(u);f.top===c.top&&Math.abs(f.left-c.left)<c.width&&(u.style.top=u.offsetTop+u.offsetHeight+"px"),c=I(u)}o.shadowRoot.appendChild(v)}function K(e,t){return document.documentElement.appendChild(o),"RegExp"===e.constructor.name?function(e,t){for(var r in t)g[r]=t[r];n.statusLine=t&&t.statusLine||"Hints to select text";var i,a=L((function(e,t){for(var n=e.childNodes,o=0,r=n.length;o<r;o++)if(n[o].nodeType==Node.TEXT_NODE&&n[o].data.length>0){t.push(e);break}}));if(a=a.flatMap((function(e){for(var t=e.childNodes,n=[],o=0,r=t.length;o<r;o++)t[o].nodeType==Node.TEXT_NODE&&t[o].data.trim().length>1&&n.push(t[o]);return n})),-1===e.flags.indexOf("g"))i=a.map((function(e){return[e,0,""]}));else{i=[];for(var s=0,c=a.length;s<c;s++)for(var l,u=a[s];null!=(l=e.exec(u.data));)i.push([u,l.index,l[0]])}if(a=i.map((function(e){var t=H(e[0],e[1]),n=[0,0,window.innerHeight,window.innerWidth];if(d.conf.caretViewport&&4===d.conf.caretViewport.length&&(n=d.conf.caretViewport),0===e[0].data.trim().length||t.top<n[0]||t.left<n[1]||t.top>n[2]||t.left>n[3])return null;var o=T(e[0].parentNode),r=document.createElement("div");return 0===e[1]&&(r.className="begin"),r.style.position="fixed",r.style.top=t.top+"px",r.style.left=t.left+"px",r.style.zIndex=o+9999,r.zIndex=r.style.zIndex,r.link=e,r})).filter((function(e){return null!==e})),document.getSelection().anchorNode&&document.getSelection().collapseToStart(),a.length>0){D("text");var f=n.genLabels(a.length);a.forEach((function(e,t){e.label=f[t],Y(e,f[t]),v.append(e)}));var p=X("style",W);v.prepend(p),o.shadowRoot.appendChild(v)}return a.length}(e,t):Array.isArray(e)?function(e,t){for(var o in t=Object.assign({active:!0,tabbed:!1,mouseEvents:["mouseover","mousedown","mouseup","click"],multipleHits:!1,filterInvisible:!0},t||{}))g[o]=t[o];return n.statusLine=t&&t.statusLine||"Hints to click",t.filterInvisible&&(e=Q(e)),e.length>0&&B(e),e.length}(e,t):function(e,t){for(var o in n.statusLine="Hints to click",t=Object.assign({active:!0,tabbed:!1,mouseEvents:["mouseover","mousedown","mouseup","click"],multipleHits:!1},t||{}))g[o]=t[o];var r;return(r=""===e?P(r=L((function(e,t){y(e)&&t.push(e)}))):Array.isArray(e)?Q(e):P(r=Q(r=L((function(t,n){!t.matches(e)||t.disabled||t.readOnly||n.push(t)}))))).length>0&&B(r),r.length}(e,t)}n.click=function(e,t){"string"==typeof e&&(e=U(e)),e.length>1?t?e.forEach((function(e){n.dispatchMouseClick(e)})):n.create(e,n.dispatchMouseClick):1===e.length&&n.dispatchMouseClick(e[0])},n.previousPage=function(){var e=F(U("[rel=prev]",d.conf.prevLinkRegex));return e.length?(n.click(e),!0):M(-1)},n.nextPage=function(){var e=F(U("[rel=next]",d.conf.nextLinkRegex));return e.length?(n.click(e),!0):M(1)},b("hints",{scrollStarted:()=>{Y(v,""),v.remove(),p=""},scrollDone:A,topBoundaryHit:n.previousPage,bottomBoundaryHit:n.nextPage,dispatchMouseClick:n.dispatchMouseClick},!0),n.genLabels=function(e){let t=l.toUpperCase();for(var n=[""],o=0;n.length-o<e||0==o;)for(var r=n[o++],i=0;i<t.length;i++)n.push(r+t[i]);return n=n.slice(o,o+e)},n.coordinate=function(){var e=X("div","A",{style:"top: 0; left: 0;"});v.prepend(e),o.shadowRoot.appendChild(v);var t=e.getBoundingClientRect(),n={top:t.top+window.pageYOffset-document.documentElement.clientTop,left:t.left+window.pageXOffset-document.documentElement.clientLeft};return Y(v,""),v.remove(),n},n.createInputLayer=function(){document.documentElement.appendChild(o);const r="input:not([type=submit]), textarea, *[contenteditable=true], *[role=textbox], select, div.ace_cursor";var i=L((function(e,t){!e.matches(r)||e.disabled||e.readOnly||"text"!==e.type&&"email"!==e.type&&"search"!==e.type&&"password"!==e.type||t.push(e)}));if(0===i.length&&null!==document.querySelector(r)&&(document.querySelector(r).scrollIntoView(),i=L((function(e,t){!e.matches(r)||e.disabled||e.readOnly||t.push(e)}))),i.length>1){n.enter(),D("input"),i.forEach((function(e,t){var n=e.getBoundingClientRect(),o=T(e),r=document.createElement("div");r.style.position="fixed",r.style.top=n.top+"px",r.style.left=n.left+"px",r.style.width=n.width+"px",r.style.height=n.height+"px",r.style.zIndex=o+9999,r.link=e,r.innerText=" ",v.append(r)})),o.shadowRoot.appendChild(v),S.activeInput=0;var a=v.querySelector("[mode=input]>div");a.classList.add("activeInput"),t.passFocus(!0),a.link.focus()}else 1===i.length&&(t.passFocus(!0),i[0].focus(),e.enter(i[0]))},n.getSelector=function(){return x},n.create=function(e,t,o){c&&(l="1234567890"),x=e,E=t,S=o||{};var r=(new Date).getTime(),i=K(e,o);return i>(d.conf.hintExplicit?0:1)?(n.statusLine+=" - "+((new Date).getTime()-r)+"ms / "+i,n.enter()):O(),i>0},n.mouseoutLastElement=function(){h&&(k(h,["mouseout"],!1),h=null)};var W="",q="";return n.style=function(e,t){/^div\b/.test(e)||(e=`div{${e}}`),"text"===t?W=e.replace(/\bdiv\b/g,"[mode='text'] div"):q=e.replace(/\bdiv\b/g,"div")},n.feedkeys=function(e){setTimeout((function(){p=e.toUpperCase(),O()}),1)},n};const be=function(){var e={},t=document.createElement("textarea");function n(e){A((function(n){document.documentElement.appendChild(t),e(n),t.remove()}))}return t.contentEditable=!0,t.enableAutoFocus=!0,t.id="sk_clipboard",e.read=function(e){if(f().startsWith("Safari"))s("readClipboard",null,(function(t){e(t)}));else if("Firefox"!==f()||"object"!=typeof navigator.clipboard||"function"!=typeof navigator.clipboard.readText){n((function(){t.value="",Y(t,""),t.focus(),document.execCommand("paste")}));var o=t.value;""===o&&(o=t.innerHTML.replace(/<br>/gi,"\n")),e({data:o})}else navigator.clipboard.readText().then((t=>{setTimeout((function(){e({data:t})}),0)}))},e.write=function(e){const o=()=>{v("Copied: "+e)};"Chrome"===f()?(n((function(){t.value=e,console.log(e),t.select(),document.execCommand("copy"),t.value=""})),o()):(s("writeClipboard",{text:e}),o())},e};const ke=function(e,t){var n=document.createElement("div");n.style.display="block",n.style.opacity=1,n.style.colorScheme="light";var o=chrome.runtime.getURL("pages/frontend.html"),r=document.createElement("iframe");function i(e){var t=e.data&&e.data.surfingkeys_uihost_data;void 0!==t&&(t.toFrontend?(r.contentWindow.postMessage({surfingkeys_frontend_data:t},o),t.toFrontend&&e.source&&-1!==["showStatus","showEditor","openOmnibar","openFinder","chooseTab"].indexOf(t.action)&&(l&&l.window===e.source||(l&&l.window.postMessage({surfingkeys_content_data:{action:"deactivated",reason:`${t.action}@${e.timeStamp}`}},l.origin),(l={window:e.source,origin:t.origin}).window.postMessage({surfingkeys_content_data:{action:"activated",reason:`${t.action}@${e.timeStamp}`}},l.origin)))):t.action&&c.hasOwnProperty(t.action)?c[t.action](t):t.toContent&&l&&l.window.postMessage({surfingkeys_content_data:t},l.origin),e.stopImmediatePropagation())}r.setAttribute("allowtransparency",!0),r.setAttribute("frameborder",0),r.setAttribute("scrolling","no"),r.setAttribute("class","sk_ui"),r.setAttribute("src",o),r.setAttribute("title","Surfingkeys"),r.style.position="fixed",r.style.left=0,r.style.bottom=0,r.style.width="100%",r.style.height=0,r.style.zIndex=2147483647,n.attachShadow({mode:"open"}),n.shadowRoot.appendChild(r),r.addEventListener("load",(function(){this.contentWindow.postMessage({surfingkeys_frontend_data:{action:"initFrontend",ack:!0,winSize:[window.innerWidth,window.innerHeight],origin:m()}},o),window.addEventListener("message",i,!0)}),{once:!0});var a,s="none",c={},l=null;c.initFrontendAck=function(e){t(n)},c.setFrontFrame=function(t){r.style.height=t.frameHeight,t.pointerEvents&&(r.style.pointerEvents=t.pointerEvents),"none"===t.pointerEvents?(n.blur(),r.blur(),s!==t.pointerEvents&&l&&(e.getBackFocusFromFrontend?e.getBackFocusFromFrontend():l.window.postMessage({surfingkeys_content_data:{action:"getBackFocus"}},l.origin)),document.body&&(document.body.style.animationFillMode="",document.body.style.overflowY=a)):(e.focusFrontend&&e.focusFrontend(r),document.body&&(document.body.style.animationFillMode="none",void 0===a&&(a=document.body.style.overflowY),document.body.style.overflowY="visible")),s=t.pointerEvents},n.detach=function(){window.removeEventListener("message",i,!0),n.remove()},document.documentElement.appendChild(n)};const Se=function(e,t,n,o,r){var i,c={},l=[];function u(){i=new Promise((function(e,t){ke(r,(t=>{e(t),function(){for(var e of l)c.command(e)}()}))}))}var y={};function v(e){l.push(e),i&&i.then((function(){c.command(e)}))}c.command=function(e,t){if(e.toFrontend=!0,e.origin=m(),e.id=h(),t&&(e.ack=!0,y[e.id]=t),window!==top)d.postTopMessage(e);else{if(!i){if("hideKeystroke"===e.action)return;u()}i.then((function(){d.postTopMessage(e)}))}};var w={};c.addSearchAlias=function(e,t,n,o,r,i){o&&r&&(w[o]=r),v({action:"addSearchAlias",alias:e,prompt:t,url:n,suggestionURL:o,options:i})},c.removeSearchAlias=function(e){v({action:"removeSearchAlias",alias:e})};var k={},S={};function E(){var e=document.getSelection(),t=e.toString().trim();t&&!/[\W_]/.test(t)&&t.length&&"Range"===e.type&&c.performInlineQueryOnSelection(t)}c.performInlineQueryOnSelection=function(e){var t=document.getSelection().getRangeAt(0).getClientRects()[0];c.performInlineQuery(e,t,(function(e,t){t&&a("front",["showBubble",{top:e.top,left:e.left,height:e.height,width:e.width},t,!1])}))},k.updateInlineQuery=function(e){e.word?c.performInlineQueryOnSelection(e.word):E()},k.getSearchSuggestions=function(e){var t=null;if(w.hasOwnProperty(e.url)){const n=w[e.url];t="function"==typeof n?n(e.response,{url:e.requestUrl,query:e.query}):new Promise(((t,n)=>{const o=h();S[o]=e=>{t(e)},a("user",["getSearchSuggestions",e.url,e.response,{url:e.requestUrl,query:e.query},o])}))}return t},c.executeCommand=function(e){c.command({action:"executeCommand",cmdline:e})};var x,T,N=X("div","Hi, I'm here now!",{id:"sk_frame"});function _(e){document.documentElement.append(N);var t=e.rect;N.style.top=t.top+"px",N.style.left=t.left+"px",N.style.width=t.width+"px",N.style.height=t.height+"px",N.style.display="",setTimeout((function(){N.remove()}),e.duration)}function L(){let n=[t.mappings,o.mappings,e.mappings];const r=t.getLurkMode();return r&&n.unshift(r.mappings),n.map(G).reduce((function(e,t){return e.concat(t)}))}function A(){c.command({action:"hidePopup"})}function R(e){if("DIV"===T.nodeName)if("CodeMirror-code"===T.className){window.getSelection().selectAllChildren(T);let t=new DataTransfer;t.items.add(e,"text/plain"),T.dispatchEvent(new ClipboardEvent("paste",{clipboardData:t}))}else e=e.replace(/\n+$/,""),"function"==typeof T.setEditorText?T.setEditorText(e):T.innerText=e;else if("function"==typeof T.setValueWithEventDispatched)T.setValueWithEventDispatched(e);else{T.value=e;var t=document.createEvent("HTMLEvents");t.initEvent("change",!1,!0),T.dispatchEvent(t)}}N.fromSurfingKeys=!0,c.showUsage=function(){c.command({action:"showUsage",metas:L()})},c.getUsage=function(e){c.command({action:"getUsage",metas:L()},(function(t){e(t.data)}))},c.showEditor=function(e,t,n,o){n=n||e.localName;var r,i=0;if("string"==typeof e)r=e,T=document.body;else if("select"===n){var a=e.value;r=Array.from(e.querySelectorAll("option")).map((function(e,t){return e.value===a&&(i=t),e.innerText.trim()+" >< "+e.value})).join("\n"),T=e}else if("DIV"===(T=e).nodeName)if("CodeMirror-code"===T.className){let e=T.querySelectorAll(".CodeMirror-line");r=(r=Array.from(e).map((e=>e.innerText)).join("\n")).replace(/\u200B/g,"")}else r=T.innerText;else r=T.value;x=t||R;const s={action:"showEditor",type:n||"textarea",initial_line:i,content:r};(o||d.conf.useNeovim)&&(s.file_name=`${new URL(window.location.origin).host}/${T.nodeName.toLowerCase()}`),c.command(s)},c.chooseTab=function(){""!==t.repeats?s("focusTabByIndex"):c.command({action:"chooseTab"})},c.openOmnibar=function(e){e.action="openOmnibar",c.command(e)};var I,M=!1;c.performInlineQuery=function(e,t,n){if(void 0!==document.dictEnabled&&document.dictEnabled)"dictorium:"===window.location.protocol?window===top?window.location.href=e:window.postMessage({dictorium_data:{type:"DictoriumReload",word:e}}):window.postMessage({dictorium_data:{type:"OpenDictoriumQuery",word:e,sentence:"",pos:t,source:window.location.href}}),A();else if(M){d.conf.autoSpeakOnInlineQuery&&r.readText(e),e=e.toLocaleLowerCase(),d.updateHistory("OmniQuery",e);const o=h();S[o]=e=>{n(t,e)},a("user",["performInlineQuery",e,o])}else p()?(I=function(e){n(t,e)},document.getElementById("proxyFrame").contentWindow.postMessage({surfingkeys_content_data:{action:"performInlineQuery",pos:t,query:e}},"*")):($("https://github.com/brookhong/Surfingkeys/wiki/Register-inline-query"),A())},c.registerInlineQuery=function(){M=!0},c.openOmniquery=function(e){c.openOmnibar({type:"OmniQuery",extra:e.query,style:e.style})};var P,U={accumulated:"",candidates:{},key:""};function F(){P&&(clearTimeout(P),P=void 0)}c.showStatus=function(e,t){c.command({action:"showStatus",contents:e,duration:t})},c.toggleStatus=function(e){c.command({action:"toggleStatus",visible:e})},S=b("front",{showPopup:e=>{c.command({action:"showPopup",content:e})},applySettingsFromSnippets:t=>{v({action:"applyUserSettings",userSettings:t});const n=JSON.parse(JSON.stringify(t));for(var o in n)d.conf.hasOwnProperty(o)&&(d.conf[o]=n[o],delete n[o]);d.conf.enableEmojiInsertion&&e.enableEmojiInsertion(),Object.keys(n).length>0&&window===top&&s("updateSettings",{scope:"snippets",settings:n}),a("settingsFromSnippetsLoaded")},querySelectedWord:E,addMapkey:(e,t,n)=>{v({action:"addMapkey",mode:e,new_keystroke:t,old_keystroke:n})},addVimMap:(e,t,n)=>{v({action:"addVimMap",lhs:e,rhs:t,ctx:n})},addVimKeyMap:e=>{v({action:"addVimKeyMap",vimKeyMap:e})},highlightElement:_,hidePopup:A,openFinder:()=>{c.command({action:"openFinder"})},showBanner:(e,t)=>{c.command({action:"showBanner",content:e,linger_time:t})},showBubble:(e,t,n)=>{t.length>0&&(e.winWidth=window.innerWidth,e.winHeight=window.innerHeight,e.winX=0,e.winY=0,window.frameElement&&(e.winX=window.frameElement.offsetLeft,e.winY=window.frameElement.offsetTop),c.command({action:"showBubble",content:t,position:e,noPointerEvents:n}))},hideBubble:()=>{c.command({action:"hideBubble"})},hideKeystroke:()=>{U.accumulated="",U.candidates={},c.command({action:"hideKeystroke"})},showKeystroke:(e,t)=>{U.accumulated+=e,U.key=e,U.candidates={};var n=t.mappings.find(U.accumulated);n&&n.getMetas((function(e){return!0})).forEach((function(e){U.candidates[e.word]={annotation:e.annotation}})),c.command({action:"showKeystroke",keyHints:U})},showStatus:c.showStatus,toggleStatus:c.toggleStatus}),k.ace_editor_saved=function(n){void 0!==n.data&&x(n.data),d.conf.focusOnSaved&&C(T)&&(t.passFocus(!0),T.focus(),e.enter(T))},k.nextEdit=function(e){var t,o=n.getSelector()||"input, textarea, *[contenteditable=true], select";if(t=o,(o=g(document.body,NodeFilter.SHOW_ELEMENT,(function(e){return e.offsetHeight&&e.offsetWidth&&e.matches(t)}))).length){var r=o.indexOf(T);r=(r+(e.backward?-1:1))%o.length,O(o=o[r]),te(o,(()=>{c.showEditor(o)}))}},k.omnibar_query_entered=function(e){d.updateHistory("OmniQuery",e.query),c.performInlineQuery(e.query,{top:0,left:80,height:0,width:100},(function(t,n){if("Array"!==n.constructor.name&&(n=[n]),"Chrome"===f()){var r=o.findSentenceOf(e.query);r.length>0&&n.push(r)}c.command({action:"updateOmnibarResult",words:n})}))},k.getBackFocus=function(e){window.focus(),window===top&&i&&i.then((e=>{e.shadowRoot.contains(document.activeElement)&&document.activeElement.blur()}))},k.getPageText=function(e){return document.body.innerText},k.visualUpdate=function(e){F(),P=setTimeout((function(){o.visualUpdate(e.query),c.command({action:"visualUpdated"})}),500)},k.visualClear=function(e){F(),o.visualClear()},k.visualEnter=function(e){F(),o.visualEnter(e.query)},k.emptySelection=function(e){o.emptySelection()};var H,D=window===top;return k.deactivated=function(e){D=!1},k.activated=function(e){D=!0},d.on("focusFrame",(function(e,t,n){e.frameId===window.frameId&&(window.focus(),document.body.scrollIntoView({behavior:"auto",block:"center",inline:"center"}),_({duration:500,rect:{top:0,left:0,width:window.innerWidth,height:window.innerHeight}}))})),window.addEventListener("message",(function(e){var t=e.data&&(e.data.surfingkeys_content_data||e.data.dictorium_data);if(void 0!==t){if("performInlineQuery"===t.action)c.performInlineQuery(t.query,t.pos,(function(t,n){e.source.postMessage({surfingkeys_content_data:{action:"performInlineQueryResult",pos:t,result:n}},e.origin)}));else if("performInlineQueryResult"===t.action)I(t.pos,t.result);else if(D){if(y[t.id])(0,y[t.id])(t)||delete y[t.id];else if(t.action&&k.hasOwnProperty(t.action)){var n=k[t.action](t);t.ack&&n&&(n.then||(n=Promise.resolve(n)),n.then((e=>d.postTopMessage({data:e,toFrontend:!0,origin:t.origin,id:t.id}))))}}else("activated"===t.action||"DictoriumViewReady"===t.type)&&k.activated(t);e.data.dictorium_data||e.stopImmediatePropagation()}}),!0),c.attach=function(){H&&(clearTimeout(H),H=void 0),i||u()},c.detach=function(){i&&i.then((e=>{H=setTimeout((function(){e.detach(),i=void 0}),3e3)}))},c};const Ee=function(e,t,n,o,r,s,c){function l(e,t,n){var o={code:e};return n&&(o.repeatIgnore=n),t&&(t=z(t),o.feature_group=t.feature_group,o.annotation=t.annotation),o}function u(e){return!e||e.test(document.location.href)||e.test(window.origin)}function d(e,t,n,o,a){if(u((a=a||{}).domain)){t=i.encodeKeystroke(t);var s=e.mappings.remove(t);if(s)x("warn",s.meta?`${s.meta.word} for [${s.meta.annotation}] is overridden by [${n}].`:s.getMetas((function(){return!0})).map((function(e){return`${e.word} for [${e.annotation}] is overridden by [${n}].`})));else if(t.length>1)for(var c=t.substr(0,t.length-1);c.length>0;){if((s=e.mappings.find(c))&&s.meta)return void x("warn",`${s.meta.word} for [${s.meta.annotation}] precedes ${t}.`);c=c.substr(0,c.length-1)}var d=l(o,{annotation:n,feature_group:e===r?9:14},a.repeatIgnore);e.mappings.add(t,d)}}function f(e,t,o,r){d(n,e,t,o,r)}function m(e,t,n,o){d(r,e,t,n,o)}function h(e,n,o,r){d(t,e,n,o,r)}function g(e,t,o,r){if(u(o))if(":"===t[0]&&t.length>1){var c=t.substr(1),d=l((function(){s.executeCommand(c)}),r?z({annotation:r}):null,!1);n.mappings.add(i.encodeKeystroke(e),d)}else!V(n,e,t,r)&&t in fe.specialKeys?(fe.specialKeys[t].push(e),a("front",["addMapkey","Mode",e,t])):x("warn",`${t} not found in normal mode.`)}function y(e,t){if(u(t))if(n.mappings.find(i.encodeKeystroke(e)))n.mappings.remove(i.encodeKeystroke(e));else for(var o in fe.specialKeys){var r=fe.specialKeys[o].indexOf(e);-1!==r&&fe.specialKeys[o].splice(r,1)}}function v(e,t){u(t)&&r.mappings.remove(i.encodeKeystroke(e))}function w(e,t,n,o,r,i,a,c){p()||s.addSearchAlias(e,t,n,r,i,c);if(!(c?.skipMaps??!1)){f((o||"s")+e,"#6Search selected with "+t,u),f("o"+e,"#8Open Search with alias "+e,(()=>{s.openOmnibar({type:"SearchEngine",extra:e})})),m((o||"s")+e,"",u),f((o||"s")+(a||"o")+e,"",d),m((o||"s")+(a||"o")+e,"",d);var l=e.toUpperCase();if(l!==e){function h(){k(n,!1,!0,e)}function g(){k(n,!0,!0,e)}f((o||"s")+l,"",h),m((o||"s")+l,"",h),f((o||"s")+(a||"o")+l,"",g),m((o||"s")+(a||"o")+l,"",g)}}function u(){k(n)}function d(){k(n,!0)}}function k(t,n,o,r){e.read((function(e){var i=window.getSelection().toString()||e.data;n&&(i="site:"+window.location.hostname+" "+i),o?s.openOmnibar({type:"SearchEngine",extra:r,pref:i}):$(function(e,t){return e.indexOf("{0}")>0?e.format(t):e.indexOf("%s")>0?e.replace("%s",t):e+t}(t,encodeURIComponent(i)))}))}return b("api",{addSearchAlias:w,imap:function(e,n,o,r){u(o)&&V(t,e,n,r)},map:g,lmap:function(e,t,o,r){u(o)&&n.addLurkMap(e,t)},unmap:y,unmapAllExcept:function(e,o){u(o)&&[n,t].forEach((function(t){for(var n=new me,o=0,r=(e=e||[]).length;o<r;o++){var a=i.encodeKeystroke(e[o]),s=t.mappings.find(a);s&&n.add(a,s.meta)}delete t.mappings,t.mappings=n,t.map_node=n}))},iunmap:function(e,n){u(n)&&t.mappings.remove(i.encodeKeystroke(e))},vunmap:v,removeSearchAlias:function(e,t,n){p()||s.removeSearchAlias(e),y((t||"s")+e),y("o"+e),v((t||"s")+e),y((t||"s")+(n||"o")+e),v((t||"s")+(n||"o")+e);var o=e.toUpperCase();o!==e&&(y((t||"s")+o),v((t||"s")+o),y((t||"s")+(n||"o")+o),v((t||"s")+(n||"o")+o))},searchSelectedWith:k,"clipboard:write":e.write,"clipboard:read":()=>{e.read((e=>{a("user",["onClipboardRead",e])}))},"hints:click":o.click,"hints:create":o.create,"hints:setCharacters":o.setCharacters,"hints:setNumeric":o.setNumeric,"hints:style":o.style,"front:registerInlineQuery":s.registerInlineQuery,"front:openOmnibar":s.openOmnibar,"normal:feedkeys":n.feedkeys,"normal:jumpVIMark":n.jumpVIMark,"normal:passThrough":n.passThrough,"normal:scroll":n.scroll,"visual:style":r.style,mapkey:(e,t,n)=>{f(e,t,(()=>{a("user",["callUserFunction",`normal:${e}`])}),n)},imapkey:(e,t,n)=>{h(e,t,(()=>{a("user",["callUserFunction",`insert:${e}`])}),n)},vmapkey:(e,t,n)=>{m(e,t,(()=>{a("user",["callUserFunction",`visual:${e}`])}),n)}}),{addSearchAlias:w,cmap:function(e,t,n,o){u(n)&&a("front",["addMapkey","Omnibar",e,t])},map:g,mapkey:f,imapkey:h,readText:c.readText,vmapkey:m}};function xe(e,t,n){for(var o in n)d.conf.hasOwnProperty(o)&&(d.conf[o]=n[o]);if("findHistory"in n&&(d.conf.lastQuery=n.findHistory.length?n.findHistory[0]:""),!n.showAdvanced&&(n.basicMappings&&function(e,t,n){const o=new Set(Object.keys(n)),r={};for(const i in n){const a=n[i];if(o.has(a)){const e=t.mappings.find(a);e&&(r[a]=e.meta)}""===a?t.mappings.remove(i):r.hasOwnProperty(i)?t.mappings.add(a,r[i]):e.map(a,i)}}(e,t,n.basicMappings),n.disabledSearchAliases))for(const t in n.disabledSearchAliases)e.removeSearchAlias(t);document.addEventListener("surfingkeys:settingsFromSnippetsLoaded",(()=>{if(d.conf.showProxyInStatusBar&&"proxyMode"in n){var e=n.proxyMode;-1!==["byhost","always"].indexOf(n.proxyMode)&&(e="{0}: {1}".format(n.proxyMode,n.proxy)),a("front",["showStatus",[void 0,void 0,void 0,e]])}s("getState",{blocklistPattern:d.conf.blocklistPattern?d.conf.blocklistPattern:void 0,lurkingPattern:d.conf.lurkingPattern?d.conf.lurkingPattern:void 0},(function(e){let n=e.state;"disabled"===n?t.disable():"lurking"===n?n=t.startLurk():("application/pdf"!==document.contentType||e.noPdfViewer?t.enable():Oe.usePdfViewer(),fe.showStatus()),window===top&&s("setSurfingkeysIcon",{status:n})}))}),{once:!0})}function Ce(){const e=be(),t=ye(),n=he(t);n.enter(),ge(n);const o=we(t,n),r=ve(e,o),c=Se(t,n,o,r,Oe),l=Ee(e,t,n,o,r,c,Oe);return function(e,t,n,o,r,c,l){const{addSearchAlias:u,cmap:p,map:m,mapkey:h,imapkey:g,readText:y,vmapkey:b}=e;function k(e){var t=S();t.blur(),n.exit(),l.showEditor(t,null,null,e)}function x(){window.getSelection().toString()?searchSelectedWith("https://translate.google.com/?hl=en#auto/en/",!1,!1,""):$("https://translate.google.com/translate?js=n&sl=auto&tl=zh-CN&u="+window.location.href)}function C(){var e=[];return document.querySelectorAll("table").forEach((function(t){var n=t.querySelector("tr");n&&e.push(...n.children)})),e}function T(e,t){var n=new FormData(e);if("json"===t){var o={};return n.forEach((function(e,t){if(o.hasOwnProperty(t)){if(e.length){var n=o[t];"Array"===n.constructor.name?n.push(e):(o[t]=[],n.length&&o[t].push(n),o[t].push(e))}}else o[t]=e})),o}return new URLSearchParams(n).toString()}function O(e){return(e.method||"get")+"::"+new URL(e.action).pathname}h("[[","#1Click on the previous link on current page",r.previousPage),h("]]","#1Click on the next link on current page",r.nextPage),h("T","#3Choose a tab",(function(){l.chooseTab()})),h("?","#0Show usage",(function(){l.showUsage()})),h("Q","#8Open omnibar for word translation",(function(){l.openOmniquery({query:q(),style:"opacity: 0.8;"})})),g("<Ctrl-'>","#15Toggle quotes in an input element",E),g("<Ctrl-i>","#15Open vim editor for current input",(function(){k(!1)})),"Chrome"===f()&&(g("<Ctrl-Alt-i>","#15Open neovim for current input",(function(){k(!0)})),h(";s","Toggle PDF viewer from SurfingKeys",(function(){var e=window.location.href;0===e.indexOf(chrome.runtime.getURL("/pages/pdf_viewer.html"))?(e=window.location.search.substr(3),s("updateSettings",{settings:{noPdfViewer:1}},(t=>{window.location.replace(e)}))):document.querySelector("EMBED")&&"application/pdf"===document.querySelector("EMBED").getAttribute("type")?s("updateSettings",{settings:{noPdfViewer:0}},(t=>{window.location.replace(e)})):s("getSettings",{key:"noPdfViewer"},(function(e){const t=e.settings.noPdfViewer?"PDF viewer enabled.":"PDF viewer disabled.";s("updateSettings",{settings:{noPdfViewer:!e.settings.noPdfViewer}},(e=>{v(t)}))}))}))),h(";ql","#0Show last action",(function(){w(Z(d.conf.lastKeys.map((function(e){return i.decodeKeystroke(e)})).join(" → ")))}),{repeatIgnore:!0}),h("gi","#1Go to the first edit box",(function(){r.createInputLayer()})),h("i","#1Go to edit box",(function(){r.create("input:not([type=submit]), textarea, *[contenteditable=true], *[role=textbox], select, div.ace_cursor",r.dispatchMouseClick)})),h("I","#1Go to edit box with vim editor",(function(){r.create("input:not([type=submit]), textarea, *[contenteditable=true], *[role=textbox], select, div.ace_cursor",(function(e){l.showEditor(e)}))})),h("zv","#9Enter visual mode, and select whole element",(function(){c.toggle("z")})),h("yv","#7Yank text of an element",(function(){r.create(d.conf.textAnchorPat,(function(e){t.write(0===e[1]?e[0].data.trim():e[2].trim())}))})),h("ymv","#7Yank text of multiple elements",(function(){var e=[];r.create(d.conf.textAnchorPat,(function(n){e.push(0===n[1]?n[0].data.trim():n[2].trim()),t.write(e.join("\n"))}),{multipleHits:!0})})),h("V","#9Restore visual mode",(function(){c.restore()})),h("*","#9Find selected text in current page",(function(){c.star(),c.toggle()})),b("<Ctrl-u>","#9Backward 20 lines",(function(){c.feedkeys("20k")})),b("<Ctrl-d>","#9Forward 20 lines",(function(){c.feedkeys("20j")})),h("m","#10Add current URL to vim-like marks",o.addVIMark),h("'","#10Jump to vim-like mark",o.jumpVIMark),h("<Ctrl-'>","#10Jump to vim-like mark in new tab.",(function(e){o.jumpVIMark(e)})),h("w","#2Switch frames",(function(){a("ensureFrontEnd"),window===top&&r.create("iframe",(function(e){e.scrollIntoView({behavior:"auto",block:"center",inline:"center"}),o.highlightElement(e),e.contentWindow.focus()}))||o.rotateFrame()})),h("yg","#7Capture current page",(function(){l.toggleStatus(!1),setTimeout((function(){s("captureVisibleTab",null,(function(e){l.toggleStatus(!0),w("<img src='{0}' />".format(e.dataUrl))}))}),500)})),h("gu","#4Go up one path in the URL",(function(){var e=location.pathname;if(e.length>1){var t=(e=e.endsWith("/")?e.substr(0,e.length-1):e).lastIndexOf("/"),n=s.repeats;for(s.repeats=1;n-- >1;){var o=e.lastIndexOf("/",t-1);if(-1===o)break;t=o}e=e.substr(0,t)}window.location.href=location.origin+e})),h(";m","#1mouse out last element",(function(){r.mouseoutLastElement()})),h(";pp","#7Paste html on current page",(function(){t.read((function(e){document.documentElement.removeAttributes(),document.body.removeAttributes(),Y(document.head,"<title>"+new Date+" updated by Surfingkeys</title>"),Y(document.body,e.data)}))})),h(";t","Translate selected text with google",x),b("t","#9Translate selected text with google",x),h("O","#1Open detected links from text",(function(){r.create(d.conf.clickablePat,(function(e){window.location.assign(e[2])}),{statusLine:"Open detected links from text"})})),h(".","#0Repeat last action",(function(){const e=d.conf.lastKeys;o.feedkeys(e[0]);for(var t=e.slice(1),n=0;n<t.length;n++){var i=t[n].split("\t");if("Hints"===i[0]){function a(){var e=i[1];return function(){r.feedkeys(e)}}setTimeout(a(),120+100*n)}}}),{repeatIgnore:!0}),h("f","#1Open a link, press SHIFT to flip overlapped hints, hold SPACE to hide hints",(function(){r.create("",r.dispatchMouseClick)}),{repeatIgnore:!0}),h("v","#9Toggle visual mode",(function(){c.toggle()}),{repeatIgnore:!0}),h("n","#9Next found text",(function(){c.next(!1)}),{repeatIgnore:!0}),h("N","#9Previous found text",(function(){c.next(!0)}),{repeatIgnore:!0}),h(";fs","#1Display hints to focus scrollable elements",(function(){r.create(o.refreshScrollableElements(),r.dispatchMouseClick)})),b("q","#9Translate word under cursor",(function(){var e=q();N.readText(e);var t=c.getCursorPixelPos();l.performInlineQuery(e,{top:t.top,left:t.left,height:t.height,width:t.width},(function(e,t){a("front",["showBubble",e,t,!0])}))})),h("cq","#7Query word with Hints",(function(){r.create(d.conf.textAnchorPat,(function(e){var t,n,o,r=e[2].trim().replace(/[^A-z].*$/,""),i=H(e[0],e[1],e[2].length);void 0!==document.dictEnabled?document.dictEnabled&&window.postMessage({dictorium_data:{type:"OpenDictoriumQuery",word:r,sentence:(t=e[0],n=e[1],o="",A((function(e){e.setPosition(t,n),e.modify("extend","backward","sentence"),e.collapseToStart(),e.modify("extend","forward","sentence"),o=e.toString()})),o.replace(/\n/g,"")),pos:i,source:window.location.href}}):l.performInlineQuery(r,{top:i.top,left:i.left,height:i.height,width:i.width},(function(e,t){a("front",["showBubble",e,t,!1])}))}))})),m("g0",":feedkeys 99E",0,"#3Go to the first tab"),m("g$",":feedkeys 99R",0,"#3Go to the last tab"),h("zr","#3zoom reset",(function(){s("setZoom",{zoomFactor:0})})),h("zi","#3zoom in",(function(){s("setZoom",{zoomFactor:.1})})),h("zo","#3zoom out",(function(){s("setZoom",{zoomFactor:-.1})})),m("ZQ",":quit"),h("ZZ","#5Save session and quit",(function(){s("createSession",{name:"LAST",quitAfterSaved:!0})})),h("ZR","#5Restore last session",(function(){s("openSession",{name:"LAST"})})),m("u","e"),h("af","#1Open a link in active new tab",(function(){r.create("",r.dispatchMouseClick,{tabbed:!0,active:!0})})),h("gf","#1Open a link in non-active new tab",(function(){r.create("",r.dispatchMouseClick,{tabbed:!0,active:!1})})),h("cf","#1Open multiple links in a new tab",(function(){r.create("",r.dispatchMouseClick,{multipleHits:!0})})),m("C","gf"),h("<Ctrl-h>","#1Mouse over elements.",(function(){r.create("",((e,t)=>{if(chrome.surfingkeys){const t=e.getClientRects()[0];chrome.surfingkeys.sendMouseEvent(2,Math.round(t.x+t.width/2),Math.round(t.y+t.height/2),0)}else r.dispatchMouseClick(e,t)}),{mouseEvents:["mouseover"]})})),h("<Ctrl-j>","#1Mouse out elements.",(function(){r.create("",r.dispatchMouseClick,{mouseEvents:["mouseout"]})})),h("ya","#7Copy a link URL to the clipboard",(function(){r.create("*[href]",(function(e){t.write(e.href)}))})),h("yma","#7Copy multiple link URLs to the clipboard",(function(){var e=[];r.create("*[href]",(function(n){e.push(n.href),t.write(e.join("\n"))}),{multipleHits:!0})})),h("yc","#7Copy a column of a table",(function(){r.create(C(),(function(e){var n=Array.from(e.closest("table").querySelectorAll("tr")).map((function(t){return t.children.length>e.cellIndex?t.children[e.cellIndex].innerText:""}));t.write(n.join("\n"))}))})),h("ymc","#7Copy multiple columns of a table",(function(){var e=null;r.create(C(),(function(n){var o=Array.from(n.closest("table").querySelectorAll("tr")).map((function(e){return e.children.length>n.cellIndex?e.children[n.cellIndex].innerText:""}));e?o.forEach((function(t,n){e[n]+="\t"+t})):e=o,t.write(e.join("\n"))}),{multipleHits:!0})})),h("yq","#7Copy pre text",(function(){r.create("pre",(function(e){t.write(e.innerText)}))})),m("<Ctrl-i>","I"),p("<ArrowDown>","<Tab>"),p("<ArrowUp>","<Shift-Tab>"),p("<Ctrl-n>","<Tab>"),p("<Ctrl-p>","<Shift-Tab>"),h("q","#1Click on an Image or a button",(function(){r.create("img, button",r.dispatchMouseClick)})),h("<Alt-p>","#3pin/unpin current tab",(function(){s("togglePinTab")})),h("<Alt-m>","#3mute/unmute current tab",(function(){s("muteTab")})),h("B","#4Go one tab history back",(function(){s("historyTab",{backward:!0})}),{repeatIgnore:!0}),h("F","#4Go one tab history forward",(function(){s("historyTab",{backward:!1})}),{repeatIgnore:!0}),h("<Ctrl-6>","#4Go to last used tab",(function(){s("goToLastTab")})),h("gT","#4Go to first activated tab",(function(){s("historyTab",{index:0})}),{repeatIgnore:!0}),h("gt","#4Go to last activated tab",(function(){s("historyTab",{index:-1})}),{repeatIgnore:!0}),h("gp","#4Go to the playing tab",(function(){s("getTabs",{queryInfo:{audible:!0}},(e=>{e.tabs?.at(0)&&(tab=e.tabs[0],s("focusTab",{windowId:tab.windowId,tabId:tab.id}))}))}),{repeatIgnore:!0}),h("S","#4Go back in history",(function(){history.go(-1)}),{repeatIgnore:!0}),h("D","#4Go forward in history",(function(){history.go(1)}),{repeatIgnore:!0}),h("r","#4Reload the page",(function(){s("reloadTab",{nocache:!1})})),h("oi","#8Open incognito window",(function(){s("openIncognito",{url:window.location.href})})),h("H","#8Open opened URL in current tab",(function(){l.openOmnibar({type:"TabURLs"})})),h("om","#8Open URL from vim-like marks",(function(){l.openOmnibar({type:"VIMarks"})})),h(":","#8Open commands",(function(){l.openOmnibar({type:"Commands"})})),h("yi","#7Yank text of an input",(function(){r.create("input, textarea, select",(function(e){t.write(e.value)}))})),h("x","#3Close current tab",(function(){s("closeTab")})),h(";w","#2Focus top window",(function(){top.focus()})),h("cc","#7Open selected link or link from clipboard",(function(){window.getSelection().toString()?$(window.getSelection().toString()):t.read((function(e){$(e.data)}))})),h(";cq","#7Clear all URLs in queue to be opened",(function(){s("clearQueueURLs")})),h("ys","#7Copy current page's source",(function(){var e=document.documentElement.cloneNode(!0);t.write(e.outerHTML)})),h("yj","#7Copy current settings",(function(){s("getSettings",{key:"RAW"},(function(e){t.write(JSON.stringify(e.settings,null,4))}))})),h(";pj","#7Restore settings data from clipboard",(function(){t.read((function(e){s("updateSettings",{settings:JSON.parse(e.data.trim())})}))})),h("yt","#3Duplicate current tab",(function(){s("duplicateTab")})),h("yT","#3Duplicate current tab in background",(function(){s("duplicateTab",{active:!1})})),h("yy","#7Copy current page's URL",(function(){var e=window.location.href;0===e.indexOf(chrome.runtime.getURL("/pages/pdf_viewer.html"))&&(e=window.location.search.substr(3)),t.write(e)})),h("yY","#7Copy all tabs's url",(function(){s("getTabs",null,(function(e){t.write(e.tabs.map((e=>e.url)).join("\n"))}))})),h("yh","#7Copy current page's host",(function(){var e=new URL(window.location.href);t.write(e.host)})),h("yl","#7Copy current page's title",(function(){t.write(document.title)})),h("yQ","#7Copy all query history of OmniQuery.",(function(){s("getSettings",{key:"OmniQueryHistory"},(function(e){t.write(e.settings.OmniQueryHistory.join("\n"))}))})),h("yf","#7Copy form data in JSON on current page",(function(){var e={};document.querySelectorAll("form").forEach((function(t){e[O(t)]=T(t,"json")})),t.write(JSON.stringify(e,null,4))})),h(";pf","#7Fill form with data from yf",(function(){r.create("form",(function(e,n){var o=O(e);t.read((function(t){var n=JSON.parse(t.data.trim());if(n.hasOwnProperty(o)){var r=n[o];e.querySelectorAll("input, textarea").forEach((function(t){if(r.hasOwnProperty(t.name)&&"hidden"!==t.type)if("radio"===t.type){var n=e.querySelector(`input[name='${t.name}'][value='${r[t.name]}']`);n&&(n.checked=!0)}else Array.isArray(r[t.name])?(e.querySelectorAll(`input[name='${t.name}']`).forEach((function(e){e.checked=!1})),r[t.name].forEach((function(n){var o=e.querySelector(`input[name='${t.name}'][value='${n}']`);o&&(o.checked=!0)}))):"string"==typeof r[t.name]&&(t.value=r[t.name])}))}else v("No form data found for your selection from clipboard.")}))}))})),h("yp","#7Copy form data for POST on current page",(function(){var e=[];document.querySelectorAll("form").forEach((function(t){var n={};n[(t.method||"get")+"::"+t.action]=T(t),e.push(n)})),t.write(JSON.stringify(e,null,4))})),h("g?","#4Reload current page without query string(all parts after question mark)",(function(){window.location.href=window.location.href.replace(/\?[^\?]*$/,"")})),h("g#","#4Reload current page without hash fragment",(function(){window.location.href=window.location.href.replace(/\#[^\#]*$/,"")})),h("gU","#4Go to root of current URL hierarchy",(function(){window.location.href=window.location.origin})),h("gxt","#3Close tab on left",(function(){s("closeTabLeft")})),h("gxT","#3Close tab on right",(function(){s("closeTabRight")})),h("gx0","#3Close all tabs on left",(function(){s("closeTabsToLeft")})),h("gx$","#3Close all tabs on right",(function(){s("closeTabsToRight")})),h("gxx","#3Close all tabs except current one",(function(){s("tabOnly")})),h("gxp","#3Close playing tab",(function(){s("closeAudibleTab")})),h(";e","#11Edit Settings",(function(){$("/pages/options.html")})),h(";u","#4Edit current URL with vim editor, and open in new tab",(function(){l.showEditor(window.location.href,(function(e){$(e)}),"url")})),h(";U","#4Edit current URL with vim editor, and reload",(function(){l.showEditor(window.location.href,(function(e){window.location.href=e}),"url")})),u("g","google","https://www.google.com/search?q=","s","https://www.google.com/complete/search?client=chrome-omni&gs_ri=chrome-ext&oit=1&cp=1&pgcl=7&q=",(function(e){return JSON.parse(e.text)[1]})),u("d","duckduckgo","https://duckduckgo.com/?q=","s","https://duckduckgo.com/ac/?q=",(function(e){return JSON.parse(e.text).map((function(e){return e.phrase}))})),u("b","baidu","https://www.baidu.com/s?wd=","s","https://suggestion.baidu.com/su?cb=&wd=",(function(e){var t=e.text.match(/,s:\[("[^\]]+")]}/);return t?t[1].replace(/"/g,"").split(","):[]})),u("e","wikipedia","https://en.wikipedia.org/wiki/","s","https://en.wikipedia.org/w/api.php?action=opensearch&format=json&formatversion=2&namespace=0&limit=40&search=",(function(e){return JSON.parse(e.text)[1]})),u("w","bing","https://www.bing.com/search?setmkt=en-us&setlang=en-us&q=","s","https://api.bing.com/osjson.aspx?query=",(function(e){return JSON.parse(e.text)[1]})),u("s","stackoverflow","https://stackoverflow.com/search?q="),u("h","github","https://github.com/search?q=","s","https://api.github.com/search/repositories?order=desc&q=",(function(e){var t=JSON.parse(e.text).items;return t?t.map((function(e){return{title:e.description,url:e.html_url}})):[]})),u("y","youtube","https://www.youtube.com/results?search_query=","s","https://clients1.google.com/complete/search?client=youtube&ds=yt&callback=cb&q=",(function(e){return JSON.parse(e.text.substr(9,e.text.length-10))[1].map((function(e){return e[0]}))}));const N=f();"Firefox"===N?h("on","#3Open newtab",(function(){$("about:blank")})):"Chrome"===N&&(h("cp","#13Toggle proxy for current site",(function(){var e=window.location.host.replace(/:\d+/,"");e&&e.length&&s("updateProxy",{host:e,operation:"toggle"})})),h(";cp","#13Copy proxy info",(function(){s("getSettings",{key:["proxyMode","proxy","autoproxy_hosts"]},(function(e){t.write(JSON.stringify(e.settings,null,4))}))})),h(";ap","#13Apply proxy info from clipboard",(function(){t.read((function(e){var t=JSON.parse(e.data);s("updateProxy",{operation:"set",host:t.autoproxy_hosts,proxy:t.proxy,mode:t.proxyMode})}))})),m(";pa",":setProxyMode always",0,"#13set proxy mode `always`"),m(";pb",":setProxyMode byhost",0,"#13set proxy mode `byhost`"),m(";pd",":setProxyMode direct",0,"#13set proxy mode `direct`"),m(";ps",":setProxyMode system",0,"#13set proxy mode `system`"),m(";pc",":setProxyMode clear",0,"#13set proxy mode `clear`"),h("gr","#14Read selected text or text from clipboard",(function(){t.read((function(e){y(window.getSelection().toString()||e.data,{verbose:!0})}))})),b("gr","#9Read selected text",(function(){y(window.getSelection().toString(),{verbose:!0})})),h("on","#3Open newtab",(function(){$("chrome://newtab/")})),h("ga","#12Open Chrome About",(function(){$("chrome://help/")})),h("gb","#12Open Chrome Bookmarks",(function(){$("chrome://bookmarks/")})),h("gc","#12Open Chrome Cache",(function(){$("chrome://cache/")})),h("gd","#12Open Chrome Downloads",(function(){$("chrome://downloads/")})),h("gh","#12Open Chrome History",(function(){$("chrome://history/")})),h("gk","#12Open Chrome Cookies",(function(){$("chrome://settings/cookies")})),h("ge","#12Open Chrome Extensions",(function(){$("chrome://extensions/")})),h("gn","#12Open Chrome net-internals",(function(){$("chrome://net-internals/#proxy")})),h(";i","#12Open Chrome Inspect",(function(){$("chrome://inspect/#devices")})),h(";v","#11Open neovim",(function(){$("/pages/neovim.html")}))),f().startsWith("Safari")||(h("t","#8Open a URL",(function(){l.openOmnibar({type:"URLs"})})),h("go","#8Open a URL in current tab",(function(){l.openOmnibar({type:"URLs",tabbed:!1})})),h("ox","#8Open recently closed URL",(function(){l.openOmnibar({type:"RecentlyClosed"})})),h("X","#3Restore closed tab",(function(){s("openLast")})),h("b","#8Open a bookmark",(function(){l.openOmnibar({type:"Bookmarks"})})),h("ab","#8Bookmark current page to selected folder",(function(){var e={url:window.location.href,title:document.title};l.openOmnibar({type:"AddBookmark",extra:e})})),h("oh","#8Open URL from history",(function(){l.openOmnibar({type:"History"})})),h("W","#3Move current tab to another window",(function(){l.openOmnibar({type:"Windows"})})),h(";gt","#3Gather filtered tabs into current window",(function(){l.openOmnibar({type:"Tabs",extra:{action:"gather"}})})),h(";gw","#3Gather all tabs into current window",(function(){s("gatherWindows")})),h("<<","#3Move current tab to left",(function(){s("moveTab",{step:-1})})),h(">>","#3Move current tab to right",(function(){s("moveTab",{step:1})})),h("yd","#7Copy current downloading URL",(function(){s("getDownloads",{query:{state:"in_progress"}},(function(e){var n=e.downloads.map((function(e){return e.url}));t.write(n.join(","))}))})),h("gs","#12View page source",(function(){s("viewSource",{tab:{tabbed:!0}})})),h(";pm","#11Preview markdown",(function(){$("/pages/markdown.html")})),h(";di","#1Download image",(function(){r.create("img",(function(e){s("download",{url:e.src})}))})),h(";j","#12Close Downloads Shelf",(function(){s("closeDownloadsShelf",{clearHistory:!0})})),h(";dh","#14Delete history older than 30 days",(function(){s("deleteHistoryOlderThan",{days:30})})),h(";yh","#14Yank histories",(function(){s("getHistory",{},(function(e){t.write(e.history.map((e=>e.url)).join("\n"))}))})),h(";ph","#14Put histories from clipboard",(function(){t.read((function(e){s("addHistories",{history:e.data.split("\n")})}))})),h(";db","#14Remove bookmark for current page",(function(){s("removeBookmark")})))}(l,e,t,n,o,r,c),"function"==typeof Oe.plugin&&Oe.plugin({front:c}),a("defaultSettingsLoaded",{normal:n,api:l}),s("getSettings",null,(function(e){var t=e.settings;xe(l,n,t);a("userSettingsLoaded",{settings:t,disabledSearchAliases:t.disabledSearchAliases,getUsage:c.getUsage,frontCommand:c.command})})),{normal:n,front:c,api:l}}function Te(e){if(window.frameId=h(),d.on("settingsUpdated",(t=>{var n=t.settings;xe(e.api,e.normal,n)})),d.conf.stealFocusOnLoad&&!p()&&document.body&&document.body.childElementCount>1){var t=S();t&&t.blur()}}let Oe;window.getFrameId=function(){return!window.frameId&&window.innerWidth>16&&window.innerHeight>16&&document.body&&document.body.childElementCount>0&&-1===d.conf.ignoredFrameHosts.indexOf(window.origin)&&(!window.frameElement||parseInt("0"+getComputedStyle(window.frameElement).zIndex)>=0&&window.frameElement.offsetWidth>16&&window.frameElement.offsetWidth>16)&&Te(Ce()),window.frameId},fe.init(window===top?void 0:()=>{window.addEventListener("focus",(()=>{getFrameId()}),{once:!0})}),Oe={usePdfViewer:function(){window.location.replace(chrome.runtime.getURL("/pages/pdf_viewer.html")+"?r="+document.URL)},readText:function(e,t){var n=(t=t||{enqueue:!0,voiceName:d.conf.defaultVoice}).verbose,o=/[\s\u00a0]/g,r=(n=t.verbose,t.onEnd);delete t.verbose,delete t.onEnd,s("read",{content:e,options:t},(function(t){if(n)if("start"===t.ttsEvent.type)w(e);else if("word"===t.ttsEvent.type){o.lastIndex=t.ttsEvent.charIndex;var i=o.exec(e);w(i?e.substr(0,t.ttsEvent.charIndex)+"<font style='font-weight: bold; text-decoration: underline'>"+e.substr(t.ttsEvent.charIndex,i.index-t.ttsEvent.charIndex+1)+"</font>"+e.substr(i.index):e.substr(0,t.ttsEvent.charIndex)+"<font style='font-weight: bold; text-decoration: underline'>"+e.substr(t.ttsEvent.charIndex)+"</font>")}else"end"===t.ttsEvent.type&&a("front",["hidePopup"]);return!r||"end"!==t.ttsEvent.type&&"interrupted"!==t.ttsEvent.type||r(),"end"!==t.ttsEvent.type}))}}||{usePdfViewer:()=>{},readText:()=>{}},window===top?new Promise(((e,t)=>{window.location.href===chrome.runtime.getURL("/pages/options.html")?import("./pages/options.js").then((t=>{t.default(s,i,fe,X,f,Z,j,T,Y,v),e(Ce())})):e(Ce())})).then((e=>{Te(e),d.on("titleChanged",(function(){fe.checkEventListener((()=>{e.front.detach(),Te(e=Ce()),e.front.attach()}))})),d.on("tabActivated",(function(){e.front.attach()})),d.on("tabDeactivated",(function(){e.front.detach()})),d.on("setScrollPos",(function(e,t,n){setTimeout((()=>{document.scrollingElement.scrollLeft=e.scrollLeft,document.scrollingElement.scrollTop=e.scrollTop}),1e3)})),d.on("showBanner",(function(e,t,n){v(e.message,3e3)})),document.addEventListener("surfingkeys:ensureFrontEnd",(function(t){e.front.attach()})),s("tabURLAccessed",{title:document.title,url:window.location.href},(function(e){if(e.index>0){var t=function(){o=!0,document.title=n+" "+r},n=e.index,o=!1,r=document.title;new MutationObserver((function(e){o?o=!1:(r=document.title,t())})).observe(document.querySelector("title"),{childList:!0}),t(),d.on("tabIndexChange",(function(e,o,r){e.index!==n&&(n=e.index,t())}))}}))})):document.addEventListener("surfingkeys:iframeBoot",(()=>{Te(Ce())}),{once:!0})})()})();