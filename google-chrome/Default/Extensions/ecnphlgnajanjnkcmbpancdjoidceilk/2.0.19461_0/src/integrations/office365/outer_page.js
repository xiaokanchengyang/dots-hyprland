(function(){"use strict";window.addEventListener("message",s);function s(n){var t,o;if(!((t=n.data)!=null&&t.requestKamiOfficeDocumentData))return;const e=r();if(!e){console.debug("Kami: unable to extract document data");return}for(const a of document.querySelectorAll("iframe")){const i={kamiOfficeDocumentData:!0,data:e};console.debug("Kami: sending document data to child",i),(o=a.contentWindow)==null||o.postMessage(i,n.origin)}window.removeEventListener("message",s)}function r(){return window.location.host==="onedrive.live.com"?u():c()}function c(){var a,i;if(!_wopiContextJson||!_spPageContextInfo)return;let n,e,t;typeof _spPageContextInfo.userEmail=="string"&&(n=_spPageContextInfo.userEmail);const o=_wopiContextJson.BundleUrl;if(typeof o=="string"&&(e=(a=o.match(/drives\/(b![^/]+)/))==null?void 0:a[1],t=(i=o.match(/items\/([^/]+)/))==null?void 0:i[1]),!e&&!t&&typeof _wopiContextJson.DriveId=="string"&&typeof _wopiContextJson.DriveItemId=="string"&&(e=_wopiContextJson.DriveId,t=_wopiContextJson.DriveItemId),!(!e||!t||!n))return{driveId:e,itemId:t,userEmail:n,accountType:"business"}}function u(){const n=WacConfig.viewParams.cid,e=WacConfig.viewParams.id,t=$Config.email,o="personal";if(n&&e&&t)return{driveId:n,itemId:e,userEmail:t,accountType:o}}})();
